
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Material Balances XIV &#8212; Kinetics and Reaction Engineering</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Material Balances XV" href="587-L24.html" />
    <link rel="prev" title="Material Balances XIII" href="587-L22.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/JQB.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Kinetics and Reaction Engineering</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Chapter1.html">
   Python Supplements
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S01.html">
     The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S02.html">
     Data Structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S03.html">
     Arrays and Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S04.html">
     For Loops and Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S05.html">
     Logical Tests and Comparisons
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S06.html">
     While Loops in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S07.html">
     Functions, D&amp;D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S08.html">
     The Fall of Acererak
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S09.html">
     Root Finding: Univariate Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S10.html">
     Minimizing a Univariate Function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S11.html">
     Minimizing Multivariate Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S12.html">
     Systems of Nonlinear Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S13.html">
     Least Squares Revisited
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S14.html">
     ODE Solvers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S15.html">
     Quadrature
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../Chapter2.html">
   Lectures
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="587-L01.html">
     Introduction and Stoichiometry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L02.html">
     Extent and Conversion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L03.html">
     Algebraic and Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L04.html">
     Chemical Equilibrium I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L05.html">
     Chemical Equilibrium II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L06.html">
     Chemical Equilibrium III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L07.html">
     Chemical Equilibrium IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L08.html">
     Chemical Equilibrium V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L09.html">
     Chemical and Phase Equilibria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L10.html">
     Material Balances I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L11.html">
     Material Balances II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L12.html">
     Material Balances III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L13.html">
     Material Balances IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L14.html">
     Material Balances V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L15.html">
     Material Balances VI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L16.html">
     Material Balances VII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L17.html">
     Material Balances VIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L18.html">
     Material Balances IX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L19.html">
     Material Balances X
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L20.html">
     Material Balances XI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L21.html">
     Material Balances XII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L22.html">
     Material Balances XIII
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Material Balances XIV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L24.html">
     Material Balances XV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L25.html">
     Material Balances XVI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L26.html">
     Material Balances XVII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L27.html">
     Material Balances XVIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L28.html">
     Kinetics I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L29.html">
     Kinetics II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L30.html">
     Kinetics III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L31.html">
     Kinetics IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L32.html">
     Kinetics V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L33.html">
     Kinetics VI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L34.html">
     Kinetics VII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L35.html">
     Kinetics VIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L36.html">
     Kinetics IX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L37.html">
     Kinetics X
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L38.html">
     Kinetics XI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L39.html">
     Energy Balances I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L40.html">
     Energy Balances II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L41.html">
     Energy Balances III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L42.html">
     Energy Balances IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L43.html">
     Energy Balances VI
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Chapter3.html">
   Recitations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R01.html">
     Jupyter and Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R02.html">
     Solving Algebraic Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R03.html">
     Chemical Equilibrium
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R04.html">
     Solving ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R05.html">
     Chemical/Phase Equilibria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R06.html">
     CSTRs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R07.html">
     Python tips and tricks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R08.html">
     Optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R09.html">
     Reactors with Recycle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R10.html">
     Interpolation and Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R11.html">
     Nonlinear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R12.html">
     Parameter Estimation I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R13.html">
     Parameter Estimation II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R14.html">
     Energy Balances
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/jqbond/2022CEN587/main?urlpath=tree/Lectures/587-L23.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/jqbond/2022CEN587"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/jqbond/2022CEN587/issues/new?title=Issue%20on%20page%20%2FLectures/587-L23.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Lectures/587-L23.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-01-revisiting-benzene-pyrolysis-in-a-pfr">
   Example Problem 01: Revisiting Benzene Pyrolysis in a PFR
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-01">
     Solution to Example Problem 01
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#consider-maximixing-diphenyl-production-as-opposed-to-benzene-conversion">
     Consider Maximixing Diphenyl Production as opposed to Benzene Conversion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-max-and-np-argmax">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       max()
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       np.argmax()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introducing-yield-and-selectivity">
     Introducing Yield and Selectivity
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-02-benzene-pyrolysis-with-yields-and-selectivities">
   Example Problem 02: Benzene Pyrolysis with Yields and Selectivities
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-02">
     Solution to Example Problem 02
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-the-value-and-location-of-the-maximum-diphenyl-yield">
     Finding the value and location of the maximum diphenyl yield
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-03">
   Example Problem 03
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-03">
     Solution to Example 03
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-a">
       Balance on A
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-b">
       Balance on B
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-c">
       Balance on C
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#definining-conversion-yield-and-selectivity">
     Definining Conversion, Yield, and Selectivity
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#conversion">
       Conversion
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#yields">
       Yields
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#selectivities">
       Selectivities
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#maximizing-the-yield-of-b">
     Maximizing the Yield of B
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Material Balances XIV</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-01-revisiting-benzene-pyrolysis-in-a-pfr">
   Example Problem 01: Revisiting Benzene Pyrolysis in a PFR
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-01">
     Solution to Example Problem 01
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#consider-maximixing-diphenyl-production-as-opposed-to-benzene-conversion">
     Consider Maximixing Diphenyl Production as opposed to Benzene Conversion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-max-and-np-argmax">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       max()
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       np.argmax()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introducing-yield-and-selectivity">
     Introducing Yield and Selectivity
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-02-benzene-pyrolysis-with-yields-and-selectivities">
   Example Problem 02: Benzene Pyrolysis with Yields and Selectivities
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-02">
     Solution to Example Problem 02
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-the-value-and-location-of-the-maximum-diphenyl-yield">
     Finding the value and location of the maximum diphenyl yield
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-03">
   Example Problem 03
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-03">
     Solution to Example 03
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-a">
       Balance on A
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-b">
       Balance on B
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-c">
       Balance on C
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#definining-conversion-yield-and-selectivity">
     Definining Conversion, Yield, and Selectivity
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#conversion">
       Conversion
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#yields">
       Yields
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#selectivities">
       Selectivities
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#maximizing-the-yield-of-b">
     Maximizing the Yield of B
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="material-balances-xiv">
<h1>Material Balances XIV<a class="headerlink" href="#material-balances-xiv" title="Permalink to this headline">#</a></h1>
<p>This lecture continues the discussion of reactor design for systems involving multiple reactions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
</pre></div>
</div>
</div>
</div>
<section id="example-problem-01-revisiting-benzene-pyrolysis-in-a-pfr">
<h2>Example Problem 01: Revisiting Benzene Pyrolysis in a PFR<a class="headerlink" href="#example-problem-01-revisiting-benzene-pyrolysis-in-a-pfr" title="Permalink to this headline">#</a></h2>
<p>You are carrying out Benzene Pyrolysis in a Plug Flow Reactor operating at 1033K and 1.0 atm.  The two reactions occurring in this system are benzene coupling to form diphenyl and hydrogen followed by a secondary reaction between benzene and diphenyl to form triphenyl and hydrogen:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
&amp;2B \longleftrightarrow D + H_2\\
&amp;B + D \longleftrightarrow T + H_2
\end{align*}\]</div>
<p>Both reactions are reversible and <em><strong>follow elementary rate laws</strong></em>.  Rate constants and equilibrium concentration ratios (<span class="math notranslate nohighlight">\(K_C\)</span>) are given below.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
&amp;k_1 = 7.0 \ \times 10^5 \ \textrm{L} \ \textrm{mol}^{-1} \ \textrm{h}^{-1}\\
&amp;k_2 = 4.0 \ \times 10^5 \ \textrm{L} \ \textrm{mol}^{-1} \ \textrm{h}^{-1}\\
&amp;K_{C_1} = 0.31\\
&amp;K_{C_2} = 0.48
\end{align*}\]</div>
<p>If pure benzene is fed into the reactor at 60,000 moles per hour, find the PFR volume required to achieve 50% conversion of Benzene.  Also, plot the mole fraction of each species as a function of PFR volume.</p>
<p><strong>Answer</strong>: 403.3 L</p>
<section id="solution-to-example-problem-01">
<h3>Solution to Example Problem 01<a class="headerlink" href="#solution-to-example-problem-01" title="Permalink to this headline">#</a></h3>
<p><em>This is exactly the same as our solution from L22, we are just going to expand consideration of the PFR.</em></p>
<p>Even though there are multiple reactions, we approach this problem the same way as usual: we write a material balance on Benzene.</p>
<div class="math notranslate nohighlight">
\[\frac{dF_B}{dV} = R_B\]</div>
<p>We generally know that <span class="math notranslate nohighlight">\(R_B\)</span> is going to be a complex function of concentrations of all of the species present in this system.  That means we can’t solve the above balance on Benzene without also solving balances on Diphenyl, Hydrogen, and Triphenyl <em>at the same time</em>, i.e., we have to solve the coupled system of differential equations below:</p>
<div class="amsmath math notranslate nohighlight" id="equation-a4df1b67-ea7b-496f-bc6f-b8bbd5f177c7">
<span class="eqno">(122)<a class="headerlink" href="#equation-a4df1b67-ea7b-496f-bc6f-b8bbd5f177c7" title="Permalink to this equation">#</a></span>\[\begin{align}
    \frac{dF_B}{dV} &amp;= R_B \\
    \frac{dF_D}{dV} &amp;= R_D \\
    \frac{dF_H}{dV} &amp;= R_H \\
    \frac{dF_T}{dV} &amp;= R_T \\
\end{align}\]</div>
<p>So, we’ve got 4 differential equations that tell us how 4 dependent variables (<span class="math notranslate nohighlight">\(F_B\)</span>, <span class="math notranslate nohighlight">\(F_D\)</span>, <span class="math notranslate nohighlight">\(F_H\)</span>, <span class="math notranslate nohighlight">\(F_T\)</span>) change as a function of the one independent variable, V.  We can solve this system <em>if</em> we can define everything on the right hand sides of the above equations (<span class="math notranslate nohighlight">\(R_B\)</span>, <span class="math notranslate nohighlight">\(R_D\)</span>, <span class="math notranslate nohighlight">\(R_H\)</span>, and <span class="math notranslate nohighlight">\(R_T\)</span>) in terms of <span class="math notranslate nohighlight">\(F_B\)</span>, <span class="math notranslate nohighlight">\(F_D\)</span>, <span class="math notranslate nohighlight">\(F_H\)</span>, <span class="math notranslate nohighlight">\(F_T\)</span>, and/or <span class="math notranslate nohighlight">\(V\)</span>.</p>
<p>We know how to do this!!</p>
<p>Generally:</p>
<div class="math notranslate nohighlight">
\[R_j = \sum_i \nu_{i,j} r_i\]</div>
<p>So:</p>
<div class="amsmath math notranslate nohighlight" id="equation-b2c5cfa7-3e0a-4035-8b55-5d36ea45aa9a">
<span class="eqno">(123)<a class="headerlink" href="#equation-b2c5cfa7-3e0a-4035-8b55-5d36ea45aa9a" title="Permalink to this equation">#</a></span>\[\begin{align}
    R_B &amp;= -2r1 - r2 \\
    R_D &amp;=  r1 - r2 \\
    R_H &amp;=  r2 + r2 \\
    R_T &amp;=  r2 \\
\end{align}\]</div>
<p>We next define reaction rates:</p>
<div class="amsmath math notranslate nohighlight" id="equation-292e1f1a-b31a-4abe-b36b-93f6f9b323f9">
<span class="eqno">(124)<a class="headerlink" href="#equation-292e1f1a-b31a-4abe-b36b-93f6f9b323f9" title="Permalink to this equation">#</a></span>\[\begin{align}
    r_1 &amp;= k_{1,f}C_B^2 - k_{1,r}C_HC_D \\
    r_2 &amp;= k_{2,f}C_BC_D - k_{2,r}C_HC_T \\
\end{align}\]</div>
<p>We define concentrations in terms of molar flowrates:</p>
<div class="math notranslate nohighlight">
\[F_j = \frac{F_j}{Q}\]</div>
<p>Which throws a volumetric flowrate, Q, into the mix.  Fortunately, this is a gas phase reaction at low pressure, so we know we can define Q in terms of the total molar flowrate:</p>
<div class="math notranslate nohighlight">
\[Q = \frac{F_{tot}RT}{P}\]</div>
<p>Where</p>
<div class="math notranslate nohighlight">
\[F_{tot} = \sum_j F_j\]</div>
<p>With that, we’ve defined out system of ODES fully as a function of molar flowrates and reactor volume.  We can solve this numerically using solve_ivp.  See below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">P01</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
    
    <span class="c1">#Dependent variables are all in var</span>
    <span class="n">FB</span><span class="p">,</span> <span class="n">FD</span><span class="p">,</span> <span class="n">FH</span><span class="p">,</span> <span class="n">FT</span> <span class="o">=</span> <span class="n">var</span>
    
    <span class="c1">#Constants from problem statement</span>
    <span class="n">T</span>   <span class="o">=</span> <span class="mi">1033</span>    <span class="c1">#K</span>
    <span class="n">P</span>   <span class="o">=</span> <span class="mf">1.0</span>     <span class="c1">#atm</span>
    <span class="n">R</span>   <span class="o">=</span> <span class="mf">0.08206</span> <span class="c1">#L*atm/mol/K</span>
    <span class="n">k1f</span> <span class="o">=</span> <span class="mf">7.0e5</span>   <span class="c1">#L/mol/h</span>
    <span class="n">k2f</span> <span class="o">=</span> <span class="mf">4.0e5</span>   <span class="c1">#L/mol/h</span>
    <span class="n">KC1</span> <span class="o">=</span> <span class="mf">0.31</span>
    <span class="n">KC2</span> <span class="o">=</span> <span class="mf">0.48</span>
    <span class="n">k1r</span> <span class="o">=</span> <span class="n">k1f</span><span class="o">/</span><span class="n">KC1</span> <span class="c1">#L/mol/h</span>
    <span class="n">k2r</span> <span class="o">=</span> <span class="n">k2f</span><span class="o">/</span><span class="n">KC2</span> <span class="c1">#L/mol/h=</span>
    
    <span class="c1">#total molar flowrate, function of individual molar flowrates</span>
    <span class="n">FTOT</span> <span class="o">=</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">FD</span> <span class="o">+</span> <span class="n">FH</span> <span class="o">+</span> <span class="n">FT</span>
    
    <span class="c1">#volumetric flowrate</span>
    <span class="n">Q</span>    <span class="o">=</span> <span class="n">FTOT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>
    
    <span class="c1">#Define concentrations</span>
    <span class="n">CB</span>   <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CD</span>   <span class="o">=</span> <span class="n">FD</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CH</span>   <span class="o">=</span> <span class="n">FH</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CT</span>   <span class="o">=</span> <span class="n">FT</span><span class="o">/</span><span class="n">Q</span>
    
    <span class="c1">#now that we have concentrations, we define reaction rates</span>
    <span class="n">r1</span>   <span class="o">=</span> <span class="n">k1f</span><span class="o">*</span><span class="n">CB</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">k1r</span><span class="o">*</span><span class="n">CD</span><span class="o">*</span><span class="n">CH</span>
    <span class="n">r2</span>   <span class="o">=</span> <span class="n">k2f</span><span class="o">*</span><span class="n">CB</span><span class="o">*</span><span class="n">CD</span> <span class="o">-</span> <span class="n">k2r</span><span class="o">*</span><span class="n">CT</span><span class="o">*</span><span class="n">CH</span>
    
    <span class="c1">#With reaction rates, you can define production rates</span>
    <span class="n">RB</span>   <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RD</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RH</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span>
    <span class="n">RT</span>   <span class="o">=</span>         <span class="n">r2</span>
    
    <span class="c1">#For a PFR, dFj/dV = Rj, so these are our derivatives of FB, FD, FH, FT</span>
    <span class="n">D1</span>   <span class="o">=</span> <span class="n">RB</span>
    <span class="n">D2</span>   <span class="o">=</span> <span class="n">RD</span>
    <span class="n">D3</span>   <span class="o">=</span> <span class="n">RH</span>
    <span class="n">D4</span>   <span class="o">=</span> <span class="n">RT</span>
    
    <span class="c1">#return derivatives of each dependent variable w.r.t. volume</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">,</span> <span class="n">D3</span><span class="p">,</span> <span class="n">D4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#This cell solves the ODE system (an initial value problem) using solve_ivp</span>
<span class="n">FBf</span>     <span class="o">=</span> <span class="mi">60000</span> <span class="c1">#mol/h</span>
<span class="n">FDf</span>     <span class="o">=</span> <span class="mi">0</span>
<span class="n">FHf</span>     <span class="o">=</span> <span class="mi">0</span>
<span class="n">FTf</span>     <span class="o">=</span> <span class="mi">0</span>

<span class="c1">#Solve the problem</span>
<span class="n">vspan</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
<span class="n">var0</span>    <span class="o">=</span> <span class="p">[</span><span class="n">FBf</span><span class="p">,</span> <span class="n">FDf</span><span class="p">,</span> <span class="n">FHf</span><span class="p">,</span> <span class="n">FTf</span><span class="p">]</span>
<span class="n">solP01</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">P01</span><span class="p">,</span> <span class="n">vspan</span><span class="p">,</span> <span class="n">var0</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-12</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-12</span><span class="p">)</span>

<span class="c1">#Extract data from the solution structure.</span>

<span class="c1">#Volumes from the ODE solver</span>
<span class="n">Vout</span>    <span class="o">=</span> <span class="n">solP01</span><span class="o">.</span><span class="n">t</span>

<span class="c1">#Molar flowrates as a function of volume.</span>
<span class="n">FBout</span>   <span class="o">=</span> <span class="n">solP01</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">FDout</span>   <span class="o">=</span> <span class="n">solP01</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">FHout</span>   <span class="o">=</span> <span class="n">solP01</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">FTout</span>   <span class="o">=</span> <span class="n">solP01</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="c1">#Sum things up to get the total molar flowrate as a function of volume.</span>
<span class="n">FTot_o</span>  <span class="o">=</span> <span class="n">FBout</span> <span class="o">+</span> <span class="n">FDout</span> <span class="o">+</span> <span class="n">FHout</span> <span class="o">+</span> <span class="n">FTout</span>

<span class="c1">#Calculate mole fractions as a function of volume.</span>
<span class="n">yBout</span>   <span class="o">=</span> <span class="n">FBout</span><span class="o">/</span><span class="n">FTot_o</span>
<span class="n">yDout</span>   <span class="o">=</span> <span class="n">FDout</span><span class="o">/</span><span class="n">FTot_o</span>
<span class="n">yHout</span>   <span class="o">=</span> <span class="n">FHout</span><span class="o">/</span><span class="n">FTot_o</span>
<span class="n">yTout</span>   <span class="o">=</span> <span class="n">FTout</span><span class="o">/</span><span class="n">FTot_o</span>

<span class="c1">#Calculate conversion</span>
<span class="n">XBout</span>   <span class="o">=</span> <span class="p">(</span><span class="n">FBf</span> <span class="o">-</span> <span class="n">FBout</span><span class="p">)</span><span class="o">/</span><span class="n">FBf</span>

<span class="c1">#Plot conversion vs. reactor volume.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Benzene Conversion vs. PFR Volume&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">XBout</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">vspan</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">vspan</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Benzene Conversion&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L23_5_0.png" src="../_images/587-L23_5_0.png" />
</div>
</div>
</section>
<section id="consider-maximixing-diphenyl-production-as-opposed-to-benzene-conversion">
<h3>Consider Maximixing Diphenyl Production as opposed to Benzene Conversion<a class="headerlink" href="#consider-maximixing-diphenyl-production-as-opposed-to-benzene-conversion" title="Permalink to this headline">#</a></h3>
<p>We already know (from L21) that we need a 403L PFR in order to achieve 50% conversion of Benzene.  A different question might be what volume <em>should</em> the reactor be.  As we discussed in class, that depends on our goal.  If it is to maximize Benzene conversion, then something like a 3000L reactor…but if it is to maximize the production of a certain compound, like diphenyl, we’d make a different choice. In fact, if we really wanted to maximize Diphenyl production, we’d probably want to stick with a reactor volume of about 400L because that is where the mole fraction of diphenyl is at a maximum.  This leads us into a discussion about <em><strong>optimization</strong></em>, which is the third type of numerical method we will use in this course (the first one being <em><strong>algebraic equation solvers</strong></em> like those in <code class="docutils literal notranslate"><span class="pre">opt.root()</span></code> or <code class="docutils literal notranslate"><span class="pre">opt.newton()</span></code> and the second one being <em><strong>ODE/Initial Value Problem solvers</strong></em> like those in <code class="docutils literal notranslate"><span class="pre">solve_ivp()</span></code>). We will take a look at numerical methods for optimization (minimization) in Recitation 08 on Thursday.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot mole fractions vs. volume</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Species Mole Fractions vs. PFR Volume&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">yBout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yB&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">yDout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">yHout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yH&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">yTout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yT&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">vspan</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mole fraction&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#Plot mole fractions vs. volume</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Finding the maximum value for yD&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">yBout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yB&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">yDout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">yHout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yH&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">yTout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yT&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mole fraction&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L23_7_0.png" src="../_images/587-L23_7_0.png" />
<img alt="../_images/587-L23_7_1.png" src="../_images/587-L23_7_1.png" />
</div>
</div>
</section>
<section id="using-max-and-np-argmax">
<h3>Using <code class="docutils literal notranslate"><span class="pre">max()</span></code> and <code class="docutils literal notranslate"><span class="pre">np.argmax()</span></code><a class="headerlink" href="#using-max-and-np-argmax" title="Permalink to this headline">#</a></h3>
<p>For this example, since we’ve already solved for mole fractions as a function of volume, it is relatively easy to find the PFR volume that would maximize production of diphenyl.</p>
<div class = "alert alert-block alert-warning">
    <b>Note</b>: This is a relatively crude optimization because we are finding the maximum mole fraction of diphenyl that <i>the solver stepped to</i> when solving the ODE system.  The true maximum is probably slightly different from this.
    </div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yDmax1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">yDout</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The maximum diphenyl mole fraction is </span><span class="si">{</span><span class="n">yDmax1</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">. </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">indexmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">yDout</span><span class="p">)</span>
<span class="n">yDmax2</span>   <span class="o">=</span> <span class="n">yDout</span><span class="p">[</span><span class="n">indexmax</span><span class="p">]</span>
<span class="n">Vmax2</span>    <span class="o">=</span> <span class="n">Vout</span><span class="p">[</span><span class="n">indexmax</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The maximum diphenyl mole fraction is </span><span class="si">{</span><span class="n">yDmax2</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">, which we obtain at a PFR volume of </span><span class="si">{</span><span class="n">Vmax2</span><span class="si">:</span><span class="s1">0.0f</span><span class="si">}</span><span class="s1">L.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The maximum diphenyl mole fraction is 0.205. 

The maximum diphenyl mole fraction is 0.205, which we obtain at a PFR volume of 488L.
</pre></div>
</div>
</div>
</div>
</section>
<section id="introducing-yield-and-selectivity">
<h3>Introducing Yield and Selectivity<a class="headerlink" href="#introducing-yield-and-selectivity" title="Permalink to this headline">#</a></h3>
<p>The benzene pyrolysis examples highlight the fact that conversion alone is not an adequate process specification when we’re dealing with multiple reactions.  We also need a way to quantify the amounts of each product that we make.  This is done using two metrics: <strong>Yield</strong> and <strong>Selectivity</strong>.</p>
<p>We define the <strong>yield</strong> as the percentage of our reactant that was converted into a specific product.</p>
<p>We define the <strong>overall selectivity</strong> as the percentage of consumed reactant that was converted into a specific product.</p>
<p><strong>Consider A generic pair of reactions</strong></p>
<p>Let’s discuss two reactions.  The first one converts our reactant, A, into a desired product (valuable, non-toxic, beneficial to society somehow, etc).  The second one occurs in parallel and converts our reactant A into something undesirable (toxic, costly to dispose, greenhouse gas, etc).  We would like to establish a general way for discussing the amounts of D and U that are produced in reaction.</p>
<div class="amsmath math notranslate nohighlight" id="equation-decfe389-fa53-4d46-aa0d-be8cf220c573">
<span class="eqno">(125)<a class="headerlink" href="#equation-decfe389-fa53-4d46-aa0d-be8cf220c573" title="Permalink to this equation">#</a></span>\[\begin{align}
    (1) \qquad \nu_{A1} \, A \longrightarrow \nu_{D1} D \\
    (2) \qquad \nu_{A2} \, A \longrightarrow \nu_{D1} U \\
\end{align}\]</div>
<p><strong>Yields</strong></p>
<p>Consider the yield:  This would be the percentage of our reactant, A, that is converted into each product.  So, for a batch reactor (where we usually work with moles of species), the “yield of D with respect to A” would be defined conceptually as: the number of moles of A converted into species D divided by the initial number of moles of A put into the system.  In equation form, that looks like:</p>
<p><em><strong>In a batch reactor</strong></em></p>
<div class="math notranslate nohighlight">
\[Y_{D/A} = \frac{\left|\frac{\nu_{A1}}{\nu_{D1}}\right|N_D}{N_{A0}}\]</div>
<p>Similarly, we would define the yield of U with respect to A as the number of moles of A converted into species U divided by the initial number of moles of A put into the system, i.e.:</p>
<div class="math notranslate nohighlight">
\[Y_{U/A} = \frac{\left|\frac{\nu_{A2}}{\nu_{U2}}\right|N_U}{N_{A0}}\]</div>
<p><em><strong>In a Flow Reactor</strong></em></p>
<p>If we were working with a flow reactor, it usually makes more sense to work with molar flowrates instead of number of moles, so we would define the two yields as:</p>
<div class="math notranslate nohighlight">
\[Y_{D/A} = \frac{\left|\frac{\nu_{A1}}{\nu_{D1}}\right|F_D}{F_{Af}}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[Y_{U/A} = \frac{\left|\frac{\nu_{A2}}{\nu_{U2}}\right|F_U}{F_{Af}}\]</div>
<p><strong>Selectivities</strong></p>
<p>For now, we’ll only work with a quantity that we call the “Overall Selectivity,” which is defined as the percentage of the <em>consumed reactant</em> that was converted into a specific product.  So, at a conceptual level, if I wanted to define the “overall selectivity of D with respect to A,” that would be defined as the number of moles of A that were converted to make D divided by the total number of moles of A consumed.  In Equation form:</p>
<p><em><strong>In a Batch Reactor</strong></em></p>
<div class="math notranslate nohighlight">
\[S_{D/A} = \frac{\left|\frac{\nu_{A1}}{\nu_{D1}}\right|N_D}{N_{A0} - N_A}\]</div>
<p>And the “overall selectivity of U with respect to A” is given by the number of moles of A converted to make U divided by the total number of moles of A consumed.</p>
<div class="math notranslate nohighlight">
\[S_{U/A} = \frac{\left|\frac{\nu_{A2}}{\nu_{U2}}\right|N_U}{N_{A0} - N_A}\]</div>
<p><em><strong>In a Flow Reactor</strong></em></p>
<p>And, similar to yields, if I’m working with a flow process, I will define these quantities in terms of molar flowrates.</p>
<div class="math notranslate nohighlight">
\[S_{D/A} = \frac{\left|\frac{\nu_{A1}}{\nu_{D1}}\right|F_D}{F_{Af} - F_A}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[S_{U/A} = \frac{\left|\frac{\nu_{A2}}{\nu_{U2}}\right|F_U}{F_{Af} - F_A}\]</div>
<p><strong>Fractional Conversion</strong></p>
<p>These definitions complement the one for fractional conversion:</p>
<p><strong>Batch Reactor</strong></p>
<div class="math notranslate nohighlight">
\[X_A = \frac{N_{A0} - N_A}{N_{A0}}\]</div>
<p><strong>Flow Reactor</strong></p>
<div class="math notranslate nohighlight">
\[X_A = \frac{F_{Af} - F_A}{F_{Af}}\]</div>
<p>As a final note:</p>
<div class = "alert alert-block alert-info">
    With the definitions above, fractional conversion, selectivity, and yield will always be between 0 and 1.
    </div></section>
</section>
<section id="example-problem-02-benzene-pyrolysis-with-yields-and-selectivities">
<h2>Example Problem 02: Benzene Pyrolysis with Yields and Selectivities<a class="headerlink" href="#example-problem-02-benzene-pyrolysis-with-yields-and-selectivities" title="Permalink to this headline">#</a></h2>
<p>You are carrying out Benzene Pyrolysis in a Plug Flow Reactor operating at 1033K and 1.0 atm.  The two reactions occurring in this system are benzene coupling to form diphenyl and hydrogen followed by a secondary reaction between benzene and diphenyl to form triphenyl and hydrogen:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
&amp;2B \longleftrightarrow D + H_2\\
&amp;B + D \longleftrightarrow T + H_2
\end{align*}\]</div>
<p>Both reactions are reversible and <em><strong>follow elementary rate laws</strong></em>.  Rate constants and equilibrium concentration ratios (<span class="math notranslate nohighlight">\(K_C\)</span>) are given below.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
&amp;k_1 = 7.0 \ \times 10^5 \ \textrm{L} \ \textrm{mol}^{-1} \ \textrm{h}^{-1}\\
&amp;k_2 = 4.0 \ \times 10^5 \ \textrm{L} \ \textrm{mol}^{-1} \ \textrm{h}^{-1}\\
&amp;K_{C_1} = 0.31\\
&amp;K_{C_2} = 0.48
\end{align*}\]</div>
<p>Pure benzene is fed into the reactor at 60,000 moles per hour.  <strong>Plot the overall yield and overall selectivity toward diphenyl (with respect to benzene) as a function of reactor volume.</strong></p>
<section id="solution-to-example-problem-02">
<h3>Solution to Example Problem 02<a class="headerlink" href="#solution-to-example-problem-02" title="Permalink to this headline">#</a></h3>
<p>We solve this essentially the same way as we did Example Problem 01 – we write the material balances for all species in the reactor, and we solve the resultant coupled system of ODEs using <code class="docutils literal notranslate"><span class="pre">solve_ivp()</span></code>. This part is identical to the solution from L22.</p>
<p>We recognize that solution of the problem using <code class="docutils literal notranslate"><span class="pre">solve_ivp()</span></code> will give us the molar flowrates of Benzene, Diphenyl, Triphenyl, and Hydrogen as a function of reactor volume.  This is enough information for us to calculate yields and selectivity as a function of reactor volume since both of those quantities are defined in terms of molar flowrates for flow reactors.  Specifically:</p>
<p><strong>Yield of Diphenyl with respect to Benzene</strong></p>
<p>According to the first reaction, each diphenyl produced will consume two benzenes, so the correct definition for yield according to the equations in the preceding section is:</p>
<div class="math notranslate nohighlight">
\[Y_{D/B} = \frac{2F_D}{F_{Bf}}\]</div>
<p>The coefficients are less clear for triphenyl since each triphenyl consumes one diphenyl…which consumes two benzenes.  The easiest way to handle the yield definition for a sequential reaction like this is to add the overall reactions so that we can relate triphenyl directly to benzene:</p>
<div class="amsmath math notranslate nohighlight" id="equation-314b835f-6b5c-4dc0-aa32-42e701b8d74a">
<span class="eqno">(126)<a class="headerlink" href="#equation-314b835f-6b5c-4dc0-aa32-42e701b8d74a" title="Permalink to this equation">#</a></span>\[\begin{align}
   &amp;2B \leftrightarrow D + H \\
   &amp;B + D \leftrightarrow T + H \\
        \hline
    &amp;3B \leftrightarrow T + 2H \\
\end{align}\]</div>
<p>From that overall equation, it becomes clear that it takes 3 benzenes to make one triphenyl, so the yield definition is:</p>
<div class="math notranslate nohighlight">
\[Y_{T/B} = \frac{3F_T}{F_{Bf}}\]</div>
<p>We extend these ideas to the selectivity definitions, which quantify the percentage of consumed reactant that went to produce diphenyl or triphenyl.</p>
<p>Selectivity to diphenyl with respect to benzene:</p>
<div class="math notranslate nohighlight">
\[S_{D/B} = \frac{2F_D}{F_{Bf} - F_B}\]</div>
<p>Selectivity to triphenyl with respect to benzene:</p>
<div class="math notranslate nohighlight">
\[S_{T/B} = \frac{3F_T}{F_{Bf} - F_B}\]</div>
<p>It is also worth pointing out the the product of fractional conversion and product selectivity (when defined as above) will give the yield to a specific product:</p>
<div class="math notranslate nohighlight">
\[Y_{D/B} = X_BS_{D/B} = \frac{F_{Bf} - F_B}{F_{Bf}} \cdot \frac{2F_D}{F_{Bf} - F_B} = \frac{2F_D}{F_{Bf}}\]</div>
<div class="math notranslate nohighlight">
\[Y_{T/B} = X_BS_{T/B} = \frac{F_{Bf} - F_B}{F_{Bf}} \cdot \frac{3F_T}{F_{Bf} - F_B} = \frac{3F_T}{F_{Bf}}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Note that we can still use the function that contains the ODE system in P01(vol, var) above. </span>
<span class="c1">## Nothing about the problem has changed other than how we process the ODE solution.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Commented sections of cell here were solved above; I&#39;m adding just to remind us.</span>
<span class="c1">## No need to re-solve.</span>

<span class="c1"># #This cell solves the ODE system (an initial value problem) using solve_ivp</span>
<span class="c1"># FBf     = 60000 #mol/h</span>
<span class="c1"># FDf     = 0</span>
<span class="c1"># FHf     = 0</span>
<span class="c1"># FTf     = 0</span>

<span class="c1"># #Solve the problem</span>
<span class="c1"># vspan   = (0, 5000)</span>
<span class="c1"># var0    = [FBf, FDf, FHf, FTf]</span>
<span class="c1"># solP01 = solve_ivp(P01, vspan, var0, atol = 1e-12, rtol = 1e-12)</span>

<span class="c1"># #Extract data from the solution structure.</span>

<span class="c1"># #Volumes from the ODE solver</span>
<span class="c1"># Vout    = solP01.t</span>

<span class="c1"># #Molar flowrates as a function of volume.</span>
<span class="c1"># FBout   = solP01.y[0]</span>
<span class="c1"># FDout   = solP01.y[1]</span>
<span class="c1"># FHout   = solP01.y[2]</span>
<span class="c1"># FTout   = solP01.y[3]</span>

<span class="c1"># #Sum things up to get the total molar flowrate as a function of volume.</span>
<span class="c1"># FTot_o  = FBout + FDout + FHout + FTout</span>

<span class="c1"># #Calculate mole fractions as a function of volume.</span>
<span class="c1"># yBout   = FBout/FTot_o</span>
<span class="c1"># yDout   = FDout/FTot_o</span>
<span class="c1"># yHout   = FHout/FTot_o</span>
<span class="c1"># yTout   = FTout/FTot_o</span>

<span class="c1"># #Calculate conversion</span>
<span class="c1"># XBout   = (FBf - FBout)/FBf</span>

<span class="c1">#Calculate diphenyl/triphenyl yield</span>
<span class="n">YDB</span>     <span class="o">=</span> <span class="n">FDout</span><span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="n">FBf</span>
<span class="n">YTB</span>     <span class="o">=</span> <span class="n">FTout</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="n">FBf</span>

<span class="c1">#Calculate diphenyl selectivity</span>
<span class="n">SDB</span>     <span class="o">=</span> <span class="n">FDout</span><span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">FBf</span> <span class="o">-</span> <span class="n">FBout</span><span class="p">)</span>
<span class="n">STB</span>     <span class="o">=</span> <span class="n">FTout</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">FBf</span> <span class="o">-</span> <span class="n">FBout</span><span class="p">)</span>

<span class="c1">#Plot yield, selectivity, conversion vs. reactor volume.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Conversion and Diphenyl Yield in a PFR&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">XBout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Conversion&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">YDB</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Yield to D&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">vspan</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Benzene Conversion/Diphenyl Yield&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Diphenyl and Triphenyl Selectivity&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XBout</span><span class="p">,</span> <span class="n">SDB</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Selectivity to D&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XBout</span><span class="p">,</span> <span class="n">STB</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Selectivity to T&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Benzene Conversion&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Product Selectivity&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Diphenyl and Triphenyl Yield&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XBout</span><span class="p">,</span> <span class="n">YDB</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Yield to D&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XBout</span><span class="p">,</span> <span class="n">YTB</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Yield to T&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Benzene Conversion&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Product Yield&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\jqbond\AppData\Local\Temp\ipykernel_9132\1217347526.py:43: RuntimeWarning: invalid value encountered in true_divide
  SDB     = FDout*2/(FBf - FBout)
C:\Users\jqbond\AppData\Local\Temp\ipykernel_9132\1217347526.py:44: RuntimeWarning: invalid value encountered in true_divide
  STB     = FTout*3/(FBf - FBout)
</pre></div>
</div>
<img alt="../_images/587-L23_14_1.png" src="../_images/587-L23_14_1.png" />
<img alt="../_images/587-L23_14_2.png" src="../_images/587-L23_14_2.png" />
<img alt="../_images/587-L23_14_3.png" src="../_images/587-L23_14_3.png" />
</div>
</div>
</section>
<section id="finding-the-value-and-location-of-the-maximum-diphenyl-yield">
<h3>Finding the value and location of the maximum diphenyl yield<a class="headerlink" href="#finding-the-value-and-location-of-the-maximum-diphenyl-yield" title="Permalink to this headline">#</a></h3>
<p>We’ll use <code class="docutils literal notranslate"><span class="pre">max()</span></code> and <code class="docutils literal notranslate"><span class="pre">np.argmax()</span></code> as above to get a crude approximation of the maximum, and we’ll refine that a bit by creating an interpolating polynomial that returns Volume as a function of benzene yield.  We’ll use that with <code class="docutils literal notranslate"><span class="pre">opt.minimize_scalar()</span></code> to find the location of the optimum.  We’ll cover this in more detail in Recitation 08.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YDBmax1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">YDB</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The maximum diphenyl yield is approximately </span><span class="si">{</span><span class="n">YDBmax1</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">. </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">indexmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">YDB</span><span class="p">)</span>
<span class="n">YDBmax2</span>   <span class="o">=</span> <span class="n">YDB</span><span class="p">[</span><span class="n">indexmax</span><span class="p">]</span>
<span class="n">Vmax2</span>    <span class="o">=</span> <span class="n">Vout</span><span class="p">[</span><span class="n">indexmax</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The maximum diphenyl yield is </span><span class="si">{</span><span class="n">YDBmax2</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">, which we obtain at a PFR volume of </span><span class="si">{</span><span class="n">Vmax2</span><span class="si">:</span><span class="s1">0.0f</span><span class="si">}</span><span class="s1">L. </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">YvVol</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">YDB</span><span class="p">)</span>
<span class="n">objtemp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">V</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">YvVol</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">opt_answer</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">objtemp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The maximum yield is </span><span class="si">{</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">opt_answer</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1"> at a PFR volume of </span><span class="si">{</span><span class="n">opt_answer</span><span class="o">.</span><span class="n">x</span><span class="si">:</span><span class="s1">3.0f</span><span class="si">}</span><span class="s1">L&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The maximum diphenyl yield is approximately 0.409. 

The maximum diphenyl yield is 0.409, which we obtain at a PFR volume of 488L. 

The maximum yield is 0.409 at a PFR volume of 488L
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="example-problem-03">
<h2>Example Problem 03<a class="headerlink" href="#example-problem-03" title="Permalink to this headline">#</a></h2>
<p><strong>This is a slightly modified version of Example 8.4 from Fogler</strong></p>
<p>The following pair of liquid-phase reactions occur in series. Each reaction is first order in its reactant.</p>
<div class="amsmath math notranslate nohighlight" id="equation-23fe574a-221b-41dc-bd74-07a2ea9c26b6">
<span class="eqno">(127)<a class="headerlink" href="#equation-23fe574a-221b-41dc-bd74-07a2ea9c26b6" title="Permalink to this equation">#</a></span>\[\begin{align}
    A &amp;\longrightarrow B\\
    B &amp;\longrightarrow C \\
\end{align}\]</div>
<p>By “series” or “sequential” reactions we mean that a product of the first reaction is a reactant in a second reaction, and so on. These are very common systems in Chemical Reaction Engineering – especially in the petrochemical industry, where we often make reactive things from inert alkanes.  Quite often, the reactive things we make then react away to form things we don’t want.  Selectivity control in series reactions requires careful attention to operating conditions and reaction times (space times for flow reactors).</p>
<p>You carry out these reactions in a CSTR operating at steady state.  You may assume the density of the fluid does not change with reaction and so the inlet volumetric flowrate is equal to the outlet volumetric flowrate.  You have the following data available:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f2cf5d57-72a4-4220-b4a2-f8f1386151e7">
<span class="eqno">(128)<a class="headerlink" href="#equation-f2cf5d57-72a4-4220-b4a2-f8f1386151e7" title="Permalink to this equation">#</a></span>\[\begin{align}
    k_1 &amp;= 0.5 \ \textrm{h}^{-1} \\
    k_2 &amp;= 0.2 \ \textrm{h}^{-1} \\
    C_{Af} &amp;= 20 \ \textrm{mol} \ \textrm{L}^{-1}
\end{align}\]</div>
<p>Find the <strong>space time</strong> required to maximize the <strong>yield</strong> of B (with respect to A) in this CSTR.</p>
<section id="solution-to-example-03">
<h3>Solution to Example 03<a class="headerlink" href="#solution-to-example-03" title="Permalink to this headline">#</a></h3>
<section id="balance-on-a">
<h4>Balance on A<a class="headerlink" href="#balance-on-a" title="Permalink to this headline">#</a></h4>
<p>To get yields, selectivities, and conversions, we need to write material balances on all species.  This allows us to determine the exit molar flowrates of all species.  Starting with a balance on A:</p>
<div class="math notranslate nohighlight">
\[0 = F_{A,f} - F_A + R_AV\]</div>
<p>We aren’t given a ton of information except for the feed concentration of A.  Presumably, the feed concentrations of B and C are both zero.  We are also told we want to work with a space time, which is defined for a CSTR as:</p>
<div class="math notranslate nohighlight">
\[\tau = \frac{V}{Q_f}\]</div>
<p>I’m going to convert my balance so that it is written in terms of concentration and space time instead of molar flowrate and volume. I can express molar flowrates in terms of concentrations and volumetric flowrates:</p>
<div class="math notranslate nohighlight">
\[0 = C_{A,f}Q_f - C_AQ + R_AV\]</div>
<p>We know the intensive production rate of A:</p>
<div class="math notranslate nohighlight">
\[R_A = -r_1\]</div>
<p>Since the reactions are first order in the reactant:</p>
<div class="math notranslate nohighlight">
\[r_1 = k_1C_A\]</div>
<p>Making these substitutions, we find:</p>
<div class="math notranslate nohighlight">
\[0 = C_{A,f}Q_f - C_AQ - k_1C_AV\]</div>
<p>We are told that we can assume constant density in this system, which means (at steady state)</p>
<div class="math notranslate nohighlight">
\[Q = Q_f\]</div>
<p>Thus:</p>
<div class="math notranslate nohighlight">
\[0 = C_{A,f}Q_f - C_AQ_f - k_1C_AV\]</div>
<p>Dividing by <span class="math notranslate nohighlight">\(Q_f\)</span>, we express the balance in terms of a space time and concentrations.</p>
<div class="math notranslate nohighlight">
\[0 = C_{A,f} - C_A - k_1C_A\tau\]</div>
<p>And we can solve this for <span class="math notranslate nohighlight">\(C_A\)</span>, the exit concentration of A from the CSTR:</p>
<div class="math notranslate nohighlight">
\[C_A = \frac{C_{A,f}}{1 + k_1\tau}\]</div>
<p>This is an important result.  It gives us the exit concentration of A as a function of space time. Now we move on to a balance on B:</p>
</section>
<section id="balance-on-b">
<h4>Balance on B<a class="headerlink" href="#balance-on-b" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[0 = F_{B,f} - F_B + R_BV\]</div>
<p>We can replace molar flowrates with the product of concentration and volumetric flowrate, noting again that <span class="math notranslate nohighlight">\(Q = Q_f\)</span> for this problem:</p>
<div class="math notranslate nohighlight">
\[0 = C_{B,f}Q_f - C_BQ_f + R_BV\]</div>
<p>We can define the intensive production rate of B, <span class="math notranslate nohighlight">\(R_B\)</span>:</p>
<div class="math notranslate nohighlight">
\[R_B = r_1 - r_2\]</div>
<p>We know the reactions are both first order in their reactant, so:</p>
<div class="math notranslate nohighlight">
\[R_B = k_1C_A - k_2C_B\]</div>
<p>And we can substitute this into the material balance:</p>
<div class="math notranslate nohighlight">
\[0 = C_{B,f}Q_f - C_BQ_f + (k_1C_A - k_2C_B)V\]</div>
<p>Dividing through by <span class="math notranslate nohighlight">\(Q_f\)</span>:</p>
<div class="math notranslate nohighlight">
\[0 = C_{B,f} - C_B + (k_1C_A - k_2C_B)\tau\]</div>
<p>Noting that <span class="math notranslate nohighlight">\(C_{B,f} = 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[0 = C_B + (k_1C_A - k_2C_B)\tau\]</div>
<p>And we can solve this for <span class="math notranslate nohighlight">\(C_B\)</span>:</p>
<div class="math notranslate nohighlight">
\[C_B = \frac{k_1C_A\tau}{1 + k_2 \tau}\]</div>
<p>The above is expressed in terms of <span class="math notranslate nohighlight">\(C_A\)</span>.  We can substitute that expression in to get:</p>
<div class="math notranslate nohighlight">
\[C_B = \frac{k_1C_{A,f}\tau}{(1+k_1\tau)(1+k_2\tau)}\]</div>
<p>This is another important equation as it gives us <span class="math notranslate nohighlight">\(C_B\)</span> as a function of <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
</section>
<section id="balance-on-c">
<h4>Balance on C<a class="headerlink" href="#balance-on-c" title="Permalink to this headline">#</a></h4>
<p>Technically, we don’t need this to solve for yield/selectivity to B, but I’m curious to see how it behaves, so we’ll go ahead and write a balance on C:</p>
<div class="math notranslate nohighlight">
\[0 = F_{C,f} - F_C + R_CV\]</div>
<p>Converting to a function of concentration:</p>
<div class="math notranslate nohighlight">
\[0 = C_{C,f}Q_f - C_CQ_f + R_CV\]</div>
<p>Defining the production rate for C:</p>
<div class="math notranslate nohighlight">
\[R_C = r_2 = k_2C_B\]</div>
<p>We get:</p>
<div class="math notranslate nohighlight">
\[0 = C_{C,f}Q_f - C_CQ_f + k_2C_BV\]</div>
<p>Dividing by <span class="math notranslate nohighlight">\(Q_f\)</span>:</p>
<div class="math notranslate nohighlight">
\[0 = C_{C,f} - C_C + k_2C_B\tau\]</div>
<p>Noting that <span class="math notranslate nohighlight">\(C_f = 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[0 = - C_C + k_2C_B\tau\]</div>
<p>Which we can solve for <span class="math notranslate nohighlight">\(C_C\)</span>:</p>
<div class="math notranslate nohighlight">
\[C_C = k_2C_B\tau\]</div>
<p>And we can substitute the expression for <span class="math notranslate nohighlight">\(C_B\)</span> here to get:</p>
<div class="math notranslate nohighlight">
\[C_C = \frac{k_1k_2C_{A,f}\tau^2}{(1+k_1\tau)(1+k_2\tau)}\]</div>
<p>There we have our concentrations expressed as 3 functions of tau.  These are developed as lambda functions below, which are plotted as a function of tau.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k1</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1">#1/h</span>
<span class="n">k2</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1">#1/h</span>
<span class="n">CAf</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1">#mol/L</span>

<span class="n">CA</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">CAf</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">k1</span><span class="o">*</span><span class="n">tau</span><span class="p">)</span>
<span class="n">CB</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">k1</span><span class="o">*</span><span class="n">CAf</span><span class="o">*</span><span class="n">tau</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k1</span><span class="o">*</span><span class="n">tau</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k2</span><span class="o">*</span><span class="n">tau</span><span class="p">)</span>
<span class="n">CC</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">k1</span><span class="o">*</span><span class="n">k2</span><span class="o">*</span><span class="n">CAf</span><span class="o">*</span><span class="n">tau</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k1</span><span class="o">*</span><span class="n">tau</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k2</span><span class="o">*</span><span class="n">tau</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tauset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">CA</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">CB</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CB&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">CC</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Concentration vs. space time (τ)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;τ (h)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mol/L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">tauset</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L23_20_0.png" src="../_images/587-L23_20_0.png" />
</div>
</div>
</section>
</section>
<section id="definining-conversion-yield-and-selectivity">
<h3>Definining Conversion, Yield, and Selectivity<a class="headerlink" href="#definining-conversion-yield-and-selectivity" title="Permalink to this headline">#</a></h3>
<p>With the concentrations of each species defined, we can now consider Conversion, Yields and Selectivities.</p>
<section id="conversion">
<h4>Conversion<a class="headerlink" href="#conversion" title="Permalink to this headline">#</a></h4>
<p>We define the fractional conversion of A as:</p>
<div class="math notranslate nohighlight">
\[X_A = \frac{F_{A,f} - F_A}{F_{A,f}}\]</div>
<p>Although we have no way to solve for molar flowrates (since Q is unknown), we can express them in terms of concentrations, noting symbolically that <span class="math notranslate nohighlight">\(Q = Q_f\)</span>.</p>
<div class="math notranslate nohighlight">
\[X_A = \frac{C_{A,f}Q_f - C_AQ_f}{C_{A,f}Q_f}\]</div>
<p>We can factor and cancel the volumetric flowrate, giving us the result below, which is always true for a constant density fluid:</p>
<div class="math notranslate nohighlight">
\[X_A = \frac{C_{A,f} - C_A}{C_{A,f}}\]</div>
</section>
<section id="yields">
<h4>Yields<a class="headerlink" href="#yields" title="Permalink to this headline">#</a></h4>
<p>For a CSTR, we would generally define the yield of B with respect to A as:</p>
<div class="math notranslate nohighlight">
\[Y_{B/A} = \frac{F_B\left|\frac{\nu_{A1}}{\nu_{B1}}\right|}{F_{A,f}}\]</div>
<p>Which simplfies for this problem to:</p>
<div class="math notranslate nohighlight">
\[Y_{B/A} = \frac{F_B}{F_{A,f}}\]</div>
<p>We actually don’t know the molar flowrates since we don’t know the size (Q, V) of this system, but we can express these in terms of concentrations, noting that since density is constant <span class="math notranslate nohighlight">\(Q = Q_f\)</span>:</p>
<div class="math notranslate nohighlight">
\[Y_{B/A} = \frac{C_BQ_f}{C_{A,f}Q_f}\]</div>
<p>This reduces to:</p>
<div class="math notranslate nohighlight">
\[Y_{B/A} = \frac{C_B}{C_{A,f}}\]</div>
<p>When we go to calculate a yield of C with respect to A, we have to note that by summing the two reactions, we can get the overall stoichiometry of converting A into C:</p>
<div class="math notranslate nohighlight">
\[A \longrightarrow C\]</div>
<p>With that, we can use a similar approach to that above to define the yield to C in terms of concentrations:</p>
<div class="math notranslate nohighlight">
\[Y_{C/A} = \frac{C_B}{C_{A,f}}\]</div>
</section>
<section id="selectivities">
<h4>Selectivities<a class="headerlink" href="#selectivities" title="Permalink to this headline">#</a></h4>
<p>We can define the selectivity of species B with respect to A:</p>
<div class="math notranslate nohighlight">
\[S_{B/A} = \frac{F_B\left|\frac{\nu_{A1}}{\nu_{B1}}\right|}{F_{A,f} - F_A}\]</div>
<p>Substituting stoichiometric coefficients, expressing in terms of concentrations, and noting that <span class="math notranslate nohighlight">\(Q = Q_f\)</span>:</p>
<div class="math notranslate nohighlight">
\[S_{B/A} = \frac{C_BQ_f}{C_{A,f}Q_f - C_AQ_f}\]</div>
<p>Factoring and cancelling the volumetric flowrate (which we can do in cases where it is constant):</p>
<div class="math notranslate nohighlight">
\[S_{B/A} = \frac{C_B}{C_{A,f} - C_A}\]</div>
<p>You can follow similar steps to define a selectivity to species C with respect to the reactant A:</p>
<div class="math notranslate nohighlight">
\[S_{C/A} = \frac{C_C}{C_{A,f} - C_A}\]</div>
<p>We’ll write lambda functions for each of these; note that I’m re-using my concentration functions defined above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YB</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">CB</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span><span class="o">/</span><span class="n">CAf</span>
<span class="n">YC</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">CC</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span><span class="o">/</span><span class="n">CAf</span>
<span class="n">SB</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">CB</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">CAf</span> <span class="o">-</span> <span class="n">CA</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span>
<span class="n">SC</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">CC</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">CAf</span> <span class="o">-</span> <span class="n">CA</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span>
<span class="n">XA</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="p">(</span><span class="n">CAf</span> <span class="o">-</span> <span class="n">CA</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span><span class="o">/</span><span class="n">CAf</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#This just prints out the first few selectivities to show the NAN (&quot;not a number&quot;) error</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">SB</span><span class="p">(</span><span class="n">tauset</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">SC</span><span class="p">(</span><span class="n">tauset</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Conversion and Selectivity in a CSTR&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">XA</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Conversion of A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">SB</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Selectivity to B&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">SC</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Selectivity to C&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;τ (h)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Conversion/Selectivity&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Conversion and Yield in a CSTR&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">XA</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Conversion of A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">YB</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Yield to B&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">YC</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Yield to C&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;τ (h)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Conversion/Yield&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[       nan        nan]
 [0.97073171 0.02926829]
 [0.94312796 0.05687204]
 [0.91705069 0.08294931]
 [0.89237668 0.10762332]]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\jqbond\AppData\Local\Temp\ipykernel_9132\3616170257.py:3: RuntimeWarning: invalid value encountered in true_divide
  SB = lambda tau: CB(tau)/(CAf - CA(tau))
C:\Users\jqbond\AppData\Local\Temp\ipykernel_9132\3616170257.py:4: RuntimeWarning: invalid value encountered in true_divide
  SC = lambda tau: CC(tau)/(CAf - CA(tau))
</pre></div>
</div>
<img alt="../_images/587-L23_23_2.png" src="../_images/587-L23_23_2.png" />
<img alt="../_images/587-L23_23_3.png" src="../_images/587-L23_23_3.png" />
</div>
</div>
</section>
</section>
<section id="maximizing-the-yield-of-b">
<h3>Maximizing the Yield of B<a class="headerlink" href="#maximizing-the-yield-of-b" title="Permalink to this headline">#</a></h3>
<p>An important question is clearly what space time do we need to use to maximize the yield to species B (the intermediate in the series reaction).  From the graph of Yield vs. tau, we can see this occurs at a space time of about 3 hours.  To get more precise, we can either solve it analytically by taking a derivative of <span class="math notranslate nohighlight">\(Y_{B/A}\)</span> with respect to tau; after some calculus and algebra, we get:</p>
<div class="math notranslate nohighlight">
\[\frac{dY_{B/A}}{d\tau} = \frac{k_1(1 + k_1\tau)(1 + k_2\tau) - k_1\tau\left[k_1(1 + k_2\tau) + k_2(1 + k_1\tau)\right]}{\left[(1 + k_1\tau)(1+k_1\tau)\right]^2}\]</div>
<p>To find the optimum value of tau, we solve the following expression for <span class="math notranslate nohighlight">\(\tau\)</span>:</p>
<div class="math notranslate nohighlight">
\[0 = \frac{k_1(1 + k_1\tau)(1 + k_2\tau) - k_1\tau\left[k_1(1 + k_2\tau) + k_2(1 + k_1\tau)\right]}{\left[(1 + k_1\tau)(1+k_1\tau)\right]^2}\]</div>
<p>I did this by hand to find:</p>
<div class="math notranslate nohighlight">
\[\tau_{\textrm{opt}} = \sqrt{\frac{1}{k_1k_2}}\]</div>
<p>Which we can plug into a calculator to get:</p>
<div class="math notranslate nohighlight">
\[\tau_{\textrm{opt}} = 3.16 \ \textrm{h}\]</div>
<p>Or, you know, we could just create an objective function (return negative yield of B at a specific volume) and minimize that with an optimization routine.  See below.  You get the same answer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">YB</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span> <span class="c1">#this objective function returns -1*YB for a given value of tau</span>
<span class="n">optsol</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="c1">#this varies tau until we hit minimum value of -1*YB</span>
<span class="nb">print</span><span class="p">(</span><span class="n">optsol</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The maximum yield to species B is </span><span class="si">{</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">optsol</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s1">3.2f</span><span class="si">}</span><span class="s1"> which occurs at a space time of </span><span class="si">{</span><span class="n">optsol</span><span class="o">.</span><span class="n">x</span><span class="si">:</span><span class="s1">3.2f</span><span class="si">}</span><span class="s1"> hours&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     fun: -0.3752470442573563
 message: &#39;\nOptimization terminated successfully;\nThe returned value satisfies the termination criteria\n(using xtol = 1.48e-08 )&#39;
    nfev: 17
     nit: 11
 success: True
       x: 3.162277615990361 

The maximum yield to species B is 0.38 which occurs at a space time of 3.16 hours
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="587-L22.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Material Balances XIII</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="587-L24.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Material Balances XV</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Jesse Q. Bond, Syracuse University<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>