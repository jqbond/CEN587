
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Material Balances IX &#8212; Kinetics and Reaction Engineering</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Material Balances X" href="587-L19.html" />
    <link rel="prev" title="Material Balances VIII" href="587-L17.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/JQB.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Kinetics and Reaction Engineering</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Chapter1.html">
   Python Supplements
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S01.html">
     The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S02.html">
     Data Structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S03.html">
     Arrays and Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S04.html">
     For Loops and Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S05.html">
     Logical Tests and Comparisons
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S06.html">
     While Loops in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S07.html">
     Functions, D&amp;D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S08.html">
     The Fall of Acererak
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S09.html">
     Root Finding: Univariate Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S10.html">
     Minimizing a Univariate Function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S11.html">
     Minimizing Multivariate Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S12.html">
     Systems of Nonlinear Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S13.html">
     Least Squares Revisited
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S14.html">
     ODE Solvers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S15.html">
     Quadrature
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../Chapter2.html">
   Lectures
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="587-L01.html">
     Introduction and Stoichiometry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L02.html">
     Extent and Conversion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L03.html">
     Algebraic and Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L04.html">
     Chemical Equilibrium I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L05.html">
     Chemical Equilibrium II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L06.html">
     Chemical Equilibrium III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L07.html">
     Chemical Equilibrium IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L08.html">
     Chemical Equilibrium V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L09.html">
     Chemical and Phase Equilibria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L10.html">
     Material Balances I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L11.html">
     Material Balances II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L12.html">
     Material Balances III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L13.html">
     Material Balances IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L14.html">
     Material Balances V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L15.html">
     Material Balances VI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L16.html">
     Material Balances VII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L17.html">
     Material Balances VIII
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Material Balances IX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L19.html">
     Material Balances X
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L20.html">
     Material Balances XI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L21.html">
     Material Balances XII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L22.html">
     Material Balances XIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L23.html">
     Material Balances XIV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L24.html">
     Material Balances XV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L25.html">
     Material Balances XVI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L26.html">
     Material Balances XVII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L27.html">
     Material Balances XVIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L28.html">
     Kinetics I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L29.html">
     Kinetics II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L30.html">
     Kinetics III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L31.html">
     Kinetics IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L32.html">
     Kinetics V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L33.html">
     Kinetics VI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L34.html">
     Kinetics VII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L35.html">
     Kinetics VIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L36.html">
     Kinetics IX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L37.html">
     Kinetics X
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L38.html">
     Kinetics XI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L39.html">
     Energy Balances I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L40.html">
     Energy Balances II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L41.html">
     Energy Balances III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L42.html">
     Energy Balances IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L43.html">
     Energy Balances VI
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Chapter3.html">
   Recitations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R01.html">
     Jupyter and Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R02.html">
     Solving Algebraic Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R03.html">
     Chemical Equilibrium
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R04.html">
     Solving ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R05.html">
     Chemical/Phase Equilibria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R06.html">
     CSTRs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R07.html">
     Python tips and tricks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R08.html">
     Optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R09.html">
     Reactors with Recycle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R10.html">
     Interpolation and Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R11.html">
     Nonlinear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R12.html">
     Parameter Estimation I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R13.html">
     Parameter Estimation II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R14.html">
     Energy Balances
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/jqbond/CEN587/main?urlpath=tree/Lectures/587-L18.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/jqbond/CEN587"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/jqbond/CEN587/issues/new?title=Issue%20on%20page%20%2FLectures/587-L18.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Lectures/587-L18.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-01">
   Example Problem 01
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-01">
     Solution to Example Problem 01
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-02">
   Example Problem 02
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-02">
     Solution to Example Problem 02
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-03">
   Example Problem 03
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-03">
     Solution to Example Problem 03
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Material Balances IX</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-01">
   Example Problem 01
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-01">
     Solution to Example Problem 01
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-02">
   Example Problem 02
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-02">
     Solution to Example Problem 02
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-03">
   Example Problem 03
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-03">
     Solution to Example Problem 03
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="material-balances-ix">
<h1>Material Balances IX<a class="headerlink" href="#material-balances-ix" title="Permalink to this headline">#</a></h1>
<p>This lecture solves more Material Balance Example Problems</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
</pre></div>
</div>
</div>
</div>
<section id="example-problem-01">
<h2>Example Problem 01<a class="headerlink" href="#example-problem-01" title="Permalink to this headline">#</a></h2>
<p>The reversible, gas-phase, homogeneous reaction shown below is carried out in a well-mixed batch reactor operating at a constant temperature (<span class="math notranslate nohighlight">\(T = 298\)</span>K) and a constant pressure (<span class="math notranslate nohighlight">\(P = 1.0\)</span> atm).</p>
<div class="math notranslate nohighlight">
\[A \rightleftharpoons 4B\]</div>
<p>The reaction is first order in A and fourth order in B; additional data are given below:</p>
<div class="amsmath math notranslate nohighlight" id="equation-da1c1f0b-6372-42e0-ab96-8402678ec1f5">
<span class="eqno">(63)<a class="headerlink" href="#equation-da1c1f0b-6372-42e0-ab96-8402678ec1f5" title="Permalink to this equation">#</a></span>\[\begin{align}
    k_f &amp;= 0.5 \ \textrm{min}^{-1}\\
    k_r &amp;= 20 \ \textrm{L}^{3} \ \textrm{mol}^{-3} \textrm{min}^{-1}\\
    T   &amp;= 298 \ \textrm{K}\\
    P   &amp;= 1.0 \ \textrm{atm}\\
    V_0 &amp;= 1.0 \ \textrm{L}\\
    K_C &amp;= 0.025 \ \textrm{mol}^3 \ \textrm{L}^{-3}
\end{align}\]</div>
<p>The reactor is initially charged with pure compound A.  How long will it take to achieve 80% conversion of species A?</p>
<p><strong>Answer</strong>: t = 3.26 min</p>
<section id="solution-to-example-problem-01">
<h3>Solution to Example Problem 01<a class="headerlink" href="#solution-to-example-problem-01" title="Permalink to this headline">#</a></h3>
<p>Since this problem asks how long it will take to achieve a specific fractional conversion of A, my instinct is to write a material balance on A for this well-mixed batch reactor:</p>
<div class="math notranslate nohighlight">
\[\frac{dN_A}{dt} = R_AV\]</div>
<p>We define <span class="math notranslate nohighlight">\(R_A\)</span> as usual to find:</p>
<div class="math notranslate nohighlight">
\[R_A = -r\]</div>
<p>And then we are given reaction orders, so we can write a rate expression.</p>
<div class="math notranslate nohighlight">
\[r = k_fC_A - k_rC_B^4\]</div>
<p>Here we see our first complication: the rate of reaction depends on the concentration of species B.  Our next complication arises when we define concentration.  Since we are in a batch reactor, we define concentrations for A and B as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-51c8ab84-0313-4629-b432-31e98477cf5b">
<span class="eqno">(64)<a class="headerlink" href="#equation-51c8ab84-0313-4629-b432-31e98477cf5b" title="Permalink to this equation">#</a></span>\[\begin{align}
    C_A &amp;= N_A/V \\
    C_B &amp;= N_B/V
\end{align}\]</div>
<p>We see that the volume appears here. These concentrations represent the concentration in the reactor at any point in time, t.  So, relative to the starting point, <span class="math notranslate nohighlight">\(N_A\)</span> and <span class="math notranslate nohighlight">\(N_B\)</span> are both changing.  The less obvious thing is that the volume of the reactor is also changing.  Here’s why:</p>
<p>The reactor temperature and pressure are fixed at 298K and 1 atm, respectively.  Because the pressure is low, we can use the ideal gas law to define the volume of the system:</p>
<div class="math notranslate nohighlight">
\[V = \frac{N_TRT}{P}\]</div>
<p>In other words, for a fixed temperature and pressure, the volume of the reactor scales directly with the total number of moles in the reactor. For this reaction, we can see clearly that every time the reaction occurs, it consumes 1 mole of A and produces 4 moles of B.  This means the reaction causes an increase in the number of moles in the system, so as it progresses, the volume of the reactor must increase to maintain a constant temperature and pressure.</p>
<p>This means that we also have to keep track of the total number of moles in our system:</p>
<div class="math notranslate nohighlight">
\[N_T = N_A + N_B\]</div>
<p>For me, the easiest way to handle this is to just write a balance on each species and solve the set of coupled differential equations numerically:</p>
<div class="amsmath math notranslate nohighlight" id="equation-eb10c459-9793-4fb2-92f9-3c63d0bb854d">
<span class="eqno">(65)<a class="headerlink" href="#equation-eb10c459-9793-4fb2-92f9-3c63d0bb854d" title="Permalink to this equation">#</a></span>\[\begin{align}
    \frac{dN_A}{dt} = R_AV \\
    \frac{dN_B}{dt} = R_BV
\end{align}\]</div>
<p>Now we just make sure that everything on the right hand side of those two balances is defined in terms of contants or the three variables tracked by our ODE solver (t, NA, NB).</p>
<div class="amsmath math notranslate nohighlight" id="equation-5ad157c2-b36d-4f15-9d5e-bba7dd9600cd">
<span class="eqno">(66)<a class="headerlink" href="#equation-5ad157c2-b36d-4f15-9d5e-bba7dd9600cd" title="Permalink to this equation">#</a></span>\[\begin{align}
    R_A = -r \\
    R_B = 4r
\end{align}\]</div>
<p>Where rate is given as:</p>
<div class="math notranslate nohighlight">
\[r = k_fC_A - k_rC_B^4\]</div>
<p>This means we need to define concentrations in terms of NA and NB:</p>
<div class="amsmath math notranslate nohighlight" id="equation-2ed2ebfa-7aa8-4970-8b5f-7243336b9399">
<span class="eqno">(67)<a class="headerlink" href="#equation-2ed2ebfa-7aa8-4970-8b5f-7243336b9399" title="Permalink to this equation">#</a></span>\[\begin{align}
    C_A = N_A/V \\
    C_B = N_B/V
\end{align}\]</div>
<p>And we know that Volume can be defined in terms of the total moles in the system; hence we define:</p>
<div class="math notranslate nohighlight">
\[N_T = N_A + N_B\]</div>
<p>And use this result with the ideal gas law to calculate system volume.</p>
<div class="math notranslate nohighlight">
\[V = \frac{N_TRT}{P}\]</div>
<p>Now <span class="math notranslate nohighlight">\(R_AV\)</span> and <span class="math notranslate nohighlight">\(R_BV\)</span> are fully defined in terms of t, NA, and NB, and we can solve this with solve_ivp.</p>
<p>First, we create the function that specifies the ODE system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">P01</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">var</span><span class="p">):</span>
    <span class="n">NA</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">NB</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">T</span> <span class="o">=</span> <span class="mi">298</span>   <span class="c1">#K</span>
    <span class="n">P</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1">#atm</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mf">0.0821</span>  <span class="c1">#mol/L/K/atm</span>
    <span class="n">kf</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1">#1/min</span>
    <span class="n">kr</span> <span class="o">=</span> <span class="mi">20</span>   <span class="c1">#L^3/mol^3/min</span>

    <span class="n">NT</span> <span class="o">=</span> <span class="n">NA</span> <span class="o">+</span> <span class="n">NB</span>

    <span class="n">V</span>  <span class="o">=</span> <span class="n">NT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>

    <span class="n">CA</span> <span class="o">=</span> <span class="n">NA</span><span class="o">/</span><span class="n">V</span>
    <span class="n">CB</span> <span class="o">=</span> <span class="n">NB</span><span class="o">/</span><span class="n">V</span>

    <span class="n">r</span>  <span class="o">=</span> <span class="n">kf</span><span class="o">*</span><span class="n">CA</span> <span class="o">-</span> <span class="n">kr</span><span class="o">*</span><span class="n">CB</span><span class="o">**</span><span class="mi">4</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span>
    <span class="n">RB</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">r</span>
    <span class="n">D1</span> <span class="o">=</span> <span class="n">RA</span><span class="o">*</span><span class="n">V</span>
    <span class="n">D2</span> <span class="o">=</span> <span class="n">RB</span><span class="o">*</span><span class="n">V</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we set up the initial value problem solver.  We’re working with NA and NB as our dependent variables, so we need their initial values.  These are easy to calculate using the ideal gas law with the initial T, P, V and composition of the system, all of which are given in the problem statement.  Once that is done, we use solve_ivp as ususal and then interpolate to find the time where <span class="math notranslate nohighlight">\(X_A = 0.8\)</span>.</p>
<p>Doing so, we find <span class="math notranslate nohighlight">\(t = 3.26\)</span> min.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span>     <span class="o">=</span> <span class="mi">298</span>   <span class="c1">#K</span>
<span class="n">P</span>     <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1">#atm</span>
<span class="n">R</span>     <span class="o">=</span> <span class="mf">0.0821</span>  <span class="c1">#mol/L/K/atm</span>
<span class="n">V0</span>    <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1">#L</span>
<span class="n">NA0</span>   <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">V0</span><span class="o">/</span><span class="n">R</span><span class="o">/</span><span class="n">T</span>
<span class="n">NB0</span>   <span class="o">=</span> <span class="mi">0</span>
<span class="n">var0</span>  <span class="o">=</span> <span class="p">[</span><span class="n">NA0</span><span class="p">,</span> <span class="n">NB0</span><span class="p">]</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ans</span>   <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">P01</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">var0</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">)</span>
<span class="n">t</span>     <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">t</span>
<span class="n">NA</span>    <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">NB</span>    <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>
<span class="n">XA</span>    <span class="o">=</span> <span class="p">(</span><span class="n">NA0</span> <span class="o">-</span> <span class="n">NA</span><span class="p">)</span><span class="o">/</span><span class="n">NA0</span>
<span class="n">NT</span>    <span class="o">=</span> <span class="n">NA</span> <span class="o">+</span> <span class="n">NB</span>
<span class="n">V</span>     <span class="o">=</span> <span class="n">NT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>

<span class="n">itp1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">XA</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The time required to achieve 80% conversion is </span><span class="si">{</span><span class="n">itp1</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1"> minutes&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">XA</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (min)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;XA&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (min)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;V (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The time required to achieve 80% conversion is 3.26 minutes
</pre></div>
</div>
<img alt="../_images/587-L18_6_1.png" src="../_images/587-L18_6_1.png" />
<img alt="../_images/587-L18_6_2.png" src="../_images/587-L18_6_2.png" />
</div>
</div>
</section>
</section>
<section id="example-problem-02">
<h2>Example Problem 02<a class="headerlink" href="#example-problem-02" title="Permalink to this headline">#</a></h2>
<p>The reversible, gas-phase, homogeneous reaction shown below is carried out in a well-mixed batch reactor operating at a constant temperature (<span class="math notranslate nohighlight">\(T = 298\)</span>K) and a constant Volume (<span class="math notranslate nohighlight">\(V = 1.0\)</span> L).</p>
<div class="math notranslate nohighlight">
\[A \rightleftharpoons 4B\]</div>
<p>The reaction is first order in A and fourth order in B; additional data are given below:</p>
<div class="amsmath math notranslate nohighlight" id="equation-6d060d47-3af3-449e-ad53-888bce255398">
<span class="eqno">(68)<a class="headerlink" href="#equation-6d060d47-3af3-449e-ad53-888bce255398" title="Permalink to this equation">#</a></span>\[\begin{align}
    k_f &amp;= 0.5 \ \textrm{min}^{-1}\\
    k_r &amp;= 20 \ \textrm{L}^{3} \ \textrm{mol}^{-3} \textrm{min}^{-1}\\
    T   &amp;= 298 \ \textrm{K}\\
    P_0 &amp;= 1.0 \ \textrm{atm}\\
    V   &amp;= 1.0 \ \textrm{L}\\
    K_C &amp;= 0.025 \ \textrm{mol}^3 \ \textrm{L}^{-3}
\end{align}\]</div>
<p>The reactor is initially charged with pure compound A.  How long will it take to achieve 80% conversion of species A?</p>
<section id="solution-to-example-problem-02">
<h3>Solution to Example Problem 02<a class="headerlink" href="#solution-to-example-problem-02" title="Permalink to this headline">#</a></h3>
<p>This problem is almost identical to the one above except for the fact that we fix the volume constant and no longer have to solve for it with the ideal gas law.  Otherwise, we approach it pretty much the same way.  Since my rate law depends on both <span class="math notranslate nohighlight">\(C_A\)</span> and <span class="math notranslate nohighlight">\(C_B\)</span>, I’ll write a balance on both species.</p>
<div class="amsmath math notranslate nohighlight" id="equation-04c2d038-157b-46a8-8eba-eccbbaf70ccc">
<span class="eqno">(69)<a class="headerlink" href="#equation-04c2d038-157b-46a8-8eba-eccbbaf70ccc" title="Permalink to this equation">#</a></span>\[\begin{align}
    \frac{dN_A}{dt} = R_AV \\
    \frac{dN_B}{dt} = R_BV
\end{align}\]</div>
<p>Now we just make sure that everything on the right hand side of those two balances is defined in terms of contants or the three variables tracked by our ODE solver (t, NA, NB).</p>
<div class="amsmath math notranslate nohighlight" id="equation-c61af93d-2225-442d-8dd0-b8144af90e60">
<span class="eqno">(70)<a class="headerlink" href="#equation-c61af93d-2225-442d-8dd0-b8144af90e60" title="Permalink to this equation">#</a></span>\[\begin{align}
    R_A = -r \\
    R_B = 4r
\end{align}\]</div>
<p>Where rate is given as:</p>
<div class="math notranslate nohighlight">
\[r = k_fC_A - k_rC_B^4\]</div>
<p>This means we need to define concentrations in terms of NA and NB:</p>
<div class="amsmath math notranslate nohighlight" id="equation-0247decf-965e-43ab-9ca4-32ad4799c451">
<span class="eqno">(71)<a class="headerlink" href="#equation-0247decf-965e-43ab-9ca4-32ad4799c451" title="Permalink to this equation">#</a></span>\[\begin{align}
    C_A = N_A/V \\
    C_B = N_B/V
\end{align}\]</div>
<p>And in this case, the volume is fixed at 1.0L.  At this point, we have written all the equations that we need, and we can solve this with an ODE solver just as we did above.</p>
<p>In this case, we find that this reversible reaction reaches chemical equilibrium at about 76% conversion.  This is the maximum conversion that can be attained if we fix the reactor volume.  The reason for this is actually that, by fixing the volume, we are forcing the pressure in the reactor to increase.  As you can see in the stoichiometry for this reaction, there are more moles on the right hand side than the left hand side, so increasing pressure favors the left hand side and will decrease the equilibrium conversion we can attain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">P02</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">var</span><span class="p">):</span>
    <span class="n">NA</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">NB</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">kf</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1">#1/min</span>
    <span class="n">kr</span> <span class="o">=</span> <span class="mi">20</span>   <span class="c1">#L^3/mol^3/min</span>

    <span class="n">V</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1">#L</span>

    <span class="n">CA</span> <span class="o">=</span> <span class="n">NA</span><span class="o">/</span><span class="n">V</span>
    <span class="n">CB</span> <span class="o">=</span> <span class="n">NB</span><span class="o">/</span><span class="n">V</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">kf</span><span class="o">*</span><span class="n">CA</span> <span class="o">-</span> <span class="n">kr</span><span class="o">*</span><span class="n">CB</span><span class="o">**</span><span class="mi">4</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span>
    <span class="n">RB</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">r</span>
    <span class="n">D1</span> <span class="o">=</span> <span class="n">RA</span><span class="o">*</span><span class="n">V</span>
    <span class="n">D2</span> <span class="o">=</span> <span class="n">RB</span><span class="o">*</span><span class="n">V</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span>     <span class="o">=</span> <span class="mi">298</span>   <span class="c1">#K</span>
<span class="n">P0</span>    <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1">#atm</span>
<span class="n">R</span>     <span class="o">=</span> <span class="mf">0.0821</span>  <span class="c1">#mol/L/K/atm</span>
<span class="n">V</span>     <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1">#L</span>
<span class="n">KC</span>    <span class="o">=</span> <span class="mf">0.025</span>
<span class="n">NA0</span>   <span class="o">=</span> <span class="n">P0</span><span class="o">*</span><span class="n">V</span><span class="o">/</span><span class="n">R</span><span class="o">/</span><span class="n">T</span>
<span class="n">NB0</span>   <span class="o">=</span> <span class="mi">0</span>
<span class="n">var0</span>  <span class="o">=</span> <span class="p">[</span><span class="n">NA0</span><span class="p">,</span> <span class="n">NB0</span><span class="p">]</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">sol</span>   <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">P02</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">var0</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">)</span>
<span class="n">NA</span>    <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">NB</span>    <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>
<span class="n">CA</span>    <span class="o">=</span> <span class="n">NA</span><span class="o">/</span><span class="n">V</span>
<span class="n">CB</span>    <span class="o">=</span> <span class="n">NB</span><span class="o">/</span><span class="n">V</span>
<span class="n">XA</span>    <span class="o">=</span> <span class="p">(</span><span class="n">NA0</span> <span class="o">-</span> <span class="n">NA</span><span class="p">)</span><span class="o">/</span><span class="n">NA0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">XA</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (min)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;XA&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">CB</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="n">CA</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CB^4/CA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">KC</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;KC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (min)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Equilibrium Ratio&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="n">XA</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1">#interp = interp1d(XA,sol.t)</span>
<span class="c1">#interp(0.8)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L18_10_0.png" src="../_images/587-L18_10_0.png" />
<img alt="../_images/587-L18_10_1.png" src="../_images/587-L18_10_1.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7630069354428065
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="example-problem-03">
<h2>Example Problem 03<a class="headerlink" href="#example-problem-03" title="Permalink to this headline">#</a></h2>
<p>The reaction below is carried out in the liquid phase in a well-mixed batch reactor.</p>
<div class="math notranslate nohighlight">
\[A \rightarrow B\]</div>
<p>The reaction is second order in A.  Additional data are given below.</p>
<div class="amsmath math notranslate nohighlight" id="equation-1bb104a6-c9ca-4b3e-b7cf-c7cc19c11505">
<span class="eqno">(72)<a class="headerlink" href="#equation-1bb104a6-c9ca-4b3e-b7cf-c7cc19c11505" title="Permalink to this equation">#</a></span>\[\begin{align}
    k &amp;= 3.5 \times 10^{-3} \ \textrm{L} \ \textrm{mol}^{-1} \ \textrm{min}^{-1}\\
    {V_A}^\circ &amp;= 50 \ \textrm{mL} \ \textrm{mol}^{-1}\\
    {V_B}^\circ &amp;= 38.46 \ \textrm{mL} \ \textrm{mol}^{-1}\\
\end{align}\]</div>
<p>The reactor is initially charged with 10 moles of species A. How long will it take to achieve 75% conversion of species A?</p>
<p><strong>Answer</strong>: 37.5 minutes.</p>
<section id="solution-to-example-problem-03">
<h3>Solution to Example Problem 03<a class="headerlink" href="#solution-to-example-problem-03" title="Permalink to this headline">#</a></h3>
<p>The problem asks about fractional conversion of A, so I start by writing a balance on A:</p>
<div class="math notranslate nohighlight">
\[\frac{dN_A}{dt} = R_AV\]</div>
<p>I’d like to write everything on the right hand side in terms of <span class="math notranslate nohighlight">\(N_A\)</span> and t.  We can expand the production rate:</p>
<div class="math notranslate nohighlight">
\[R_A = -r\]</div>
<p>And the reaction rate</p>
<div class="math notranslate nohighlight">
\[r = kC_A^2\]</div>
<p>So far so good, the reaction rate only depends on the concentration of A.  Now we define this in terms of molar quantities of A and Volume:</p>
<div class="math notranslate nohighlight">
\[C_A = N_A/V\]</div>
<p>But here, we have a problem.  As the reaction happens, species A is converted into species B, and the two species occupy a different amount of space per mole.  In other words, they have different molar volumes (<span class="math notranslate nohighlight">\({V_j}^\circ\)</span>).  So we need an equation of state to relate the number of moles of species to the volume of the system.  Here, I’ll assume an ideal mixture, which is basically expressed as:</p>
<div class="math notranslate nohighlight">
\[\sum_j C_j{V_j}^\circ = 1\]</div>
<p>The practical implication is that the volumes of species are additive.  For a single species, I calculate the volume it occupies, <span class="math notranslate nohighlight">\(V_j\)</span> as:</p>
<div class="math notranslate nohighlight">
\[V_j = N_j{V_j}^\circ\]</div>
<p>When we have multiple species, we calculate the total volume of the system by adding the space occupied by each species:</p>
<div class="math notranslate nohighlight">
\[V = \sum_j {V_j}\]</div>
<p>Or:</p>
<div class="math notranslate nohighlight">
\[V = \sum_j N_j{V_j}^\circ\]</div>
<p>In this particular example, we only have to worry about species A and species B, so:</p>
<div class="math notranslate nohighlight">
\[V = N_A{V_A}^\circ + N_B{V_B}^\circ\]</div>
<p>Now that <span class="math notranslate nohighlight">\(N_B\)</span> shows up in my definition of Volume, I have two dependent variables: <span class="math notranslate nohighlight">\(N_A\)</span> and <span class="math notranslate nohighlight">\(N_B\)</span>.  I can either write them both in terms of a single fractional conversion or I can write balances on both A and B.  I choose the latter here because I find it more straightforward.</p>
<div class="math notranslate nohighlight">
\[\frac{dN_B}{dt} = R_BV\]</div>
<p>Now we can pack our ODE system into a function and solve it with solve_ivp.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">P03</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">var</span><span class="p">):</span>
    <span class="n">NA</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">NB</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">VA</span> <span class="o">=</span> <span class="mf">50e-3</span>     <span class="c1">#L/mol</span>
    <span class="n">VB</span> <span class="o">=</span> <span class="mf">38.46e-3</span>  <span class="c1">#L/mol</span>
    <span class="n">k</span>  <span class="o">=</span> <span class="mf">3.5e-3</span>    <span class="c1">#L/mol/min</span>

    <span class="n">V</span>  <span class="o">=</span> <span class="n">NA</span><span class="o">*</span><span class="n">VA</span> <span class="o">+</span> <span class="n">NB</span><span class="o">*</span><span class="n">VB</span>
    <span class="n">CA</span> <span class="o">=</span> <span class="n">NA</span><span class="o">/</span><span class="n">V</span>

    <span class="n">r</span>  <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">CA</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">RA</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span>
    <span class="n">RB</span> <span class="o">=</span> <span class="n">r</span>
    <span class="n">D1</span> <span class="o">=</span> <span class="n">RA</span><span class="o">*</span><span class="n">V</span>
    <span class="n">D2</span> <span class="o">=</span> <span class="n">RB</span><span class="o">*</span><span class="n">V</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now that’s done, we just define the starting state and the integration span, and we can solve our problem with solve_ivp.  As usual, since we’re using an interative ODE solver, it won’t hit the target conversion exactly, so we use an interpolation to find the time required to achieve 75% conversion of A.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">VA</span>    <span class="o">=</span> <span class="mi">50</span><span class="o">/</span><span class="mi">1000</span>  <span class="c1">#L/mol</span>
<span class="n">VB</span>    <span class="o">=</span> <span class="mf">38.46</span><span class="o">/</span><span class="mi">1000</span> <span class="c1">#L/mol</span>

<span class="n">NA0</span>   <span class="o">=</span> <span class="mi">10</span>  <span class="c1">#mol</span>
<span class="n">NB0</span>   <span class="o">=</span> <span class="mi">0</span>   <span class="c1">#mol</span>
<span class="n">var0</span>  <span class="o">=</span> <span class="p">[</span><span class="n">NA0</span><span class="p">,</span> <span class="n">NB0</span><span class="p">]</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">ans</span>   <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">P03</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">var0</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">)</span>
<span class="n">t</span>     <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">t</span>
<span class="n">NA</span>    <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">NB</span>    <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>
<span class="n">V</span>     <span class="o">=</span> <span class="n">NA</span><span class="o">*</span><span class="n">VA</span> <span class="o">+</span> <span class="n">NB</span><span class="o">*</span><span class="n">VB</span>

<span class="n">XA</span>    <span class="o">=</span> <span class="p">(</span><span class="n">NA0</span> <span class="o">-</span> <span class="n">NA</span><span class="p">)</span><span class="o">/</span><span class="n">NA0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">XA</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;XA&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;V (L)&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (min)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;XA or V (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">int1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">XA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="n">t_ans</span> <span class="o">=</span> <span class="n">int1</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The time when conversion of A reaches 75% is </span><span class="si">{</span><span class="n">t_ans</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1"> min&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L18_15_0.png" src="../_images/587-L18_15_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The time when conversion of A reaches 75% is 37.54 min
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="587-L17.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Material Balances VIII</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="587-L19.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Material Balances X</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Jesse Q. Bond, Syracuse University<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>