
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Minimizing a Univariate Function &#8212; Using Python in Chemical Engineering Curricula</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lectures" href="../Chapter2.html" />
    <link rel="prev" title="Root Finding: Univariate Functions" href="Module%2009%20-%20Root%20Finding%20for%20Univariate%20Scalar%20Functions.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/JQB.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Using Python in Chemical Engineering Curricula</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../Chapter1.html">
   Python Supplements
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Module%2001%20-%20The%20Basics.html">
     The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Module%2002%20-%20Lists%2C%20Tuples%2C%20Numpy%20Arrays%2C%20and%20Dictionaries.html">
     Data Structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Module%2003%20-%20Arrays%20and%20Matrices.html">
     Arrays and Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Module%2004%20-%20For%20Loops%2C%20List%20Comprehensions%2C%20Vectorization%2C%20and%20Plotting.html">
     For Loops, Vectorization, and Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Module%2005%20-%20Booleans%2C%20Conditionals%2C%20and%20Logical%20Tests.html">
     Logical Tests and Comparisons
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Module%2006%20-%20While%20Loops.html">
     While Loops in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Module%2007%20-%20Functions.html">
     Functions, D&amp;D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Module%2008%20-%20Probability%20Distributions%2C%20D%26D.html">
     The Probability of the Fall of Acererak
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Module%2009%20-%20Root%20Finding%20for%20Univariate%20Scalar%20Functions.html">
     Root Finding: Univariate Functions
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Minimizing a Univariate Function
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Chapter2.html">
   Lectures
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/F22-587-L02.html">
     Lecture 02: Extent and Conversion
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Chapter3.html">
   Recitations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/F22-587-R01.html">
     Recitation 01: Jupyter and Python Fundamentals
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/jqbond/AICHE2022_Python/main?urlpath=tree/Supplements/Module 10 - Optimization of Univariate Scalar Functions.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/jqbond/AICHE2022_Python"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/jqbond/AICHE2022_Python/issues/new?title=Issue%20on%20page%20%2FSupplements/Module 10 - Optimization of Univariate Scalar Functions.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Supplements/Module 10 - Optimization of Univariate Scalar Functions.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#locating-extrema-in-a-function-analytical-solution">
   Locating extrema in a function (analytical solution)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#newton-iteration">
     Newton Iteration
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optimization-routines-in-scipy">
   Optimization Routines in Scipy
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#opt-minimize-scalar">
     <code class="docutils literal notranslate">
      <span class="pre">
       opt.minimize_scalar()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exploring-the-solution-structure-from-minimize-scalar">
     Exploring the solution structure from
     <code class="docutils literal notranslate">
      <span class="pre">
       minimize_scalar()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introducing-opt-minimize">
   Introducing
   <code class="docutils literal notranslate">
    <span class="pre">
     opt.minimize()
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-basic-syntax-of-opt-minimize">
     The basic syntax of
     <code class="docutils literal notranslate">
      <span class="pre">
       opt.minimize()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#changing-algorithms-with-opt-minimize">
     Changing algorithms with
     <code class="docutils literal notranslate">
      <span class="pre">
       opt.minimize()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-additional-options-and-inputs-to-opt-minimize">
     Adding additional options and inputs to
     <code class="docutils literal notranslate">
      <span class="pre">
       opt.minimize()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bounds-and-constraints">
     Bounds and Constraints
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-bit-of-practice-with-opt-minimize">
     A bit of practice with
     <code class="docutils literal notranslate">
      <span class="pre">
       opt.minimize()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-constraints-to-opt-minimize">
     Adding constraints to
     <code class="docutils literal notranslate">
      <span class="pre">
       opt.minimize()
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#this-one-s-for-atherton-wing">
       This one’s for Atherton Wing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#adding-a-constraint">
       Adding a constraint
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#not-all-algorithms-will-accept-constraints-on-optimization-problems">
       Not all algorithms will accept constraints on optimization problems
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finding-global-optima">
   Finding global optima
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#you-may-want-to-try-a-global-optimization-algorithm">
     You may want to try a global optimization algorithm…
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Minimizing a Univariate Function</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#locating-extrema-in-a-function-analytical-solution">
   Locating extrema in a function (analytical solution)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#newton-iteration">
     Newton Iteration
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optimization-routines-in-scipy">
   Optimization Routines in Scipy
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#opt-minimize-scalar">
     <code class="docutils literal notranslate">
      <span class="pre">
       opt.minimize_scalar()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exploring-the-solution-structure-from-minimize-scalar">
     Exploring the solution structure from
     <code class="docutils literal notranslate">
      <span class="pre">
       minimize_scalar()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introducing-opt-minimize">
   Introducing
   <code class="docutils literal notranslate">
    <span class="pre">
     opt.minimize()
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-basic-syntax-of-opt-minimize">
     The basic syntax of
     <code class="docutils literal notranslate">
      <span class="pre">
       opt.minimize()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#changing-algorithms-with-opt-minimize">
     Changing algorithms with
     <code class="docutils literal notranslate">
      <span class="pre">
       opt.minimize()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-additional-options-and-inputs-to-opt-minimize">
     Adding additional options and inputs to
     <code class="docutils literal notranslate">
      <span class="pre">
       opt.minimize()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bounds-and-constraints">
     Bounds and Constraints
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-bit-of-practice-with-opt-minimize">
     A bit of practice with
     <code class="docutils literal notranslate">
      <span class="pre">
       opt.minimize()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-constraints-to-opt-minimize">
     Adding constraints to
     <code class="docutils literal notranslate">
      <span class="pre">
       opt.minimize()
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#this-one-s-for-atherton-wing">
       This one’s for Atherton Wing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#adding-a-constraint">
       Adding a constraint
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#not-all-algorithms-will-accept-constraints-on-optimization-problems">
       Not all algorithms will accept constraints on optimization problems
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finding-global-optima">
   Finding global optima
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#you-may-want-to-try-a-global-optimization-algorithm">
     You may want to try a global optimization algorithm…
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="minimizing-a-univariate-function">
<h1>Minimizing a Univariate Function<a class="headerlink" href="#minimizing-a-univariate-function" title="Permalink to this headline">#</a></h1>
<p>The general concept of “optimization” is one of the most important that you’ll encounter in engineering.  Generally speaking, your goal in optimization is to maximize or minimize <em><strong>something</strong></em>, and the types of things you may want to maximize or minimize take many, many forms. But the basic concepts of optimization are relatively simple, and the strategy we use is always roughly the same. You will construct a model that predicts the value you are trying to optimize: let’s call it an <em><strong>objective function</strong></em>, though you may also hear it referred to as a <em><strong>loss function</strong></em> or a <em><strong>cost function</strong></em> depending on the specific type of minimization problem or sub-field where you encouter optimization.</p>
<p>In general, our <em><strong>objective function</strong></em> will depend on many variable inputs.  Our goal in optimization is to find the value(s) of those inputs that either minimize or maximize the value of our objective function.</p>
<p>What are some concrete examples of things you might want to maximize or minimize?</p>
<p>How about profit? The profit obtained by a process is typically a complex function of raw material costs, sale prices, volume sold, capital costs, and operating costs. A very common goal is to figure out the scale your process should operate at (i.e., what volume) in order to maximize profit.  This is an example of an objective function that we’d like to maximize by finding the volume that gives us the best balance of revenue and expenses.  It is not always evident what that solution is since objective functions can be very complex. Moreover, we may be bound by several constraints on the system–it might be essential that we supply at least 100,000 units to meet our current orders.</p>
<p>Another example might be a new medical device - perhaps its overall cost to the patient is a complex function of size, materials and power supply…but you also have the constraint that you are providing the device for use in remote locations that don’t have reliable access to medical care…so it needs to have a lifetime of at least 5 years because it cannot be replaced easily. You may need to minimize that cost by varying materials of construction, power supply, and size while still meeting the constraint that you can only replace it once every few years due to sparse availability of medical care in the area where you’re working.</p>
<p>These are just examples to get you thinking about how frequently we are looking to either minimize or maximize a function. Again, that objective function may represent the cost of your product, the profit from your technology, the toxicity of a drug, or almost any other quantity you might want to either minimize or maximize. Because this is such a common goal, optimization is an essential skill for anyone working with data analysis and modelling, and there is a nice suite of optimization tools already built into Python. To use them, all we really need to know is how to define an objective function and tweak our solver options. But first, we’ll learn a little about how the methods work because it is always good to know what is under the hood.</p>
<p>In this Module, we will focus on optimizing a value returned by a univariate <em>scalar</em> function, i.e., a model that has a single input and returns a single output.  In the next Module, we’ll extend the methods to consider optimization of multivariate scalar functions. Finally, here we will focus on using numerical methods to optimize nonlinear problems. If you need to optimize a linear system, consider taking a course in linear algebra and linear programming methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>
</div>
</div>
</div>
<section id="locating-extrema-in-a-function-analytical-solution">
<h2>Locating extrema in a function (analytical solution)<a class="headerlink" href="#locating-extrema-in-a-function-analytical-solution" title="Permalink to this headline">#</a></h2>
<p>Let’s start with a basic idea: we are trying to find extrema (either a minimum or a maximum value) returned by a univariate scalar function. We already learned how to do this analytically in our calculus courses, right?  We just find where the derivative of our function is equal to zero!</p>
<p>It’s always nice to start out with a problem that we can solve analytically, so let’s look at a cubic polynomial.</p>
<div class="math notranslate nohighlight">
\[y(x) = -1.6x^3 + 5x^2 + 8x - 23\]</div>
<p>We know that we can expect, at most, 3 real roots for this polynomial, and we can expect at most 2 extrema (either maxima or minima). In the cell below, graph this function on the domain <span class="math notranslate nohighlight">\(x = [-2.3, 4]\)</span>; plot the x-axis to visualize the root locations, and find any roots in that domain using an algorithm of your choice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.6</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">23</span>
<span class="n">xset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1">## Graphing function</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xset</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">xset</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Module 10 - Optimization of Univariate Scalar Functions_3_0.png" src="../_images/Module 10 - Optimization of Univariate Scalar Functions_3_0.png" />
</div>
</div>
<p>I can see from the graph that there are 3 roots at <em>roughly</em> x = -2, x = 2, and x = 3.5.  I will provide each of these to the <code class="docutils literal notranslate"><span class="pre">opt.newton()</span></code> solver as initial guesses alongside my function <code class="docutils literal notranslate"><span class="pre">y</span></code>.  Once you get the hang of programming in Python, you see that you can do things like leverage your skills with for loops or (in this example) list comprehensions in order to streamline solving a nonlinear equation for multiple initial guesses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xguess</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">]</span>
<span class="n">roots</span>  <span class="o">=</span> <span class="p">[</span><span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="n">xguess</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The roots are located at x = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">roots</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The roots are located at x = [-2.183  1.978  3.33 ]
</pre></div>
</div>
</div>
</div>
<p>According to my results, the roots of this function are x = -2.183, x = 1.978, and x = 3.330. From the graph, I can see clearly that these roots are entirely different from the locations of the extrema - the maxima and minima. This is just to drive home the point that root finding (Module 09) and optimization (this Supplement) are two entirely different things. Looking at the graph, I can see that there is a minimum somewhere around <span class="math notranslate nohighlight">\(x = -1\)</span>, where <span class="math notranslate nohighlight">\(y \approx -25\)</span> or so.  There is also a maximum somewhere around <span class="math notranslate nohighlight">\(x = 3\)</span>, where <span class="math notranslate nohighlight">\(y \approx 3\)</span>.</p>
<p>While a graphical analysis is usually informative, we can be more precise in our solution by finding the roots of the derivative of y(x), i.e., by solving:</p>
<div class="math notranslate nohighlight">
\[y^{\prime}(x) = -4.8x^2 + 10x + 8 = 0\]</div>
<p>Take your pick of solution method and solve this equation in the cell below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.8</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span><span class="mi">8</span>
<span class="n">ypp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.6</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">10</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xset</span><span class="p">,</span> <span class="n">yp</span><span class="p">(</span><span class="n">xset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;first derivative of y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xset</span><span class="p">,</span> <span class="n">ypp</span><span class="p">(</span><span class="n">xset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;second derivative of y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Module 10 - Optimization of Univariate Scalar Functions_7_0.png" src="../_images/Module 10 - Optimization of Univariate Scalar Functions_7_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xguess</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">opts</span>   <span class="o">=</span> <span class="p">[</span><span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">yp</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="n">xguess</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Extrema in this function are located at x = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">opts</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The extrema in the function have the values y = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">opts</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The second derivative of the function at these locations are ypp = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ypp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">opts</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Extrema in this function are located at x = [-0.617  2.701]
The extrema in the function have the values y = [-25.66   3.56]
The second derivative of the function at these locations are ypp = [ 15.92 -15.92]
</pre></div>
</div>
</div>
</div>
<p>I find that the two roots of the <span class="math notranslate nohighlight">\(y^\prime(x)\)</span> are <span class="math notranslate nohighlight">\(x = -0.617\)</span> and <span class="math notranslate nohighlight">\(x = 2.7\)</span>. At these locations <span class="math notranslate nohighlight">\(y^{\prime}(x) = 0\)</span>. Further, I can evaluate the function here: <span class="math notranslate nohighlight">\(y(-0.617) = -25.66\)</span> and <span class="math notranslate nohighlight">\(y(2.7) = 3.56\)</span>. To determine if it is a maximum or a minimum in calculus, we would consider the second derivative.  At <span class="math notranslate nohighlight">\(x = -0.617\)</span>, <span class="math notranslate nohighlight">\(y^{\prime\prime}(x) = 15.9\)</span>, which indicates that the slope is increasing so this is a local minimum. At <span class="math notranslate nohighlight">\(x = 2.7\)</span>, <span class="math notranslate nohighlight">\(y^{\prime\prime}(x) = -15.9\)</span>, which means the slope is decreasing at this point and we have a local maximum. This is consistent with our graphical analysis.</p>
<p>Great! We’ve fully explored the analytical solution! Let’s make sure our numerical methods match up. We’ll start by writing our own optimization algorithm, which gives us some insight into how this works.</p>
<section id="newton-iteration">
<h3>Newton Iteration<a class="headerlink" href="#newton-iteration" title="Permalink to this headline">#</a></h3>
<p>Newton was a super rad dude. So it’s not surprising that he also has a method for finding the minimum of a function using an interative strategy. It is actually very similar to a Newton-Raphson iteration, except we use the first derivative and second derivative of the function instead of the first derivative and the function value. The general formula:</p>
<div class="math notranslate nohighlight">
\[x_{i+1} = x_i - \frac{f^\prime(x_i)}{f^{\prime\prime}(x_i)}\]</div>
<p>Based on that expression, you can see that iterations will converge once the <em><strong>derivative</strong></em> of the function is zero, which is the criteria we typically look for in finding extrema in a function. In contrast, a Newton-Raphson root finding iteration converges when the <em><strong>function itself</strong></em> is zero.</p>
<p>Similar to a Newton-Raphson algorithm, this Newton’s method looks like something we could implement in a loop! We won’t worry right now about finding a maximum or minimum specifically, just extrema in general. To do that, all we need to do is let the while loop proceed until our derivative value is close enough to zero that we are satisfied.  It may not be completely clear how to do this just yet, so we’ll walk through this example together.  Just as a refresher, we’ll use lambda functions to define the function itself, <code class="docutils literal notranslate"><span class="pre">y</span></code>, its first derivative, <code class="docutils literal notranslate"><span class="pre">dy</span></code>, and its second derivative <code class="docutils literal notranslate"><span class="pre">ddy</span></code>. But note, you can also use the long form function definitions using the def keyword:  there is nothing magic about a lambda function other than convenience!  Once you’ve done that, you can write the Newton Iteration as a while loop:</p>
<p>Go ahead and run this for a couple of initial guesses and watch the algorithm find the extrema in this function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>   <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.6</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">23</span>
<span class="n">dy</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="mf">1.6</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">8</span>
<span class="n">ddy</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mf">1.6</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">10</span>

<span class="n">x</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dy</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1e-8</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">4</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">dy</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">dy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">ddy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>   
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.0 -1043.0 -372.0
5.6744 -108.9467 -89.8111
3.655 -5.089 -19.5741
2.8748 3.3068 -2.9219
2.7088 3.5567 -0.1323
2.7005 3.5572 -0.0003
</pre></div>
</div>
</div>
</div>
<p>If you want an extra visualization of its progress, you can modify the code to illustrate the progress made on each iteration:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>   <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.6</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">23</span>
<span class="n">dy</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="mf">1.6</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">8</span>
<span class="n">ddy</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mf">1.6</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">10</span>

<span class="n">xrange</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">yrange</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">xplot</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xrange</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">yplot</span>  <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">xplot</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<span class="n">xlist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ylist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dy</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1e-8</span><span class="p">:</span>
    <span class="n">xlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span><span class="n">yplot</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xrange</span><span class="p">,</span><span class="n">yrange</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xlist</span><span class="p">,</span> <span class="n">ylist</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">4</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">dy</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span>
    <span class="c1">#time.sleep(2) #Add a 2 second pause before going on to next iteration</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">dy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">ddy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Module 10 - Optimization of Univariate Scalar Functions_12_0.png" src="../_images/Module 10 - Optimization of Univariate Scalar Functions_12_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-3 41.2 -65.2
</pre></div>
</div>
<img alt="../_images/Module 10 - Optimization of Univariate Scalar Functions_12_2.png" src="../_images/Module 10 - Optimization of Univariate Scalar Functions_12_2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.3196 -21.1736 -13.5542
</pre></div>
</div>
<img alt="../_images/Module 10 - Optimization of Univariate Scalar Functions_12_4.png" src="../_images/Module 10 - Optimization of Univariate Scalar Functions_12_4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.7216 -25.568 -1.7162
</pre></div>
</div>
<img alt="../_images/Module 10 - Optimization of Univariate Scalar Functions_12_6.png" src="../_images/Module 10 - Optimization of Univariate Scalar Functions_12_6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.6203 -25.6567 -0.0493
</pre></div>
</div>
<img alt="../_images/Module 10 - Optimization of Univariate Scalar Functions_12_8.png" src="../_images/Module 10 - Optimization of Univariate Scalar Functions_12_8.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.6172 -25.6567 -0.0
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="optimization-routines-in-scipy">
<h2>Optimization Routines in Scipy<a class="headerlink" href="#optimization-routines-in-scipy" title="Permalink to this headline">#</a></h2>
<p>As with root finding in the last exercise, I don’t recommend we write our own minimization routines outside of doing so to learn more about how they work. In general, it can be difficult to get optimization routines to converge rapidly and stably, and more sophisticated methods are available in the Scipy.optimize package.</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html">https://docs.scipy.org/doc/scipy/reference/optimize.html</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Our very simple Newton method above found extrema without distinguishing between maxima and minima.  It was only looking for a place where the derivative = 0. Scipy optimization algorithms will always <em><strong>minimize</strong></em> your objective function by default.  If you want to <em><strong>maximize</strong></em> a function, you can always just multiply the value returned by your objective function by -1.</p>
</div>
<section id="opt-minimize-scalar">
<h3><code class="docutils literal notranslate"><span class="pre">opt.minimize_scalar()</span></code><a class="headerlink" href="#opt-minimize-scalar" title="Permalink to this headline">#</a></h3>
<p>The usage for scipy optimization algorithms is very similar to what we learned with root finding for scalar functions.  Let’s start with the most basic option:  minimizing a univariate, scalar function, i.e., the case we are currently considering:</p>
<div class="math notranslate nohighlight">
\[y(x) = -1.6x^3 + 5x^2 + 8x - 23\]</div>
<p>Since y(x) is univariate, we are really just looking for the value of x where y is at a minimum. If all you need to do is find a local minimum in a univariate function, you can use <code class="docutils literal notranslate"><span class="pre">opt.minimize_scalar()</span></code> from <code class="docutils literal notranslate"><span class="pre">scipy</span></code>. It has a very small set of minimum inputs: you only need to provide it with the function, and it will return a local minimum.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">function_name</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we just run <code class="docutils literal notranslate"><span class="pre">opt.minimize_scalar(y)</span></code></p>
<p>For this very simple minimization, you should see that it returns both our minimum x location and the minimum function value.  You can consult the scipy docs above for options that you can provide to <code class="docutils literal notranslate"><span class="pre">opt.minimze_scalar()</span></code>; most of them are passed using keyword arguments as we did with <code class="docutils literal notranslate"><span class="pre">opt.newton()</span></code>, <code class="docutils literal notranslate"><span class="pre">opt.brentq()</span></code>, etc in Module 09.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     fun: -25.656739046884304
 message: &#39;\nOptimization terminated successfully;\nThe returned value satisfies the termination criteria\n(using xtol = 1.48e-08 )&#39;
    nfev: 15
     nit: 11
 success: True
       x: -0.6171691124890302
</pre></div>
</div>
</div>
</div>
</section>
<section id="exploring-the-solution-structure-from-minimize-scalar">
<h3>Exploring the solution structure from <code class="docutils literal notranslate"><span class="pre">minimize_scalar()</span></code><a class="headerlink" href="#exploring-the-solution-structure-from-minimize-scalar" title="Permalink to this headline">#</a></h3>
<p>All of these optimization routines will return some type of solution structure, where each attribute of the structure can be accessed using a dot operator.  For example, if I run <code class="docutils literal notranslate"><span class="pre">sol</span> <span class="pre">=</span> <span class="pre">opt.minimize_scalar(y)</span></code>, it will store that solution structure in <code class="docutils literal notranslate"><span class="pre">answer</span></code> (an arbitrary name).  I can then access the function value (<code class="docutils literal notranslate"><span class="pre">answer.fun</span></code>), the number of function evaluations (<code class="docutils literal notranslate"><span class="pre">answer.nfev</span></code>), the number of iterations (<code class="docutils literal notranslate"><span class="pre">answer.nit</span></code>), the convergence status (<code class="docutils literal notranslate"><span class="pre">answer.success</span></code>), and the value of x at the minimum (<code class="docutils literal notranslate"><span class="pre">answer.x</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">answer</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">answer</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">answer</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span> <span class="n">answer</span><span class="o">.</span><span class="n">nfev</span><span class="p">,</span> <span class="n">answer</span><span class="o">.</span><span class="n">nit</span><span class="p">,</span> <span class="n">answer</span><span class="o">.</span><span class="n">success</span><span class="p">,</span> <span class="n">answer</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     fun: -25.656739046884304
 message: &#39;\nOptimization terminated successfully;\nThe returned value satisfies the termination criteria\n(using xtol = 1.48e-08 )&#39;
    nfev: 15
     nit: 11
 success: True
       x: -0.6171691124890302 

-25.656739046884304 15 11 True -0.6171691124890302
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="introducing-opt-minimize">
<h2>Introducing <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code><a class="headerlink" href="#introducing-opt-minimize" title="Permalink to this headline">#</a></h2>
<p>Digging a bit deeper into packages available in <strong>Scipy</strong>, the <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code> function is a more general routine than <code class="docutils literal notranslate"><span class="pre">opt.minimize_scalar()</span></code>. It will allow you to minimize either <em><strong>univariate</strong></em> or <em><strong>multivariate</strong></em> scalar functions, the latter meaning that a function accepts multiple arguments (inputs), but it only returns a single, scalar output. We’ll cover how to work through minimization of multivarariate functions in the Module 11. For now, we’ll stick with minimizing our simple cubic function, y(x), to get a feel for the different syntax between <code class="docutils literal notranslate"><span class="pre">opt.minimize_scalar()</span></code> and <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code>. Generally speaking, the way we pass extra options is similar for both, so we’ll consider adding options to the more fully featured <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code>, knowing that the same approach applies to <code class="docutils literal notranslate"><span class="pre">opt.minimize_scalar()</span></code>.</p>
<section id="the-basic-syntax-of-opt-minimize">
<h3>The basic syntax of <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code><a class="headerlink" href="#the-basic-syntax-of-opt-minimize" title="Permalink to this headline">#</a></h3>
<p>At a minimum (pun intended), <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code> in its default state requires us to provide the function name and an initial guess at the variable values where we expect to find a minimum:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">function_name</span><span class="p">,</span> <span class="n">initial_guess_for_optimum_location</span><span class="p">)</span>
</pre></div>
</div>
<p>For this example, we’ll minimize the function y and we’ll specify that we think x = -1 is a reasonable guess for the x location of the minimum in y(x), <code class="docutils literal notranslate"><span class="pre">opt.minimize(y,-1)</span></code>. This command will run <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code> with a default optimization algorithm (either BFGS, L-BFGS-B, or SLSQP depending on the specific nature of the problem) starting at an initial guess of -1 to find the minimum value of y.  <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code> will return a solution structure similar to <code class="docutils literal notranslate"><span class="pre">opt.minimize_scalar()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: -25.656739046884304
 hess_inv: array([[1]])
      jac: array([2.38418579e-07])
  message: &#39;Optimization terminated successfully.&#39;
     nfev: 6
      nit: 1
     njev: 3
   status: 0
  success: True
        x: array([-0.6171691])
</pre></div>
</div>
</div>
</div>
</section>
<section id="changing-algorithms-with-opt-minimize">
<h3>Changing algorithms with <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code><a class="headerlink" href="#changing-algorithms-with-opt-minimize" title="Permalink to this headline">#</a></h3>
<p>As your optimization problems get more difficult, you may find that default solvers do not perform well, and it may be necessary to test a new algorithm. Selecting the right algorithm is actually a pretty advanced topic, one that is far beyond the scope of this module, but be aware that each algorithm will use different methods that are often suited to a specific type of problem.  Regardless, once you decide on the algorithm you want to use, it is very easy to change with a keyword argument. This is similar to adding specifications to root finding algorithms or to the pyplot interface.</p>
<p>For example, to repeat the minimization above with a Nelder-Mead algorithm:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Nelder-Mead&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> final_simplex: (array([[-0.6171875 ],
       [-0.61708984]]), array([-25.65673904, -25.656739  ]))
           fun: -25.656739044189454
       message: &#39;Optimization terminated successfully.&#39;
          nfev: 28
           nit: 14
        status: 0
       success: True
             x: array([-0.6171875])
</pre></div>
</div>
</div>
</div>
</section>
<section id="adding-additional-options-and-inputs-to-opt-minimize">
<h3>Adding additional options and inputs to <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code><a class="headerlink" href="#adding-additional-options-and-inputs-to-opt-minimize" title="Permalink to this headline">#</a></h3>
<p>You may find that some algorithms require additional inputs, similar to a Newton-Raphson algorithm needing a derivative input in the root finding assignment. For example, the <em><strong>dogleg</strong></em> algorithm requires you to provide the <em><strong>Jacobian</strong></em>, which is the set of partial deriviatives of the objective function with respect to each one of its arguments (e.g., “x” in this case), and the <em><strong>Hessian</strong></em>, which is the set of second partial derivatives of the objective function with respect to each of its arguments. For a simple univariate scalar function like this, the Jacobian is just the derivative <span class="math notranslate nohighlight">\(y^{\prime}(x)\)</span>, and the Hessian is just the second derivative <span class="math notranslate nohighlight">\(y^{\prime\prime}(x)\)</span>. Don’t get used to that level of simplicity. More commonly, we will use numerical optimization routines on multivariate functions, and Jacobians and Hessians are generally going to be vector functions for multivariate objectives.</p>
<p>For this example, to give you a feel for how to add more options, we are also adding the <code class="docutils literal notranslate"><span class="pre">options</span></code> keyword argument, which takes name : value pairs in a dictionary.  Here, I’m using it to turn on the display of results for intermediate iterations (not just the final output).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;dogleg&#39;</span><span class="p">,</span> <span class="n">jac</span> <span class="o">=</span> <span class="n">dy</span><span class="p">,</span> <span class="n">hess</span> <span class="o">=</span> <span class="n">ddy</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;disp&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         Current function value: -25.656739
         Iterations: 3
         Function evaluations: 4
         Gradient evaluations: 4
         Hessian evaluations: 3
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     fun: -25.65673904688429
    hess: array([[15.92482381]])
     jac: array([-6.93231542e-07])
 message: &#39;Optimization terminated successfully.&#39;
    nfev: 4
    nhev: 3
     nit: 3
    njev: 4
  status: 0
 success: True
       x: array([-0.61716915])
</pre></div>
</div>
</div>
</div>
</section>
<section id="bounds-and-constraints">
<h3>Bounds and Constraints<a class="headerlink" href="#bounds-and-constraints" title="Permalink to this headline">#</a></h3>
<p>There are two more useful things to add into optimization routines: bounds and constraints. <strong>Bounds</strong> are strict limits on the actual values of the arguments that we are minimizing with respect to. These are straightforward to add into an optimization function in Python by using the <code class="docutils literal notranslate"><span class="pre">bounds</span></code> keyword, which generally takes the form of pairs of lower bounds and upper bounds in a tuple.</p>
<p>For instance, if we wanted to find the local minimum of y(x) on the domain x = [0, 1], we could do so by specifying upper and lower bounds on x in line when we call <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: -23.0
 hess_inv: &lt;1x1 LbfgsInvHessProduct with dtype=float64&gt;
      jac: array([7.99999995])
  message: &#39;CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL&#39;
     nfev: 2
      nit: 0
     njev: 1
   status: 0
  success: True
        x: array([0.])
</pre></div>
</div>
</div>
</div>
<p>In the general <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code> syntax each tuple in the “bounds” keyword argument is a pair of (lower bound, upper bound) for the variable that you’re optimizing. In the above example, I want to only search for a minimum between x = 0 and x = 1, so I set the bounds accordingly. You’ll see this finds the minimum value of y on the specified domain, which is y = -23 at x = 0. This is not the same as the local minimum over the full domain we are considering because we have prevented x from going below 0 by setting bounds on it.  Why might this be useful? Let’s say x is a physical quantity like mass, concentration, or temperature, where a negative value is the mathematically correct solution, but it is physically impossible to attain.  In these cases, you may want to impose a bound on that variable, and you can do so easily with the bounds keyword.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The above syntax for the <code class="docutils literal notranslate"><span class="pre">bounds</span></code> keyword argument is relatively universal for <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code> as well as the global optimization methods from scipy. That said, there may be a little flexibility in how you specify bounds for a particular routine, so double check the documentation to make sure your syntax is correct and doing what you want it to do.  The least squares optimization routines use a different syntax, IIRC.</p>
</div>
</section>
<section id="a-bit-of-practice-with-opt-minimize">
<h3>A bit of practice with <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code><a class="headerlink" href="#a-bit-of-practice-with-opt-minimize" title="Permalink to this headline">#</a></h3>
<p>Before we move on to a more complex problem with constraints, try a few things with our original cubic equation y(x):</p>
<ol class="simple">
<li><p>Minimize y(x) using the Powell algorithm.</p></li>
<li><p>Minimize y(x) using the trust-krylov algorithm</p></li>
<li><p>Minimize y(x) using the SLSQP algorithm but place a lower bound of 1 on x.</p></li>
<li><p>Minimize y(x) using the BFGS method; set the tolerance to 1e-8; set the max iterations to 1000, and turn the display on.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Powell&#39;</span><span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jac</span> <span class="o">=</span> <span class="n">dy</span><span class="p">,</span> <span class="n">hess</span> <span class="o">=</span> <span class="n">ddy</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;trust-krylov&#39;</span><span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;SLSQP&#39;</span><span class="p">,</span> <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)])</span>
<span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;BFGS&#39;</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;disp&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;maxiter&#39;</span> <span class="p">:</span> <span class="mi">1000</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: -25.656739
         Iterations: 7
         Function evaluations: 18
         Gradient evaluations: 9
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: -25.656739046884304
 hess_inv: array([[0.05966305]])
      jac: array([0.])
  message: &#39;Optimization terminated successfully.&#39;
     nfev: 18
      nit: 7
     njev: 9
   status: 0
  success: True
        x: array([-0.61716911])
</pre></div>
</div>
</div>
</div>
</section>
<section id="adding-constraints-to-opt-minimize">
<h3>Adding constraints to <code class="docutils literal notranslate"><span class="pre">opt.minimize()</span></code><a class="headerlink" href="#adding-constraints-to-opt-minimize" title="Permalink to this headline">#</a></h3>
<p>Next, we may have a more complex <strong>constraint</strong> on our system that we cannot handle by simply bounding the variables. We typically encounter two types: equality constraints, and inequality constraints.  We’ll go through a simple example that illustrates both types of constraints, just to see how they work and how their syntax is almost interchangeable.</p>
<section id="this-one-s-for-atherton-wing">
<h4>This one’s for Atherton Wing<a class="headerlink" href="#this-one-s-for-atherton-wing" title="Permalink to this headline">#</a></h4>
<p>Let’s say for the sake of argument that I captain a rogue Firefly class cargo ship named <em><strong>Serenity</strong></em>. My crew and I are moving a herd of cattle off of Persephone and out to The Rim Planets for Sir Warrick.  Our cut on the job is 30% of the total sale price of the cattle, which sell for 8000 credits per head. However, each additional cow has a dramatic impact on my fuel economy. My fuel costs come to <span class="math notranslate nohighlight">\(100 \times \textrm{cows}^2\)</span> credits. In addition, I have to pay a bribe to a crooked Alliance customs agent to get the cattle off of Persephone in the first place. The bribe cost can be modeled as a decaying exponential function, <span class="math notranslate nohighlight">\((500\cdot e^\left(\textrm{-cows*0.5}\right) + 32)\cdot \textrm{cows}\)</span>.  It would be reasonble for me to create the following objective function, which returns my negative profit as a univariate function of cows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">obj</span><span class="p">(</span><span class="n">cows</span><span class="p">):</span>
    <span class="n">Revenue</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mi">8000</span><span class="o">*</span><span class="n">cows</span>
    <span class="n">Fuel</span>    <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">cows</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">Bribe</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">500</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">cows</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span><span class="o">*</span><span class="n">cows</span>
    <span class="n">Profit</span>  <span class="o">=</span> <span class="n">Revenue</span> <span class="o">-</span> <span class="n">Fuel</span> <span class="o">-</span> <span class="n">Bribe</span>
    <span class="n">objective</span> <span class="o">=</span> <span class="o">-</span> <span class="n">Profit</span>
    <span class="k">return</span> <span class="n">objective</span>
</pre></div>
</div>
</div>
</div>
<p>Recall that Scipy optimization routines will minimize your objective function.  I want to maximize profit, so I am returning its negative in this objective.</p>
<p>I’m going to make an initial guess (complete wild guess here) that 16 cows will net me maximum profit. For some insight, I arrived at this number because I think that is about how many cows Malcolm Reynolds took onto Serenity in the Firefly Episode “Shindig.”</p>
<p>From there, we’ll start the optimization routine and see what we get. As formulated, you can easily minimize this objective using any of the above approaches; I show a basic, unbounded, unconstrained optimization above. It may be of interest to print out values of Revenue, Fuel Costs, Bribe Costs, and Profit to get a feel for how the optimization responds to various changes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obj</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">)))</span> <span class="c1"># np.floor rounds down to nearest integer</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obj</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">)))</span>  <span class="c1">#np.ceiling rounds up to nearest integer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[11.8726013]
[-13925.52275709]
[-14001.12748694]
</pre></div>
</div>
</div>
</div>
<p>I find that moving 12 cows from Persephone to The Rim will earn us a net profit of 14001 credits.  The true optimum is actually something like 11.8, but you can only get 8000 credits for an integer cow.  12 is slightly more profitable than 11, so we take 12.</p>
</section>
<section id="adding-a-constraint">
<h4>Adding a constraint<a class="headerlink" href="#adding-a-constraint" title="Permalink to this headline">#</a></h4>
<p>Now for the constraint: Our crooked Alliance contact informs us that he will accept no less than 700 credits for his bribe to allow us to move the cattle off of Persephone without going through customs: he is taking on a lot of risk to look the other way while we smuggle cattle. That right there? Just the kind of inequality constraint we were talking about.</p>
<div class="math notranslate nohighlight">
\[\textrm{Bribe} \geqslant 700\]</div>
<p>In Scipy’s constrained optimization packages, specifying constraints is a little non-intuitive, but you get used to it.  We’ll go through a basic implementation with only the core requirements.  We add constraints to our optimization function call using the constraints keyword argument. Constraints are formulated as dictionaries that have the following format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">constraint_dictionary</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span> <span class="p">:</span> <span class="n">constraint_type</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span> <span class="p">:</span> <span class="n">function_name</span><span class="p">}</span>
</pre></div>
</div>
<p>The ‘type’ key is used to declare whether a constraint is an equality (‘eq’) or an inequality (‘ineq’). The ‘fun’ key is used to declare the function that specifies your constraint. If it is an inequality constraint, your function is forced to be non-negative.  If it is an equality constraint, your function is forced to equal zero.</p>
<p>You can stack as many constraints as you want into the constraint keyword using the following convention:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span><span class="n">constraint_dictionary1</span><span class="p">,</span> <span class="n">constraint_dictionary2</span><span class="p">,</span> <span class="n">constraint_dictionary3</span><span class="p">,</span> <span class="n">etc</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, we have a single inequality constraint:  the Alliance contact won’t accept a bribe of less than 700 credits; we can formulate that as a function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">constraintfun1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">cows</span><span class="p">:</span> <span class="p">(</span><span class="mi">500</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">cows</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span><span class="o">*</span><span class="n">cows</span> <span class="o">-</span> <span class="mi">700</span>
</pre></div>
</div>
</div>
</div>
<p>That constraint function evaluates the total bribe and subtracts 700 from it.  Adding it to the optimization routine will ensure that</p>
<div class="math notranslate nohighlight">
\[\textrm{Bribe} - 700 \geqslant 0\]</div>
<p>We will use this constraint function to build a constraint dictionary that we can then add to our optimization routine. The type of constraint is, again, an inequality.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">constraint_dictionary</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span> <span class="p">:</span> <span class="s1">&#39;ineq&#39;</span> <span class="p">,</span> <span class="s1">&#39;fun&#39;</span> <span class="p">:</span> <span class="n">constraintfun1</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="not-all-algorithms-will-accept-constraints-on-optimization-problems">
<h4>Not all algorithms will accept constraints on optimization problems<a class="headerlink" href="#not-all-algorithms-will-accept-constraints-on-optimization-problems" title="Permalink to this headline">#</a></h4>
<p>We then add this constraint_dictionary to our optimization routine as shown below; we’ll use SLSQP since it is a constrained optimization algorithm that takes either inequality or equality constraints.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Only SLSQP, COBYLA, and trust-constr algorithms accept constraints.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;SLSQP&#39;</span><span class="p">,</span> <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span><span class="n">constraint_dictionary</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     fun: -3960.4686595970297
     jac: array([2005.69265747])
 message: &#39;Optimization terminated successfully&#39;
    nfev: 12
     nit: 4
    njev: 4
  status: 0
 success: True
       x: array([21.86890639])
</pre></div>
</div>
</div>
</div>
<p>Ouch! That really cuts into our profit! We meet the constraint if we move 21.8 cows, but of course that rounds up to 22, where we find our total profit comes down to about 3696 credits.</p>
<p>In this situation, the only reasonable thing to do is ask Jayne Cobb to <em>talk</em> to the Alliance contact.  After the conversation, the contact agrees to accept a bribe cost of exactly 500 credits.  While there are other ways that we could build this change into our model (saying explicitly Bribe = 500 being the best), I’ll illustrate how to do this by a simple change in our constraint equation.  We will change it to an equality constraint, and we will write it so that it evaluates to zero:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">constraintfun2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">cows</span><span class="p">:</span> <span class="p">(</span><span class="mi">500</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">cows</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span><span class="o">*</span><span class="n">cows</span> <span class="o">-</span> <span class="mi">500</span>
<span class="n">constraint_dictionary</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span> <span class="p">:</span> <span class="s1">&#39;eq&#39;</span> <span class="p">,</span> <span class="s1">&#39;fun&#39;</span> <span class="p">:</span> <span class="n">constraintfun2</span><span class="p">}</span>
<span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;SLSQP&#39;</span><span class="p">,</span> <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span><span class="n">constraint_dictionary</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     fun: -12659.7918023667
     jac: array([734.89135742])
 message: &#39;Optimization terminated successfully&#39;
    nfev: 12
     nit: 4
    njev: 4
  status: 0
 success: True
       x: array([15.52165898])
</pre></div>
</div>
</div>
</div>
<p>OK, not too bad! If we move 15.5 (rounded up to 16) cows to The Rim, we clear 12285 credits in profit without any hassle from customs on Persephone!  Thanks Jayne! In a nutshell, that is how you use constrained optimization routines to simulate the Cattle Smuggling caper from <em>Firefly</em>.</p>
</section>
</section>
</section>
<section id="finding-global-optima">
<h2>Finding global optima<a class="headerlink" href="#finding-global-optima" title="Permalink to this headline">#</a></h2>
<p>As a final example, we want to talk about finding global optima in a function that may have many local optima.  Generally speaking, the higher dimensional your optimization problem becomes (i.e., the more parameters you are trying to fit), the more likely you are to have many, many local minima.  But what you are actually interested in is a global minimum…and these can be very difficult to find.  As a simple example, we’ll look at a univariate function of x that has many local minima but only one global minimum:</p>
<div class="math notranslate nohighlight">
\[k(x) =  \frac{\sin (10 \pi x)}{2x} + \left(x - 1\right)^4\]</div>
<p>Plot the function on the domain <span class="math notranslate nohighlight">\(x = [0.1, 2.5]\)</span>; see for yourself!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span>
<span class="n">xplot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">kplot</span> <span class="o">=</span> <span class="n">k</span><span class="p">(</span><span class="n">xplot</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">kplot</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Module 10 - Optimization of Univariate Scalar Functions_42_0.png" src="../_images/Module 10 - Optimization of Univariate Scalar Functions_42_0.png" />
</div>
</div>
<p>Clearly, there are many local minima on this domain, but only one global minimum somewhere around <span class="math notranslate nohighlight">\(x = 0.1\)</span>.  How to find it exactly?  Try out some of our above optimization routines with varied initial guesses.</p>
<p>For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xguess</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">xguess</span><span class="p">,</span> <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">kplot</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;k(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;minimum that we found&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The for an initial guess of </span><span class="si">{</span><span class="n">xguess</span><span class="si">}</span><span class="s1">, the minimum we find is a value of k = </span><span class="si">{</span><span class="n">k</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1"> at x = </span><span class="si">{</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The for an initial guess of 0.2, the minimum we find is a value of k = -2.874 at x = 0.144.
</pre></div>
</div>
<img alt="../_images/Module 10 - Optimization of Univariate Scalar Functions_44_1.png" src="../_images/Module 10 - Optimization of Univariate Scalar Functions_44_1.png" />
</div>
</div>
<p>Notice how hard it is to get these routines to locate the true global minimum.  It is almost a question of a lucky combination of algorithm, initial guess, and/or bounds at this point…</p>
<section id="you-may-want-to-try-a-global-optimization-algorithm">
<h3>You may want to try a global optimization algorithm…<a class="headerlink" href="#you-may-want-to-try-a-global-optimization-algorithm" title="Permalink to this headline">#</a></h3>
<p>This is the type of case where we might be interested in trying out a global optimization routine, of which there are several available in Scipy: <code class="docutils literal notranslate"><span class="pre">basinhopping</span></code>, <code class="docutils literal notranslate"><span class="pre">brute</span></code>, <code class="docutils literal notranslate"><span class="pre">differential_evolution</span></code>, <code class="docutils literal notranslate"><span class="pre">shgo</span></code>, and <code class="docutils literal notranslate"><span class="pre">dual_annealing</span></code>.  They all have fairly similar syntax. You will typically supply the function name (all algorithms), an initial guess (basinhopping), and/or the bounds on the variable(s) (all other algorithms). Here, the syntax for bounds is similar to what we used for opt.minimize, except that we don’t need a bounds keyword.</p>
<p>For example, to look for a minimum with this function using basinhopping:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xguess</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">sol</span>   <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">basinhopping</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">kplot</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;k(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;minimum that we found&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The for an initial guess of </span><span class="si">{</span><span class="n">xguess</span><span class="si">}</span><span class="s1">, the minimum we find is a value of k = </span><span class="si">{</span><span class="n">k</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1"> at x = </span><span class="si">{</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The for an initial guess of 1, the minimum we find is a value of k = -2.874 at x = 0.144.
</pre></div>
</div>
<img alt="../_images/Module 10 - Optimization of Univariate Scalar Functions_46_1.png" src="../_images/Module 10 - Optimization of Univariate Scalar Functions_46_1.png" />
</div>
</div>
<p>Whereas if you wanted to use dual_annealing, you would supply the function and a range to consider:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xplot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">kplot</span> <span class="o">=</span> <span class="n">k</span><span class="p">(</span><span class="n">xplot</span><span class="p">)</span>
<span class="n">sol</span>   <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">dual_annealing</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">[(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">kplot</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;k(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;minimum that we found&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The minimum we find is a value of k = </span><span class="si">{</span><span class="n">k</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1"> at x = </span><span class="si">{</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The minimum we find is a value of k = -2.874 at x = 0.144.
</pre></div>
</div>
<img alt="../_images/Module 10 - Optimization of Univariate Scalar Functions_48_1.png" src="../_images/Module 10 - Optimization of Univariate Scalar Functions_48_1.png" />
</div>
</div>
<p>Once you get the hang of the basic optimization interface, it is pretty straightforward to switch between optimization methods, but you should check their documentation to confirm as you can find slightly different syntax in each case.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Supplements"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Module%2009%20-%20Root%20Finding%20for%20Univariate%20Scalar%20Functions.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Root Finding: Univariate Functions</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../Chapter2.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lectures</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Jesse Q. Bond, Syracuse University<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>