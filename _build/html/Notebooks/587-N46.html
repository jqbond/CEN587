
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Kinetics VI &#8212; Kinetics and Reaction Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Notebooks/587-N46';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Nonlinear Regression" href="587-N45.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/JQB.png" class="logo__image only-light" alt="Kinetics and Reaction Engineering - Home"/>
    <script>document.write(`<img src="../_static/JQB.png" class="logo__image only-dark" alt="Kinetics and Reaction Engineering - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../Chapter2.html">Lectures</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="587-N45.html">Nonlinear Regression</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Kinetics VI</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jqbond/CEN587/main?urlpath=tree/Notebooks/587-N46.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jqbond/CEN587" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jqbond/CEN587/issues/new?title=Issue%20on%20page%20%2FNotebooks/587-N46.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Notebooks/587-N46.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Kinetics VI</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-01">Example Problem 01</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-01">Solution to Example Problem 01</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#use-product-flowrates-to-estimate-rate">Use Product Flowrates to estimate rate</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linearization-of-data">Linearization of data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression-to-estimate-alpha-and-k">Linear Regression to estimate <span class="math notranslate nohighlight">\(\alpha\)</span> and k</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-closer-look">A closer look</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reaction-mechanisms">Reaction Mechanisms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#azomethane-decomposition-a-possible-mechanism">Azomethane Decomposition: A Possible Mechanism</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#is-the-mechanism-consistent-with-our-observations">Is the mechanism consistent with our observations?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pseudo-steady-state-hypothesis">The Pseudo Steady State Hypothesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reconciliation-with-observed-trends">Reconciliation with Observed trends</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#low-concentration-limit">Low concentration limit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#high-concentration-limit">High concentration limit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="kinetics-vi">
<h1>Kinetics VI<a class="headerlink" href="#kinetics-vi" title="Link to this heading">#</a></h1>
<p>This lecture covers the analysis differential tubular reactors (plug flow or packed bed reactors). We will consider the origin of “non-elementary” or non-power law kinetics observed during Azomethane decomposition. This will transition into analysis of reaction mechanisms and elementary steps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">opt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">ceil</span><span class="p">,</span> <span class="n">floor</span>
</pre></div>
</div>
</div>
</div>
<section id="example-problem-01">
<h2>Example Problem 01<a class="headerlink" href="#example-problem-01" title="Link to this heading">#</a></h2>
<p>Azomethane decomposition is carried out in a 50 mL Plug Flow Reactor that is operating under differential conditions at steady state. The reaction is given below:</p>
<div class="math notranslate nohighlight">
\[C_2H_6N_2 \longrightarrow C_2H_6 + N_2\]</div>
<p>Azomethane decomposition is thermodynamically very favorable, so you can assume the reaction is irreversible.  For convenience, we will just relabel everything as:</p>
<div class="math notranslate nohighlight">
\[A \longrightarrow B + C\]</div>
<p>For this experiment, you vary the feed concentration while maintaining a very high volumetric flowrate (your space time approaches zero). This ensures the fractional conversion of <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(X_A\)</span>, stays well below 1% for all experiments. At each unique feed concentration, you measure the concentration of species <span class="math notranslate nohighlight">\(B\)</span> in the reactor effluent and use it to determine the effluent molar flowrate of species <span class="math notranslate nohighlight">\(B\)</span>. Collected data are compiled in the table below.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><span class="math notranslate nohighlight">\(C_{Af} \ (\mathrm{mmol \ L^{-1}})\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(F_B (\mathrm{mmol \ min^{-1}})\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(0.001\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(2.45 \times 10^{-9}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(0.002\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(9.08 \times 10^{-9}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(0.005\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(6.29 \times 10^{-8}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(0.01\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(2.27 \times 10^{-7}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(0.02\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(9.50 \times 10^{-7}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(0.05\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(5.39 \times 10^{-6}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(0.10\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(2.05 \times 10^{-5}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(0.20\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(5.72 \times 10^{-5}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(0.50\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(2.43 \times 10^{-4}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(1.0\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(6.71 \times 10^{-4}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(2.0\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(1.56 \times 10^{-3}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(5.0\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(4.25 \times 10^{-3}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(10.0\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(7.43 \times 10^{-3}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(20.0\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(1.70 \times 10^{-2}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(50.0\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(3.98 \times 10^{-2}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(100.0\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(7.99 \times 10^{-2}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Use the measured concentrations of <span class="math notranslate nohighlight">\(A\)</span> in the reactor effluent to determine the reaction order in <span class="math notranslate nohighlight">\(A\)</span> and the rate constant for this reaction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span>  <span class="o">=</span> <span class="mf">0.050</span> <span class="c1">#L</span>
<span class="n">CA_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span> <span class="c1">#mmol/L</span>
<span class="n">FB_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.01E-09</span><span class="p">,</span> <span class="mf">1.09E-08</span><span class="p">,</span> <span class="mf">5.98E-08</span><span class="p">,</span> <span class="mf">2.53E-07</span><span class="p">,</span> <span class="mf">9.75E-07</span><span class="p">,</span> <span class="mf">5.84E-06</span><span class="p">,</span> <span class="mf">1.82E-05</span><span class="p">,</span> <span class="mf">6.89E-05</span><span class="p">,</span> <span class="mf">2.03E-04</span><span class="p">,</span> <span class="mf">5.23E-04</span><span class="p">,</span> <span class="mf">1.60E-03</span><span class="p">,</span> <span class="mf">3.75E-03</span><span class="p">,</span> <span class="mf">8.40E-03</span><span class="p">,</span> <span class="mf">1.49E-02</span><span class="p">,</span> <span class="mf">4.52E-02</span><span class="p">,</span> <span class="mf">7.10E-02</span><span class="p">])</span> <span class="c1">#mmol/min</span>
</pre></div>
</div>
</div>
</div>
<section id="solution-to-example-problem-01">
<h3>Solution to Example Problem 01<a class="headerlink" href="#solution-to-example-problem-01" title="Link to this heading">#</a></h3>
<p>A differential tubular reactor is a bit of a different concept than what we’ve covered so far.  The idea is that you operate the reactor so close to 0% conversion that the composition is constant across the reactor.  We also generally would operate a differential reactor in such a way that the change in temperature and pressure across the reactor is neglible.  This is important because we generally expect that reaction rate depends on temperature, pressure, and composition. If these three things are constant across the reactor Volume (or catalyst bed), then the reaction rate is also constant spatially across the entire length of the reactor. We start our analysis by writing a material balance on the tubular reactor. In this case, it is a PFR:</p>
<div class="math notranslate nohighlight">
\[\frac{dF_A}{dV} = R_A\]</div>
<p>We have a single reaction with a coefficient of -1 on A, so <span class="math notranslate nohighlight">\(R_A = -r\)</span>.</p>
<div class="math notranslate nohighlight">
\[\frac{dF_A}{dV} = -r\]</div>
<p>As usual, we find that the derivative of molar flowrate with respect to volume would give us the reaction rate.  In this specific case of a differential reactor, we take advantage of the fact that the rate is constant with respect to reactor volume. Separating variables, we get:</p>
<div class="math notranslate nohighlight">
\[dF_A = -rdV\]</div>
<p>We want to integrate this from inlet to outlet of the PFR:</p>
<div class="math notranslate nohighlight">
\[\int_{F_{A,f}}^{F_A} dF_A = \int_0^V-rdV\]</div>
<p>Here, we take advantage of the fact that the rate is constant, so it is independent of volume:</p>
<div class="math notranslate nohighlight">
\[\int_{F_{A,f}}^{F_A} dF_A = -r\int_0^VdV\]</div>
<p>So this equation becomes easy to solve.  We find:</p>
<div class="math notranslate nohighlight">
\[F_{A} - F_{A,f} = -rV\]</div>
<p>Solving for <span class="math notranslate nohighlight">\(r\)</span>:</p>
<div class="math notranslate nohighlight">
\[r = \frac{F_{A,f} - F_A}{V}\]</div>
<p>In other words, if we take the difference between the feed and exit molar flowrate of A, and we divide it by the volume of the reactor, we get an exact value of the reaction rate at the relevant concentration, temperature, and pressure at the reactor inlet. Note that if fluid density is constant, which it almost certainly is in a differential tubular reactor, then the following is also true.</p>
<div class="math notranslate nohighlight">
\[r = \frac{C_{A,f} - C_A}{\tau}\]</div>
<p>For both of the above expressions, you should see that they are identical to CSTR balances.  This is correct – if we are operating a tubular reactor in such a way that the composition, temperature, and pressure are invariant across the reactor, then it is functioning exactly like a well-mixed flow reactor and the balance becomes a CSTR balance! We have a problem here, though, because as <span class="math notranslate nohighlight">\(X_A \rightarrow 0\)</span>, we know that <span class="math notranslate nohighlight">\(F_A \rightarrow F_{A,f}\)</span> and <span class="math notranslate nohighlight">\(C_F \rightarrow C_{A,f}\)</span>. This limits on our ability to measure precise concentrations and flowrates will create serious problems in rate estimates at the zero conversion limit. We encountered this already in <a class="reference external" href="https://jqbond.github.io/CEN587/Notebooks/587-N43.html">Notebook 43</a> when analyzing CSTR data obtained at very short values of <span class="math notranslate nohighlight">\(\tau\)</span>, where conversion was nearly 0%. As in the CSTR analysis, our solution here is to focus define rates in terms of product formation instead of in terms of reactant consumption.</p>
<section id="use-product-flowrates-to-estimate-rate">
<h4>Use Product Flowrates to estimate rate<a class="headerlink" href="#use-product-flowrates-to-estimate-rate" title="Link to this heading">#</a></h4>
<p>Usually, our precision in quantifying the molar flowrate of the reactant (species <span class="math notranslate nohighlight">\(A\)</span>) coming out of the differential reactor is, at best, <span class="math notranslate nohighlight">\(\pm 5\%\)</span>. That means the difference between the feed and exit flowrate of <span class="math notranslate nohighlight">\(A\)</span> is within our precision limits, and we get very noisy estimates of reaction rates if we try to quantify things this way. As we saw in <a class="reference external" href="https://jqbond.github.io/CEN587/Notebooks/587-N43.html">Notebook 43</a>, when reactors are operated such that reactant conversion approaches zero, the better approach is to use reaction product measurements to estimate the rate of reaction. We start by writing a balance on a product instead of on a reactant:</p>
<div class="math notranslate nohighlight">
\[\frac{dF_B}{dV} = R_B\]</div>
<p>For a single reaction where species <span class="math notranslate nohighlight">\(B\)</span> has a coefficient of 1:</p>
<div class="math notranslate nohighlight">
\[\frac{dF_B}{dV} = r\]</div>
<p>We’ll separate this ODE and integrate over the appropriate limits:</p>
<div class="math notranslate nohighlight">
\[\int_{F_{B,f}}^{F_B}dF_B = \int_0^VrdV\]</div>
<p>Again, we know that rate is not changing over the reactor volume, so r is a constant in this case.  This allows the following simplification:</p>
<div class="math notranslate nohighlight">
\[\int_{F_{B,f}}^{F_B}dF_B = r\int_0^VdV\]</div>
<p>Which makes the integration pretty straightforward.  We ultimately get:</p>
<div class="math notranslate nohighlight">
\[F_B - F_{B,f} = rV\]</div>
<p>We know that there is no species <span class="math notranslate nohighlight">\(B\)</span> coming into the reactor, so <span class="math notranslate nohighlight">\(F_{B,f} = 0\)</span>.  We then solve for r:</p>
<div class="math notranslate nohighlight">
\[r = \frac{F_B}{V}\]</div>
<p>Again, since fluid density is almost certainly constant in a differential flow reactor, we can write express the above in terms of concentration and space time.</p>
<div class="math notranslate nohighlight">
\[r = \frac{C_B}{\tau}\]</div>
<p>This is really a useful result, and we again see balances that are equivalent to the CSTR result!  It means that estimating the reaction rate just requires us to measure the flowrate of product coming out of the reactor and divide it by the reactor volume. That’s the approach we’ll use below. Importantly, when we base our rate estimates off of product formation, we do not have to worry about the issues that arise when we subtract two imprecise numbers that are nearly identical (e.g., <span class="math notranslate nohighlight">\(F_{A,f} - F_A\)</span>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################################</span>
<span class="c1"># Calculate reaction rates for each experiment using the differential reactor result         #</span>
<span class="c1">##############################################################################################</span>

<span class="n">r_exp</span> <span class="o">=</span> <span class="n">FB_exp</span><span class="o">/</span><span class="n">V</span> <span class="c1">#mol/L/min</span>

<span class="c1">##############################################################################################</span>
<span class="c1"># Plot reaction rates as a function of CA to assess reaction order in A                      #</span>
<span class="c1">##############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">CA_exp</span><span class="p">,</span> <span class="n">r_exp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;experimental data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;CA (mmol/L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;rate (mmol/L/min)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04e1abaf9eaebf7567267d665e02629f88b2d1677a16e2ece542d7404329574c.png" src="../_images/04e1abaf9eaebf7567267d665e02629f88b2d1677a16e2ece542d7404329574c.png" />
</div>
</div>
</section>
<section id="linearization-of-data">
<h4>Linearization of data<a class="headerlink" href="#linearization-of-data" title="Link to this heading">#</a></h4>
<p>Now we have estimates of the reaction rate for various values of feed concentration of <span class="math notranslate nohighlight">\(A\)</span>.  Since we are operating the reactor at very low conversion, we know that the concentration of <span class="math notranslate nohighlight">\(A\)</span> throughout the reactor is approximately equal to the feed concentration of <span class="math notranslate nohighlight">\(A\)</span>.  Thus, we have a set of rates at a representative set of concentrations of the reactant. Our aim is to determine the reaction order in <span class="math notranslate nohighlight">\(A\)</span> as well as the rate constant. We might propose that this reaction follows power law kinetics as usual:</p>
<div class="math notranslate nohighlight">
\[r = k \, {C_A}^\alpha\]</div>
<p>This can be linearized using a logarithmic transformation:</p>
<div class="math notranslate nohighlight">
\[\ln(r) = \ln(k) + \alpha \ln(C_A)\]</div>
<p>We then plot <span class="math notranslate nohighlight">\(\ln(r)\)</span> vs. <span class="math notranslate nohighlight">\(\ln(C_A)\)</span> to assess linearity and regress the slope, <span class="math notranslate nohighlight">\(\alpha\)</span>, and y-intercept, <span class="math notranslate nohighlight">\(\ln(k)\)</span>…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#############################################################################</span>
<span class="c1"># Attempt power law linearization of rate vs. CA data                       #</span>
<span class="c1">#############################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CA_exp</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r_exp</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;experimental data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ln(CA) (mmol/L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ln(rate) (mmol/L/min)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/32f62f2e522572a80583f7f2c82a534a0118e81a4e70a174f86ab8a7f704aed3.png" src="../_images/32f62f2e522572a80583f7f2c82a534a0118e81a4e70a174f86ab8a7f704aed3.png" />
</div>
</div>
</section>
<section id="linear-regression-to-estimate-alpha-and-k">
<h4>Linear Regression to estimate <span class="math notranslate nohighlight">\(\alpha\)</span> and k<a class="headerlink" href="#linear-regression-to-estimate-alpha-and-k" title="Link to this heading">#</a></h4>
<p>The log transformed data above doesn’t really look very linear, but let’s go ahead and regress the best fit line, estimate parameters, and calculate relevant statistics to provide a more quantitative assessment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#####################################################################################################</span>
<span class="c1"># Define the xdata array and ydata array                                                            #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r_exp</span><span class="p">)</span>
<span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CA_exp</span><span class="p">)</span>

<span class="c1">#####################################################################################################</span>
<span class="c1"># Define the X matrix and Y array                                                                   #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">Y</span>     <span class="o">=</span> <span class="n">ydata</span>
<span class="n">X</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#This creates the X matrix shown above, truncating at 1st order</span>

<span class="c1">#####################################################################################################</span>
<span class="c1"># Solve the least squares problem to find the best fit coefficients                                 #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">A</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@Y</span><span class="p">)</span> 

<span class="c1">#####################################################################################################</span>
<span class="c1"># Workup and analysis for quantifying and visualizing goodness of fit                               #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">Ypred</span>  <span class="o">=</span> <span class="n">X</span><span class="nd">@A</span>                          <span class="c1">#Calculate discrete array of predicted y values at each x value</span>
<span class="n">Ybar</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>               <span class="c1">#Calculate the mean of the measured y values, use for SST calculation</span>
<span class="n">Ndata</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>                   <span class="c1">#Calculate the number of data points/measurementws</span>
<span class="n">SSE1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ypred</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>       <span class="c1">#Calculate residual sum of squares using intuitive summation formula</span>
<span class="n">SSE2</span>   <span class="o">=</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">X</span><span class="nd">@A</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">@</span><span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">X</span><span class="nd">@A</span><span class="p">)</span>        <span class="c1">#Calculate residual sum of squares using matrix multiplication; equivalent to SSE1</span>
<span class="n">SST</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ybar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>        <span class="c1">#Calculate total sum of squares; assumes model is just y_pred = mean(ydata)</span>
<span class="n">MSE</span>    <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">Ndata</span>                   <span class="c1">#Calculate mean square error</span>
<span class="n">RMSE</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>                 <span class="c1">#Calculate root mean square error</span>
<span class="n">R2</span>     <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">SST</span>                 <span class="c1">#Calculate R2 (coefficient of determination)</span>
<span class="n">DOF</span>    <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>          <span class="c1">#Count degrees of freedom</span>
<span class="n">s2</span>     <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">DOF</span>                     <span class="c1">#Estimate variance</span>
<span class="n">COV</span>    <span class="o">=</span> <span class="n">s2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">)</span>      <span class="c1">#Generate the covariance matrix for this fit</span>
<span class="n">m</span>      <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                         <span class="c1">#This is a linear model; with the way we define the X matrix, slope is A[0], intercept is A[1]</span>
<span class="n">b</span>      <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                         <span class="c1">#This is a linear model; with the way we define the X matrix, slope is A[0], intercept is A[1] </span>
<span class="n">SEm</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>           <span class="c1">#For our definition of the X matrix, standard error in the slope is the first diagonal element in COV</span>
<span class="n">SEb</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>           <span class="c1">#For our definition of the X matrix, standard error in the intercept is the second diagonal element in COV</span>
<span class="n">tval</span>   <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">DOF</span><span class="p">)</span>      <span class="c1">#t distribution for 95% confidence interval t(1 - α/2, DOF), α = 0.05 for 95% confidence interval</span>
<span class="n">CIm</span>    <span class="o">=</span> <span class="n">SEm</span><span class="o">*</span><span class="n">tval</span>                     <span class="c1">#confidence interval on slope</span>
<span class="n">CIb</span>    <span class="o">=</span> <span class="n">SEb</span><span class="o">*</span><span class="n">tval</span>                     <span class="c1">#confidence interval on intercept</span>
<span class="n">α</span>      <span class="o">=</span> <span class="n">m</span>                            <span class="c1">#slope is equal to the reaction order</span>
<span class="n">k</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>                    <span class="c1">#y intercept is equal to ln(k)</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Printing results using f strings; create arrays of labels and values                     #</span>
<span class="c1">############################################################################################</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;SSE&#39;</span><span class="p">,</span> <span class="s1">&#39;SST&#39;</span><span class="p">,</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span><span class="s1">&#39;RMSE&#39;</span><span class="p">,</span> <span class="s1">&#39;R2&#39;</span><span class="p">,</span> <span class="s1">&#39;α&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span>  <span class="p">,</span>  <span class="n">b</span> <span class="p">,</span>  <span class="n">SSE1</span><span class="p">,</span>  <span class="n">SST</span> <span class="p">,</span> <span class="n">MSE</span> <span class="p">,</span> <span class="n">RMSE</span> <span class="p">,</span>  <span class="n">R2</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIm</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIb</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;α&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIm</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> (but is between </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">CIb</span><span class="p">)</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">CIb</span><span class="p">)</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Visualizing results; overlay data and regressed y(x)                                     #</span>
<span class="c1">############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;experimental rates&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">Ypred</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;linear fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">8.0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">18.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ln(CA) mol/L&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ln(r) mol/L/s&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Visualizing results; plot of residual errors                                             #</span>
<span class="c1">############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ypred</span><span class="p">)</span><span class="o">/</span><span class="n">Y</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;residual error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">floor</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])),</span> <span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;zero error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;% Residual Error in ln (r)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Plot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>m    =  1.50e+00 +/- 1.23e-01
b    = -5.23e+00 +/- 4.59e-01
SSE  =      9.28
SST  =    463.79
MSE  =      0.58
RMSE =      0.76
R2   =      0.98
α    =  1.50e+00 +/- 1.23e-01
k    =  5.33e-03 (but is between 3.37e-03 and 8.44e-03)
</pre></div>
</div>
<img alt="../_images/fed30d30921887f8a5e704819ed4d0ad35a91dbb5f0a0f5d13b22ccd8d37bb99.png" src="../_images/fed30d30921887f8a5e704819ed4d0ad35a91dbb5f0a0f5d13b22ccd8d37bb99.png" />
<img alt="../_images/c64674f02df1d46c4d3caf1f3d077205005d992d77588787804f2beb64704c9c.png" src="../_images/c64674f02df1d46c4d3caf1f3d077205005d992d77588787804f2beb64704c9c.png" />
</div>
</div>
</section>
<section id="a-closer-look">
<h4>A closer look<a class="headerlink" href="#a-closer-look" title="Link to this heading">#</a></h4>
<p>OK, there are some problems here.  While the R2 value isn’t bad, we see clear systematic deviation instead of data points scattered randomly around the line of best fit.  This suggests that our power law model is not correct.  Furthermore, we get a “best fit” reaction order of 1.5, which is a bit strange.  Let’s take a closer look!</p>
<p>If you focus only on data obtained at low concentration, we see linearity. Similarly, at very high concentrations, we see linearity again.  This suggests power law kinetics hold at very low and very high concentrations of <span class="math notranslate nohighlight">\(A\)</span>, it’s just that the value of the reaction order, <span class="math notranslate nohighlight">\(\alpha\)</span>, is different in each concentration regime. We will fit a line to the 4 lowest concentration measurements and the 4 highest concentration measurements to assess reaction orders in each limit. These regressed lines are added to the plot of experimental data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r_exp</span><span class="p">)</span>
<span class="n">X</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CA_exp</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">Alow</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,:],</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span><span class="nd">@Y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="c1">#regression coefficients, slope and intercept</span>
<span class="n">Ahigh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:,:]</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:,:],</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:,:]</span><span class="o">.</span><span class="n">T</span><span class="nd">@Y</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span> <span class="c1">#regression coefficients, slope and intercept</span>
<span class="n">Yplow</span> <span class="o">=</span> <span class="n">X</span><span class="nd">@Alow</span>
<span class="n">Yphigh</span> <span class="o">=</span> <span class="n">X</span><span class="nd">@Ahigh</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The regressed order at low CA is </span><span class="si">{</span><span class="n">Alow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The regressed order at high CA is </span><span class="si">{</span><span class="n">Ahigh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Y</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;experimental rates&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CA_exp</span><span class="p">),</span> <span class="n">Yplow</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;second order kinetics&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CA_exp</span><span class="p">),</span> <span class="n">Yphigh</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;first order kinetics&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ln(CA) mmol/L&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ln(r) mmol/L/min&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The regressed order at low CA is 2.095
The regressed order at high CA is 0.966
</pre></div>
</div>
<img alt="../_images/1dddd3a5382f5b4e1265510f916ea0f9e50885a00e0177324f7c55f715ad806f.png" src="../_images/1dddd3a5382f5b4e1265510f916ea0f9e50885a00e0177324f7c55f715ad806f.png" />
</div>
</div>
<p>This confirms that we see different reaction orders in different concentration regimes – this means that the the observed reaction order changes depending on where we measure the reaction rate. If we make measurements at very low concentrations of <span class="math notranslate nohighlight">\(A\)</span>, the rate is second order in <span class="math notranslate nohighlight">\(A\)</span>.  If we make measurements at very high concentrations of <span class="math notranslate nohighlight">\(A\)</span>, the rate is first order in <span class="math notranslate nohighlight">\(A\)</span>. The reason for this is that Azomethane decomposition (and almost every other reaction we might study in the lab) is an <em><strong>overall</strong></em> reaction. The balanced equation for azomethane decomposition describes the stoichiometric changes between observable reactants and products, but it does not describe the bond breaking and bond forming events that comprise the chemical transformations. In other words, azomethane decomposition as written above is not an elementary step.</p>
</section>
</section>
</section>
<section id="reaction-mechanisms">
<h2>Reaction Mechanisms<a class="headerlink" href="#reaction-mechanisms" title="Link to this heading">#</a></h2>
<p>The basic concept to understand is that overall reactions reflect the stoichiometric changes that we see at the macroscopic scale in laboratories and industrial reactors. In reality, chemistry doesn’t happen as it is written in the overall reaction. At the molecular level, chemical transformations occur through a series of <em><strong>elementary steps,</strong></em> which are reactions that occur exactly as written. They typically reflect either the scission or formation of a single bond. In some cases, they might involve formation and/or scission of two bonds. Rarely do they involve more complex events than this.</p>
<p>Every elementary step has a characteristic standard state change in Enthalpy <span class="math notranslate nohighlight">\((\Delta H^\circ)\)</span>, Entropy <span class="math notranslate nohighlight">\((\Delta S^\circ)\)</span>, and Gibbs Free Energy <span class="math notranslate nohighlight">\((\Delta G^\circ)\)</span>. These describe the formation of products of the step from the reactants of the step, and it determines how <em><strong>thermodynamically favorable</strong></em> that elementary step is. We use these standard state enthalpy, entropy, and free energy transitions to calculate the <em><strong>equilibrium constant</strong></em> for the elementary step. Every elementary step also has a characteristic standard state Enthalpy <span class="math notranslate nohighlight">\((\Delta H^\ddagger)\)</span>, Entropy <span class="math notranslate nohighlight">\((\Delta S^\ddagger)\)</span>, and Gibbs Free Energy <span class="math notranslate nohighlight">\((\Delta G^\ddagger)\)</span> of activation. These quantities describe the formation of a transition state from the reactants participating in the elementary step, and they determine how <em><strong>kinetically favorable</strong></em> a reaction is. We use these enthalpy, entropy, and free energy transitions to calculate the <em><strong>rate constant</strong></em> for that elementary step. Generally, thermodynamics determine <em><strong>how far</strong></em> a reaction will go, and kinetics determine <em><strong>how fast</strong></em> a reaction will occur.</p>
<p>We’ve already been introduced to these concepts, it’s just that, for a reaction mechanism, we will chain together multiple elementary steps, each with their own rate and equilibrium constant, in order to make up the overall, observable reaction.</p>
<section id="azomethane-decomposition-a-possible-mechanism">
<h3>Azomethane Decomposition: A Possible Mechanism<a class="headerlink" href="#azomethane-decomposition-a-possible-mechanism" title="Link to this heading">#</a></h3>
<p>When scientists originally observed that unimolecular reactions like Azomethane decomposition were second order at low concentrations and first order at high concentrations, they considered phenomena that would lead to this observation.  An early concept was proposed by Lindemann and Christensen. In simple terms, their idea was that azomethane (or a molecule like it) cannot undergo decomposition until it is “activated” by some energetic collision with a second azomethane molecule. This collision would place the azomethane into an excited state that is unstable and could do one of two things. First, it could dissipate this energy and return reversibly to its ground state without decomposing. Second, it could decompose.</p>
<p>We can translate this conceptual description of the possible molecular events underlying azomethane decomposition into a pair of elementary steps. To start, we will assume that all elementary steps are reversible because, in principle, they all are. If we can convert reactants into products by passing through a high energy transition state, then we have to be able to traverse the same energetic pathway in reverse going from products, through the same transition state, and back to reactants. These are the concepts of <em><strong>microscopic reversibility</strong></em> and <em><strong>detailed balance</strong></em>. Each elementary step, <span class="math notranslate nohighlight">\(i\)</span>, has a forward rate constant, <span class="math notranslate nohighlight">\(k_{i}\)</span>, a reverse rate constant, <span class="math notranslate nohighlight">\(k_{-i}\)</span>, and an equilibrium constant, <span class="math notranslate nohighlight">\(K_i\)</span>. We may recall that for an elementary step, or for a step with elementary kinetics, the following is also true:</p>
<div class="math notranslate nohighlight">
\[K_{C,i} = \frac{k_{i}}{k_{-i}}\]</div>
<p>With this in mind, we propose the following set of elementary steps as the mechanism of Azomethane decomposition.</p>
<div class="amsmath math notranslate nohighlight" id="equation-eaff79cd-7f0b-4554-bc12-fca8af8556d1">
<span class="eqno">(2)<a class="headerlink" href="#equation-eaff79cd-7f0b-4554-bc12-fca8af8556d1" title="Permalink to this equation">#</a></span>\[\begin{align}
    &amp;(1) \qquad A + A \rightleftharpoons A^* + A\\
    &amp;(2) \qquad A^* \rightleftharpoons B + C\\
\end{align}\]</div>
<p>Another requirement of a reaction mechanism is that we have to be able to reproduce overall stoichiometry through a linear combination of elementary steps.  For example, in the above mechanism, if we add step (1) and step (2) together, we get:</p>
<div class="math notranslate nohighlight">
\[A \rightleftharpoons B + C\]</div>
<p>Which is the overall stoichiometry of azomethane decomposition.</p>
<p>We will now make a simplifying assumption that is based on our insight into a decomposition reaction. These are generally thermodynamically very favorable (<span class="math notranslate nohighlight">\(\Delta G &lt; -100\)</span> kJ/mol); as such, the equilibrium constant for the decomposition step and thus the overall reaction is very large, and we can assume both the second elementary step and the overall reaction are irreversible.  For justification as to why we classify the first step (collision of two azomethane molecules) to be reversible, consider that the free energy difference between the reactant state and the excited state produced by a collision is very small, so we expect that the product can feasibly (from a free energy perspective) convert back to the reactant. We will update the steps accordingly.</p>
<p><strong>Mechanism</strong></p>
<div class="amsmath math notranslate nohighlight" id="equation-6d739e55-fb4d-4c18-b520-50cbfac9297f">
<span class="eqno">(3)<a class="headerlink" href="#equation-6d739e55-fb4d-4c18-b520-50cbfac9297f" title="Permalink to this equation">#</a></span>\[\begin{align}
    &amp;(1) \qquad A + A \rightleftharpoons A^* + A\\
    &amp;(2) \qquad A^* \longrightarrow B + C\\
\end{align}\]</div>
<p><strong>Overall</strong></p>
<div class="math notranslate nohighlight">
\[A \longrightarrow B + C\]</div>
</section>
<section id="is-the-mechanism-consistent-with-our-observations">
<h3>Is the mechanism consistent with our observations?<a class="headerlink" href="#is-the-mechanism-consistent-with-our-observations" title="Link to this heading">#</a></h3>
<p>The next requirement of a mechanism is that it has to qualitatively agree with what we observe in the laboratory. In this case, this mechanism has to predict that the overall rate of reaction is 2nd order in A at low concentrations and first order in A at high concentrations.  If it does not, then it is either incorrect or at the very least an incomplete description of the chemistry. It is not immediately clear how that mechanism will give us the overall reaction rate. Considering the overall reaction rate, we see that, in the laboratory, a few things must be true:</p>
<div class="amsmath math notranslate nohighlight" id="equation-658cd7d1-5489-4bed-9994-6a333256bf4e">
<span class="eqno">(4)<a class="headerlink" href="#equation-658cd7d1-5489-4bed-9994-6a333256bf4e" title="Permalink to this equation">#</a></span>\[\begin{align}
    r &amp;= -R_A \\
    r &amp;= R_B \\
    r &amp;= R_C \\
\end{align}\]</div>
<p>We can go to our mechanism to write any of those net production rates by considering the formation/consumption of each species through the elementary steps that comprise the mechanism. So, for example:</p>
<div class="amsmath math notranslate nohighlight" id="equation-772646ec-b1c2-4f6c-bc48-e222d72b69da">
<span class="eqno">(5)<a class="headerlink" href="#equation-772646ec-b1c2-4f6c-bc48-e222d72b69da" title="Permalink to this equation">#</a></span>\[\begin{align}
    R_A &amp;= -r_1 \\
    R_B &amp;=  r_2  \\
    R_C &amp;=  r_2  \\
\end{align}\]</div>
<p>So, looking at that, we can make the following relationships between our overall rate and the rate of each elementary step:</p>
<div class="amsmath math notranslate nohighlight" id="equation-e58f2a4f-048f-4b87-bc1d-314460a23c1a">
<span class="eqno">(6)<a class="headerlink" href="#equation-e58f2a4f-048f-4b87-bc1d-314460a23c1a" title="Permalink to this equation">#</a></span>\[\begin{align}
    r &amp;= r_1 \\
    r &amp;= r_2
\end{align}\]</div>
<p>I can pick either one and work through the derivation. Eventually, they will lead to the same place. That said, <em><strong>the best practice is</strong></em>, when possible, to start your analysis with the step where the product is formed, especially if it is an irreversible step. This usually results in a slightly less cumbersome starting equation. With that established, let’s say:</p>
<div class="math notranslate nohighlight">
\[r = r_2\]</div>
<p>This expression tells us that the net rate of reaction <em><strong>must be</strong></em> equal to the rate of the 2nd elementary step, which makes sense because it is the only step where our product, <span class="math notranslate nohighlight">\(B\)</span>, is formed. Now, let’s write out the rate expression for that step. Since it is an elementary step, we can write it by inspection:</p>
<div class="math notranslate nohighlight">
\[r = r_2 = k_{2}{C_{A^*}}\]</div>
<p>Now we run into a problem – this is not a convenient rate expression because it is written in terms of an activated, probably very reactive intermediate. It is generally going to be very hard for us to observe this species in the reaction mixture, and we certainly can’t control it, quantify it with lab instruments, or purchase it from a supplier. It forms in situ and it is present for short times and only in trace, usually unmeasurable, quantities. We would much rather have this rate expression written in terms of concentrations of stable species, namely <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, and/or <span class="math notranslate nohighlight">\(C\)</span>. The simple reason is that we can measure, control, quantify, etc. the concentrations of these macroscopically observable species, so it is much more useful in reactor design to have a rate expression defined in terms of them. We can accomplish this by <em><strong>expressing</strong></em> the concentration of the high energy species, <span class="math notranslate nohighlight">\(C_{A^*}\)</span>, in terms of the stable species <span class="math notranslate nohighlight">\(C_A\)</span>, <span class="math notranslate nohighlight">\(C_B\)</span>, and/or <span class="math notranslate nohighlight">\(C_C\)</span>. There are many ways we can approach this; all of them will generally involve some approximation about that species and the rate of its formation and consumption. For this analysis, we will invoke the Pseudo Steady State Approximation (PSSA)</p>
</section>
<section id="the-pseudo-steady-state-hypothesis">
<h3>The Pseudo Steady State Hypothesis<a class="headerlink" href="#the-pseudo-steady-state-hypothesis" title="Link to this heading">#</a></h3>
<p>For homogeneous reactions, we frequently will assume that high energy intermediates (things like radicals, ions, high energy states, etc.) satisfy two requirements:</p>
<ol class="arabic simple">
<li><p>Their formation is usually challenging (thermodynamically and kinetically), so they form slowly and are generally present in small quantities.</p></li>
<li><p>They are reactive, so they tend to be consumed quickly.</p></li>
</ol>
<p>When these requirements are met, we generally consider that this species effectively reacts as soon as it forms, so its concentration in the system is not changing appreciably. In other words, its net production rate is zero.  This is generally called the <strong>Pseudo Steady State Hypothesis</strong> or various forms of that (Pseudo Steady State Assumption, Pseudo Steady State Approximation, Quasi Steady State Approximation, Quasi Steady State Assumption, Quasi Steady State Hypothesis).</p>
<p>We first write the production rate for the high energy intermediate <span class="math notranslate nohighlight">\(A^*\)</span>:</p>
<div class="math notranslate nohighlight">
\[R_{A^*} = r_1 - r_2\]</div>
<p>Then we apply the PSSH by setting the net production rate to zero:</p>
<div class="math notranslate nohighlight">
\[0 = r_1 - r_2\]</div>
<p>(Note that this leads to the conclusion that <span class="math notranslate nohighlight">\(r_1 = r_2\)</span>, but we’ll work with the above form here)</p>
<p>We can now substitute rate expressions into the PSSH equation:</p>
<div class="math notranslate nohighlight">
\[0 = k_1{C_A}^2 - k_{-1}C_{A^*}C_A - k_2C_{A^*}\]</div>
<p>The beauty and utility of this approximation now become clear: we have an equation written in one “unknown”, <span class="math notranslate nohighlight">\(C_{A^*}\)</span>. This means that we can solve the above to develop an expression for <span class="math notranslate nohighlight">\(C_{A^*}\)</span> as a function of <span class="math notranslate nohighlight">\(C_A\)</span> and various rate constants. Doing so, we get:</p>
<div class="math notranslate nohighlight">
\[C_{A^*} = \frac{k_1 {C_A}^2}{k_2 + k_{-1}C_A}\]</div>
<p>Now we can substitute this expression back into the rate expression for step 2 (which is equal to the rate of product formation and thus the overall rate of reaction):</p>
<div class="math notranslate nohighlight">
\[r = \frac{k_1 k_2 {C_A}^2}{k_2 + k_{-1}C_A}\]</div>
<p>We can simplify this just a little. It is common convention to factor and cancel terms such that the first term in the denominator polynomial is 1.</p>
<div class="math notranslate nohighlight">
\[r = \frac{k_1 {C_A}^2}{1 + K^\prime C_A}\]</div>
<p>Where we define <span class="math notranslate nohighlight">\(K^\prime = k_{-1}/k_2\)</span></p>
</section>
<section id="reconciliation-with-observed-trends">
<h3>Reconciliation with Observed trends<a class="headerlink" href="#reconciliation-with-observed-trends" title="Link to this heading">#</a></h3>
<p>Now we have an overall rate expression written only in terms of <span class="math notranslate nohighlight">\(C_A\)</span> and various kinetic and/or thermodynamic parameters.</p>
<div class="math notranslate nohighlight">
\[r = \frac{k_1 {C_A}^2}{1 + K^\prime C_A}\]</div>
<p>Before we go further, let’s make sure that this expression at least <em><strong>can</strong></em> predict the behaviors that we observe in the reactor. We know that this reaction appears 2nd order in aomethane <span class="math notranslate nohighlight">\((A)\)</span> at low concentrations and first order in <span class="math notranslate nohighlight">\(A\)</span> at high concentrations. We can determine if the rate expression can predict this with an analysis of limiting behavior. First, let’s consider the limit as <span class="math notranslate nohighlight">\(C_A \rightarrow 0\)</span>.</p>
<section id="low-concentration-limit">
<h4>Low concentration limit<a class="headerlink" href="#low-concentration-limit" title="Link to this heading">#</a></h4>
<p>In this case, the overall rate clearly approaches zero, but that’s not what we’re interested in. We’re interested in how the rate responds to changes in the concentration of <span class="math notranslate nohighlight">\(A\)</span> at low concentrations. So we look at dominant terms in the numerator and denominator as <span class="math notranslate nohighlight">\(C_A \rightarrow 0\)</span>. In this regime, the dominant term in the numerator is <span class="math notranslate nohighlight">\(kC_A^2\)</span>.  In other words, the numerator has a second order dependence on <span class="math notranslate nohighlight">\(C_A\)</span> in the limit of low concentration. If we look at the denominator, we see that, as <span class="math notranslate nohighlight">\(C_A \rightarrow 0\)</span>, then <span class="math notranslate nohighlight">\(1 &gt;&gt; K^\prime C_A\)</span>.  Accordingly, the dominant term in the denominator is 1.</p>
<p>With these behaviors established, we conclude that at low concentrations, the rate of reaction should look like this:</p>
<div class="math notranslate nohighlight">
\[r = \frac{k_1 {C_A}^2}{1} = k_1 {C_A}^2\]</div>
<p>In other words, the rate of reaction is second order in <span class="math notranslate nohighlight">\(A\)</span> at low concentrations, just as observed in experiments.</p>
</section>
<section id="high-concentration-limit">
<h4>High concentration limit<a class="headerlink" href="#high-concentration-limit" title="Link to this heading">#</a></h4>
<p>Now, we’ll let <span class="math notranslate nohighlight">\(C_A \rightarrow \infty\)</span> and repeat analysis of dominant terms in the numerator and denominator. The dominant term in the numerator is again <span class="math notranslate nohighlight">\(k_1C_A^2\)</span>, so the numerator still has a second order dependence on the concentration of <span class="math notranslate nohighlight">\(A\)</span>. Looking at the denominator, as <span class="math notranslate nohighlight">\(C_A \rightarrow \infty\)</span>, then <span class="math notranslate nohighlight">\(1 &lt;&lt; K^\prime C_A\)</span>. So the second term is dominant, and our rate expression becomes:</p>
<div class="math notranslate nohighlight">
\[r = \frac{k_1 {C_A}^2}{K^\prime C_A} = \frac{k_1}{K^\prime} {C_A}\]</div>
<p>That is, at high concentrations of <span class="math notranslate nohighlight">\(A\)</span>, the reaction is first order in A, just as observed in laboratory.</p>
</section>
<section id="conclusion">
<h4>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h4>
<p>Based on this analysis, we can conclude that this mechanism is consistent with our observations in the laboratory.  We can’t prove it, of course, but we can say that it captures our observations and so is at least plausible. We can then proceed to trying to estimate the values of our two parameters, <span class="math notranslate nohighlight">\(k_1\)</span> and <span class="math notranslate nohighlight">\(K^\prime\)</span> based on analysis of our data. We can do this in a few ways. The most obvious and straightforward is to use nonlinear regression. That is, we minimize the residual sum of squares by iteratively varying the values of the two parameters. This is implemented in the cell below. Notice that the residual error here is defined as a percentage instead of an absolute error. This is because the rates we have measured vary over orders of magnitude, and absolute errors for numbers like <span class="math notranslate nohighlight">\(10^{-8}\)</span> are natrually small compared to those for numbers like 1 or 10. When we have this difference of scales in data, naive least squares will bias the fit toward large measurements and often fail to describe small measurements. Percent error is scaled, so it forces regression to assign similar weight to large and small measurements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1"># Define a model that calculates reaction rate given (k1, K&#39;, and CA)        #</span>
<span class="c1">##############################################################################</span>

<span class="k">def</span><span class="w"> </span><span class="nf">r_model</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">Kprime</span><span class="p">,</span> <span class="n">CA</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">k1</span><span class="o">*</span><span class="n">CA</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Kprime</span><span class="o">*</span><span class="n">CA</span><span class="p">)</span>

<span class="c1">##############################################################################</span>
<span class="c1"># Define objective function; it should be of form f([k1, K&#39;])                #</span>
<span class="c1"># It should calculate SSE and return it                                      #</span>
<span class="c1">##############################################################################</span>

<span class="k">def</span><span class="w"> </span><span class="nf">OBJ</span><span class="p">(</span><span class="n">par</span><span class="p">):</span>
    <span class="c1">#parameter values</span>
    <span class="n">k1</span><span class="p">,</span> <span class="n">Kprime</span> <span class="o">=</span> <span class="n">par</span>
    
    <span class="c1">#model prediction</span>
    <span class="n">r_mod</span> <span class="o">=</span> <span class="n">r_model</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">Kprime</span><span class="p">,</span> <span class="n">CA_exp</span><span class="p">)</span>
    
    <span class="c1">#SSE</span>
    <span class="c1"># SSE = np.sum(((r_exp - r_mod))**2)</span>
    <span class="n">SSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">r_exp</span> <span class="o">-</span> <span class="n">r_mod</span><span class="p">)</span><span class="o">/</span><span class="n">r_exp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">SSE</span>

<span class="c1">#################################################################################</span>
<span class="c1"># Define initial guesses for parameter values; run optimization                 #</span>
<span class="c1">#################################################################################</span>

<span class="n">par0</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">ansNL</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">OBJ</span><span class="p">,</span> <span class="n">par0</span><span class="p">)</span><span class="c1">#, method = &#39;Nelder-Mead&#39;,tol = 1e-6, options = {&#39;maxiter&#39;: 5000})</span>

<span class="c1">#################################################################################</span>
<span class="c1"># Check convergence, bind results to variable names, print as needed                               #</span>
<span class="c1">#################################################################################</span>

<span class="n">k1_opt</span> <span class="o">=</span> <span class="n">ansNL</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Kprime_opt</span> <span class="o">=</span> <span class="n">ansNL</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Did the optimization succeeed? </span><span class="si">{</span><span class="n">ansNL</span><span class="o">.</span><span class="n">success</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The convergence message is: </span><span class="si">{</span><span class="n">ansNL</span><span class="o">.</span><span class="n">message</span><span class="si">:</span><span class="s1">s</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The regressed k1 is </span><span class="si">{</span><span class="n">k1_opt</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1"> L/mmol/min&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The regressed Kprime </span><span class="si">{</span><span class="n">Kprime_opt</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1"> L/mmol&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The residual sum of squares is SSE = </span><span class="si">{</span><span class="n">ansNL</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Did the optimization succeeed? False
The convergence message is: Desired error not necessarily achieved due to precision loss.
The regressed k1 is 0.049 L/mmol/min
The regressed Kprime 3.101 L/mmol
The residual sum of squares is SSE = 0.203
</pre></div>
</div>
</div>
</div>
<p>It is always a good idea to plot your optimal fit against your data to visually inspect the trend. Note the magnitude of errors associated with small and large reaction rates.  In this case, the optimized parameter values do a reasonable job of capturing the trend in data. The convergence error is associated with failure to reach a tolerance on the objective function value (how close is it to zero?) or the parameter values (how much are they changing on each iteration). We can address this by (1) changing the optimization method (e.g., Nelder-Mead), (2) adjusting tolerances, and/or (3) increasing iterations. In this case, it does not significantly impact the parameter estimates, but it does allow the optimization routine to converge to specified tolerances, which may be important depending on the script that you’re developing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##################################################################################</span>
<span class="c1"># Calculate model predictions at the optimal parameter set                       #</span>
<span class="c1">##################################################################################</span>

<span class="n">r_mod</span> <span class="o">=</span> <span class="n">r_model</span><span class="p">(</span><span class="n">k1_opt</span><span class="p">,</span> <span class="n">Kprime_opt</span><span class="p">,</span> <span class="n">CA_exp</span><span class="p">)</span>

<span class="c1">##################################################################################</span>
<span class="c1"># Overlay optimal data fit with experimental data                                #</span>
<span class="c1">##################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="c1"># plt.plot(CA_exp, r_exp, marker = &#39;o&#39;, markeredgecolor = &#39;black&#39;, markerfacecolor = &#39;none&#39;, linestyle = &#39;none&#39;, label = &#39;Experimental Data&#39;)</span>
<span class="c1"># plt.plot(CA_exp, r_mod, color = &#39;blue&#39;, linestyle = &#39;dashed&#39;, linewidth = 1, label = &#39;Lindemann-Christensen Mechanism&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">CA_exp</span><span class="p">,</span> <span class="n">r_exp</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Experimental Data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">CA_exp</span><span class="p">,</span> <span class="n">r_mod</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Lindemann-Christensen Mechanism&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;CA (mmol/L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;r mmol/L/min&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">##################################################################################</span>
<span class="c1"># Next line optionally prints out various residuals; illustrate large vs. small  #</span>
<span class="c1">##################################################################################</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">r_exp</span><span class="p">,</span> <span class="n">r_mod</span><span class="p">,</span> <span class="p">(</span><span class="n">r_exp</span> <span class="o">-</span> <span class="n">r_mod</span><span class="p">),</span> <span class="p">(</span><span class="n">r_exp</span> <span class="o">-</span> <span class="n">r_mod</span><span class="p">)</span><span class="o">/</span><span class="n">r_exp</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7ce1bf7ac2f8aa9a887eaca0c165d7676a4c85c11091387ccae0a3928121e6ec.png" src="../_images/7ce1bf7ac2f8aa9a887eaca0c165d7676a4c85c11091387ccae0a3928121e6ec.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 4.02000000e-08  4.84927224e-08 -8.29272242e-09 -2.06286627e-01]
 [ 2.18000000e-07  1.93373018e-07  2.46269817e-08  1.12967806e-01]
 [ 1.19600000e-06  1.19750822e-06 -1.50821896e-09 -1.26105264e-03]
 [ 5.06000000e-06  4.71798839e-06  3.42011605e-07  6.75912264e-02]
 [ 1.95000000e-05  1.83208443e-05  1.17915568e-06  6.04695219e-02]
 [ 1.16800000e-04  1.05281786e-04  1.15182143e-05  9.86148483e-02]
 [ 3.64000000e-04  3.71282036e-04 -7.28203642e-06 -2.00055946e-02]
 [ 1.37800000e-03  1.20085816e-03  1.77141838e-04  1.28549955e-01]
 [ 4.06000000e-03  4.76763120e-03 -7.07631197e-04 -1.74293398e-01]
 [ 1.04600000e-02  1.18601465e-02 -1.40014646e-03 -1.33857214e-01]
 [ 3.20000000e-02  2.70135041e-02  4.98649592e-03  1.55827997e-01]
 [ 7.50000000e-02  7.36706031e-02  1.32939687e-03  1.77252916e-02]
 [ 1.68000000e-01  1.51943616e-01  1.60563840e-02  9.55737143e-02]
 [ 2.98000000e-01  3.08708707e-01 -1.07087072e-02 -3.59352592e-02]
 [ 9.04000000e-01  7.79189340e-01  1.24810660e-01  1.38064890e-01]
 [ 1.42000000e+00  1.56338730e+00 -1.43387300e-01 -1.00976972e-01]]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="587-N45.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Nonlinear Regression</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-01">Example Problem 01</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-01">Solution to Example Problem 01</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#use-product-flowrates-to-estimate-rate">Use Product Flowrates to estimate rate</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linearization-of-data">Linearization of data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression-to-estimate-alpha-and-k">Linear Regression to estimate <span class="math notranslate nohighlight">\(\alpha\)</span> and k</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-closer-look">A closer look</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reaction-mechanisms">Reaction Mechanisms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#azomethane-decomposition-a-possible-mechanism">Azomethane Decomposition: A Possible Mechanism</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#is-the-mechanism-consistent-with-our-observations">Is the mechanism consistent with our observations?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pseudo-steady-state-hypothesis">The Pseudo Steady State Hypothesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reconciliation-with-observed-trends">Reconciliation with Observed trends</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#low-concentration-limit">Low concentration limit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#high-concentration-limit">High concentration limit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jesse Q. Bond, Syracuse University
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>