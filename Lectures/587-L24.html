
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Material Balances XV &#8212; Kinetics and Reaction Engineering</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Material Balances XVI" href="587-L25.html" />
    <link rel="prev" title="Material Balances XIV" href="587-L23.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/JQB.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Kinetics and Reaction Engineering</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Chapter1.html">
   Python Supplements
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S01.html">
     The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S02.html">
     Data Structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S03.html">
     Arrays and Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S04.html">
     For Loops and Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S05.html">
     Logical Tests and Comparisons
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S06.html">
     While Loops in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S07.html">
     Functions, D&amp;D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S08.html">
     The Fall of Acererak
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S09.html">
     Root Finding: Univariate Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S10.html">
     Minimizing a Univariate Function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S11.html">
     Minimizing Multivariate Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S12.html">
     Systems of Nonlinear Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S13.html">
     Least Squares Revisited
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S14.html">
     ODE Solvers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S15.html">
     Quadrature
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../Chapter2.html">
   Lectures
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="587-L01.html">
     Introduction and Stoichiometry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L02.html">
     Extent and Conversion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L03.html">
     Algebraic and Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L04.html">
     Chemical Equilibrium I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L05.html">
     Chemical Equilibrium II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L06.html">
     Chemical Equilibrium III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L07.html">
     Chemical Equilibrium IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L08.html">
     Chemical Equilibrium V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L09.html">
     Chemical and Phase Equilibria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L10.html">
     Material Balances I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L11.html">
     Material Balances II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L12.html">
     Material Balances III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L13.html">
     Material Balances IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L14.html">
     Material Balances V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L15.html">
     Material Balances VI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L16.html">
     Material Balances VII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L17.html">
     Material Balances VIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L18.html">
     Material Balances IX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L19.html">
     Material Balances X
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L20.html">
     Material Balances XI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L21.html">
     Material Balances XII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L22.html">
     Material Balances XIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L23.html">
     Material Balances XIV
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Material Balances XV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L25.html">
     Material Balances XVI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L26.html">
     Material Balances XVII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L27.html">
     Material Balances XVIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L28.html">
     Kinetics I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L29.html">
     Kinetics II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L30.html">
     Kinetics III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L31.html">
     Kinetics IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L32.html">
     Kinetics V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L33.html">
     Kinetics VI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L34.html">
     Kinetics VII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L35.html">
     Kinetics VIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L36.html">
     Kinetics IX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L37.html">
     Kinetics X
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L38.html">
     Kinetics XI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L39.html">
     Energy Balances I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L40.html">
     Energy Balances II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L41.html">
     Energy Balances III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L42.html">
     Energy Balances IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L43.html">
     Energy Balances VI
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Chapter3.html">
   Recitations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R01.html">
     Jupyter and Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R02.html">
     Solving Algebraic Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R03.html">
     Chemical Equilibrium
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R04.html">
     Solving ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R05.html">
     Chemical/Phase Equilibria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R06.html">
     CSTRs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R07.html">
     Python tips and tricks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R08.html">
     Optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R09.html">
     Reactors with Recycle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R10.html">
     Interpolation and Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R11.html">
     Nonlinear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R12.html">
     Parameter Estimation I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R13.html">
     Parameter Estimation II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R14.html">
     Energy Balances
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/jqbond/2022CEN587/main?urlpath=tree/Lectures/587-L24.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/jqbond/2022CEN587"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/jqbond/2022CEN587/issues/new?title=Issue%20on%20page%20%2FLectures/587-L24.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Lectures/587-L24.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-01">
   Example Problem 01
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-01">
     Solution to Example Problem 01
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#material-balance-on-a">
       Material Balance on A:
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-b">
       Balance on B
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-c">
       Balance on C
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#defining-conversion-selectivities-and-yields">
       Defining Conversion, Selectivities, and Yields
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#conversion">
       Conversion
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#yields">
       Yields
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#selectivities">
       Selectivities
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maximizing-the-yield-of-b">
       Maximizing the Yield of B
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-02">
   Example Problem 02
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-02">
     Solution to Example Problem 02
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Conversion
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Selectivities
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Yields
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#optimizing-yields-and-selectivities">
       Optimizing Yields and Selectivities
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Material Balances XV</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-01">
   Example Problem 01
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-01">
     Solution to Example Problem 01
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#material-balance-on-a">
       Material Balance on A:
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-b">
       Balance on B
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-c">
       Balance on C
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#defining-conversion-selectivities-and-yields">
       Defining Conversion, Selectivities, and Yields
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#conversion">
       Conversion
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#yields">
       Yields
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#selectivities">
       Selectivities
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maximizing-the-yield-of-b">
       Maximizing the Yield of B
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-02">
   Example Problem 02
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-02">
     Solution to Example Problem 02
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Conversion
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Selectivities
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Yields
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#optimizing-yields-and-selectivities">
       Optimizing Yields and Selectivities
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="material-balances-xv">
<h1>Material Balances XV<a class="headerlink" href="#material-balances-xv" title="Permalink to this headline">#</a></h1>
<p>This lecture continues with a discussion of yield, selectivity, and optimization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
</pre></div>
</div>
</div>
</div>
<section id="example-problem-01">
<h2>Example Problem 01<a class="headerlink" href="#example-problem-01" title="Permalink to this headline">#</a></h2>
<p><strong>This is a slightly modified version of Example 8.4 from Fogler</strong></p>
<p>The following pair of liquid-phase reactions occur in series. Each reaction is first order in its reactant.</p>
<div class="amsmath math notranslate nohighlight" id="equation-81ba78fc-50fc-4116-92de-81cdcdbd2e25">
<span class="eqno">(129)<a class="headerlink" href="#equation-81ba78fc-50fc-4116-92de-81cdcdbd2e25" title="Permalink to this equation">#</a></span>\[\begin{align}
    A &amp;\longrightarrow B\\
    B &amp;\longrightarrow C \\
\end{align}\]</div>
<p>By “series” or “sequential” reactions we mean that a product of the first reaction is a reactant in a second reaction, and so on. These are very common systems in Chemical Reaction Engineering – especially in the petrochemical industry, where we often make reactive things from inert alkanes.  Quite often, the reactive things we make then react away to form things we don’t want.  Selectivity control in series reactions requires careful attention to operating conditions and reaction times (space times for flow reactors).</p>
<p>You carry out these reactions in a CSTR operating at steady state.  You may assume the density of the fluid does not change with reaction and so the inlet volumetric flowrate is equal to the outlet volumetric flowrate.  You have the following data available:</p>
<div class="amsmath math notranslate nohighlight" id="equation-46f49229-779e-4657-9ad2-236356bef9b6">
<span class="eqno">(130)<a class="headerlink" href="#equation-46f49229-779e-4657-9ad2-236356bef9b6" title="Permalink to this equation">#</a></span>\[\begin{align}
    k_1 &amp;= 0.5 \ \textrm{h}^{-1} \\
    k_2 &amp;= 0.2 \ \textrm{h}^{-1} \\
    C_{Af} &amp;= 20 \ \textrm{mol} \ \textrm{L}^{-1}
\end{align}\]</div>
<p>Find the space time required to maximize the <strong>yield</strong> of B (with respect to A) in this CSTR.</p>
<section id="solution-to-example-problem-01">
<h3>Solution to Example Problem 01<a class="headerlink" href="#solution-to-example-problem-01" title="Permalink to this headline">#</a></h3>
<p>To get yields, selectivities, and conversions, we need to write material balances on all species.  This allows us to determine the exit molar flowrates of all species. This problem is a bit unique in that we can solve balances for A, B, and C sequentially.  This is enabled by the fact that the balance on A is independent of species B; solving the balance on A enables us to solve the balance on B; the balance on B is independent of species C; and solving the balance on B enables us to solve the balance on C.  See below.</p>
<section id="material-balance-on-a">
<h4>Material Balance on A:<a class="headerlink" href="#material-balance-on-a" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[0 = F_{A,f} - F_A + R_AV\]</div>
<p>We aren’t given a ton of information except for the feed concentration of A.  Presumably, the feed concentrations of B and C are both zero.  We are also told we want to work with a space time, which is defined for a CSTR as:</p>
<div class="math notranslate nohighlight">
\[\tau = \frac{V}{Q_f}\]</div>
<p>I’m going to convert my balance so that it is written in terms of concentration and space time instead of molar flowrate and volume. I can express molar flowrates in terms of concentrations and volumetric flowrates:</p>
<div class="math notranslate nohighlight">
\[0 = C_{A,f}Q_f - C_AQ + R_AV\]</div>
<p>We know the intensive production rate of A:</p>
<div class="math notranslate nohighlight">
\[R_A = -r_1\]</div>
<p>Since the reactions are first order in the reactant:</p>
<div class="math notranslate nohighlight">
\[r_1 = k_1C_A\]</div>
<p>Making these substitutions, we find:</p>
<div class="math notranslate nohighlight">
\[0 = C_{A,f}Q_f - C_AQ - k_1C_AV\]</div>
<p>We are told that we can assume constant density in this system, which means (at steady state)</p>
<div class="math notranslate nohighlight">
\[Q = Q_f\]</div>
<p>Thus:</p>
<div class="math notranslate nohighlight">
\[0 = C_{A,f}Q_f - C_AQ_f - k_1C_AV\]</div>
<p>Dividing by <span class="math notranslate nohighlight">\(Q_f\)</span>, we express the balance in terms of a space time and concentrations.</p>
<div class="math notranslate nohighlight">
\[0 = C_{A,f} - C_A - k_1C_A\tau\]</div>
<p>And we can solve this for <span class="math notranslate nohighlight">\(C_A\)</span>, the exit concentration of A from the CSTR:</p>
<div class="math notranslate nohighlight">
\[C_A = \frac{C_{A,f}}{1 + k_1\tau}\]</div>
<p>This is an important result.  It gives us the exit concentration of A as a function of space time. Now we move on to a balance on B:</p>
</section>
<section id="balance-on-b">
<h4>Balance on B<a class="headerlink" href="#balance-on-b" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[0 = F_{B,f} - F_B + R_BV\]</div>
<p>We can replace molar flowrates with the product of concentration and volumetric flowrate, noting again that <span class="math notranslate nohighlight">\(Q = Q_f\)</span> for this problem:</p>
<div class="math notranslate nohighlight">
\[0 = C_{B,f}Q_f - C_BQ_f + R_BV\]</div>
<p>We can define the intensive production rate of B, <span class="math notranslate nohighlight">\(R_B\)</span>:</p>
<div class="math notranslate nohighlight">
\[R_B = r_1 - r_2\]</div>
<p>We know the reactions are both first order in their reactant, so:</p>
<div class="math notranslate nohighlight">
\[R_B = k_1C_A - k_2C_B\]</div>
<p>And we can substitute this into the material balance:</p>
<div class="math notranslate nohighlight">
\[0 = C_{B,f}Q_f - C_BQ_f + (k_1C_A - k_2C_B)V\]</div>
<p>Dividing through by <span class="math notranslate nohighlight">\(Q_f\)</span>:</p>
<div class="math notranslate nohighlight">
\[0 = C_{B,f} - C_B + (k_1C_A - k_2C_B)\tau\]</div>
<p>Noting that <span class="math notranslate nohighlight">\(C_{B,f} = 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[0 = C_B + (k_1C_A - k_2C_B)\tau\]</div>
<p>And we can solve this for <span class="math notranslate nohighlight">\(C_B\)</span>:</p>
<div class="math notranslate nohighlight">
\[C_B = \frac{k_1C_A\tau}{1 + k_2 \tau}\]</div>
<p>The above is expressed in terms of <span class="math notranslate nohighlight">\(C_A\)</span>.  We can substitute that expression in to get:</p>
<div class="math notranslate nohighlight">
\[C_B = \frac{k_1C_{A,f}\tau}{(1+k_1\tau)(1+k_2\tau)}\]</div>
<p>This is another important equation as it gives us <span class="math notranslate nohighlight">\(C_B\)</span> as a function of <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
</section>
<section id="balance-on-c">
<h4>Balance on C<a class="headerlink" href="#balance-on-c" title="Permalink to this headline">#</a></h4>
<p>Technically, we don’t need this to solve for yield/selectivity to B, but I’m curious to see how it behaves, so we’ll go ahead and write a balance on C:</p>
<div class="math notranslate nohighlight">
\[0 = F_{C,f} - F_C + R_CV\]</div>
<p>Converting to a function of concentration:</p>
<div class="math notranslate nohighlight">
\[0 = C_{C,f}Q_f - C_CQ_f + R_CV\]</div>
<p>Defining the production rate for C:</p>
<div class="math notranslate nohighlight">
\[R_C = r_2 = k_2C_B\]</div>
<p>We get:</p>
<div class="math notranslate nohighlight">
\[0 = C_{C,f}Q_f - C_CQ_f + k_2C_BV\]</div>
<p>Dividing by <span class="math notranslate nohighlight">\(Q_f\)</span>:</p>
<div class="math notranslate nohighlight">
\[0 = C_{C,f} - C_C + k_2C_B\tau\]</div>
<p>Noting that <span class="math notranslate nohighlight">\(C_f = 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[0 = - C_C + k_2C_B\tau\]</div>
<p>Which we can solve for <span class="math notranslate nohighlight">\(C_C\)</span>:</p>
<div class="math notranslate nohighlight">
\[C_C = k_2C_B\tau\]</div>
<p>And we can substitute the expression for <span class="math notranslate nohighlight">\(C_B\)</span> here to get:</p>
<div class="math notranslate nohighlight">
\[C_C = \frac{k_1k_2C_{A,f}\tau^2}{(1+k_1\tau)(1+k_2\tau)}\]</div>
<p>There we have our concentrations expressed as 3 functions of tau.  These are developed as lambda functions below, which are plotted as a function of tau.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k1</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1">#1/h</span>
<span class="n">k2</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1">#1/h</span>
<span class="n">CAf</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1">#mol/L</span>

<span class="n">CA</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">CAf</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">k1</span><span class="o">*</span><span class="n">tau</span><span class="p">)</span>
<span class="n">CB</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">k1</span><span class="o">*</span><span class="n">CAf</span><span class="o">*</span><span class="n">tau</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k1</span><span class="o">*</span><span class="n">tau</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k2</span><span class="o">*</span><span class="n">tau</span><span class="p">)</span>
<span class="n">CC</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">k1</span><span class="o">*</span><span class="n">k2</span><span class="o">*</span><span class="n">CAf</span><span class="o">*</span><span class="n">tau</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k1</span><span class="o">*</span><span class="n">tau</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k2</span><span class="o">*</span><span class="n">tau</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tauset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">CA</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">CB</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CB&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">CC</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Species concentration vs. CSTR space time&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;tau (h)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mol/L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">tauset</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L24_5_0.png" src="../_images/587-L24_5_0.png" />
</div>
</div>
</section>
<section id="defining-conversion-selectivities-and-yields">
<h4>Defining Conversion, Selectivities, and Yields<a class="headerlink" href="#defining-conversion-selectivities-and-yields" title="Permalink to this headline">#</a></h4>
<p>With the concentrations of each species defined, we can now consider Conversion, Yields and Selectivities.</p>
</section>
<section id="conversion">
<h4>Conversion<a class="headerlink" href="#conversion" title="Permalink to this headline">#</a></h4>
<p>We define the fractional conversion of A as:</p>
<div class="math notranslate nohighlight">
\[X_A = \frac{F_{A,f} - F_A}{F_{A,f}}\]</div>
<p>Although we have no way to solve for molar flowrates (since Q is unknown), we can express them in terms of concentrations, noting symbolically that <span class="math notranslate nohighlight">\(Q = Q_f\)</span>.</p>
<div class="math notranslate nohighlight">
\[X_A = \frac{C_{A,f}Q_f - C_AQ_f}{C_{A,f}Q_f}\]</div>
<p>We can factor and cancel the volumetric flowrate, giving us the result below, which is always true for a constant density fluid:</p>
<div class="math notranslate nohighlight">
\[X_A = \frac{C_{A,f} - C_A}{C_{A,f}}\]</div>
</section>
<section id="yields">
<h4>Yields<a class="headerlink" href="#yields" title="Permalink to this headline">#</a></h4>
<p>For a flow reactor, we would generally define the yield of B with respect to A as:</p>
<div class="math notranslate nohighlight">
\[Y_{B/A} = \frac{F_B\left|\frac{\nu_{A1}}{\nu_{B1}}\right|}{F_{A,f}}\]</div>
<p>Which simplfies for this problem to:</p>
<div class="math notranslate nohighlight">
\[Y_{B/A} = \frac{F_B}{F_{A,f}}\]</div>
<p>We actually don’t know the molar flowrates since we don’t know the size (Q, V) of this system, but we can express these in terms of concentrations, noting that since density is constant <span class="math notranslate nohighlight">\(Q = Q_f\)</span>:</p>
<div class="math notranslate nohighlight">
\[Y_{B/A} = \frac{C_BQ_f}{C_{A,f}Q_f}\]</div>
<p>This reduces to:</p>
<div class="math notranslate nohighlight">
\[Y_{B/A} = \frac{C_B}{C_{A,f}}\]</div>
<p>When we go to calculate a yield of C with respect to A, we have to note that by summing the two reactions, we can get the overall stoichiometry of converting A into C:</p>
<div class="math notranslate nohighlight">
\[A \longrightarrow C\]</div>
<p>With that, we can use a similar approach to that above to define the yield to C in terms of concentrations:</p>
<div class="math notranslate nohighlight">
\[Y_{C/A} = \frac{C_C}{C_{A,f}}\]</div>
</section>
<section id="selectivities">
<h4>Selectivities<a class="headerlink" href="#selectivities" title="Permalink to this headline">#</a></h4>
<p>We can define the selectivity of species B with respect to A:</p>
<div class="math notranslate nohighlight">
\[S_{B/A} = \frac{F_B\left|\frac{\nu_{A1}}{\nu_{B1}}\right|}{F_{A,f} - F_A}\]</div>
<p>Substituting stoichiometric coefficients, expressing in terms of concentrations, and noting that <span class="math notranslate nohighlight">\(Q = Q_f\)</span>:</p>
<div class="math notranslate nohighlight">
\[S_{B/A} = \frac{C_BQ_f}{C_{A,f}Q_f - C_AQ_f}\]</div>
<p>Factoring and cancelling the volumetric flowrate (which we can do in cases where it is constant):</p>
<div class="math notranslate nohighlight">
\[S_{B/A} = \frac{C_B}{C_{A,f} - C_A}\]</div>
<p>You can follow similar steps to define a selectivity to species C with respect to the reactant A:</p>
<div class="math notranslate nohighlight">
\[S_{C/A} = \frac{C_C}{C_{A,f} - C_A}\]</div>
<p>We’ll write lambda functions for each of these; note that I’m re-using my concentration functions defined above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YB</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">CB</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span><span class="o">/</span><span class="n">CAf</span>
<span class="n">YC</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">CC</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span><span class="o">/</span><span class="n">CAf</span>
<span class="n">SB</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">CB</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">CAf</span> <span class="o">-</span> <span class="n">CA</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span>
<span class="n">SC</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="n">CC</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">CAf</span> <span class="o">-</span> <span class="n">CA</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span>
<span class="n">XA</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="p">(</span><span class="n">CAf</span> <span class="o">-</span> <span class="n">CA</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span><span class="o">/</span><span class="n">CAf</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can plot everything for a graphical analysis; note, this will throw a warning because we divde by zero at some point.  This occurs at 0 tau, where <span class="math notranslate nohighlight">\(C_A = C_{A,f}\)</span>, causing a zero in the denominator of our selectivity expressions.  In this case, Python just reports the error and moves on, but just know that there is an infinity or a NAN value in our selectivity data.  In some cases, this may cause us problems, so we should know where the error is coming from and how we can deal with it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#This just prints out the first few selectivities to show the NAN (&quot;not a number&quot;) error</span>
<span class="c1">#print(np.array([SB(tauset)[0:5], SC(tauset)[0:5]]).T) </span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">XA</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Conversion of A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">SB</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Selectivity to B&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">SC</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Selectivity to C&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Space time (h)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Conversion/Selectivity&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">XA</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Conversion of A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">YB</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Yield to B&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tauset</span><span class="p">,</span> <span class="n">YC</span><span class="p">(</span><span class="n">tauset</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Yield to C&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Space time (h)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Conversion/Yield&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\jqbond\AppData\Local\Temp\ipykernel_15788\3616170257.py:3: RuntimeWarning: invalid value encountered in true_divide
  SB = lambda tau: CB(tau)/(CAf - CA(tau))
C:\Users\jqbond\AppData\Local\Temp\ipykernel_15788\3616170257.py:4: RuntimeWarning: invalid value encountered in true_divide
  SC = lambda tau: CC(tau)/(CAf - CA(tau))
</pre></div>
</div>
<img alt="../_images/587-L24_9_1.png" src="../_images/587-L24_9_1.png" />
<img alt="../_images/587-L24_9_2.png" src="../_images/587-L24_9_2.png" />
</div>
</div>
</section>
<section id="maximizing-the-yield-of-b">
<h4>Maximizing the Yield of B<a class="headerlink" href="#maximizing-the-yield-of-b" title="Permalink to this headline">#</a></h4>
<p>An important question is clearly what space time do we need to use to maximize the yield to species B (the intermediate in the series reaction).  From the graph of Yield vs. tau, we can see this occurs at a space time of about 3 hours.  To get more precise, we can either solve it analytically by taking a derivative of <span class="math notranslate nohighlight">\(Y_{B/A}\)</span> with respect to tau; after some calculus and algebra, we get:</p>
<div class="math notranslate nohighlight">
\[\frac{dY_{B/A}}{d\tau} = \frac{k_1(1 + k_1\tau)(1 + k_2\tau) - k_1\tau\left[k_1(1 + k_2\tau) + k_2(1 + k_1\tau)\right]}{\left[(1 + k_1\tau)(1+k_1\tau)\right]^2}\]</div>
<p>To find the optimum value of tau, we solve the following expression for <span class="math notranslate nohighlight">\(\tau\)</span>:</p>
<div class="math notranslate nohighlight">
\[0 = \frac{k_1(1 + k_1\tau)(1 + k_2\tau) - k_1\tau\left[k_1(1 + k_2\tau) + k_2(1 + k_1\tau)\right]}{\left[(1 + k_1\tau)(1+k_1\tau)\right]^2}\]</div>
<p>I did this by hand to find:</p>
<div class="math notranslate nohighlight">
\[\tau_{\textrm{opt}} = \sqrt{\frac{1}{k_1k_2}}\]</div>
<p>Which we can plug into a calculator to get:</p>
<div class="math notranslate nohighlight">
\[\tau_{\textrm{opt}} = 3.16 \ \textrm{h}\]</div>
<p>Or, you know, we could just create an objective function (return negative yield of B at a specific volume) and minimize that with an optimization routine.  See below.  You get the same answer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">tau</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">YB</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span> <span class="c1">#this objective function returns -1*YB for a given value of tau</span>
<span class="n">optsol</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="c1">#this varies tau until we hit minimum value of -1*YB</span>
<span class="nb">print</span><span class="p">(</span><span class="n">optsol</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The maximum yield to species B is </span><span class="si">{</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">optsol</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s1">3.2f</span><span class="si">}</span><span class="s1"> which occurs at a space time of </span><span class="si">{</span><span class="n">optsol</span><span class="o">.</span><span class="n">x</span><span class="si">:</span><span class="s1">3.2f</span><span class="si">}</span><span class="s1"> hours&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     fun: -0.3752470442573563
 message: &#39;\nOptimization terminated successfully;\nThe returned value satisfies the termination criteria\n(using xtol = 1.48e-08 )&#39;
    nfev: 17
     nit: 11
 success: True
       x: 3.162277615990361 

The maximum yield to species B is 0.38 which occurs at a space time of 3.16 hours
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="example-problem-02">
<h2>Example Problem 02<a class="headerlink" href="#example-problem-02" title="Permalink to this headline">#</a></h2>
<p><strong>This is a slightly modified version of Example 8.5 from Fogler</strong></p>
<p>The gas-phase reactions given below are carried out in an isobaric (constant pressure) Packed Bed Reactor</p>
<div class="amsmath math notranslate nohighlight" id="equation-d12dc79e-e0a0-43c2-b141-7932d5a09566">
<span class="eqno">(131)<a class="headerlink" href="#equation-d12dc79e-e0a0-43c2-b141-7932d5a09566" title="Permalink to this equation">#</a></span>\[\begin{align}
    A + 2B &amp;\longrightarrow C\\
    2A + 3C &amp;\longrightarrow D
\end{align}\]</div>
<p>Both reactions follow elementary rate laws (though neither reaction is truly an elementary reaction).</p>
<p>We have the following data available:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ef22bac7-d5fe-4494-be37-24f39a84f9ed">
<span class="eqno">(132)<a class="headerlink" href="#equation-ef22bac7-d5fe-4494-be37-24f39a84f9ed" title="Permalink to this equation">#</a></span>\[\begin{align}
    k_1 &amp;= 100 \ \textrm{L}^{3} \ \textrm{mol}^{-2} \ \textrm{kg}^{-1} \ \textrm{min}^{-1} \\
    k_2 &amp;= 500 \ \textrm{L}^{5} \ \textrm{mol}^{-4} \ \textrm{kg}^{-1} \ \textrm{min}^{-1} \\
    C_{T,f} &amp;= 0.2 \ \textrm{mol} \ \textrm{L}^{-1}\\
    T &amp;= 573 \ \textrm{K}\\
    F_{Af} &amp;= 10 \ \textrm{mol} \ \textrm{min}^{-1}\\
    F_{Bf} &amp;= 10 \ \textrm{mol} \ \textrm{min}^{-1}\\
\end{align}\]</div>
<ol class="simple">
<li><p>plot <span class="math notranslate nohighlight">\(X_A\)</span>, <span class="math notranslate nohighlight">\(Y_{C/A}\)</span>, <span class="math notranslate nohighlight">\(Y_{D/A}\)</span>, <span class="math notranslate nohighlight">\(S_{C/A}\)</span>, and <span class="math notranslate nohighlight">\(S_{D/A}\)</span> as a function of catalyst mass (up to 1000kg of catalyst).</p></li>
<li><p>what catalyst mass would you recommend in order to maximize the <em>selectivity</em> toward C in this reactor?</p></li>
<li><p>what catalyst mass would you recommend in order to maximize the <em>yield</em> of C in this reactor?</p></li>
</ol>
<section id="solution-to-example-problem-02">
<h3>Solution to Example Problem 02<a class="headerlink" href="#solution-to-example-problem-02" title="Permalink to this headline">#</a></h3>
<p>Start by writing material balances on each species.  Packed bed balances are almost identical to PFR balances, except we use mass of catalyst instead of volume as the independent variable (the one that defines the size of the reactor), and we write our intensive rate law in units of moles per mass of catalyst per time.  Hence:</p>
<div class="amsmath math notranslate nohighlight" id="equation-2ed891a5-05d4-440b-a56e-f79bda3983b6">
<span class="eqno">(133)<a class="headerlink" href="#equation-2ed891a5-05d4-440b-a56e-f79bda3983b6" title="Permalink to this equation">#</a></span>\[\begin{align}
    \frac{dF_A}{dW} &amp;= {R_A}^\prime \\
    \frac{dF_B}{dW} &amp;= {R_B}^\prime \\
    \frac{dF_C}{dW} &amp;= {R_C}^\prime \\
    \frac{dF_D}{dW} &amp;= {R_D}^\prime \\
\end{align}\]</div>
<p>Where the prime (<span class="math notranslate nohighlight">\(^\prime\)</span>) superscript just means that intensive rates are specified per unit mass of catalyst.  Otherwise, intensive production rates are defined as usual.</p>
<div class="amsmath math notranslate nohighlight" id="equation-1a5fe3c9-ec90-4037-805f-6001f7a0ab17">
<span class="eqno">(134)<a class="headerlink" href="#equation-1a5fe3c9-ec90-4037-805f-6001f7a0ab17" title="Permalink to this equation">#</a></span>\[\begin{align}
    {R_A}^\prime &amp;= -r_1 -2r_2 \\
    {R_B}^\prime &amp;= -2r_1 \\
    {R_C}^\prime &amp;= r_1 -3r_2 \\
    {R_D}^\prime &amp;= r_2 \\
\end{align}\]</div>
<p>These reactions have elementary kinetics, so:</p>
<div class="amsmath math notranslate nohighlight" id="equation-7383bef7-ad45-40a8-a5fd-d382622b4c59">
<span class="eqno">(135)<a class="headerlink" href="#equation-7383bef7-ad45-40a8-a5fd-d382622b4c59" title="Permalink to this equation">#</a></span>\[\begin{align}
    r_1 &amp;= k_1C_AC_B^2 \\
    r_2 &amp;= k_2CA^2C_C^3 \\
\end{align}\]</div>
<p>We define concentrations in terms of flowrates (dependent variables) as usual for a tubular reactor:</p>
<div class="amsmath math notranslate nohighlight" id="equation-43b1ad6b-9f6c-4fe0-942d-3e9318b5178d">
<span class="eqno">(136)<a class="headerlink" href="#equation-43b1ad6b-9f6c-4fe0-942d-3e9318b5178d" title="Permalink to this equation">#</a></span>\[\begin{align}
    C_A &amp;= F_A/Q \\
    C_B &amp;= F_B/Q \\
    C_C &amp;= F_C/Q \\
\end{align}\]</div>
<p>Since this is a gas-phase reaction at low pressure, we can define Q using the ideal gas law:</p>
<div class="math notranslate nohighlight">
\[Q = \frac{F_TRT}{P}\]</div>
<p>And since we know the reactor is isobaric, we can calculate the total pressure from the total feed concentration of species:</p>
<div class="math notranslate nohighlight">
\[P = C_{T,f}RT\]</div>
<p>At this point, everything on the right-hand side of our ODEs is defined in terms of our dependent variables, so we’re good to solve with solve_ivp.</p>
<p>We do want to define conversion, selectivity, and yield in terms of molar flowrates since our problem statement asks us to plot these quantities.</p>
<section id="id1">
<h4>Conversion<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h4>
<p>We define conversion as usual:</p>
<div class="math notranslate nohighlight">
\[X_A = \frac{F_{Af} - F_A}{F_{Af}}\]</div>
</section>
<section id="id2">
<h4>Selectivities<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h4>
<p>Based on the stoichiometry of the first reaction, we can see that 1 mole of C requires 1 mole of A. The overall selectivity to C would therefore be defined as:</p>
<div class="math notranslate nohighlight">
\[S_{C/A} = \frac{F_C}{F_{Af} - F_A}\]</div>
<p>The stoichiometric relationship between species A and species D is less clear from the two reactions given; however, if we sum them up:</p>
<div class="amsmath math notranslate nohighlight" id="equation-c1724867-0ef1-4b1f-b656-6906fbdce259">
<span class="eqno">(137)<a class="headerlink" href="#equation-c1724867-0ef1-4b1f-b656-6906fbdce259" title="Permalink to this equation">#</a></span>\[\begin{align}
    A + 2B &amp;\longrightarrow C\\
    2A + 3C &amp;\longrightarrow D \\
    \hline
    5A + 6B &amp;\longrightarrow D
\end{align}\]</div>
<p>With that, we can see that producing 1 mole of D will consume 5 moles of A, so:</p>
<div class="math notranslate nohighlight">
\[S_{D/A} = \frac{5F_D}{F_{Af} - F_A}\]</div>
</section>
<section id="id3">
<h4>Yields<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h4>
<p>We use the same insights about stoichiometry discussed above in order to define yields to C and D:</p>
<div class="amsmath math notranslate nohighlight" id="equation-3e19da77-36fc-494c-bb83-2bb1636bc565">
<span class="eqno">(138)<a class="headerlink" href="#equation-3e19da77-36fc-494c-bb83-2bb1636bc565" title="Permalink to this equation">#</a></span>\[\begin{align}
    Y_{C/A} = \frac{F_C}{F_{Af}} \\
    Y_{D/A} = \frac{5F_D}{F_{Af}} \\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">P02</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
    <span class="n">FA</span><span class="p">,</span> <span class="n">FB</span><span class="p">,</span> <span class="n">FC</span><span class="p">,</span> <span class="n">FD</span> <span class="o">=</span> <span class="n">var</span>
    <span class="n">FT</span> <span class="o">=</span> <span class="n">FA</span> <span class="o">+</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">FC</span> <span class="o">+</span> <span class="n">FD</span>
    
    <span class="n">k1</span>  <span class="o">=</span> <span class="mi">100</span> <span class="c1">#L^3/mol^2/kg/min</span>
    <span class="n">k2</span>  <span class="o">=</span> <span class="mi">500</span> <span class="c1">#L^5/mol^4/kg/min    </span>
    <span class="n">CAf</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1">#mol/L</span>
    <span class="n">T</span>   <span class="o">=</span> <span class="mi">573</span> <span class="c1">#K</span>
    <span class="n">R</span>   <span class="o">=</span> <span class="mf">0.08206</span> <span class="c1">#L*atm/mol/K</span>
    <span class="n">P</span>   <span class="o">=</span> <span class="n">CAf</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span>
    <span class="n">Q</span>   <span class="o">=</span> <span class="n">FT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>
    
    <span class="n">CA</span>  <span class="o">=</span> <span class="n">FA</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CB</span>  <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CC</span>  <span class="o">=</span> <span class="n">FC</span><span class="o">/</span><span class="n">Q</span>
    
    <span class="n">r1</span>  <span class="o">=</span> <span class="n">k1</span><span class="o">*</span><span class="n">CA</span><span class="o">*</span><span class="n">CB</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">r2</span>  <span class="o">=</span> <span class="n">k2</span><span class="o">*</span><span class="n">CA</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">CC</span><span class="o">**</span><span class="mi">3</span>
    
    <span class="n">RA</span>  <span class="o">=</span> <span class="o">-</span><span class="n">r1</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r2</span>
    <span class="n">RB</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r1</span>
    <span class="n">RC</span>  <span class="o">=</span> <span class="n">r1</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">r2</span>
    <span class="n">RD</span>  <span class="o">=</span> <span class="n">r2</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="n">RA</span><span class="p">,</span> <span class="n">RB</span><span class="p">,</span> <span class="n">RC</span><span class="p">,</span> <span class="n">RD</span><span class="p">]</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FAf</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">#mol/min</span>
<span class="n">FBf</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">#mol/min</span>
<span class="n">FCf</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1">#mol/min</span>
<span class="n">FDf</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1">#mol/min</span>

<span class="n">var0</span> <span class="o">=</span> <span class="p">[</span><span class="n">FAf</span><span class="p">,</span> <span class="n">FBf</span><span class="p">,</span> <span class="n">FCf</span><span class="p">,</span> <span class="n">FDf</span><span class="p">]</span>

<span class="n">Wspan</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="c1">#kg catalyst</span>

<span class="n">answer</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">P02</span><span class="p">,</span> <span class="n">Wspan</span><span class="p">,</span> <span class="n">var0</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">)</span>

<span class="n">W</span>  <span class="o">=</span> <span class="n">answer</span><span class="o">.</span><span class="n">t</span>
<span class="n">FA</span> <span class="o">=</span> <span class="n">answer</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">FB</span> <span class="o">=</span> <span class="n">answer</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">FC</span> <span class="o">=</span> <span class="n">answer</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">FD</span> <span class="o">=</span> <span class="n">answer</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="n">XA</span>  <span class="o">=</span> <span class="p">(</span><span class="n">FAf</span> <span class="o">-</span> <span class="n">FA</span><span class="p">)</span><span class="o">/</span><span class="n">FAf</span>

<span class="n">SCA</span> <span class="o">=</span> <span class="n">FC</span><span class="o">/</span><span class="p">(</span><span class="n">FAf</span> <span class="o">-</span> <span class="n">FA</span><span class="p">)</span>
<span class="n">SDA</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">FD</span><span class="o">/</span><span class="p">(</span><span class="n">FAf</span> <span class="o">-</span> <span class="n">FA</span><span class="p">)</span>

<span class="n">YCA</span> <span class="o">=</span> <span class="n">FC</span><span class="o">/</span><span class="n">FAf</span>
<span class="n">YDA</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">FD</span><span class="o">/</span><span class="n">FAf</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">XA</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Conversion of A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass of Catalyst (kg)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Conversion&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">SCA</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Selectivity to C&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">SDA</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Selectivity to D&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass of Catalyst (kg)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Selectivity&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">YCA</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Yield to C&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">YDA</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Yield to D&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass of Catalyst (kg)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Yield&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\jqbond\AppData\Local\Temp\ipykernel_15788\3189117652.py:20: RuntimeWarning: invalid value encountered in true_divide
  SCA = FC/(FAf - FA)
C:\Users\jqbond\AppData\Local\Temp\ipykernel_15788\3189117652.py:21: RuntimeWarning: invalid value encountered in true_divide
  SDA = 5*FD/(FAf - FA)
</pre></div>
</div>
<img alt="../_images/587-L24_15_1.png" src="../_images/587-L24_15_1.png" />
<img alt="../_images/587-L24_15_2.png" src="../_images/587-L24_15_2.png" />
<img alt="../_images/587-L24_15_3.png" src="../_images/587-L24_15_3.png" />
</div>
</div>
</section>
<section id="optimizing-yields-and-selectivities">
<h4>Optimizing Yields and Selectivities<a class="headerlink" href="#optimizing-yields-and-selectivities" title="Permalink to this headline">#</a></h4>
<p>Here, we have the classic problem in maximizing selectivity/yield to the intermediate species in a sequence of reactions.  Selectivity is maximizing by operating as close to zero conversion as possible.  This is because, in this limit, the concentration of species C is near zero, so the rate of the second reaction is near zero.  Unfortunately, since yield is the product of conversion and selectivity, the yield of C also approaches zero at zero conversion.  To produce a viable quantity of product C, you’ll have to tolerate some loss of selectivity – The point of maximum yield will be the mass of catalyst where conversion has increased enough to produce an appreciable quantity of C, but not so much that we are producing mostly D.  As shown below, this occurs at 140 kg of catalyst, where we find a maximum yield of B of approximately 40%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YIELD</span>   <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">YCA</span><span class="p">)</span>  <span class="c1">#This gives me yield as a continuous function of W</span>
<span class="c1">#OBJ     = lambda W: YIELD(W)*-1  #I want to minimize negative yield.</span>
<span class="k">def</span> <span class="nf">OBJ</span><span class="p">(</span><span class="n">W</span><span class="p">):</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">W</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">([</span><span class="n">W</span><span class="p">,</span> <span class="n">YIELD</span><span class="p">(</span><span class="n">W</span><span class="p">)])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error: </span><span class="si">{</span><span class="n">W</span><span class="si">}</span><span class="s1">kg of catalyst is outside interpolation range&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">YIELD</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>

<span class="n">answer2</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">OBJ</span><span class="p">)</span>
<span class="n">W_opt</span>   <span class="o">=</span> <span class="n">answer2</span><span class="o">.</span><span class="n">x</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The maximum yield of C is </span><span class="si">{</span><span class="n">YIELD</span><span class="p">(</span><span class="n">W_opt</span><span class="p">)</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1"> at a catalyst loading of </span><span class="si">{</span><span class="n">W_opt</span><span class="si">:</span><span class="s1">0.0f</span><span class="si">}</span><span class="s1">kg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0, array(0.)]
[1.0, array(0.0098198)]
[2.6180339999999998, array(0.02451275)]
[17.892964975441355, array(0.14608862)]
[42.60832264135863, array(0.25468483)]
[54.8926563161009, array(0.30430925)]
[74.76912586917882, array(0.34880455)]
[84.8177098060513, array(0.36144965)]
[101.07666026776482, array(0.38190987)]
Error: 1873.302260594539kg of catalyst is outside interpolation range
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">~\AppData\Local\Temp\ipykernel_15788\1450459284.py</span> in <span class="ni">&lt;cell line: 10&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">YIELD</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> 
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="n">answer2</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">OBJ</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="n">W_opt</span>   <span class="o">=</span> <span class="n">answer2</span><span class="o">.</span><span class="n">x</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> 

<span class="nn">~\anaconda3\lib\site-packages\scipy\optimize\_minimize.py</span> in <span class="ni">minimize_scalar</span><span class="nt">(fun, bracket, bounds, args, method, tol, options)</span>
<span class="g g-Whitespace">    </span><span class="mi">884</span>         <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="n">bracket</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">885</span>     <span class="k">elif</span> <span class="n">meth</span> <span class="o">==</span> <span class="s1">&#39;brent&#39;</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">886</span>         <span class="k">return</span> <span class="n">_minimize_scalar_brent</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">bracket</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">887</span>     <span class="k">elif</span> <span class="n">meth</span> <span class="o">==</span> <span class="s1">&#39;bounded&#39;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">888</span>         <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">~\anaconda3\lib\site-packages\scipy\optimize\_optimize.py</span> in <span class="ni">_minimize_scalar_brent</span><span class="nt">(func, brack, args, xtol, maxiter, disp, **unknown_options)</span>
<span class="g g-Whitespace">   </span><span class="mi">2496</span>                   <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="n">disp</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2497</span>     <span class="n">brent</span><span class="o">.</span><span class="n">set_bracket</span><span class="p">(</span><span class="n">brack</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2498</span>     <span class="n">brent</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">2499</span>     <span class="n">x</span><span class="p">,</span> <span class="n">fval</span><span class="p">,</span> <span class="n">nit</span><span class="p">,</span> <span class="n">nfev</span> <span class="o">=</span> <span class="n">brent</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2500</span> 

<span class="nn">~\anaconda3\lib\site-packages\scipy\optimize\_optimize.py</span> in <span class="ni">optimize</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">2266</span>         <span class="c1"># set up for optimization</span>
<span class="g g-Whitespace">   </span><span class="mi">2267</span>         <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
<span class="ne">-&gt; </span><span class="mi">2268</span>         <span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">fa</span><span class="p">,</span> <span class="n">fb</span><span class="p">,</span> <span class="n">fc</span><span class="p">,</span> <span class="n">funcalls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bracket_info</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">2269</span>         <span class="n">_mintol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mintol</span>
<span class="g g-Whitespace">   </span><span class="mi">2270</span>         <span class="n">_cg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cg</span>

<span class="nn">~\anaconda3\lib\site-packages\scipy\optimize\_optimize.py</span> in <span class="ni">get_bracket_info</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">2240</span>         <span class="c1">### carefully DOCUMENT any CHANGES in core ##</span>
<span class="g g-Whitespace">   </span><span class="mi">2241</span>         <span class="k">if</span> <span class="n">brack</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2242</span>             <span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">fa</span><span class="p">,</span> <span class="n">fb</span><span class="p">,</span> <span class="n">fc</span><span class="p">,</span> <span class="n">funcalls</span> <span class="o">=</span> <span class="n">bracket</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2243</span>         <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">brack</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2244</span>             <span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">fa</span><span class="p">,</span> <span class="n">fb</span><span class="p">,</span> <span class="n">fc</span><span class="p">,</span> <span class="n">funcalls</span> <span class="o">=</span> <span class="n">bracket</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">xa</span><span class="o">=</span><span class="n">brack</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>

<span class="nn">~\anaconda3\lib\site-packages\scipy\optimize\_optimize.py</span> in <span class="ni">bracket</span><span class="nt">(func, xa, xb, args, grow_limit, maxiter)</span>
<span class="g g-Whitespace">   </span><span class="mi">2790</span>         <span class="k">elif</span> <span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">wlim</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">wlim</span> <span class="o">-</span> <span class="n">xc</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2791</span>             <span class="n">w</span> <span class="o">=</span> <span class="n">wlim</span>
<span class="ne">-&gt; </span><span class="mi">2792</span>             <span class="n">fw</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="p">((</span><span class="n">w</span><span class="p">,)</span> <span class="o">+</span> <span class="n">args</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">2793</span>             <span class="n">funcalls</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="g g-Whitespace">   </span><span class="mi">2794</span>         <span class="k">elif</span> <span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">wlim</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xc</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>

<span class="nn">~\AppData\Local\Temp\ipykernel_15788\1450459284.py</span> in <span class="ni">OBJ</span><span class="nt">(W)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>         <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error: </span><span class="si">{</span><span class="n">W</span><span class="si">}</span><span class="s1">kg of catalyst is outside interpolation range&#39;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">8</span>     <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">YIELD</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> 
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">answer2</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">OBJ</span><span class="p">)</span>

<span class="nn">~\anaconda3\lib\site-packages\scipy\interpolate\_polyint.py</span> in <span class="ni">__call__</span><span class="nt">(self, x)</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span>         <span class="s2">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">77</span><span class="s2">         x, x_shape = self._prepare_x(x)</span>
<span class="ne">---&gt; </span><span class="mi">78</span><span class="s2">         y = self._evaluate(x)</span>
<span class="g g-Whitespace">     </span><span class="mi">79</span><span class="s2">         return self._finish_y(y, x_shape)</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span><span class="s2"> </span>

<span class="nn">~\anaconda3\lib\site-packages\scipy\interpolate\_interpolate.py</span> in <span class="ni">_evaluate</span><span class="nt">(self, x_new)</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span><span class="s2">         y_new = self._call(self, x_new)</span>
<span class="g g-Whitespace">    </span><span class="mi">704</span><span class="s2">         if not self._extrapolate:</span>
<span class="ne">--&gt; </span><span class="mi">705</span><span class="s2">             below_bounds, above_bounds = self._check_bounds(x_new)</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span><span class="s2">             if len(y_new) &gt; 0:</span>
<span class="g g-Whitespace">    </span><span class="mi">707</span><span class="s2">                 # Note fill_value must be broadcast up to the proper size</span>

<span class="nn">~\anaconda3\lib\site-packages\scipy\interpolate\_interpolate.py</span> in <span class="ni">_check_bounds</span><span class="nt">(self, x_new)</span>
<span class="g g-Whitespace">    </span><span class="mi">735</span><span class="s2">                              &quot;range.&quot;)</span>
<span class="g g-Whitespace">    </span><span class="mi">736</span><span class="s2">         if self.bounds_error and above_bounds.any():</span>
<span class="ne">--&gt; </span><span class="mi">737</span><span class="s2">             raise ValueError(&quot;A value in x_new is above the interpolation &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">738</span><span class="s2">                              &quot;range.&quot;)</span>
<span class="g g-Whitespace">    </span><span class="mi">739</span><span class="s2"> </span>

<span class="ne">ValueError</span>: A value in x_new is above the interpolation range.
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="587-L23.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Material Balances XIV</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="587-L25.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Material Balances XVI</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Jesse Q. Bond, Syracuse University<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>