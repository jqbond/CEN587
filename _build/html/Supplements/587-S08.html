

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>The Fall of Acererak &#8212; Kinetics and Reaction Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Supplements/587-S08';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/JQB.png" class="logo__image only-light" alt="Kinetics and Reaction Engineering - Home"/>
    <script>document.write(`<img src="../_static/JQB.png" class="logo__image only-dark" alt="Kinetics and Reaction Engineering - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter1.html">Python Supplements</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="587-S01.html">The Basics</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter2.html">Lectures</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Lectures/587-L01.html">Introduction and Stoichiometry</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jqbond/CEN587/main?urlpath=tree/Supplements/587-S08.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jqbond/CEN587" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jqbond/CEN587/issues/new?title=Issue%20on%20page%20%2FSupplements/587-S08.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Supplements/587-S08.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The Fall of Acererak</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-packages">Importing Packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-your-dice-roller">Build your dice roller</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construct-a-rudimentary-monte-carlo-simulation">Construct a rudimentary Monte Carlo simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-the-results-of-your-combat-simulation">Analyze the results of your combat simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-a-probability-distribution-from-the-simulation">Generating a Probability distribution from the simulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-the-results">Counting the results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-data">Visualizing the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-the-histogram">Integrating the histogram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalizing-to-unit-area">Normalizing to unit area</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-your-normalization">Check your normalization…</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-information-from-the-probability-distribution">Extracting information from the probability distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-value-of-the-distribution">Mean value of the distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variance-and-standard-deviation">Variance and Standard Deviation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-percent-chance-of-success">Calculating the percent chance of success</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assessing-the-results">Assessing the results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wait-a-minute-this-guy-is-a-1000-year-old-lich-wizard-with-7-int-there-s-no-way-his-mage-armor-failed">Wait a minute, this guy is a 1000 year old Lich-wizard with +7 INT.  There’s no way his mage armor failed!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-ll-take-what-s-behind-door-number">I’ll take what’s behind door number….</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calories-in-calories-out">Calories in, calories out</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="the-fall-of-acererak">
<h1>The Fall of Acererak<a class="headerlink" href="#the-fall-of-acererak" title="Permalink to this heading">#</a></h1>
<p>Over the past few modules, we’ve learned the basics of loops and functions.  In the Functions Module (07), we used a function combined with a while loop to gauge how many times we would need to make a dice roll for the average of those rolls to approach the true mean (within our tolerance threshold). We ran that simulation many times, and, on average, it seemed to converge somewhere between 500 and 1000 rolls. Now, that probably gives us a pretty good idea of what the mean is, but I’m not convinced 1000 rolls is enough for us to get good enough statistics to confidently assess how our damage roll will play out  against <em><strong>Acererak the Archlich</strong></em>.</p>
<p>To recap the situation you’re in, Acererak is down to 28 hit points. You are swinging a magic battle axe named <em><strong>Lichslayer III</strong></em>, and we are still going to assume that you hit Acererak (for now). Your axe does 4d12+5 base damage with 2d4+2 bonus damage to Liches. We know that your mean damage roll is 38, so, assuming you hit 38 or better 50% of the time, you have a pretty solid chance of winning this fight. But you don’t have a 100% chance of winning this fight, do you?  It’s entirely possible that your roll comes back less than 28, in which case, you are looking at a pretty anti-climactic TPK.</p>
<p>We are going to do a very basic Monte Carlo-type simulation to see if we can better assess your chances.  First, we will figure out the probability distribution on the damage roll. By that I mean, what is the probability that you will make a certain damage roll between 13 (minimum) and 63 (maximum). Figuring out the probability that we’ll beat 28 based on the dice and modifiers is much more complicated than determining the average. We’ll visualize that probability distribution for the damage roll, and then do some basic analysis to figure out the mean (which we expect should be 38 if we’ve done everything correctly), the variance, and the percentage chance we have of winning the fight under the terms we’ve laid out here.</p>
<p>This analysis is part of a basic interpretation of probability distributions, which is useful in statistics, data analysis, physical chemistry, reactor design, and many other areas of engineering.  It’s worth learning a bit about how we generate a probability distribution for a discrete random variable (i.e., dice rolls on a d6 are either 1, 2, 3, 4, 5, 6…not a continuous variable that goes from 13 to 63) from a monte carlo simulation, having a look at a probability distribution, and learning how to analyze it just a little.</p>
<p>Here, we will abandon the while loop we used to determine the mean roll in Module 07. Instead, we’ll just use a for loop to simulate the outcome of each damage roll from 1 to n (we decide the value of n when we start the simulation). For each roll we make, we will do two things.  First, we will record the total and append it to a running list of totals for damage rolls 1 to n.  Second, based on the result of each roll, we will record the binary result of the battle.  We either win or lose.  If our roll is 28 or better, we win.  If it is lower than 28, we lose.  We can easily do this with an if statement to direct the program to take a different course of action for each result.</p>
<p>We will start by making 1,000 rolls and see how things look.  One important clarification that may be confusing:  We are making n “rolls”.  These refer to “n” damage rolls, each of which is 4d12+5 + 2d4+2, not “n” individual dice.  So for each damage roll, we are rolling 4d12’s and 2d4’s…then adding some modifiers to calculate the total damage roll.  This total is what gets stored on each pass through the for loop.</p>
<p>We’ll go through the code together for this example and explain how it works, then we’ll have a more complex scenario that you can resolve by adapting the simulation.</p>
<section id="importing-packages">
<h2>Importing Packages<a class="headerlink" href="#importing-packages" title="Permalink to this heading">#</a></h2>
<p>To start, we will use both pyplot and random in this example, let’s import them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">math</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="build-your-dice-roller">
<h2>Build your dice roller<a class="headerlink" href="#build-your-dice-roller" title="Permalink to this heading">#</a></h2>
<p>Next, we need to add our dice roller function from Module 07.  Notice how nice it is to have a function that we can use for many different situations by just adapting the arguments (inputs) to that function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generator</span><span class="p">(</span><span class="n">sides</span><span class="p">,</span> <span class="n">dice</span><span class="p">):</span>
    <span class="n">roll</span>  <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sides</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dice</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">roll</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="construct-a-rudimentary-monte-carlo-simulation">
<h2>Construct a rudimentary Monte Carlo simulation<a class="headerlink" href="#construct-a-rudimentary-monte-carlo-simulation" title="Permalink to this heading">#</a></h2>
<p>We are doing a very basic Monte Carlo simulation, which means we will roll the dice a lot of times, calculate the total for each time, and figure out how many times we won or lost based on those outcomes.  If we do it enough times, we get a reasonable approximation of the probability distribution for our damage roll and the probability that we win or lose this particular combat. Again, a disclaimer – this is probably not the most efficient way to run an MC simulation, but it is logical and clear, so it has educational value in learning how to structure functions, loops, and flow control.  You can work on optimizing it later if that is within the scope of your interests or your course.</p>
<p>To start, we’ll use 1000 damage rolls, so let’s set <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">1000</span></code> and then write a for loop to cycle through n total damage rolls (for this first test, we have set <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">1000</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">We are going to construct this simulation using a for loop.  </span>
<span class="sd">Each pass through the for loop represents another damage roll.  </span>
<span class="sd">Every time we make a roll, we append it to a list called damage. </span>
<span class="sd">The damage list contains the results of each roll.  </span>
<span class="sd">To start, we will initialize that list as an empty list.  </span>
<span class="sd">In addition, we will decide after every roll whether we won or lost.</span>
<span class="sd">We&#39;ll store that win/loss outcome as a string in a list called result. </span>
<span class="sd">So we need to initialize that as well with an empty list.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">damage</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#Initialize list where we will store all damage rolls.</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#Initialize list where we will store binary result of combat (win or lose)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>         <span class="c1">#A for loop to make n damage rolls and store the results</span>
    <span class="n">roll1</span> <span class="o">=</span> <span class="n">generator</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c1">#This is your 4d12 roll</span>
    <span class="n">roll2</span> <span class="o">=</span> <span class="n">generator</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span>  <span class="mi">2</span><span class="p">)</span> <span class="c1">#This is your 2d4 roll</span>
    <span class="n">base</span>  <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">roll1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span>   <span class="c1">#Adding modifier to base</span>
    <span class="n">bonus</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">roll2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>   <span class="c1">#Adding modifer to bonus</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">base</span> <span class="o">+</span> <span class="n">bonus</span>     <span class="c1">#Result of the ith damage roll out of n damage rolls.</span>
    <span class="n">damage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>     <span class="c1">#Append the ith damage total to list called &#39;total&#39;</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    At this point, we are still in the body of the for loop, and we&#39;ve just made the ith roll.  </span>
<span class="sd">    I want to now store the result of that roll as a string that tells us whether we won or lost.  </span>
<span class="sd">    We can do that easily with an if statement:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;=</span> <span class="mi">28</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Acererak has Fallen!&#39;</span><span class="p">)</span> <span class="c1">#If you roll 28 or better, you win.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Total Party Kill!&#39;</span><span class="p">)</span>    <span class="c1">#If you don&#39;t roll 28 or better, you lose.</span>

<span class="sd">&quot;&quot;&quot;    </span>
<span class="sd">We are now returned flush left, and so we are outside of the for loop.  </span>
<span class="sd">We&#39;ve made our n damage rolls. </span>
<span class="sd">We just need to count the number of times we won and lost over 1000 combat simulations. </span>
<span class="sd">There is a built in list method called **count()** that does this for us.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">Wins</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;Acererak has Fallen!&#39;</span><span class="p">)</span>
<span class="n">Losses</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;Total Party Kill!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="n">damage</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">roll1</span> <span class="o">=</span> <span class="n">generator</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">roll2</span> <span class="o">=</span> <span class="n">generator</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">base</span>  <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">roll1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span>
    <span class="n">bonus</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">roll2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">base</span> <span class="o">+</span> <span class="n">bonus</span>
    <span class="n">damage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;=</span> <span class="mi">28</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Acererak Has Fallen!&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Total Party Kill&#39;</span><span class="p">)</span>

<span class="n">Wins</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;Acererak Has Fallen!&#39;</span><span class="p">)</span>
<span class="n">Losses</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;Total Party Kill&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="analyze-the-results-of-your-combat-simulation">
<h2>Analyze the results of your combat simulation<a class="headerlink" href="#analyze-the-results-of-your-combat-simulation" title="Permalink to this heading">#</a></h2>
<p>At this point, we’ve counted the number of times our simulation gave us a win and The probability that we win is given by:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">odds</span> <span class="o">=</span> <span class="n">Wins</span><span class="o">/</span><span class="p">(</span><span class="n">Wins</span> <span class="o">+</span> <span class="n">Losses</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">odds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Wins</span> <span class="o">+</span> <span class="n">Losses</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.929406
1000000
</pre></div>
</div>
</div>
</div>
<p>This is all we need in order to figure out our chances against Acererak.  But we’ve also generated enough data to get a full probability distribution out of this Monte Carlo simulation. Learning a bit about probability distributions and how to analyze them is generally useful. Just ask any Reaction Engineering student after they cover residence time distributions for nonideal reactor design.</p>
</section>
<section id="generating-a-probability-distribution-from-the-simulation">
<h2>Generating a Probability distribution from the simulation<a class="headerlink" href="#generating-a-probability-distribution-from-the-simulation" title="Permalink to this heading">#</a></h2>
<p>At this point in the script, you have a set of n damage rolls, and you have a list of whether you won or lost each of your n combat attempts. We will process this a just little in order to generate a probability distribution that represents the likelihood of events with this particular damage roll. This might <em>sound</em> complicated, but it is actually straightforward to generate a probability distribution for a set of discrete events (i.e., damage rolls of 13, 14, 15, …. 61, 62, 63).</p>
<p>What we want to plot to visualize the probability distribution is the <em>percentage of times we hit each damage roll</em> on the y axis against the <em>damage roll</em> itself on the x-axis. The first step is to just to count the number of times we hit each possible result between 13 and 63 when we made our n damage rolls in the Monte Carlo simulation. Again, we’ll use the list method count() to do this, this time in a for loop since we want to count multiple different events in our tally.</p>
<section id="counting-the-results">
<h3>Counting the results<a class="headerlink" href="#counting-the-results" title="Permalink to this heading">#</a></h3>
<p>Let’s initialize the list where we tally the number of times we made each roll. We’ll also want a list of roll values that correspond to each tally. Then we’ll write a for loop to count the number of times we hit each damage total and add it to the tally list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tally</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">roll</span>  <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">roll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">tally</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">damage</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualizing-the-data">
<h3>Visualizing the data<a class="headerlink" href="#visualizing-the-data" title="Permalink to this heading">#</a></h3>
<p>At this point, it is helpful to visualize what we are working with: a tally that tells us the raw number of times we scored each result between 13 and 63 on our n damage rolls.  You can plot it as a scatter plot using the syntax below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">roll</span><span class="p">,</span> <span class="n">tally</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Total Damage Roll&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of Times Rolled&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Damage Rolls in </span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s1">d</span><span class="si">}</span><span class="s1"> simulations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Or, if you prefer, you can create a histogram using a bar chart as shown below (my preference for this example)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">roll</span><span class="p">,</span> <span class="n">tally</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Total Damage Roll&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of Times Rolled&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Histogram of Damage Rolls in </span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s1">d</span><span class="si">}</span><span class="s1"> simulations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/770e7b7d1cc8a1b855fff752dee1f64f1a5f96f6a58ce6a0ac751f6970c42d41.png" src="../_images/770e7b7d1cc8a1b855fff752dee1f64f1a5f96f6a58ce6a0ac751f6970c42d41.png" />
</div>
</div>
<p>Each column or data point represents the number of times (in your n total rolls) you scored each result.  Thinking about this visualization helps us to understand the next step, which requires us to estimate the area under the tally vs. roll curve. If you aren’t satisfied at this point that your data set is sufficiently Gaussian, now is a good time to re-reun the simulation with more damage rolls – I generally see a pretty smooth distribution at about 100,000 damage rolls.</p>
</section>
<section id="integrating-the-histogram">
<h3>Integrating the histogram<a class="headerlink" href="#integrating-the-histogram" title="Permalink to this heading">#</a></h3>
<p>The next part is less intuitive unless you’ve already taken a probability and statistics course. To convert our raw tally into probability, we want to normalize it such that the total area under the probability distribution curve is 1.  We will do that by dividing each result in our <strong>tally column</strong> by the <strong>integral of tally as a function of roll</strong> evaluated from our minimum roll (13) to our maximum roll (63).</p>
<p>This is tough because we are dealing with a set of discrete events, so we can’t calculate an integral in the way we may be used to with a continuous function.  That said, we have numerical quadrature methods, such as the trapezoidal rule, which basically uses geometry to <em>approximate</em> the area under a curve:</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Trapezoidal_rule">https://en.wikipedia.org/wiki/Trapezoidal_rule</a></p>
<p>As usual, with base Python and list collections, we’ll do this with a for loop and flex some of those increment operators we learned with while loops.  Note that we could also do this by making a list of the area of each trapezoid at each step in the for loop and summing their values external to the for loop, but this illustration shows you another way to use increment operators.  Note the loop includes a calculation involving the j+1 element, so were only going to go up to the second to last element in the set of possible rolls. Once this loop is done, we have the total area under the curve.  For this particular example, it should be roughly equal to the total number of rolls that we made.  You can double check just to make sure; see if you can rationalize why this is so based on the way you are calculating the integral:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integral</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">integral</span> <span class="o">+=</span> <span class="p">(</span><span class="n">tally</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">tally</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>999998.5
1000000
</pre></div>
</div>
</div>
</div>
</section>
<section id="normalizing-to-unit-area">
<h3>Normalizing to unit area<a class="headerlink" href="#normalizing-to-unit-area" title="Permalink to this heading">#</a></h3>
<p>Now that we have the normalizing integral, we can convert our raw count into a probability distribution by dividing each count in tally by the normalizing integral.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="o">/</span><span class="n">integral</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">tally</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have a probability distribution, we definitely should plot it. The total given by rolling multiple dice and adding them together should have a Gaussian distribution, so plot it and see how much it looks like a Bell-shaped Gaussian distribution (or not):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">roll</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Total Damage Roll&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fraction of the time rolled rolled&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Probability distribution from </span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s1">d</span><span class="si">}</span><span class="s1"> simulations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">roll</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Total Damage Roll&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fraction of the time rolled&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Probability distribution from </span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s1">d</span><span class="si">}</span><span class="s1"> simulations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/079280c70dc04bbe74141d21aedf032081fb83377376118ceda0f1bd266bcc31.png" src="../_images/079280c70dc04bbe74141d21aedf032081fb83377376118ceda0f1bd266bcc31.png" />
<img alt="../_images/f5c287b57ee4f9adf69fcd63bfc94eed5c74cf18dcee0ca7a799c6e21ad8b603.png" src="../_images/f5c287b57ee4f9adf69fcd63bfc94eed5c74cf18dcee0ca7a799c6e21ad8b603.png" />
</div>
</div>
</section>
<section id="check-your-normalization">
<h3>Check your normalization…<a class="headerlink" href="#check-your-normalization" title="Permalink to this heading">#</a></h3>
<p>Before we go any further, let’s check our normalization by integrating the probability distribution from the minimum value (13) to the maximum value (63). If we’ve done everything correctly, it should integrate to 1 since there is a 100% chance we obtain a results between 13 and 63.  We can again approximate that area with the trapezoidal rule. We’ll add another plot of the distribution below because we’ll talk bout it in the next cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">norm</span> <span class="o">+=</span> <span class="p">(</span><span class="n">prob</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">prob</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The area under the probability distribution is </span><span class="si">{</span><span class="n">norm</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">roll</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Total Damage Roll&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fraction of the time rolled&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Probability distribution from </span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s1">d</span><span class="si">}</span><span class="s1"> simulations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The area under the probability distribution is 1.000
</pre></div>
</div>
<img alt="../_images/3d744083faabfcd031a43bb1fee50d1a73e5ccc5208ef3187f6cefbbfbf9d568.png" src="../_images/3d744083faabfcd031a43bb1fee50d1a73e5ccc5208ef3187f6cefbbfbf9d568.png" />
</div>
</div>
</section>
<section id="extracting-information-from-the-probability-distribution">
<h3>Extracting information from the probability distribution<a class="headerlink" href="#extracting-information-from-the-probability-distribution" title="Permalink to this heading">#</a></h3>
<p>Look again at the probability distribution. There is actually a lot of statistical information in a probability distribution. See how the peak is centered at a certain number that looks to be about 38?  That’s typical of a gaussian distribution, which is symmetric about the mean.  The height of the probability distribution at any value of “roll” tells us the probability that we make that roll.  So, based on that, we have roughly a 5.5% chance of rolling the mean value of 38 exactly…and we have nearly 0% chance of rolling either a 13 or a 63. The breadth of the peak gives you an idea of the variance (square of standard deviation) in your event.</p>
</section>
<section id="mean-value-of-the-distribution">
<h3>Mean value of the distribution<a class="headerlink" href="#mean-value-of-the-distribution" title="Permalink to this heading">#</a></h3>
<p>We can calculate the mean and standard deviation of this event once we have the probability distribution. The mean value of the damage roll is given by the “first moment” of the probability distribution, which is the integral of (roll * probability * delta_roll) from the minimum value (13) to the maximum value (63):</p>
<div class="math notranslate nohighlight">
\[\bar{r} = \int_{13}^{63}rP(r)dr\]</div>
<p>We can approxoimate that integral using the trapezoidal rule, which we’ve done a homebrew version of in the cell below (for educational purposes):</p>
<p>You may also note that for a discrete probability distribution such as this one, you can also calculate the mean value from the following summation:</p>
<div class="math notranslate nohighlight">
\[\bar{r} = \sum_{i = 13}^{63} r_i P_i\]</div>
<p>Whis is done in the cell below using a list comprehension, again for educational purposes. These will give roughly the same results here as long as we’ve done a reasonable number of simulations. We can print the result and see how close it is to the true mean (38).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#Initialize the mean.</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">mean</span> <span class="o">+=</span> <span class="p">(</span><span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">prob</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">prob</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>

<span class="nb">sum</span><span class="p">([</span><span class="n">rval</span><span class="o">*</span><span class="n">pval</span> <span class="k">for</span> <span class="n">rval</span><span class="p">,</span> <span class="n">pval</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">roll</span><span class="p">,</span> <span class="n">prob</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>38.00682676024014
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>38.00687101030652
</pre></div>
</div>
</div>
</div>
</section>
<section id="variance-and-standard-deviation">
<h3>Variance and Standard Deviation<a class="headerlink" href="#variance-and-standard-deviation" title="Permalink to this heading">#</a></h3>
<p>Now that we have the mean, we can also calculate the variance (<span class="math notranslate nohighlight">\(\sigma\)</span><sup>2</sup>), which is given by the second moment of the probability distribution, i.e, the integral of ( (roll - mean_roll)<sup>2</sup> * (probability) * delta_roll) from 13 to 63:</p>
<div class="math notranslate nohighlight">
\[\sigma^2 = \int_{13}^{63}(r - \bar{r})^2P(r)dr\]</div>
<p>Using either the trapezoidal rule or, since it is a discrete distribution, you can calculate the variance with the following summation:</p>
<div class="math notranslate nohighlight">
\[\sigma^2 = \sum_{i = 13}^{63} (r_i - \bar{r})^2 P_i\]</div>
<p>Note that the standard deviation is given by the square root of variance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#Initialize the variance.</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">var</span> <span class="o">+=</span> <span class="p">((</span><span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span><span class="p">(</span><span class="n">prob</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">prob</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">var</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span>

<span class="n">var</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">rval</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">pval</span> <span class="k">for</span> <span class="n">rval</span><span class="p">,</span> <span class="n">pval</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">roll</span><span class="p">,</span> <span class="n">prob</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">var</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.092905997148683
7.0753297209390045
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculating-the-percent-chance-of-success">
<h3>Calculating the percent chance of success<a class="headerlink" href="#calculating-the-percent-chance-of-success" title="Permalink to this heading">#</a></h3>
<p>Finally, we can calculate our percent chance of success by integrating the probability distribution from the lowest successful roll, 28, to the maximum possible roll of 63.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">success</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#Initialize the integrated area under the curve at 0.</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">28</span><span class="p">:</span>
        <span class="k">pass</span>               <span class="c1">#pass just says &quot;do nothing&quot;</span>
    <span class="k">elif</span> <span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">28</span><span class="p">:</span>
        <span class="n">success</span> <span class="o">+=</span> <span class="p">(</span><span class="n">prob</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">prob</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">roll</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="assessing-the-results">
<h3>Assessing the results<a class="headerlink" href="#assessing-the-results" title="Permalink to this heading">#</a></h3>
<p>Now that we’ve collected all of that information, let’s display the results all in one place.  We’ll check to see how your analysis of the probability distribution compares with the odds you calculated directly by counting wins and losses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;By counting the wins and losses, the odds that we win the battle are &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">odds</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The probability of success we calculated by integrating the probability distribution is &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">success</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The mean damage roll is &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The standard deviation on the damage roll is &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">var</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The total are under the curve for the probability distribution is &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">norm</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>By counting the wins and losses, the odds that we win the battle are  0.929
The probability of success we calculated by integrating the probability distribution is  0.918
The mean damage roll is  38.01
The standard deviation on the damage roll is  7.08
The total are under the curve for the probability distribution is  1.0
</pre></div>
</div>
</div>
</div>
<p>Now that you have a feel for what it takes to get the odds on a particular event, here are two problems you should solve independently by adapting the methods given above.</p>
</section>
</section>
<section id="wait-a-minute-this-guy-is-a-1000-year-old-lich-wizard-with-7-int-there-s-no-way-his-mage-armor-failed">
<h2>Wait a minute, this guy is a 1000 year old Lich-wizard with +7 INT.  There’s no way his mage armor failed!<a class="headerlink" href="#wait-a-minute-this-guy-is-a-1000-year-old-lich-wizard-with-7-int-there-s-no-way-his-mage-armor-failed" title="Permalink to this heading">#</a></h2>
<p>Now we will make the problem a little more complex.  You are still a pretty boss berserker, and your battle axe still does 4d12+5 + 2d4+2 damage. <em><strong>If it hits Acererak</strong></em>.</p>
<p>Your eyes must have failed you in the darkness, or perhaps the old wizard had a few tricks up his sleeve yet.  Whatever the reason, just as you’re about to swing the axe, a ghostly shield materializes out of thin air, and you see the ancient wizard’s body framed in faint blue light. What that means in practice: The shield adds +2 to his armor, and the blue light is a shield spell that he just cast, adding +5 to his armor. That gives him a total AC of 21, and it makes your job just a little harder.</p>
<p>He still has only 28 hit points, but now you have to hit him before you can even make your damage roll. Now you’re a pretty fierce warrior, so normally, you would get 1d20+11 as your attack roll, and contest that against Acererak’s armor class. Unfortunately, you are attacking at a disadvantage because your comrades are all down, and you are just plain afraid of Acererak. You are trembling as you swing <em>Lichslayer III</em>.</p>
<p>So here’s how disadvantage works out in terms of dice rolls: To make your attack, you will roll 2d20 instead of 1d20, and you have to take the lower result as your attack roll. You still get to add 11 to it because you are a berserker. If that total is greater than or equal to 21, <em>you hit</em> Acererak, which is only the first part of this.</p>
<p>If you hit Acererak, then you can roll your damage roll. The rules are the same as in the first problem. You roll 4d12+5 + 2d4+2.  If you get 28 or better, you win.</p>
<p><em><strong>Except….</strong></em></p>
<p>Acererak is a really, really bad dude. In the event that you do roll 28 or better - what is theoretically enough to win - He gets a saving throw. If he succeeds on his saving throw, he negates any damage done by your axe through sheer Lich. Now, to do this, <em>Acererak</em> makes a roll. He rolls 1d20 + 9.  If he rolls 25 or better, he shrugs off the damage and drops you with a something really lame, like magic missle, for the total party kill.</p>
<p>Write a Monte carlo Simulation to figure out your chance for success in this scenario. You do not need to generate a probability distribution as we did above - that was a distribution for the damage roll alone.  Here you have 3 separate events that combine to determine a binary outcome (win or lose).  So your probability distribution here is just what fraction of times you win + what fraction of times you lose.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">attack_roll</span> <span class="o">=</span> <span class="n">generator</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">attack_roll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">attack_roll</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">attack</span> <span class="o">=</span> <span class="n">attack_roll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">attack</span> <span class="o">=</span> <span class="n">attack_roll</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">attack</span>     <span class="o">=</span> <span class="n">attack</span> <span class="o">+</span> <span class="mi">11</span>
    
    <span class="k">if</span> <span class="n">attack</span> <span class="o">&lt;</span> <span class="mi">21</span><span class="p">:</span> <span class="c1">#You don&#39;t hit Acererak; game over.</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Total Party Kill!&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#You do hit Acererak, time to make a damage roll.</span>
        <span class="n">roll1</span> <span class="o">=</span> <span class="n">generator</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">roll2</span> <span class="o">=</span> <span class="n">generator</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">base</span>  <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">roll1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span>
        <span class="n">bonus</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">roll2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">base</span> <span class="o">+</span> <span class="n">bonus</span>
        <span class="k">if</span> <span class="n">total</span> <span class="o">&lt;</span> <span class="mi">28</span><span class="p">:</span> <span class="c1">#You don&#39;t drop Acererak; game over</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Total Party Kill!&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1">#You do enough damage to drop Acererak, now he gets a saving throw.</span>
            <span class="n">roll3</span> <span class="o">=</span> <span class="n">generator</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">save</span>  <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">roll3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">9</span>
            <span class="k">if</span> <span class="n">save</span> <span class="o">&gt;=</span> <span class="mi">25</span><span class="p">:</span> <span class="c1">#Acererak makes his save and ignores damage; game over</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Total Party Kill!&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1">#Acererak fails his save; you win!</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Acererak Has Fallen!&#39;</span><span class="p">)</span>

<span class="n">Wins</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;Acererak Has Fallen!&#39;</span><span class="p">)</span>
<span class="n">Losses</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;Total Party Kill!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">odds</span> <span class="o">=</span> <span class="n">Wins</span><span class="o">/</span><span class="p">(</span><span class="n">Wins</span> <span class="o">+</span> <span class="n">Losses</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">odds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.21066
</pre></div>
</div>
</div>
</div>
</section>
<section id="i-ll-take-what-s-behind-door-number">
<h2>I’ll take what’s behind door number….<a class="headerlink" href="#i-ll-take-what-s-behind-door-number" title="Permalink to this heading">#</a></h2>
<p>You are on a game show. The host presents you with a choice between 3 doors, and the choice you make will determine your fate in life. Behind one of the doors is your dream job, your dream life. If you pick that door, you get to work at something satisfying, rewarding, and well paid for as long as you want to. Behind the other two doors is misery. If you pick one of them, you get to be a college professor. (<em><strong>I’m kidding</strong></em>). Imagine the job in the world you’d hate doing the most - that is what’s behind the other two doors…and once you pick it, you are obligated to do it until you are dead because a) it has no retirement plan and b) once you take this job, you are ineligible for social security.</p>
<p>What lies beyond each door is determined randomly.  No one, including the game show host knows what lies behind each one.  <em><strong>You steel your nerve and pick one of the three doors</strong></em>, because even misery is better than being on a game show right?</p>
<p>But <em><strong>just before you open the door that you picked</strong></em>, the game show host stops you from opening it and says “Wait wait, let’s make this a little more interesting!”</p>
<p>The live studio audience roars.</p>
<p>The game show host then <em><strong>opens one of the two doors that you didn’t pick</strong></em>. Behind it?  <strong>Misery</strong>.  Keep in mind, the game show host had no idea what was behind any of the doors.</p>
<p>It looks like you dodged at least one bullet, yeah?  But then the game show host turns to you and says:</p>
<p><em><strong>“I’ll give you one last chance, do you want to change your pick?”</strong></em></p>
<p>Write a Monte Carlo simulation to analyze the best course of action.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">reject</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">switch</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="c1">#What&#39;s behind the doors: 1 is good, 0 is bad.</span>
    <span class="n">D1</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">D1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">D2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">D3</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">D1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">D2</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">D2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">D3</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">D2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">D3</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="n">D1</span><span class="p">,</span><span class="n">D2</span><span class="p">,</span><span class="n">D3</span><span class="p">]</span>
    
    <span class="c1">#Make your pick</span>
    <span class="n">pick</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">outcome</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="n">pick</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1">#You picked the winner on your first try.  Deal with the other two doors.</span>
        <span class="n">host_outcome</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">remaining_door</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">outcome</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1">#You picked a loser on your first try, deal with the other two doors.</span>
        <span class="n">remaining_door</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">if</span> <span class="n">remaining_door</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">switch</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;lose&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remaining_door</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">switch</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;win&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remaining_door</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">switch</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;win&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remaining_door</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">switch</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;lose&#39;</span><span class="p">)</span>

<span class="n">wins</span>   <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;win&#39;</span><span class="p">)</span>
<span class="n">losses</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;lose&#39;</span><span class="p">)</span>
<span class="n">odds</span>   <span class="o">=</span> <span class="n">wins</span><span class="o">/</span><span class="p">(</span><span class="n">wins</span> <span class="o">+</span> <span class="n">losses</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">odds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wins</span> <span class="o">+</span> <span class="n">losses</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reject</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">reject</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;If switch = </span><span class="si">{</span><span class="n">switch</span><span class="si">:</span><span class="s1">s</span><span class="si">}</span><span class="s1">, you have a </span><span class="si">{</span><span class="n">odds</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">4.2f</span><span class="si">}</span><span class="s1">% chance of winning&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.66674
100000
0
100000
If switch = yes, you have a 66.67% chance of winning
</pre></div>
</div>
</div>
</div>
</section>
<section id="calories-in-calories-out">
<h2>Calories in, calories out<a class="headerlink" href="#calories-in-calories-out" title="Permalink to this heading">#</a></h2>
<p>For all of the above cases, we’ve been dealing with discrete random variables.  Again, that means that the values taken on by the variable are not a continuous function, they are discrete values.  In this case, a dice roll will always give you an integer between 1 and the number of sides on that die.</p>
<p>Now we’re going to take this up just a little in intensity and present you with a framework that is generally useful in doing something like a Monte Carlo simulation where the important factors in your model obey some type of known probability distribution?  Gaussian is one example, but you might also have log normal, Poisson, Voigt, or many, many other types of distributions.</p>
<p>There are quite a lot of them, both discrete and continuous.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/List_of_probability_distributions">https://en.wikipedia.org/wiki/List_of_probability_distributions</a></p>
<p>Here’s an illustration of a few of those distributions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gaussian</span>   <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)]</span>
<span class="n">Lognorm</span>    <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">lognormvariate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)]</span>
<span class="n">Triangular</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">triangular</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)]</span>

<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">10</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)]</span>

<span class="c1">#Create a histogram of data generated by these random generators for visualization</span>
<span class="n">countG</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">countL</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">countT</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mf">0.05</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">0.05</span>
    <span class="n">tempG</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tempL</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tempT</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">Gaussian</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">lower</span> <span class="o">&lt;=</span> <span class="n">Gaussian</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">:</span>
            <span class="n">tempG</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Gaussian</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">lower</span> <span class="o">&lt;=</span> <span class="n">Lognorm</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">:</span>
            <span class="n">tempL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Lognorm</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">lower</span> <span class="o">&lt;=</span> <span class="n">Triangular</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">:</span>
            <span class="n">tempT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Triangular</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
    <span class="n">countG</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tempG</span><span class="p">))</span>
    <span class="n">countL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tempL</span><span class="p">))</span>
    <span class="n">countT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tempT</span><span class="p">))</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">countG</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Histogram for a Gaussian Variable&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">countL</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Histogram for a Lorgnorm Variable&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">countT</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Histogram for a Triangular Variable&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7d2f6ed647eda353077e93f1e6bd61ea41e606f20a4e642ea576b330f4634a85.png" src="../_images/7d2f6ed647eda353077e93f1e6bd61ea41e606f20a4e642ea576b330f4634a85.png" />
<img alt="../_images/33f00968f98a2b86b85b46cb262ff7d951de1320d72bd98997f3e64a296e82eb.png" src="../_images/33f00968f98a2b86b85b46cb262ff7d951de1320d72bd98997f3e64a296e82eb.png" />
<img alt="../_images/6d54f1ff3309b9833100f270e1c5a55f44a98c340a7f3fb43de9e659898c8946.png" src="../_images/6d54f1ff3309b9833100f270e1c5a55f44a98c340a7f3fb43de9e659898c8946.png" />
</div>
</div>
<p>The heart of Monte Carlo simulations is figuring out which of those distributions apply to the uncertain parameters in your model, and then drawing random numbers from that distribution weighted by the probability of that event occuring.</p>
<p>Let’s say I have a few things that determine my daily calorie balance on a day where I both have some type of training session AND I have access to unlimited donuts. Let’s break this down because nothing is certain about any of these things.</p>
<p>I have a reasonably steady average basal metabolic rate around 1800 kcal/day - this is roughly the number of calories I burn if I don’t do anything too out of the ordinary.  It will vary up and down some.  Sitting on the couch is lower, maybe a day where I walk to work is higher, but on average, the variance is pretty small. This is a training day, so I’m probably either rowing or on the bike.  Let’s say I generally hit 800 kcal in a session, but the variance is large.  Some days I feel great and go up to 1200 or 1400, other days, I bail pretty quick and might only do 200kcal. Let’s pretend that my donut consumption is not correlated with my calorie burn.  If I have access, I will eat 7 donuts on average, but there is a bit of variance, and it tends to skew higher than 7.  Let’s say on average each donut has 350kcal.</p>
<p>We’ll describe each of these variables using probability distributions.  On average, I probably come in close to the mean numbers above, but all of these things vary from day to day.  So we’ll pull numbers from relevant probability distributions.</p>
<p>Let’s say my BMR is on average, 1600 kcal, and it is described by a normal (Gaussian) distribution with a standard deviation of 125 kcal.  I can draw a random number that obeys that distribution (most likely around 1600, less likely below 1400 or above 1800) using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">BMR</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">1600</span><span class="p">,</span><span class="mi">125</span><span class="p">)</span> <span class="c1">#kcal</span>
</pre></div>
</div>
<p>Alright, so I usually eat 7 donuts, but who knows right?  Let’s say it is Gaussian, but with constraints. First, I always eat at least 2, so a result less than 2 will be set to 2.  Second, I never eat a fraction of a donut, so I will round up whatever value the gaussian distribution returns.  There is no upper limit on the number of donuts I will eat. Standard deviation: 3 donuts.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Donuts</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="c1">#donuts</span>
</pre></div>
</div>
<p>I have a preference for things like apple fritters, so they have a lot of calories.  But I won’t turn away anything.  Let’s say that the calories in my typical donut follow a Gaussian distribution centered at 350 kcal, with a standard deviation of 140, but only upward.  The minimum calories I will consume in a single donut are 350 kcal. There is no upper limit.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">D_Cal</span>  <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span><span class="mi">140</span><span class="p">)</span> <span class="c1">#kcal</span>
</pre></div>
</div>
<p>My workouts can be described with a triangular distribution centered at 800 calories, but going anywhere from 400 to 1200.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Training</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">triangular</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span> <span class="c1">#kcal</span>
</pre></div>
</div>
<p>Now, I have enough information to run a monte carlo simulation to figure out my typical net calories in a given day.  I would do this with a for loop that runs through maybe 10<sup>6</sup> iterations.  On each pass, I’ll draw a random value for BMR, Donuts, D_Cal, and Training, then I’ll add them up to get my net total.  Once that’s done we can create a histogram from the data, which gives us a pretty good representation of our probability distribution my daily net calorie intake.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BMR</span>      <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">1600</span><span class="p">,</span> <span class="mi">125</span><span class="p">)</span> <span class="c1">#kcal</span>
<span class="n">Donuts</span>   <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="c1">#donuts</span>
<span class="n">D_Cal</span>    <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">140</span><span class="p">)</span> <span class="c1">#kcal</span>
<span class="n">Training</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">triangular</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span> <span class="c1">#kcal</span>

<span class="n">net</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">):</span>
    <span class="n">BMR</span>    <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">1600</span><span class="p">,</span> <span class="mi">125</span><span class="p">)</span> <span class="c1">#kcal</span>
    <span class="n">Donuts</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="c1">#kcal</span>
    <span class="k">if</span> <span class="n">Donuts</span>  <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">Donuts</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">D_Cal</span>     <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span><span class="mi">140</span><span class="p">)</span> <span class="c1">#kcal</span>
    <span class="k">if</span> <span class="n">D_Cal</span>  <span class="o">&lt;</span> <span class="mi">350</span><span class="p">:</span>
        <span class="n">D_Cal</span> <span class="o">=</span> <span class="mi">350</span>
    <span class="n">Training</span>  <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">triangular</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span> <span class="c1">#kcal</span>
    <span class="n">net</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Donuts</span><span class="o">*</span><span class="n">D_Cal</span> <span class="o">-</span> <span class="n">BMR</span> <span class="o">-</span> <span class="n">Training</span><span class="p">)</span>

<span class="c1">#Create a histogram   </span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)]</span>
<span class="n">count_cal</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">50</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">50</span>
    <span class="n">temp</span>  <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">net</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">lower</span> <span class="o">&lt;=</span> <span class="n">net</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">:</span>
            <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">net</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
    <span class="n">count_cal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>

<span class="c1">#Convert to a probability distribution</span>
<span class="n">integral</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">integral</span> <span class="o">+=</span> <span class="p">(</span><span class="n">count_cal</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">count_cal</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">values</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

<span class="n">prob</span> <span class="o">=</span> <span class="p">[</span><span class="n">cals</span><span class="o">/</span><span class="n">integral</span> <span class="k">for</span> <span class="n">cals</span> <span class="ow">in</span> <span class="n">count_cal</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Net Calorie Intake (kcal)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Probability distribution of net calorie intake&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c1a2a858e7cc67541e08685dc8728c47bdbdf301a7c41ae17c32fe2ecc269451.png" src="../_images/c1a2a858e7cc67541e08685dc8728c47bdbdf301a7c41ae17c32fe2ecc269451.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Supplements"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-packages">Importing Packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-your-dice-roller">Build your dice roller</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construct-a-rudimentary-monte-carlo-simulation">Construct a rudimentary Monte Carlo simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-the-results-of-your-combat-simulation">Analyze the results of your combat simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-a-probability-distribution-from-the-simulation">Generating a Probability distribution from the simulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-the-results">Counting the results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-data">Visualizing the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-the-histogram">Integrating the histogram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalizing-to-unit-area">Normalizing to unit area</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-your-normalization">Check your normalization…</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-information-from-the-probability-distribution">Extracting information from the probability distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-value-of-the-distribution">Mean value of the distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variance-and-standard-deviation">Variance and Standard Deviation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-percent-chance-of-success">Calculating the percent chance of success</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assessing-the-results">Assessing the results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wait-a-minute-this-guy-is-a-1000-year-old-lich-wizard-with-7-int-there-s-no-way-his-mage-armor-failed">Wait a minute, this guy is a 1000 year old Lich-wizard with +7 INT.  There’s no way his mage armor failed!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-ll-take-what-s-behind-door-number">I’ll take what’s behind door number….</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calories-in-calories-out">Calories in, calories out</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jesse Q. Bond, Syracuse University
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>