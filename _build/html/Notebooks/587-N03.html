
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Solving Algebraic Equations &#8212; Kinetics and Reaction Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Notebooks/587-N03';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Extent and Conversion" href="587-N04.html" />
    <link rel="prev" title="Jupyter and Python" href="587-N02.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/JQB.png" class="logo__image only-light" alt="Kinetics and Reaction Engineering - Home"/>
    <script>document.write(`<img src="../_static/JQB.png" class="logo__image only-dark" alt="Kinetics and Reaction Engineering - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Chapter1.html">Python Supplements</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../Chapter2.html">Lectures</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="587-N01.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="587-N02.html">Jupyter and Python</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Solving Algebraic Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="587-N04.html">Extent and Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="587-N05.html">Chemical Equilibrium I</a></li>
<li class="toctree-l2"><a class="reference internal" href="587-N06.html">Chemical Equilibrium II</a></li>
<li class="toctree-l2"><a class="reference internal" href="587-N07.html">Chemical Equilibrium III</a></li>
<li class="toctree-l2"><a class="reference internal" href="587-N08.html">Chemical Equilibrium IV</a></li>
<li class="toctree-l2"><a class="reference internal" href="587-N09.html">Passing Extra Parameters in Python</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jqbond/CEN587/main?urlpath=tree/Notebooks/587-N03.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jqbond/CEN587" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jqbond/CEN587/issues/new?title=Issue%20on%20page%20%2FNotebooks/587-N03.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Notebooks/587-N03.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Solving Algebraic Equations</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-methods">Numerical Methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topics-covered">Topics Covered</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-01">Problem 01</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-closed-form-exact-analytical-solution">A Closed Form (Exact Analytical) Solution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-graphical-solution">A Graphical Solution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#guess-and-check-a-brute-force-numerical-method">Guess and Check: A Brute Force Numerical Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#newton-raphson-method">Newton-Raphson Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-robust-tools-are-available-in-python-scipy">More Robust Tools are available in Python (scipy)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-02">Problem 02</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-problem-02">Solution to Problem 02</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-3">Problem 3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-problem-03">Solution to Problem 03</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#surface-plots">Surface Plots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#overlaid-surface-plots">Overlaid Surface Plots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#contour-plots">Contour Plots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#overlay-contour-plots">Overlay Contour Plots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#adjusting-contour-plot-options">Adjusting Contour Plot Options</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-with-scipy-optimize-root">Solving with <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-04">Problem 04</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-problem-04">Solution to Problem 04</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-of-nonlinear-equation-solvers">Stability of Nonlinear Equation Solvers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-guess-sensitivity-and-nan-errors-in-problem-04">Initial Guess Sensitivity and NaN errors in Problem 04</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#an-extreme-example-of-instability-with-the-newton-raphson-iteration">An Extreme Example of instability with the Newton-Raphson Iteration</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="solving-algebraic-equations">
<h1>Solving Algebraic Equations<a class="headerlink" href="#solving-algebraic-equations" title="Link to this heading">#</a></h1>
<p>These exercises cover the basic ideas behind numerical methods for solving algebraic equations. For more detail on these concepts and how they are implemented in Python, please reference <strong>Supplements 09 - 14</strong>.</p>
<section id="numerical-methods">
<h2>Numerical Methods<a class="headerlink" href="#numerical-methods" title="Link to this heading">#</a></h2>
<p>Your mathematics and introductory engineering courses have given you a lot of problems that you were able to solve by hand (i.e., analytically) to obtain closed-form solutions using pencil-and-paper and, at most, a calculator. This is not generally the case in engineering practice, especially in reactor design.</p>
<p>We frequently have to solve equations or sets of equations that have no tractable analytical solution. These are usually, at best, tedious to solve by hand and, at worst, impossible to solve by hand. In these cases, we have to rely on numerical methods, which provide an approximation of the true solution. We will use numerical methods extensively in this course. so we will introduce a few of the key tools for solving various types of equations in this notebook, and then we’ll get a lot of practice with them for the rest of the semester. Here, we will cover the basics of solving <em><strong>algebraic equations</strong></em> analytically, graphically, and using numerical methods. We will use these tools for solving problems in <em><strong>Chemical Equilibrium</strong></em> and <em><strong>Reactor Design</strong></em>.</p>
</section>
<section id="topics-covered">
<h2>Topics Covered<a class="headerlink" href="#topics-covered" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Basic principles of root finding</p></li>
<li><p>Graphical root finding in 2D and 3D</p></li>
<li><p>Numerical methods for root finding (Iterative approaches, Newton-Raphson method)</p></li>
<li><p>Scipy package; <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code></p></li>
<li><p>Solution of algebraic equations with <code class="docutils literal notranslate"><span class="pre">optimize.newton()</span></code> (root finding for univariate functions).</p></li>
<li><p>Solving systems of nonlinear algebraic equations with <code class="docutils literal notranslate"><span class="pre">optimize.root</span></code> (root finding for multivariate functions).</p></li>
<li><p>The importance of initial guesses; strategies for providing good initial guesses to Equations solvers.</p></li>
<li><p>Stability issues with iterative solvers.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># I usually import all packages in a single cell so that I can keep everything in one place</span>
<span class="c1"># These are all of the packages used in this notebook</span>
<span class="c1"># For teaching purposes, I&#39;ll add packages as we need them throughout the notebook</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">optimize</span> <span class="k">as</span> <span class="n">opt</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="problem-01">
<h2>Problem 01<a class="headerlink" href="#problem-01" title="Link to this heading">#</a></h2>
<p>Imagine we have an algebraic equation that we want to solve.  In this case, we’ll consider a simple function:</p>
<div class="math notranslate nohighlight">
\[f(x) = x^2 - 10x - 25\]</div>
<p>We want to find the root of that function, i.e., we want to find the value of <span class="math notranslate nohighlight">\(x\)</span> where <span class="math notranslate nohighlight">\(f(x) = 0\)</span>.  So, with root finding, we are trying to solve for the value of <span class="math notranslate nohighlight">\(x\)</span> that satisfies the equation below:</p>
<div class="math notranslate nohighlight">
\[0 = x^2 - 10x - 25\]</div>
<section id="a-closed-form-exact-analytical-solution">
<h3>A Closed Form (Exact Analytical) Solution<a class="headerlink" href="#a-closed-form-exact-analytical-solution" title="Link to this heading">#</a></h3>
<p>This is pretty easy to solve–that is intentional. When you first test out numerical methods (which give approximate solutions), it is very helpful to know the correct answer so that you can make sure your numerical methods are working properly. In this case, I would just use the quadratic formula if I needed an exact solution:</p>
<div class="math notranslate nohighlight">
\[ x = -b \pm \frac{\sqrt{\left(b^2 - 4ac\right)}}{2a}\]</div>
<p>If we do that, we find that there are two solutions to this equation (two roots of the function):</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    x &amp;= 12.07107 \\
    x &amp;= -2.07107
\end{align*}\]</div>
<p>But what if we had no idea how to solve the problem?  There are a number of things we might try.  First, if it is possible, I like to graph the function on the relevant domain. For univariate problems like this one, it is easy and illustrative to do this.</p>
</section>
<section id="a-graphical-solution">
<h3>A Graphical Solution<a class="headerlink" href="#a-graphical-solution" title="Link to this heading">#</a></h3>
<p>In the cell below, we plot the function of interest on a domain (set of <span class="math notranslate nohighlight">\(x\)</span> values) of <span class="math notranslate nohighlight">\(x = [-20, 20]\)</span>. Roots are where the function crosses the x-axis (i.e., where <span class="math notranslate nohighlight">\(y = 0\)</span>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For graphing, we&#39;ll import pyplot.  </span>
<span class="c1"># Numpy is also useful here; it lets us create array and perform elementwise calculations</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We need to tell Python that f(x) = x^2 - 10x - 25 </span>
<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">25</span>
    <span class="k">return</span> <span class="n">y</span>

<span class="c1"># This creates a set of 100 x values between -20 and 20.</span>
<span class="n">xplot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="c1"># print(xplot)</span>

<span class="c1"># This creates and displays a plot of f(x) vs. x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xplot</span><span class="p">))</span>

<span class="c1"># Add formatting to figure to suit your specific needs and make a more informative figure.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1">#limits on x axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="c1">#set x-ticks manually</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span> <span class="c1">#add x axis label at font size of 14 pt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1">#set limits on y axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span> <span class="c1">#set tickmarks on y axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span> <span class="c1">#add lable on y axis at 14 pt font</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="c1">#horizontal line at y =0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="o">-</span><span class="mf">2.07107</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;dotted&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span> <span class="c1">#vertical line at root 1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">12.07107</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;dotted&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span> <span class="c1">#vertical line at root 2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1">#display current figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/748147209e64726f9555b926ab3d857570743c788a7268311a48df1ad9599d1b.png" src="../_images/748147209e64726f9555b926ab3d857570743c788a7268311a48df1ad9599d1b.png" />
</div>
</div>
<p>From this, we can see there is one root near <span class="math notranslate nohighlight">\(x = -2\)</span>, and there is another root near <span class="math notranslate nohighlight">\(x = 12\)</span>. This is consistent with our quadratic formula solution. Graphing isn’t the most precise method, but it allows us to very quickly identify the rough location of roots, so it is extremely useful. Beyond this (assuming we cannot solve the problem analytically), we have to rely on numerical methods, which are usually iterative in nature. This means that we make a guess at the solution, we check the answer to see how close we are to zero, and then we change our guess based on how close we are to zero.  The hope is that we move steadily toward the solution as we continue to revise our guesses.</p>
</section>
<section id="guess-and-check-a-brute-force-numerical-method">
<h3>Guess and Check: A Brute Force Numerical Method<a class="headerlink" href="#guess-and-check-a-brute-force-numerical-method" title="Link to this heading">#</a></h3>
<p>The most basic example is an iterative guess-and-check strategy. We literally make a guess and keep changing it until we get close enough to our solution.  “Close enough” is the tolerance on our problem solution, and it depends on the level of precision we need in a particular problem. This is implemented in the cell below, where we repeatedly pass values of x to our function f(x) until it returns a value that is sufficiently close to zero for our satisfaction…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">))</span>    <span class="c1">#gives 175</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>     <span class="c1">#gives -25.  There is at least one root between -10 and 10 since I crossed the x-axis.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span>     <span class="c1">#gives 50....There is at least one root between 10 and -5 sice I crossed x again</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">))</span>     <span class="c1">#gives 94....that move was away from the root</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>     <span class="c1">#gives 14....relative to -5, that moves me toward the root</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>     <span class="c1">#gives -14...the root is somewhere between -1 and -3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>     <span class="c1">#gives -1...close, but not quite there</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">))</span>   <span class="c1">#gives 6.25...too far</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mf">2.1</span><span class="p">))</span>   <span class="c1">#gives 0.4...root must be between -2 and -2.1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mf">2.05</span><span class="p">))</span>  <span class="c1">#gives -.29...root is between -2.05 and -2.1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mf">2.075</span><span class="p">))</span> <span class="c1">#gives 0.0556...root must be between -2.05 and -2.075</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mf">2.07</span><span class="p">))</span>  <span class="c1">#gives -0.015...close enough.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>175
-25
50
94
14
-14
-1
6.25
0.41000000000000014
-0.29749999999999943
0.05562499999999915
-0.015100000000000335
</pre></div>
</div>
</div>
</div>
<p>Although it is intuitive, guess and check is an inefficient way to solve this problem.  It requires me to inspect each solution and make decisions about my next guess. Although I can generally find the root of a simple univarate funtion like f(x) above, it is always tedious. Further, it is almost impossible to solve systems of nonlinear equations using a guess and check method. Generally speaking, it is preferable to use a formal numerical method to solve algebraic equations. These approaches are usually still iterative in nature, they just use more sophisticated mathematics to update guesses.  One of the most straightforward of these approaches is the Newton-Raphson method</p>
</section>
<section id="newton-raphson-method">
<h3>Newton-Raphson Method<a class="headerlink" href="#newton-raphson-method" title="Link to this heading">#</a></h3>
<p>As an example, we’ll implement a Newton-Raphson iteration to solve this problem.  The Newton-Raphson iteration is much better than what we did above because it uses information about both the function value and its derivative to update guesses automatically.  The formula for the Newton-Raphson iteration is this:</p>
<div class="math notranslate nohighlight">
\[x_{i+1} = x_i - \frac{f(x_i)}{f^\prime(x_i)}\]</div>
<p>We make an initial guess, <span class="math notranslate nohighlight">\(x_i\)</span>, then we update that guess by subtracting the ratio of the function value at <span class="math notranslate nohighlight">\(x_i\)</span>, <span class="math notranslate nohighlight">\(f(x_i)\)</span>, to its derivative at <span class="math notranslate nohighlight">\(x_i\)</span>, <span class="math notranslate nohighlight">\(f^\prime(x_i)\)</span>. The sign of the function value and the derivative of the function value ensure that guesses are updated in a fashion that moves them toward the root location.</p>
<p>A basic Newton-Raphson iteration is implemented in the cell below. The first few iterations are performed manually, and then we see how to automate the process with a while loop, which will continue to iterate until our specified criteria are met. You can see how quickly it converges for this simple example.  This is much, much better than a simple guess and check strategy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We need to create functions for f(x) and f&#39;(x); we do this with lambda functions here</span>
<span class="n">x0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
<span class="n">f</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">25</span> <span class="c1">#telling Python  f(x) = x^2 - 10x - 25</span>
<span class="n">df</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span>  <span class="o">-</span> <span class="mi">10</span>        <span class="c1">#telling Python df(x) = 2x - 10 </span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The value of                      x = </span><span class="si">{</span><span class="n">x0</span><span class="si">:</span><span class="s1">3d</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The value of the function      at x = </span><span class="si">{</span><span class="n">x0</span><span class="si">:</span><span class="s1">3d</span><span class="si">}</span><span class="s1"> is </span><span class="si">{</span><span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span><span class="si">:</span><span class="s1">3.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1">#These are formatting string literals! Useful!!</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The derivative of the function at x = </span><span class="si">{</span><span class="n">x0</span><span class="si">:</span><span class="s1">3d</span><span class="si">}</span><span class="s1"> is </span><span class="si">{</span><span class="n">df</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span><span class="si">:</span><span class="s1">3.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># manual illustration of the first few iterations</span>
<span class="n">x1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x1</span><span class="si">:</span><span class="s1">7.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">df</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="si">:</span><span class="s1">7.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">df</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x2</span><span class="si">:</span><span class="s1">7.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">f</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">df</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span><span class="si">:</span><span class="s1">7.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span><span class="o">/</span><span class="n">df</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x3</span><span class="si">:</span><span class="s1">7.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">f</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">df</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span><span class="si">:</span><span class="s1">7.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">x4</span> <span class="o">=</span> <span class="n">x3</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span><span class="o">/</span><span class="n">df</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x4</span><span class="si">:</span><span class="s1">7.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">f</span><span class="p">(</span><span class="n">x4</span><span class="p">)</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">df</span><span class="p">(</span><span class="n">x4</span><span class="p">)</span><span class="si">:</span><span class="s1">7.3f</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># run a while loop until the NR iteration converges to within 1e-3 of zero.</span>
<span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">14.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">:</span><span class="s1">14.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># time.sleep(2)</span>
<span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1e-1</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">14.7f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">:</span><span class="s1">14.7f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># time.sleep(2)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Loop is finished!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>175
-30
The value of                      x = -10
The value of the function      at x = -10 is 175.00
The derivative of the function at x = -10 is -30.00
-10.000,  175.000, -30.000
 -4.167,   34.028, -18.333
 -2.311,    3.445, -14.621
 -2.075,    0.056, -14.150 

       -10.000,        175.000
    -4.1666667,     34.0277778
    -2.3106061,      3.4449610
    -2.0749921,      0.0555139

 Loop is finished!
</pre></div>
</div>
</div>
</div>
</section>
<section id="more-robust-tools-are-available-in-python-scipy">
<h3>More Robust Tools are available in Python (scipy)<a class="headerlink" href="#more-robust-tools-are-available-in-python-scipy" title="Link to this heading">#</a></h3>
<p>Instead of writing our own solvers, we should <em>generally</em> use the numerical methods packages that are available in whatever software we’re using. Under the hood, it’s basically the same thing, but the packages in Python are generally more robust against instabilities that you may encounter when using iterative methodds. If you’re using Python, the appropriate tools are found in the <code class="docutils literal notranslate"><span class="pre">optimize</span></code> module from the Scipy Package.</p>
<p>In the cell below, we illustrate how <code class="docutils literal notranslate"><span class="pre">scipy.opimize</span></code> works in practice. First, we import <code class="docutils literal notranslate"><span class="pre">optimize</span></code> and we alias it as <code class="docutils literal notranslate"><span class="pre">opt</span></code> just to make the syntax a little shorter and cleaner. Inside of <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code> or <code class="docutils literal notranslate"><span class="pre">opt</span></code> as we will call it hereafter, there are many solvers available.  These include the classic Newton-Raphson algorithm, among many others. As an example, we can use <code class="docutils literal notranslate"><span class="pre">opt.newton()</span></code> to find the root of the above function.  The syntax is really straightforward.  All we need to do is pass the function handle (it’s name) and an initial guess at the solution.  <code class="docutils literal notranslate"><span class="pre">opt.newton()</span></code> will handle the rest.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Despite the name, <code class="docutils literal notranslate"><span class="pre">opt.newton</span></code> actually uses a secant method by default.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">optimize</span> <span class="k">as</span> <span class="n">opt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P01</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">25</span> <span class="c1">#telling Python  P1(x) = x^2 - 10x - 25</span>
<span class="n">X0</span>  <span class="o">=</span> <span class="mi">10</span>
<span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">P01</span><span class="p">,</span> <span class="n">X0</span><span class="p">)</span>
<span class="n">sol01</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">P01</span><span class="p">,</span> <span class="n">X0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sol01</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P01</span><span class="p">(</span><span class="n">sol01</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The root of P01(x) with the current initial guess of X0 = </span><span class="si">{</span><span class="n">X0</span><span class="si">:</span><span class="s1">3.2f</span><span class="si">}</span><span class="s1"> is </span><span class="si">{</span><span class="n">sol01</span><span class="si">:</span><span class="s1">4.3f</span><span class="si">}</span><span class="s1">; P01(</span><span class="si">{</span><span class="n">sol01</span><span class="si">:</span><span class="s1">4.3f</span><span class="si">}</span><span class="s1">) = </span><span class="si">{</span><span class="n">P01</span><span class="p">(</span><span class="n">sol01</span><span class="p">)</span><span class="si">:</span><span class="s1">4.3E</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.071067811865474
-1.4210854715202004e-14
The root of P01(x) with the current initial guess of X0 = 10.00 is 12.071; P01(12.071) = -1.421E-14.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="problem-02">
<h2>Problem 02<a class="headerlink" href="#problem-02" title="Link to this heading">#</a></h2>
<p>Solve the following algebraic equation for the smallest positive root:</p>
<div class="math notranslate nohighlight">
\[x^3 - 10x + e^{-0.25x} = 35.75\]</div>
<section id="solution-to-problem-02">
<h3>Solution to Problem 02<a class="headerlink" href="#solution-to-problem-02" title="Link to this heading">#</a></h3>
<p>As we’ve discussed, if it is easy for me to graph a function, I usually do so because I need a good initial guess of the root location when I use numerical methods.  Graphing makes it very easy to see where the roots are. I’ll plot this below by creating a <strong>lambda</strong> function.  I am using a lambda function because this is a very simple expression.  Specifically, I am going to create a function of the form:</p>
<div class="math notranslate nohighlight">
\[f(x) = x^3 - 10x + \exp{(-0.25x)} - 35.75\]</div>
<p>Why do I write it that way?  Because I want to figure out where the function, <span class="math notranslate nohighlight">\(f(x)\)</span>, equals zero.  So in that form, I can graph the function and look for any places where <span class="math notranslate nohighlight">\(f(x)\)</span> crosses the x axis.  Those are the places where f(x) = 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># creating the function with lambda syntax</span>
<span class="n">P02</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mf">35.75</span> <span class="c1">#translates to p1(x) = x^3 - 10x + exp(-0.25x) - 35.75</span>

<span class="c1"># I&#39;ll plot it from x = -50 to x = 50; create the set of x values as np.array using linspace.</span>
<span class="n">xspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># plot the function value for every value in xspan.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xspan</span><span class="p">,</span> <span class="n">P02</span><span class="p">(</span><span class="n">xspan</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="c1"># plt.xticks(range(-10, 11, 1))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8250577ff945393a3b0d70a6dee9663b111fc77fe67ae8d61b34d8f62c27e79e.png" src="../_images/8250577ff945393a3b0d70a6dee9663b111fc77fe67ae8d61b34d8f62c27e79e.png" />
</div>
</div>
<p>We can see clearly that it crosses the x-axis in two places (this remains true even if we zoom out much further).  There is a root at about -45 and another at about 5.  We want the “smallest positive root” according to the problem statement, so we want to look around x = 5 for a root.</p>
<p>Unlike the first example problem, I do not have an easy way to solve this nonlinear equation analytically. I will therefore use a numerical method – specifically, I will use solver from <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code> that is designed to find the roots of univariate functions (functions that have only one argument). <code class="docutils literal notranslate"><span class="pre">opt.newton</span></code> is usually a fine choice here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol02</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">P02</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c1">#opt.newton needs our function name and an initial guess.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sol02</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P02</span><span class="p">(</span><span class="n">sol02</span><span class="p">))</span>

<span class="c1"># For a more complete picture of the solution, uncomment code below.</span>
<span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">P02</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">full_output</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">sol02</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">P02</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">full_output</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sol02</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">converged</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">iterations</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">sol02</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">converged</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">P02</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">root</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">flag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.275631645416588
-1.5702994460298214e-12
4.275631645416588 

      converged: True
           flag: converged
 function_calls: 6
     iterations: 5
           root: 4.275631645416588
         method: secant
True
5
 4.275631645416588 
 True 
 -1.5702994460298214e-12 
 converged
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="problem-3">
<h2>Problem 3<a class="headerlink" href="#problem-3" title="Link to this heading">#</a></h2>
<p>Find all roots for the following system of equations. Search only on the domain <span class="math notranslate nohighlight">\(x = [-10, 10]\)</span> and <span class="math notranslate nohighlight">\(y = [-10, 10]\)</span>.</p>
<div class="amsmath math notranslate nohighlight" id="equation-e14372e1-2460-4f9a-a16f-b2d37cb6342d">
<span class="eqno">(2)<a class="headerlink" href="#equation-e14372e1-2460-4f9a-a16f-b2d37cb6342d" title="Permalink to this equation">#</a></span>\[\begin{align}
     10 &amp;= 5x^2y - y^3\\
    -(15y+x) &amp;= 2y^2 + \textrm{tanh}(0.075x)\\
\end{align}\]</div>
<section id="solution-to-problem-03">
<h3>Solution to Problem 03<a class="headerlink" href="#solution-to-problem-03" title="Link to this heading">#</a></h3>
<p>This is a system of nonlinear equations, and even adding a second equation, we see that things get more complicated.  We do not have a solution until we find the <span class="math notranslate nohighlight">\((x,y)\)</span> pairs where both of the equations are solved.  We are essentially looking for the roots of the following two functions with this problem:</p>
<div class="amsmath math notranslate nohighlight" id="equation-301b60db-44f7-4c5c-b71b-630444948664">
<span class="eqno">(3)<a class="headerlink" href="#equation-301b60db-44f7-4c5c-b71b-630444948664" title="Permalink to this equation">#</a></span>\[\begin{align}
    f_1(x, y) &amp;= 5x^2y - y^3 - 10 \\
    f_2(x, y) &amp;= 2y^2 + \tanh{(0.075x)} + 15y + x\\
\end{align}\]</div>
<p>We have solved our problem when we find the values <span class="math notranslate nohighlight">\(\hat{x}\)</span> and <span class="math notranslate nohighlight">\(\hat{y}\)</span> that give the following result:</p>
<div class="amsmath math notranslate nohighlight" id="equation-b162f6d1-6574-49f1-95cc-39093dc40e44">
<span class="eqno">(4)<a class="headerlink" href="#equation-b162f6d1-6574-49f1-95cc-39093dc40e44" title="Permalink to this equation">#</a></span>\[\begin{align}
    f_1(\hat{x}, \hat{y}) &amp;= 0 \\
    f_2(\hat{x}, \hat{y}) &amp;= 0 \\
\end{align}\]</div>
<p>I would love to be able to assess the problem graphically because that helps me to see axis crossings, but here, we have to work in 3-dimensions.  For every <span class="math notranslate nohighlight">\((x,y)\)</span> pair that we give to each function, it will return a “z” value in a third dimension…so this is harder to visualize. Both functions describe surfaces, not lines, and we need to find the <span class="math notranslate nohighlight">\((x, y)\)</span> points where both surfaces are equal to zero.</p>
<p>But, let’s give it a try and see what we can come up with.  This is definitely <strong>not</strong> an essential step in solving this problem, but it serves a few purposes:</p>
<ol class="arabic simple">
<li><p>It gives us extra practice with graphing</p></li>
<li><p>It illustrates visually what root finding for systems of equations entails</p></li>
</ol>
<p>First, let’s create two functions that take (x,y) argument pairs and return the values of <span class="math notranslate nohighlight">\(f_1(x,y)\)</span> and <span class="math notranslate nohighlight">\(f_2(x,y)\)</span>.  We can again use <code class="docutils literal notranslate"><span class="pre">lambda</span></code> syntax here because these are easy one-liners.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">y</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">10</span>
<span class="n">f2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="mf">0.075</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<section id="surface-plots">
<h4>Surface Plots<a class="headerlink" href="#surface-plots" title="Link to this heading">#</a></h4>
<p>We have to visualize these functions in 3D, so our options are surface plots (“actual” 3D illustration) or contour plots (a 2D representation of a 3D surface using contour lines).  Let’s start with the surfaces.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="n">Z1</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="c1">#values of the left-hand side of f1 for all X,Y pairs</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">f2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="c1">#values of the left-hand side of f2 for all X,Y pairs.</span>

<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;3d&quot;</span><span class="p">})</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;f1(x,y)&#39;</span><span class="p">)</span>

<span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;3d&quot;</span><span class="p">})</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;f2(x,y)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a5f17403dc68d90627918adb8104531720f7e3bf17aee3401c5ee68ec4a11152.png" src="../_images/a5f17403dc68d90627918adb8104531720f7e3bf17aee3401c5ee68ec4a11152.png" />
<img alt="../_images/65e83407ce5ca83dcaaecb33b3d85ab4fb3819417824c07cb8a2b8510340ac5f.png" src="../_images/65e83407ce5ca83dcaaecb33b3d85ab4fb3819417824c07cb8a2b8510340ac5f.png" />
</div>
</div>
<p>So, that’s fine?  I guess?  It doesn’t really help me much, though.  What I need to find are the places where <em>both</em> surfaces intersect at values of zero, and that is almost impossible to determine from these 3D projections.</p>
</section>
<section id="overlaid-surface-plots">
<h4>Overlaid Surface Plots<a class="headerlink" href="#overlaid-surface-plots" title="Link to this heading">#</a></h4>
<p>Maybe we can try to plot two surfaces on the same plot?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;3d&quot;</span><span class="p">})</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;f1 and f2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ce00ccb0610ad3666b3b1553a3a964d56adea25f196ab09a97aeac7cf47cae02.png" src="../_images/ce00ccb0610ad3666b3b1553a3a964d56adea25f196ab09a97aeac7cf47cae02.png" />
</div>
</div>
<p>Nope.  Not helpful.  I cannot really pin down any of locations of the roots using this.  Maybe contour plots?</p>
</section>
<section id="contour-plots">
<h4>Contour Plots<a class="headerlink" href="#contour-plots" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z1</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span> <span class="c1">#note, levels = scalar tells us how many contour lines to use.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cafa51b4f55fe12305df9a7c79b4f0716f49713b295611c60d698aabe424687a.png" src="../_images/cafa51b4f55fe12305df9a7c79b4f0716f49713b295611c60d698aabe424687a.png" />
<img alt="../_images/9a2ff195e99e07d9f8f74abc02f51844b71f84b09bc0942b2791c630027b985e.png" src="../_images/9a2ff195e99e07d9f8f74abc02f51844b71f84b09bc0942b2791c630027b985e.png" />
</div>
</div>
<p>Actually, this gives me a much clearer view of where the functions are near zero.  From the first plot, we can see that <span class="math notranslate nohighlight">\(f_1(x,y)\)</span> is close to zero toward the center of the plot, and then as we move to large X and Y values, we see that the function gets either very positive or very negative.  In the second case, we see that <span class="math notranslate nohighlight">\(f_2(x,y)\)</span> is close to zero over a fairly broad space between y = 3 and -7 or so…and x = -10 to 10.</p>
</section>
<section id="overlay-contour-plots">
<h4>Overlay Contour Plots<a class="headerlink" href="#overlay-contour-plots" title="Link to this heading">#</a></h4>
<p>If we put the above onto a single plot, it is a mess:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z1</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span> <span class="c1">#note, levels = scalar tells us how many contour lines to use.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8bedea0d200b9e012904c158cb1591aff559c72d00ba7d260f4ab3eb4c2ffbd5.png" src="../_images/8bedea0d200b9e012904c158cb1591aff559c72d00ba7d260f4ab3eb4c2ffbd5.png" />
</div>
</div>
</section>
<section id="adjusting-contour-plot-options">
<h4>Adjusting Contour Plot Options<a class="headerlink" href="#adjusting-contour-plot-options" title="Link to this heading">#</a></h4>
<p>It is very difficult to interpret this figure.  There is too much going on, and I can’t identify where the intersections are where both <span class="math notranslate nohighlight">\(f_1(x,y)\)</span> and <span class="math notranslate nohighlight">\(f_2(x,y)\)</span> are near zero.  However, we can also use the level keyword argument to specify a range of contour lines…sort of like applying limits to the z axis.  I can also set the colors of contour lines to various things. Here, I’ll show the contour lines for the first function in red and the second function in blue.  We will also only show the contours between -0.01 and 0.01 because these will bound any areas where the functions are zero pretty well.  With this, we can see clearly where both functions are zero(ish)–this is indicated by the lines on the contour plot below.</p>
<p><strong>This is showing us where the two surfaces intersect at values of 0</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="n">Z1</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="c1">#values of the left-hand side of f1 for all X,Y pairs</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">f2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="c1">#values of the left-hand side of f2 for all X,Y pairs.</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z1</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">colors</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>  <span class="c1">#function 1 in red</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">colors</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span> <span class="c1">#function 2 in blue</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fc6fbb56403971b0cf9f5fa81d1db60ee27afee02c1496e14d8ec0485576d155.png" src="../_images/fc6fbb56403971b0cf9f5fa81d1db60ee27afee02c1496e14d8ec0485576d155.png" />
</div>
</div>
<p>Now that makes it very clear that I have 3 roots on the domain <span class="math notranslate nohighlight">\((X, Y) = [-10, 10]\)</span>.  Specifically, they are somewhere around:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\((-3, -8)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((3, -8)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((-3, 0)\)</span></p></li>
</ol>
<p>Now that I know this, I have a pretty good idea of initial guesses to make for x and y with my iterative solver routine.</p>
</section>
<section id="solving-with-scipy-optimize-root">
<h4>Solving with <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root()</span></code><a class="headerlink" href="#solving-with-scipy-optimize-root" title="Link to this heading">#</a></h4>
<p>For a system of nonlinear equations, we can’t use <code class="docutils literal notranslate"><span class="pre">opt.newton()</span></code> – it only works on univariate functions.  Here, we need to solve functions that have two arguments, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. We’ll need to use <code class="docutils literal notranslate"><span class="pre">opt.root()</span></code> instead. This is a place where Python is picky about syntax.  We have to construct a function that models our system of equations…there are two rules we need to follow:</p>
<ol class="arabic simple">
<li><p>This function must take a single argument that contains all of the unknowns in a collection (list, array, tuple, etc.). In this example, we have to pass <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> in a single collection.</p></li>
<li><p>This function must return the values of all of the equations we’re solving for a given set of argument values–this must be done in a collection (list, array, tuple, etc.). In this example, our function must return the values of (<span class="math notranslate nohighlight">\(f_1(x,y)\)</span> and <span class="math notranslate nohighlight">\(f_2(x,y)\)</span>) for a given <span class="math notranslate nohighlight">\((x^\prime,y^\prime)\)</span> pair).</p></li>
</ol>
<p>Here, the problem is complicated enough that lambda functions lose their charm.  We’ll specify with a general function definition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">P03</span><span class="p">(</span><span class="n">var</span><span class="p">):</span> <span class="c1"># var = [x, y]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># print([x, y])</span>
    <span class="n">LHS1</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">3</span>  <span class="c1">#this is function 1, solution at LHS1 = 0</span>
    <span class="n">LHS2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="mf">0.075</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span>  <span class="c1">#this is function 2, solution at LHS2 = 0</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">LHS1</span><span class="p">,</span> <span class="n">LHS2</span><span class="p">]</span> <span class="c1">#return the value of f1 and f2 at current (x,y) values; I&#39;m using a list.</span>
</pre></div>
</div>
</div>
</div>
<p>Once we have that function defined in that particular format, then we can use <code class="docutils literal notranslate"><span class="pre">opt.root()</span></code> to solve it.  All it needs from us is the function name and an initial guess at the solution.  We have some pretty good ideas from the contour plot.</p>
<p><code class="docutils literal notranslate"><span class="pre">opt.root()</span></code> will return a “solution structure” that has a ton of information in it.  I’ll call this <code class="docutils literal notranslate"><span class="pre">sol03</span></code> below, and we’ll print the important fields from that solution:</p>
<ol class="arabic simple">
<li><p>The solution (<code class="docutils literal notranslate"><span class="pre">sol03.x</span></code>); this is our “answer to the problem”</p></li>
<li><p>The function value at the solution (<code class="docutils literal notranslate"><span class="pre">sol03.fun</span></code>); array of function values at solution; should all be zeros.</p></li>
<li><p>The message that tells us whether the solver converged or not (<code class="docutils literal notranslate"><span class="pre">sol03.message</span></code>)</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var0</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">]</span> <span class="c1">#I&#39;m passing the initial guesses as a list; these unpack as x0 and y0 in the function</span>
<span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">P03</span><span class="p">,</span> <span class="n">var0</span><span class="p">)</span>
<span class="n">sol03</span>  <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">P03</span><span class="p">,</span> <span class="n">var0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">sol03</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sol03</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">P03</span><span class="p">(</span><span class="n">sol03</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sol03</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [-3.42272248 -7.73741349] 
 [ 9.66338121e-12 -6.21724894e-13] 
 [np.float64(9.663381206337363e-12), np.float64(-6.217248937900877e-13)] 
 The solution converged.
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="problem-04">
<h2>Problem 04<a class="headerlink" href="#problem-04" title="Link to this heading">#</a></h2>
<p>Solve the following system of nonlinear equations:</p>
<div class="amsmath math notranslate nohighlight" id="equation-5d6838eb-529f-460b-be75-6e8f1de66407">
<span class="eqno">(5)<a class="headerlink" href="#equation-5d6838eb-529f-460b-be75-6e8f1de66407" title="Permalink to this equation">#</a></span>\[\begin{align}
    0 &amp;= x^2 - 10x - 25y + 17z^2\\
    18.3 &amp;= xz + \textrm{ln}(yz)\\
    145 - y^2 &amp;= x^2 + 5z\\
\end{align}\]</div>
<section id="solution-to-problem-04">
<h3>Solution to Problem 04<a class="headerlink" href="#solution-to-problem-04" title="Link to this heading">#</a></h3>
<p>Once you get the hang of formatting equations so that they are compatible with <code class="docutils literal notranslate"><span class="pre">opt.root()</span></code>, this is straightforward.  See below, and compare it to above. Think about how logically similar the two code cells are.  This one is a little bigger and a little more complex because I have 3 variables and 3 functions, but otherwise, everything is identical.  This is a super easy concept to generalize, and I can solve any number of equations in this way using <code class="docutils literal notranslate"><span class="pre">opt.root()</span></code>!!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">P04</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">LHS1</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">25</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">LHS2</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="mf">18.3</span>
    <span class="n">LHS3</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">145</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">LHS1</span><span class="p">,</span> <span class="n">LHS2</span><span class="p">,</span> <span class="n">LHS3</span><span class="p">]</span> <span class="c1">#using a list, this is my choice.</span>

<span class="n">var0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">sol04</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">P04</span><span class="p">,</span> <span class="n">var0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">sol04</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sol04</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">P04</span><span class="p">(</span><span class="n">sol04</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sol04</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [ 3.53330097 10.58103531  4.1114952 ] 
 [-2.97717406e-09 -9.44535117e-10 -2.59575472e-09] 
 [np.float64(-2.9771740628348198e-09), np.float64(-9.445351167869376e-10), np.float64(-2.595754722278798e-09)] 
 The solution converged.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="stability-of-nonlinear-equation-solvers">
<h2>Stability of Nonlinear Equation Solvers<a class="headerlink" href="#stability-of-nonlinear-equation-solvers" title="Link to this heading">#</a></h2>
<section id="initial-guess-sensitivity-and-nan-errors-in-problem-04">
<h3>Initial Guess Sensitivity and NaN errors in Problem 04<a class="headerlink" href="#initial-guess-sensitivity-and-nan-errors-in-problem-04" title="Link to this heading">#</a></h3>
<p>Although tools like <code class="docutils literal notranslate"><span class="pre">opt.newton</span></code> and <code class="docutils literal notranslate"><span class="pre">opt.root</span></code> are very easy to use, numerical solution of algebraic equations can be very tricky.  As a rule of thumb, the more equations that you are solving, and the more nonlinear these equations are, the more challening the numerical solution will be.  Usually, you need good-to-great initial guesses in order to solve difficult systems on nonlinear equations with numerical tools.</p>
<p>Below, we demonstrate how certain initial guesses would cause the solver to go off the rails.  This problem is hard because visualizing it would require us to work in 4 dimensions since we have <span class="math notranslate nohighlight">\(f1(x, y, z)\)</span>, etc.  So providing good initial guesses can be tricky.</p>
<p>In a physical system, we usually have limits on the variables that I can use to provide a better guess.  For example, fractional conversions and mole fractions are between 0 and 1; absolute temperatures can’t be less than zero; a temperature of 8000C is unrealistic in a chemical process; a pressure of 50000000 atm is unrealistic in a chemical process, etc.</p>
<p>Here, it’s just a math problem, so we have no idea how to bound x, y, and z without putting in a bit of effort (not a topic for this course).</p>
<p>Anyway, we can show that an initial guess of:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>var0 = [5, -5, -5]
</pre></div>
</div>
<p>Will cause the solver to issue a warning since it ends up passing a negative value to the logarithm in the second equation, which is undefined (notice that it still converges, though.  It gets around the nan (“not a number”) error here).  Astute readers will point out that <span class="math notranslate nohighlight">\(-5*-5 = 25\)</span>, so the negative signs should cancel, allowing us to evaluate the natural logarithm.  This is true at the start, but, remember, these are iterative processes.  We make initial guesses, and those guesses bias our solutions.  Just because the solver starts out with x and y both negative (and with a positive product), it won’t necessarily stay here.  We demonstrate this in the cell below.  You can see that it hits places where only one of the two is negative; hence the error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">P4_stability</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># print(f&#39;current values in iteration are x = {x}, y = {y}, z = {z}&#39;)</span>
    <span class="n">LHS1</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">25</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">LHS2</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="mf">18.3</span>
    <span class="n">LHS3</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">145</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">LHS1</span><span class="p">,</span> <span class="n">LHS2</span><span class="p">,</span> <span class="n">LHS3</span><span class="p">])</span>

<span class="n">var0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">P4_stability</span><span class="p">,</span> <span class="n">var0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sol</span><span class="p">)</span>
<span class="c1"># print(&#39;&#39;, sol.x, &#39;\n&#39;, sol.fun, &#39;\n&#39;, P4_stability(sol.x), &#39;\n&#39;, sol.message)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  message: The solution converged.
 success: True
  status: 1
     fun: [-7.933e-11 -2.799e-11 -1.437e-10]
       x: [ 1.152e+01  2.202e+00  1.486e+00]
  method: hybr
    nfev: 42
    fjac: [[-4.840e-01 -4.714e-02 -8.738e-01]
           [ 8.750e-01 -3.513e-02 -4.828e-01]
           [ 7.939e-03  9.983e-01 -5.825e-02]]
       r: [-2.414e+01  8.664e+00 -3.839e+01 -2.431e+01  4.270e+01
            1.312e+01]
     qtf: [-3.095e-07 -2.683e-09  3.799e-08]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\jqbon\AppData\Local\Temp\ipykernel_23332\3613340609.py:7: RuntimeWarning: invalid value encountered in log
  LHS2 = x*z + np.log(y*z) - 18.3
</pre></div>
</div>
</div>
</div>
</section>
<section id="an-extreme-example-of-instability-with-the-newton-raphson-iteration">
<h3>An Extreme Example of instability with the Newton-Raphson Iteration<a class="headerlink" href="#an-extreme-example-of-instability-with-the-newton-raphson-iteration" title="Link to this heading">#</a></h3>
<p>Although a Newton-Raphson iteration is very useful, it isn’t always guaranteed to converge.  In general, you’ll find this is true of algebraic solutions.  They can be flaky, and they are usually very sensitive to the initial guess that we make for the solution.  As the equations become increasingly nonlinear and difficult to solve, we will find we need very good initial guesses in order to get numerical methods to converge for algebraic equations. As an example, let’s consider the more difficult function:</p>
<div class="math notranslate nohighlight">
\[g(x) = -0.74 + 0.765x + 1.1x^2 - 3.55x^3\]</div>
<p>We’ll graph it and then run a Newton-Raphson iteration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span>   <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.74</span>  <span class="o">+</span> <span class="mf">0.765</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">3.55</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span>   <span class="c1">#g(x)</span>
<span class="n">dg</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>          <span class="mf">0.765</span>   <span class="o">+</span> <span class="mf">2.2</span><span class="o">*</span><span class="n">x</span>    <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="mf">3.55</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="c1">#g&#39;(x)</span>
<span class="n">ddg</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>                    <span class="mf">2.2</span>      <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mf">3.55</span><span class="o">*</span><span class="n">x</span>  <span class="c1">#g&#39;&#39;(x)</span>

<span class="n">xspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xspan</span><span class="p">,</span> <span class="n">g</span><span class="p">(</span><span class="n">xspan</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;g(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6081345343</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;dotted&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/94bbed1c10b5a2003be48197cb98d75db03ec9ce4a2ffdf2a4512017997c4cee.png" src="../_images/94bbed1c10b5a2003be48197cb98d75db03ec9ce4a2ffdf2a4512017997c4cee.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-6</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">dg</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">14.10</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">y</span><span class="si">:</span><span class="s1">14.10</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> -0.6346955796,       -0.40375
  -0.609247652,   0.1252435048
 -0.6081366095, 0.005031289919
 -0.6081345343, 9.362477129e-06
 -0.6081345343, 3.262889958e-11
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">############################################################################################################################</span>
<span class="c1"># This block of code will get stuck in an infinite loop; if you execute it, you&#39;ll need to interrupt the kernel to stop it #</span>
<span class="c1">############################################################################################################################</span>

<span class="c1"># x = 5/9</span>
<span class="c1"># y = g(x)</span>

<span class="c1"># while abs(y) &gt; 1e-6:</span>
<span class="c1">#     y = g(x)</span>
<span class="c1">#     x = x - g(x)/dg(x)</span>
<span class="c1">#     print(f&#39;{x:14.10}, {y:14.10}&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># no derivative information, opt.newton uses secant method</span>
<span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fprime</span> <span class="o">=</span> <span class="n">dg</span><span class="p">)</span> <span class="c1">#first derivative provided, opt.newton uses Newton-Raphson</span>
<span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fprime</span> <span class="o">=</span> <span class="n">dg</span><span class="p">,</span> <span class="n">fprime2</span> <span class="o">=</span> <span class="n">ddg</span><span class="p">)</span> <span class="c1">#first and second derivative provided, opt.newton uses Halley&#39;s Method</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(-0.6081345342894493)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">5</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span> <span class="c1"># no derivative information, opt.newton uses secant method</span>
<span class="c1"># opt.newton(g, 5/9, fprime = dg) #first derivative provided, opt.newton uses Newton-Raphson</span>
<span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">5</span><span class="o">/</span><span class="mi">9</span><span class="p">,</span> <span class="n">fprime</span> <span class="o">=</span> <span class="n">dg</span><span class="p">,</span> <span class="n">fprime2</span> <span class="o">=</span> <span class="n">ddg</span><span class="p">)</span> <span class="c1">#first and second derivative provided, opt.newton uses Halley&#39;s Method</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(-0.6081345342894493)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="587-N02.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Jupyter and Python</p>
      </div>
    </a>
    <a class="right-next"
       href="587-N04.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Extent and Conversion</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-methods">Numerical Methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topics-covered">Topics Covered</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-01">Problem 01</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-closed-form-exact-analytical-solution">A Closed Form (Exact Analytical) Solution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-graphical-solution">A Graphical Solution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#guess-and-check-a-brute-force-numerical-method">Guess and Check: A Brute Force Numerical Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#newton-raphson-method">Newton-Raphson Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-robust-tools-are-available-in-python-scipy">More Robust Tools are available in Python (scipy)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-02">Problem 02</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-problem-02">Solution to Problem 02</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-3">Problem 3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-problem-03">Solution to Problem 03</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#surface-plots">Surface Plots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#overlaid-surface-plots">Overlaid Surface Plots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#contour-plots">Contour Plots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#overlay-contour-plots">Overlay Contour Plots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#adjusting-contour-plot-options">Adjusting Contour Plot Options</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-with-scipy-optimize-root">Solving with <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-04">Problem 04</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-problem-04">Solution to Problem 04</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-of-nonlinear-equation-solvers">Stability of Nonlinear Equation Solvers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-guess-sensitivity-and-nan-errors-in-problem-04">Initial Guess Sensitivity and NaN errors in Problem 04</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#an-extreme-example-of-instability-with-the-newton-raphson-iteration">An Extreme Example of instability with the Newton-Raphson Iteration</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jesse Q. Bond, Syracuse University
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>