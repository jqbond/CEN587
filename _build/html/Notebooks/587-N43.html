
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Kinetics IV &#8212; Kinetics and Reaction Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Notebooks/587-N43';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Kinetics V" href="587-N44.html" />
    <link rel="prev" title="Kinetics IV" href="587-N42.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/JQB.png" class="logo__image only-light" alt="Kinetics and Reaction Engineering - Home"/>
    <script>document.write(`<img src="../_static/JQB.png" class="logo__image only-dark" alt="Kinetics and Reaction Engineering - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../Chapter2.html">Lectures</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="587-N42.html">Kinetics IV</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Kinetics IV</a></li>
<li class="toctree-l2"><a class="reference internal" href="587-N44.html">Kinetics V</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jqbond/CEN587/main?urlpath=tree/Notebooks/587-N43.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jqbond/CEN587" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jqbond/CEN587/issues/new?title=Issue%20on%20page%20%2FNotebooks/587-N43.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Notebooks/587-N43.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Kinetics IV</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-01-analysis-of-perfect-data">Example Problem 01: Analysis of Perfect Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-01">Solution to Example Problem 01</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimation-of-reaction-rates-in-a-cstr-at-steady-state">Estimation of reaction rates in a CSTR at Steady State</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression-on-perfect-data-generated-by-solving-material-balance">Linear Regression on Perfect Data (generated by solving material balance)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-02-analysis-of-slightly-more-realistic-data">Example Problem 02: Analysis of (Slightly) More Realistic Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression-on-data-rounded-to-instrument-precision">Linear Regression on Data Rounded to Instrument Precision</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-03-processing-noisy-data-simulating-a-real-experiment">Example 03: Processing Noisy Data (simulating a real experiment)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression-on-noisy-data">Linear Regression on Noisy Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-04-leveraging-product-concentrations-to-estimate-reaction-rate">Example Problem 04: Leveraging Product Concentrations to estimate reaction rate</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression-of-noisy-rates-based-on-product-concentration">Linear Regression of noisy rates based on product concentration</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-05">Example Problem 05</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-into-a-dataframe-with-pandas">Importing into a dataframe with pandas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-the-dataframe-to-a-numpy-array">Converting the dataframe to a numpy array</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-reaction-rates">Calculating Reaction Rates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-estimation">Parameter Estimation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-estimation-using-nonlinear-regression">Parameter Estimation Using Nonlinear Regression</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-parameters-using-multiple-linear-regression">Estimating Parameters using Multiple Linear Regression</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="kinetics-iv">
<h1>Kinetics IV<a class="headerlink" href="#kinetics-iv" title="Link to this heading">#</a></h1>
<p>Today, we’ll discuss analysis of kinetic data obtained in a CSTR.  We’ll consider the impacts of measurement error and how it can be managed, and we’ll also discuss strategies for extracing meaningful parameter estimates from a maddening set of data that were not obtained very systematically.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">opt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">ceil</span><span class="p">,</span> <span class="n">floor</span>
</pre></div>
</div>
</div>
</div>
<section id="example-problem-01-analysis-of-perfect-data">
<h2>Example Problem 01: Analysis of Perfect Data<a class="headerlink" href="#example-problem-01-analysis-of-perfect-data" title="Link to this heading">#</a></h2>
<p>The following reaction is carried out in a CSTR at steady state <span class="math notranslate nohighlight">\((V = 0.275\mathrm{L})\)</span>.  The experiment is performed by varying the inlet volumetric flowrate, <span class="math notranslate nohighlight">\(Q_f\)</span>, of a feed solution that has a concentration <span class="math notranslate nohighlight">\(C_{A_f} = 10 \ \mathrm{mol \ L^{-1}}\)</span>.  You may assume the fluid density is constant so that <span class="math notranslate nohighlight">\(Q = Q_f\)</span>.</p>
<div class="math notranslate nohighlight">
\[A \longrightarrow B\]</div>
<p>At each value of <span class="math notranslate nohighlight">\(Q_f\)</span>, you measure the concentration of species <span class="math notranslate nohighlight">\(A\)</span> and species <span class="math notranslate nohighlight">\(B\)</span> in the effluent stream. The data are stored as arrays in the code cell below. For now, we’ll look at essentially perfect data just to get a feel for the way that we handle the analysis without also dealing with precision and measurement uncertainty. Then, we will consider the impacts of precision and measurement uncertainty on our analysis.</p>
<p>You may assume that the reaction rate is described by power law kinetics:</p>
<div class="math notranslate nohighlight">
\[r = kC_A^{\alpha}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is an integer.</p>
<p>Please determine the reaction order in <span class="math notranslate nohighlight">\(A\)</span> and the rate constant for this reaction.</p>
<p><strong>Answer</strong>: <span class="math notranslate nohighlight">\(\alpha = 1\)</span>, <span class="math notranslate nohighlight">\(k = 0.023 \ \mathrm{s^{-1}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">########################################################################################################</span>
<span class="c1"># Define global constants                                                                              #</span>
<span class="c1">########################################################################################################</span>

<span class="n">V</span>      <span class="o">=</span> <span class="mf">0.275</span> <span class="c1">#L</span>
<span class="n">CAf</span>    <span class="o">=</span> <span class="mi">10</span>    <span class="c1">#mol/L</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Storing *nearly* exact CA and Qf values in numpy arrays -- I kept 11 decimal places in calculation   #</span>
<span class="c1">########################################################################################################</span>

<span class="n">Qftrue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.7500000000</span><span class="p">,</span> <span class="mf">0.5500000000</span><span class="p">,</span> <span class="mf">0.3666666667</span><span class="p">,</span> <span class="mf">0.2750000000</span><span class="p">,</span> <span class="mf">0.1375000000</span><span class="p">,</span> <span class="mf">0.0550000000</span><span class="p">,</span> <span class="mf">0.0275000000</span><span class="p">,</span> <span class="mf">0.0183333333</span><span class="p">,</span> <span class="mf">0.0137500000</span><span class="p">,</span> <span class="mf">0.0055000000</span><span class="p">,</span> <span class="mf">0.0027500000</span><span class="p">])</span> <span class="c1">#L/sec</span>
<span class="n">CAtrue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">9.9770527786</span><span class="p">,</span> <span class="mf">9.8863074642</span><span class="p">,</span> <span class="mf">9.8304251659</span><span class="p">,</span> <span class="mf">9.7751710655</span><span class="p">,</span> <span class="mf">9.5602294455</span><span class="p">,</span> <span class="mf">8.9686098655</span><span class="p">,</span> <span class="mf">8.1300813008</span><span class="p">,</span> <span class="mf">7.4349442379</span><span class="p">,</span> <span class="mf">6.8493150685</span><span class="p">,</span> <span class="mf">4.6511627907</span><span class="p">,</span> <span class="mf">3.0303030303</span><span class="p">])</span> <span class="c1">#mol/L</span>
<span class="n">CBtrue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0229472214</span><span class="p">,</span> <span class="mf">0.1136925358</span><span class="p">,</span> <span class="mf">0.1695748341</span><span class="p">,</span> <span class="mf">0.2248289345</span><span class="p">,</span> <span class="mf">0.4397705545</span><span class="p">,</span> <span class="mf">1.0313901345</span><span class="p">,</span> <span class="mf">1.8699186992</span><span class="p">,</span> <span class="mf">2.5650557655</span><span class="p">,</span> <span class="mf">3.1506849315</span><span class="p">,</span> <span class="mf">5.3488372093</span><span class="p">,</span> <span class="mf">6.9696969697</span><span class="p">])</span> <span class="c1">#mol/L </span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Scatterplot of raw data CA (exit) vs Qf                                                              #</span>
<span class="c1">########################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Qftrue</span><span class="p">,</span> <span class="n">CAtrue</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Qftrue</span><span class="p">,</span> <span class="n">CBtrue</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CB&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Effluent Concentrations in a CSTR&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Qf (L/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cj (M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8d78d7559a54b72c474cb94f62bf8eadd7d4229a0983cb2f7e351fd97317fcaf.png" src="../_images/8d78d7559a54b72c474cb94f62bf8eadd7d4229a0983cb2f7e351fd97317fcaf.png" />
</div>
</div>
<section id="solution-to-example-problem-01">
<h3>Solution to Example Problem 01<a class="headerlink" href="#solution-to-example-problem-01" title="Link to this heading">#</a></h3>
<p>Let’s stick with our conventional wisdom that, if we want to determine the reaction order with respect to <span class="math notranslate nohighlight">\(A\)</span>, we need to know how the rate of reaction changes in response to changes in the concentration of species <span class="math notranslate nohighlight">\(A\)</span>. This is easiest to do if everything else is constant. Fortunately, these reactions are performed at constant temperature and in a solvent, so the fluid density is constant. Also, we know from the problem statement that the rate of reaction <em><strong>does not</strong></em> depend on the concentration of species <span class="math notranslate nohighlight">\(B\)</span>. This allows us to focus on how changing the concentration of <span class="math notranslate nohighlight">\(A\)</span> will impact the rate of reaction.  We have available to us a set of concentrations of species <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(C_A\)</span>, measured at various values of feed volumetric flowrate, <span class="math notranslate nohighlight">\(Q_f\)</span>. Let’s see how we could use this to estimate a reaction order and rate constant.</p>
<section id="estimation-of-reaction-rates-in-a-cstr-at-steady-state">
<h4>Estimation of reaction rates in a CSTR at Steady State<a class="headerlink" href="#estimation-of-reaction-rates-in-a-cstr-at-steady-state" title="Link to this heading">#</a></h4>
<p>As with a batch reactor, the starting point for this analysis is a material balance. We will choose to work with a balance on <span class="math notranslate nohighlight">\(A\)</span>. The problem statement requests information about the order in <span class="math notranslate nohighlight">\(A\)</span>, so this is a sensible and intuitive approach.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We are interested in determining the reaction order in species <span class="math notranslate nohighlight">\(A\)</span>. One good way to do this is to find a way to estimate reaction rates as a function of <span class="math notranslate nohighlight">\(C_A\)</span> as in a differential analysis of Batch Reactor data. If we could find a way to do this, we could linearize the power law rate expression and estimate the reaction order and rate constant. It turns out that, for a single reaction in a CSTR, we can calculate the rate of reaction directly by solving the material balance.</p>
</div>
<p>For a CSTR at steady state, the material balance on species <span class="math notranslate nohighlight">\(A\)</span> is:</p>
<div class="math notranslate nohighlight">
\[0 = F_{A,f} - F_{A} + R_AV\]</div>
<p>We are given data about concentrations and volumetric flowrates (instead of molar flowrates, <span class="math notranslate nohighlight">\(F_j\)</span>), so we can recast this balance in terms of these parameters:</p>
<div class="math notranslate nohighlight">
\[0 = C_{A,f}Q_f - C_AQ_f + R_AV\]</div>
<p>Dividing through by the feed volumetric flowrate, we get:</p>
<div class="math notranslate nohighlight">
\[0 = C_{A,f} - C_A + R_A\tau\]</div>
<p>We recognize that we have a single reaction, we can make the substitution that <span class="math notranslate nohighlight">\(R_A = -r\)</span>:</p>
<div class="math notranslate nohighlight">
\[0 = C_{A,f} - C_A - r\tau\]</div>
<p>And we can solve for <span class="math notranslate nohighlight">\(r\)</span> to get:</p>
<div class="math notranslate nohighlight">
\[r = \frac{C_{A,f} - C_A}{\tau}\]</div>
<p>Interesting! In a CSTR, dividing <span class="math notranslate nohighlight">\(\Delta C_A\)</span> by <span class="math notranslate nohighlight">\(\Delta \tau\)</span> gives us a direct calculation of reaction rate at the concentration inside of the CSTR (rather than a finite difference approximation like in a batch reactor). That seems promising! Once we have calculated a reaction rate, we should consider that this measurement reflects the spatially averaged rate of reaction inside of the CSTR. Since the CSTR is a well-mixed reactor, species concentration inside of the reactor is uniform and equal to species concentration in the effluent. As such, solving for <span class="math notranslate nohighlight">\(r\)</span> at each experimental condition will generate us a set of reaction rates at various concentrations of <span class="math notranslate nohighlight">\(A\)</span>. As things stand now, we have a set of <span class="math notranslate nohighlight">\(r\)</span> vs. <span class="math notranslate nohighlight">\(C_A\)</span> data.  We have proposed that rate scales with <span class="math notranslate nohighlight">\(C_A\)</span> following power law kinetics (with an unknown reaction order α):</p>
<div class="math notranslate nohighlight">
\[r = kC_A^{\alpha}\]</div>
<p>As presented in previous Notebooks (see <a class="reference external" href="https://jqbond.github.io/CEN587/Notebooks/587-N39.html">Notebook 39</a>), we can linearize a power law model using a logarithmic transformation:</p>
<div class="math notranslate nohighlight">
\[\ln(r) = \ln(k) + \alpha \ln(C_A)\]</div>
<p>If the rate truly follows power law kinetics, we should see linearity if we graph <span class="math notranslate nohighlight">\(\ln(r)\)</span> vs. <span class="math notranslate nohighlight">\(\ln(C_A)\)</span>, and we can regress the slope and intercept to estimate the reaction order and rate constant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">########################################################################################################</span>
<span class="c1"># Calculate resultant set of space times from varying Qf                                               #</span>
<span class="c1">########################################################################################################</span>

<span class="n">τtrue</span>  <span class="o">=</span> <span class="n">V</span><span class="o">/</span><span class="n">Qftrue</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Calculate reaction rates                                                                             #</span>
<span class="c1">########################################################################################################</span>

<span class="n">rtrue</span>  <span class="o">=</span> <span class="p">(</span><span class="n">CAf</span> <span class="o">-</span> <span class="n">CAtrue</span><span class="p">)</span><span class="o">/</span><span class="n">τtrue</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Create scatterplot of CA vs. τ data                                                                  #</span>
<span class="c1"># Looks a bit like a CA vs. t data set for a batch, but this is CA vs &quot;space&quot; time, not &quot;clock&quot; time   #</span>
<span class="c1">########################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">τtrue</span><span class="p">,</span> <span class="n">CAtrue</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;perfect data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;tau (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CA (M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;CA vs. space time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Create scatterplot of r vs. CA data                                                                  #</span>
<span class="c1">########################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">CAtrue</span><span class="p">,</span> <span class="n">rtrue</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;perfect data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;CA (M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;rate (M/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;rate vs. CA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Create scatterplot of ln(r) vs. ln(CA) data                                                          #</span>
<span class="c1">########################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CAtrue</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rtrue</span><span class="p">),</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;perfect data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ln(CA)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ln(r)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;linearized rate vs. CA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.51</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7326a08bae7215e27faa6a7e06f874a8aeabd48595337409b9e91772b0ac5db1.png" src="../_images/7326a08bae7215e27faa6a7e06f874a8aeabd48595337409b9e91772b0ac5db1.png" />
<img alt="../_images/f0ed2a50feb99901479d0990185708beb6b368d3d72e9ecc0a32edb06488897a.png" src="../_images/f0ed2a50feb99901479d0990185708beb6b368d3d72e9ecc0a32edb06488897a.png" />
<img alt="../_images/ec5d202220a968d5dea8d71143b5053d3525b1f2d4d1b7b6d7b81ae2d854c69a.png" src="../_images/ec5d202220a968d5dea8d71143b5053d3525b1f2d4d1b7b6d7b81ae2d854c69a.png" />
</div>
</div>
</section>
<section id="linear-regression-on-perfect-data-generated-by-solving-material-balance">
<h4>Linear Regression on Perfect Data (generated by solving material balance)<a class="headerlink" href="#linear-regression-on-perfect-data-generated-by-solving-material-balance" title="Link to this heading">#</a></h4>
<p>In the cell below, we regress values for the slope and intercept, which give us information about the reaction order and rate constant. We also report confidence intervals on parameter estimates as well as various metrics that help us to quantify goodness-of-fit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#####################################################################################################</span>
<span class="c1"># Define the xdata array and ydata array                                                            #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rtrue</span><span class="p">)</span>
<span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CAtrue</span><span class="p">)</span>

<span class="c1">#####################################################################################################</span>
<span class="c1"># Define the X matrix and Y array                                                                   #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">Y</span>     <span class="o">=</span> <span class="n">ydata</span>
<span class="n">X</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#This creates the X matrix shown above, truncating at 1st order</span>

<span class="c1">#####################################################################################################</span>
<span class="c1"># Solve the least squares problem to find the best fit coefficients                                 #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">A</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@Y</span><span class="p">)</span> 

<span class="c1">#####################################################################################################</span>
<span class="c1"># Workup and analysis for quantifying and visualizing goodness of fit                               #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">Ypred</span>  <span class="o">=</span> <span class="n">X</span><span class="nd">@A</span>                          <span class="c1">#Calculate discrete array of predicted y values at each x value</span>
<span class="n">Ybar</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>               <span class="c1">#Calculate the mean of the measured y values, use for SST calculation</span>
<span class="n">Ndata</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>                   <span class="c1">#Calculate the number of data points/measurementws</span>
<span class="n">SSE1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ypred</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>       <span class="c1">#Calculate residual sum of squares using intuitive summation formula</span>
<span class="n">SSE2</span>   <span class="o">=</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">X</span><span class="nd">@A</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">@</span><span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">X</span><span class="nd">@A</span><span class="p">)</span>        <span class="c1">#Calculate residual sum of squares using matrix multiplication; equivalent to SSE1</span>
<span class="n">SST</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ybar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>        <span class="c1">#Calculate total sum of squares; assumes model is just y_pred = mean(ydata)</span>
<span class="n">MSE</span>    <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">Ndata</span>                   <span class="c1">#Calculate mean square error</span>
<span class="n">RMSE</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>                 <span class="c1">#Calculate root mean square error</span>
<span class="n">R2</span>     <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">SST</span>                 <span class="c1">#Calculate R2 (coefficient of determination)</span>
<span class="n">DOF</span>    <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>          <span class="c1">#Count degrees of freedom</span>
<span class="n">s2</span>     <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">DOF</span>                     <span class="c1">#Estimate variance</span>
<span class="n">COV</span>    <span class="o">=</span> <span class="n">s2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">)</span>      <span class="c1">#Generate the covariance matrix for this fit</span>
<span class="n">m</span>      <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                         <span class="c1">#This is a linear model; with the way we define the X matrix, slope is A[0], intercept is A[1]</span>
<span class="n">b</span>      <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                         <span class="c1">#This is a linear model; with the way we define the X matrix, slope is A[0], intercept is A[1] </span>
<span class="n">SEm</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>           <span class="c1">#For our definition of the X matrix, standard error in the slope is the first diagonal element in COV</span>
<span class="n">SEb</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>           <span class="c1">#For our definition of the X matrix, standard error in the intercept is the second diagonal element in COV</span>
<span class="n">tval</span>   <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">DOF</span><span class="p">)</span>      <span class="c1">#t distribution for 95% confidence interval t(1 - α/2, DOF), α = 0.05 for 95% confidence interval</span>
<span class="n">CIm</span>    <span class="o">=</span> <span class="n">SEm</span><span class="o">*</span><span class="n">tval</span>                     <span class="c1">#confidence interval on slope</span>
<span class="n">CIb</span>    <span class="o">=</span> <span class="n">SEb</span><span class="o">*</span><span class="n">tval</span>                     <span class="c1">#confidence interval on intercept</span>
<span class="n">α</span>      <span class="o">=</span> <span class="n">m</span>                            <span class="c1">#slope is equal to the reaction order</span>
<span class="n">k</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>                    <span class="c1">#y intercept is equal to ln(k)</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Printing results using f strings; create arrays of labels and values                     #</span>
<span class="c1">############################################################################################</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;SSE&#39;</span><span class="p">,</span> <span class="s1">&#39;SST&#39;</span><span class="p">,</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span><span class="s1">&#39;RMSE&#39;</span><span class="p">,</span> <span class="s1">&#39;R2&#39;</span><span class="p">,</span> <span class="s1">&#39;α&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span>  <span class="p">,</span>  <span class="n">b</span> <span class="p">,</span>  <span class="n">SSE1</span><span class="p">,</span>  <span class="n">SST</span> <span class="p">,</span> <span class="n">MSE</span> <span class="p">,</span> <span class="n">RMSE</span> <span class="p">,</span>  <span class="n">R2</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIm</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIb</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;α&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIm</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> (but is between </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">CIb</span><span class="p">)</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">CIb</span><span class="p">)</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Visualizing results; overlay data and regressed y(x)                                     #</span>
<span class="c1">############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;experimental rates&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">Ypred</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;linear fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.51</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ln(CA) mol/L&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ln(r) mol/L/s&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Visualizing results; plot of residual errors                                             #</span>
<span class="c1">############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ypred</span><span class="p">)</span><span class="o">/</span><span class="n">Y</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;residual error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">floor</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])),</span> <span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;zero error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.51</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;% Residual Error in ln (r)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Plot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>m    =  1.00e+00 +/- 1.13e-09
b    = -3.77e+00 +/- 2.32e-09
SSE  =      0.00
SST  =      1.46
MSE  =      0.00
RMSE =      0.00
R2   =      1.00
α    =  1.00e+00 +/- 1.13e-09
k    =  2.30e-02 (but is between 2.30e-02 and 2.30e-02)
</pre></div>
</div>
<img alt="../_images/3c0fc52a9474a8837434e67ca3059a61d74e5970f564a07198ea272f512194e1.png" src="../_images/3c0fc52a9474a8837434e67ca3059a61d74e5970f564a07198ea272f512194e1.png" />
<img alt="../_images/104c0d6cd426e3fe9a6b21c809bc92d9f3621eaf9248369d8ecb1214bc46ae37.png" src="../_images/104c0d6cd426e3fe9a6b21c809bc92d9f3621eaf9248369d8ecb1214bc46ae37.png" />
</div>
</div>
<p>From this analysis, we would conclude that we are very confident that the reaction is first order in <span class="math notranslate nohighlight">\(A\)</span> and that the value of the first order rate constant is <span class="math notranslate nohighlight">\(k = 0.023 \ \mathrm{s^{-1}}\)</span>. Note that these agree with the exact values of <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(k\)</span> given in the problem statement, and there is essentially zero uncertainty in the estimates. We also see absurdly good values for our residual sum of squares <span class="math notranslate nohighlight">\(SSE = 0.00\)</span> and coefficient of determination <span class="math notranslate nohighlight">\(R^2 = 1.00\)</span>, but that is what we might expect when performing statistical analysis on exact data. Next, let’s see what happens if we truncate data. This is a simple acknowledgement of the fact that we absolutely cannot make a measurement that is accurate to 10 decimal places in the laboratory. Even if our measurement is exactly right, we will not usually be able to report more than 3 significant figures, so let’s truncate the data accordingly.</p>
</section>
</section>
</section>
<section id="example-problem-02-analysis-of-slightly-more-realistic-data">
<h2>Example Problem 02: Analysis of (Slightly) More Realistic Data<a class="headerlink" href="#example-problem-02-analysis-of-slightly-more-realistic-data" title="Link to this heading">#</a></h2>
<p>Now let’s work toward what a real data set might look like.  First, we’d never keep 10 decimal places for data we generated from laboratory measurements, e.g., gas-chromatography, sample masses, etc. There are too many significant figures for real data where our precision is limited by measurement uncertainty. Let’s round the “perfect” data in the above arrays to expected experimental precision. We will now consider the perfect data truncated to 3 significant figures. Values are stored as numpy arrays in the code cell below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">########################################################################################################</span>
<span class="c1"># Store calculated &quot;perfect&quot; data rounded to instrument precision (3 sig figs) in numpy arrays         #</span>
<span class="c1">########################################################################################################</span>

<span class="n">Qfdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.75</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.367</span><span class="p">,</span> <span class="mf">0.275</span><span class="p">,</span> <span class="mf">0.138</span><span class="p">,</span> <span class="mf">0.055</span><span class="p">,</span> <span class="mf">0.0275</span><span class="p">,</span> <span class="mf">0.0183</span><span class="p">,</span> <span class="mf">0.0138</span><span class="p">,</span> <span class="mf">0.0055</span><span class="p">,</span> <span class="mf">0.00275</span><span class="p">])</span> <span class="c1">#mol/L</span>
<span class="n">CAdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">9.98</span><span class="p">,</span> <span class="mf">9.89</span><span class="p">,</span> <span class="mf">9.83</span><span class="p">,</span> <span class="mf">9.78</span><span class="p">,</span> <span class="mf">9.56</span><span class="p">,</span> <span class="mf">8.97</span><span class="p">,</span> <span class="mf">8.13</span><span class="p">,</span> <span class="mf">7.43</span><span class="p">,</span> <span class="mf">6.85</span><span class="p">,</span> <span class="mf">4.65</span><span class="p">,</span> <span class="mf">3.03</span><span class="p">])</span> <span class="c1">#L/sec</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Calculate space times and rates from data truncated to 3 significant figures                         #</span>
<span class="c1">########################################################################################################</span>

<span class="n">τdata</span>  <span class="o">=</span> <span class="n">V</span><span class="o">/</span><span class="n">Qfdata</span>
<span class="n">rdata</span>  <span class="o">=</span> <span class="p">(</span><span class="n">CAf</span> <span class="o">-</span> <span class="n">CAdata</span><span class="p">)</span><span class="o">/</span><span class="n">τdata</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Create scatterplot of CA vs. τ data; overlay &quot;true&quot; vs. &quot;truncated&quot;                                  #</span>
<span class="c1">########################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">τtrue</span><span class="p">,</span> <span class="n">CAtrue</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;perfect data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">τdata</span><span class="p">,</span> <span class="n">CAdata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data rounded to instrument precision&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;tau (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CA (M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;CA vs. space time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Create scatterplot of rate vs. CA data; overlay &quot;true&quot; vs. &quot;truncated&quot;                               #</span>
<span class="c1">########################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">CAtrue</span><span class="p">,</span> <span class="n">rtrue</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;perfect data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">CAdata</span><span class="p">,</span> <span class="n">rdata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data rounded to instrument precision&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;CA (M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;rate (M/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;rate vs. CA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Create scatterplot of ln(rate) vs. ln(CA) data; overlay &quot;true&quot; vs. &quot;truncated&quot;                       #</span>
<span class="c1">########################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CAtrue</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rtrue</span><span class="p">),</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;perfect data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CAdata</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rdata</span><span class="p">),</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data rounded to instrument precision&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ln(CA)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ln(r)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;linearized rate vs. CA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.51</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># If desired, uncomment lines below to print out true vs. truncated data and % error in CA and r       #</span>
<span class="c1">########################################################################################################</span>

<span class="c1"># display(np.round(np.vstack((CAtrue, CAdata, (CAtrue - CAdata)*100/CAtrue)).T, 3))</span>
<span class="c1"># display(np.round(np.vstack((rtrue, rdata, (rtrue - rdata)*100/rtrue)).T, 3))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/528bb9cc0fb118ab3d438527dca5c80ccfd24f869ef259b6dc7ed38981ba5431.png" src="../_images/528bb9cc0fb118ab3d438527dca5c80ccfd24f869ef259b6dc7ed38981ba5431.png" />
<img alt="../_images/0eef531aaff488f147f37ffaf679339468b934306872dfe8da64c01666c8be15.png" src="../_images/0eef531aaff488f147f37ffaf679339468b934306872dfe8da64c01666c8be15.png" />
<img alt="../_images/3cd96a9a1b6cf7f1f71dcfc6fb282ab3db102fe90addc62764484e580f47f490.png" src="../_images/3cd96a9a1b6cf7f1f71dcfc6fb282ab3db102fe90addc62764484e580f47f490.png" />
</div>
</div>
<section id="linear-regression-on-data-rounded-to-instrument-precision">
<h3>Linear Regression on Data Rounded to Instrument Precision<a class="headerlink" href="#linear-regression-on-data-rounded-to-instrument-precision" title="Link to this heading">#</a></h3>
<p>We can see that something as simple as truncating data to 3 significant figures begins to create some issues in our estimates of reaction rates. Overall, the linearized data still look mostly linear, though we start to see large variations and scatter at very high concentrations of A (this is at very small values of τ). Next, let’s work through the regression analysis and see if our parameter estimates and goodness-of-fit metrics have changed significantly.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This next analysis demonstrates the impact of limited precision in reporting data. Our numbers do not have any measurement error added yet, they are simply rounded to 3 significant figures!</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#####################################################################################################</span>
<span class="c1"># Define the xdata array and ydata array                                                            #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rdata</span><span class="p">)</span>
<span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CAdata</span><span class="p">)</span>

<span class="c1">#####################################################################################################</span>
<span class="c1"># Define the X matrix and Y array                                                                   #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">Y</span>     <span class="o">=</span> <span class="n">ydata</span>
<span class="n">X</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#This creates the X matrix shown above, truncating at 1st order</span>

<span class="c1">#####################################################################################################</span>
<span class="c1"># Solve the least squares problem to find the best fit coefficients                                 #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">A</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@Y</span><span class="p">)</span> 

<span class="c1">#####################################################################################################</span>
<span class="c1"># Workup and analysis for quantifying and visualizing goodness of fit                               #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">Ypred</span>  <span class="o">=</span> <span class="n">X</span><span class="nd">@A</span>                          <span class="c1">#Calculate discrete array of predicted y values at each x value</span>
<span class="n">Ybar</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>               <span class="c1">#Calculate the mean of the measured y values, use for SST calculation</span>
<span class="n">Ndata</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>                   <span class="c1">#Calculate the number of data points/measurementws</span>
<span class="n">SSE1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ypred</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>       <span class="c1">#Calculate residual sum of squares using intuitive summation formula</span>
<span class="n">SSE2</span>   <span class="o">=</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">X</span><span class="nd">@A</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">@</span><span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">X</span><span class="nd">@A</span><span class="p">)</span>        <span class="c1">#Calculate residual sum of squares using matrix multiplication; equivalent to SSE1</span>
<span class="n">SST</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ybar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>        <span class="c1">#Calculate total sum of squares; assumes model is just y_pred = mean(ydata)</span>
<span class="n">MSE</span>    <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">Ndata</span>                   <span class="c1">#Calculate mean square error</span>
<span class="n">RMSE</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>                 <span class="c1">#Calculate root mean square error</span>
<span class="n">R2</span>     <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">SST</span>                 <span class="c1">#Calculate R2 (coefficient of determination)</span>
<span class="n">DOF</span>    <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>          <span class="c1">#Count degrees of freedom</span>
<span class="n">s2</span>     <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">DOF</span>                     <span class="c1">#Estimate variance</span>
<span class="n">COV</span>    <span class="o">=</span> <span class="n">s2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">)</span>      <span class="c1">#Generate the covariance matrix for this fit</span>
<span class="n">m</span>      <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                         <span class="c1">#This is a linear model; with the way we define the X matrix, slope is A[0], intercept is A[1]</span>
<span class="n">b</span>      <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                         <span class="c1">#This is a linear model; with the way we define the X matrix, slope is A[0], intercept is A[1] </span>
<span class="n">SEm</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>           <span class="c1">#For our definition of the X matrix, standard error in the slope is the first diagonal element in COV</span>
<span class="n">SEb</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>           <span class="c1">#For our definition of the X matrix, standard error in the intercept is the second diagonal element in COV</span>
<span class="n">tval</span>   <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">DOF</span><span class="p">)</span>      <span class="c1">#t distribution for 95% confidence interval t(1 - α/2, DOF), α = 0.05 for 95% confidence interval</span>
<span class="n">CIm</span>    <span class="o">=</span> <span class="n">SEm</span><span class="o">*</span><span class="n">tval</span>                     <span class="c1">#confidence interval on slope</span>
<span class="n">CIb</span>    <span class="o">=</span> <span class="n">SEb</span><span class="o">*</span><span class="n">tval</span>                     <span class="c1">#confidence interval on intercept</span>
<span class="n">α</span>      <span class="o">=</span> <span class="n">m</span>                            <span class="c1">#slope is equal to the reaction order</span>
<span class="n">k</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>                    <span class="c1">#y intercept is equal to ln(k)</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Printing results using f strings; create arrays of labels and values                     #</span>
<span class="c1">############################################################################################</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;SSE&#39;</span><span class="p">,</span> <span class="s1">&#39;SST&#39;</span><span class="p">,</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span><span class="s1">&#39;RMSE&#39;</span><span class="p">,</span> <span class="s1">&#39;R2&#39;</span><span class="p">,</span> <span class="s1">&#39;α&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span>  <span class="p">,</span>  <span class="n">b</span> <span class="p">,</span>  <span class="n">SSE1</span><span class="p">,</span>  <span class="n">SST</span> <span class="p">,</span> <span class="n">MSE</span> <span class="p">,</span> <span class="n">RMSE</span> <span class="p">,</span>  <span class="n">R2</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIm</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIb</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;α&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIm</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> (but is between </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">CIb</span><span class="p">)</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">CIb</span><span class="p">)</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Visualizing results; overlay data and regressed y(x)                                     #</span>
<span class="c1">############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;experimental rates&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">Ypred</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;linear fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.51</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ln(CA) mol/L&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ln(r) mol/L/s&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Visualizing results; plot of residual errors                                             #</span>
<span class="c1">############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ypred</span><span class="p">)</span><span class="o">/</span><span class="n">Y</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;residual error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">floor</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])),</span> <span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;zero error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.51</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;% Residual Error in ln (r)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Plot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>m    =  9.65e-01 +/- 7.85e-02
b    = -3.72e+00 +/- 1.62e-01
SSE  =      0.02
SST  =      1.37
MSE  =      0.00
RMSE =      0.04
R2   =      0.99
α    =  9.65e-01 +/- 7.85e-02
k    =  2.43e-02 (but is between 2.07e-02 and 2.86e-02)
</pre></div>
</div>
<img alt="../_images/7d4bde481e9f4a42171890489c59f4c69575107a862d74f0456320352ad286d6.png" src="../_images/7d4bde481e9f4a42171890489c59f4c69575107a862d74f0456320352ad286d6.png" />
<img alt="../_images/5b5d46ed172568e0259f1fb010776b22d51417a150b7e0c0f35256433d2920cb.png" src="../_images/5b5d46ed172568e0259f1fb010776b22d51417a150b7e0c0f35256433d2920cb.png" />
</div>
</div>
<p>Now we have some quantitative results to work with, and we can see that truncating data to account for instrument precision has substantially reduced our confidence in parameter estimates. For example, here we conclude that <span class="math notranslate nohighlight">\(\alpha = 0.97 \pm 0.08\)</span> and that <span class="math notranslate nohighlight">\(0.021 \ \mathrm{s^{-1}} \leq k \leq 0.029 \ \mathrm{s^{-1}}\)</span>, and we find a slight increase in residual sum of squares <span class="math notranslate nohighlight">\((SSE = 0.02)\)</span> and a slight decrease in coefficient of determination <span class="math notranslate nohighlight">\((R^2 = 0.99)\)</span>. The fit is still overall very good, and we would be reasonably confident about these results, but the impact is suprisingly large considering the seeminly minor level of processing that we’ve applied to the data in rounding all numbers to three significant figures.</p>
</section>
</section>
<section id="example-03-processing-noisy-data-simulating-a-real-experiment">
<h2>Example 03: Processing Noisy Data (simulating a real experiment)<a class="headerlink" href="#example-03-processing-noisy-data-simulating-a-real-experiment" title="Link to this heading">#</a></h2>
<p>In the real world, we can rarely measure a quantity with absolute precision. Above, we simply rounded exact numbers to 3 significant figures, but here, we will acknowledge the fact that our measurements are never exact. At best, they will have a small amount of random scatter, and if we make many measurements, their mean will approach the exact value. Next, we are going to make our data <em><strong>resemble</strong></em> something we would get in a lab by adding random noise to each exact number obtained by solving the material balance on a CSTR. Here, we are adding Gaussian noise to our measurements of <span class="math notranslate nohighlight">\(C_A\)</span>. We use <code class="docutils literal notranslate"><span class="pre">numpy.random.normal()</span></code> to generate a random number from a Gaussian distribution that has a given mean and standard deviation. We scale the size of the random noise by the size of <span class="math notranslate nohighlight">\(C_A\)</span> – this makes sense. The absolute uncertainty in a small value of <span class="math notranslate nohighlight">\(C_A\)</span> is much smaller than the absolute uncertainty in a large value of <span class="math notranslate nohighlight">\(C_A\)</span>. For example, if I measure <span class="math notranslate nohighlight">\(C_A = 10.0 \ \mathrm{M}\)</span>, I might acknowledge that experimental uncertainty suggests I can only be sure about that number within a few percent – let’s say 5%.  A better way to think about that measurement would then be that <span class="math notranslate nohighlight">\(C_A = 10.0 \pm 0.5 \ \mathrm{M}\)</span> or that, if I were to measure the concentration of <span class="math notranslate nohighlight">\(A\)</span> again, I might not be surprised if I measure <span class="math notranslate nohighlight">\(9.5 \ \mathrm{M} \leq C_A \leq 10.5 \ \mathrm{M}\)</span>.  By contrast, if I measured <span class="math notranslate nohighlight">\(C_A = 0.1 \ \mathrm{M}\)</span>, my expectations would shift to maybe <span class="math notranslate nohighlight">\(C_A = 0.1 \pm 0.005 \ \mathrm{M}\)</span> or <span class="math notranslate nohighlight">\(0.095 \ \mathrm{M} \leq C_A \leq 0.105 \ \mathrm{M}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#############################################################################################################</span>
<span class="c1"># Set the noise level for this experiment                                                                   #</span>
<span class="c1">#############################################################################################################</span>

<span class="n">noise_level</span> <span class="o">=</span> <span class="mf">0.1</span>   <span class="c1">#percent standard deviation on the mean.</span>

<span class="c1">#############################################################################################################</span>
<span class="c1"># Key the seed for the randon number generation to the noise level                                          #</span>
<span class="c1"># This ensures that, for a given noise level, the RNG will generate the same set of &quot;random&quot; noise values   #</span>
<span class="c1"># This is done so that each time we run the notebook, we get a predictable result                           #</span>
<span class="c1">#############################################################################################################</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">noise_level</span><span class="p">))</span>

<span class="c1">#############################################################################################################</span>
<span class="c1"># Add gaussian noise to data to simulate measurement uncertainty                                            #</span>
<span class="c1">#############################################################################################################</span>

<span class="n">noiseA</span>  <span class="o">=</span> <span class="n">CAtrue</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span> <span class="n">CAtrue</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">CAdatan</span> <span class="o">=</span> <span class="n">CAtrue</span> <span class="o">+</span> <span class="n">noiseA</span>

<span class="c1">#############################################################################################################</span>
<span class="c1"># Use noisy Concentration measurements to calculate rates                                                   #</span>
<span class="c1">#############################################################################################################</span>

<span class="n">rdatan</span>  <span class="o">=</span> <span class="p">(</span><span class="n">CAf</span> <span class="o">-</span> <span class="n">CAdatan</span><span class="p">)</span><span class="o">/</span><span class="n">τdata</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Create scatterplot of CA vs. τ data; overlay &quot;true&quot; vs. &quot;noisy&quot;                                      #</span>
<span class="c1">########################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">τtrue</span><span class="p">,</span> <span class="n">CAtrue</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;perfect data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">τdata</span><span class="p">,</span> <span class="n">CAdatan</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;real data with </span><span class="si">{</span><span class="n">noise_level</span><span class="si">}</span><span class="s1">% standard deviation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;tau (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CA (M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;CA vs. space time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Create scatterplot of rate vs. CA data; overlay &quot;true&quot; vs. &quot;noisy&quot;                                   #</span>
<span class="c1">########################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">CAtrue</span><span class="p">,</span> <span class="n">rtrue</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;perfect data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">CAdatan</span><span class="p">,</span> <span class="n">rdatan</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;real data with </span><span class="si">{</span><span class="n">noise_level</span><span class="si">}</span><span class="s1">% standard deviation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;CA (M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;rate (M/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;rate vs. CA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Create scatterplot of ln(rate) vs. ln(CA) data; overlay &quot;true&quot; vs. &quot;noisy&quot;                           #</span>
<span class="c1">########################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CAtrue</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rtrue</span><span class="p">),</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;perfect data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CAdatan</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rdatan</span><span class="p">),</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;real data with </span><span class="si">{</span><span class="n">noise_level</span><span class="si">}</span><span class="s1">% standard deviation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ln(CA)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ln(r)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;linearized rate vs. CA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.51</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># If desired, uncomment lines below to print out true vs. truncated data and % error in CA and r       #</span>
<span class="c1">########################################################################################################</span>

<span class="c1"># display(np.vstack((CAtrue, CAdatan, (CAtrue - CAdatan)*100/CAtrue)).T)</span>
<span class="c1"># display(np.round(np.vstack((rtrue, rdatan, (rtrue - rdatan)*100/rtrue)).T, 3))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1eb5c51f5eee314d60790b199153d17e2e05a96edd7faf4d622d8885203a69d2.png" src="../_images/1eb5c51f5eee314d60790b199153d17e2e05a96edd7faf4d622d8885203a69d2.png" />
<img alt="../_images/5616cecc3aadf19549487a545922e656848c7d127bc4d570f3dd4f3f0a6baddc.png" src="../_images/5616cecc3aadf19549487a545922e656848c7d127bc4d570f3dd4f3f0a6baddc.png" />
<img alt="../_images/fc6f37cc79648e55670cf9585ba27ce73f3f6ededf7fa53d13e9ef03c92e67a5.png" src="../_images/fc6f37cc79648e55670cf9585ba27ce73f3f6ededf7fa53d13e9ef03c92e67a5.png" />
</div>
</div>
<section id="linear-regression-on-noisy-data">
<h3>Linear Regression on Noisy Data<a class="headerlink" href="#linear-regression-on-noisy-data" title="Link to this heading">#</a></h3>
<p>We can see from the above overlays that there is a substantial impact from considering noisy data. Even at modest levels of imprecision, errors begin to appear in our concentration measurements. These are amplified in our estimates of reaction rates. Let’s see if applying regression analysis can still smooth this out and give us reasonable estimates of rate constant and reaction order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#####################################################################################################</span>
<span class="c1"># Define the xdata array and ydata array                                                            #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rdatan</span><span class="p">)</span>
<span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CAdatan</span><span class="p">)</span>

<span class="c1">#####################################################################################################</span>
<span class="c1"># Define the X matrix and Y array                                                                   #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">Y</span>     <span class="o">=</span> <span class="n">ydata</span>
<span class="n">X</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#This creates the X matrix shown above, truncating at 1st order</span>

<span class="c1">#####################################################################################################</span>
<span class="c1"># Solve the least squares problem to find the best fit coefficients                                 #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">A</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@Y</span><span class="p">)</span> 

<span class="c1">#####################################################################################################</span>
<span class="c1"># Workup and analysis for quantifying and visualizing goodness of fit                               #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">Ypred</span>  <span class="o">=</span> <span class="n">X</span><span class="nd">@A</span>                          <span class="c1">#Calculate discrete array of predicted y values at each x value</span>
<span class="n">Ybar</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>               <span class="c1">#Calculate the mean of the measured y values, use for SST calculation</span>
<span class="n">Ndata</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>                   <span class="c1">#Calculate the number of data points/measurementws</span>
<span class="n">SSE1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ypred</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>       <span class="c1">#Calculate residual sum of squares using intuitive summation formula</span>
<span class="n">SSE2</span>   <span class="o">=</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">X</span><span class="nd">@A</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">@</span><span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">X</span><span class="nd">@A</span><span class="p">)</span>        <span class="c1">#Calculate residual sum of squares using matrix multiplication; equivalent to SSE1</span>
<span class="n">SST</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ybar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>        <span class="c1">#Calculate total sum of squares; assumes model is just y_pred = mean(ydata)</span>
<span class="n">MSE</span>    <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">Ndata</span>                   <span class="c1">#Calculate mean square error</span>
<span class="n">RMSE</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>                 <span class="c1">#Calculate root mean square error</span>
<span class="n">R2</span>     <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">SST</span>                 <span class="c1">#Calculate R2 (coefficient of determination)</span>
<span class="n">DOF</span>    <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>          <span class="c1">#Count degrees of freedom</span>
<span class="n">s2</span>     <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">DOF</span>                     <span class="c1">#Estimate variance</span>
<span class="n">COV</span>    <span class="o">=</span> <span class="n">s2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">)</span>      <span class="c1">#Generate the covariance matrix for this fit</span>
<span class="n">m</span>      <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                         <span class="c1">#This is a linear model; with the way we define the X matrix, slope is A[0], intercept is A[1]</span>
<span class="n">b</span>      <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                         <span class="c1">#This is a linear model; with the way we define the X matrix, slope is A[0], intercept is A[1] </span>
<span class="n">SEm</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>           <span class="c1">#For our definition of the X matrix, standard error in the slope is the first diagonal element in COV</span>
<span class="n">SEb</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>           <span class="c1">#For our definition of the X matrix, standard error in the intercept is the second diagonal element in COV</span>
<span class="n">tval</span>   <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">DOF</span><span class="p">)</span>      <span class="c1">#t distribution for 95% confidence interval t(1 - α/2, DOF), α = 0.05 for 95% confidence interval</span>
<span class="n">CIm</span>    <span class="o">=</span> <span class="n">SEm</span><span class="o">*</span><span class="n">tval</span>                     <span class="c1">#confidence interval on slope</span>
<span class="n">CIb</span>    <span class="o">=</span> <span class="n">SEb</span><span class="o">*</span><span class="n">tval</span>                     <span class="c1">#confidence interval on intercept</span>
<span class="n">α</span>      <span class="o">=</span> <span class="n">m</span>                            <span class="c1">#slope is equal to the reaction order</span>
<span class="n">k</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>                    <span class="c1">#y intercept is equal to ln(k)</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Printing results using f strings; create arrays of labels and values                     #</span>
<span class="c1">############################################################################################</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;SSE&#39;</span><span class="p">,</span> <span class="s1">&#39;SST&#39;</span><span class="p">,</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span><span class="s1">&#39;RMSE&#39;</span><span class="p">,</span> <span class="s1">&#39;R2&#39;</span><span class="p">,</span> <span class="s1">&#39;α&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span>  <span class="p">,</span>  <span class="n">b</span> <span class="p">,</span>  <span class="n">SSE1</span><span class="p">,</span>  <span class="n">SST</span> <span class="p">,</span> <span class="n">MSE</span> <span class="p">,</span> <span class="n">RMSE</span> <span class="p">,</span>  <span class="n">R2</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIm</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIb</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;α&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIm</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> (but is between </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">CIb</span><span class="p">)</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">CIb</span><span class="p">)</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Visualizing results; overlay data and regressed y(x)                                     #</span>
<span class="c1">############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;experimental rates&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">Ypred</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;linear fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.51</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ln(CA) mol/L&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ln(r) mol/L/s&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Visualizing results; plot of residual errors                                             #</span>
<span class="c1">############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ypred</span><span class="p">)</span><span class="o">/</span><span class="n">Y</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;residual error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">floor</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])),</span> <span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;zero error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.51</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;% Residual Error in ln (r)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Plot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>m    =  7.90e-01 +/- 7.24e-01
b    = -3.45e+00 +/- 1.49e+00
SSE  =      1.34
SST  =      2.25
MSE  =      0.12
RMSE =      0.35
R2   =      0.40
α    =  7.90e-01 +/- 7.24e-01
k    =  3.18e-02 (but is between 7.18e-03 and 1.41e-01)
</pre></div>
</div>
<img alt="../_images/6b42273848bd1206a969fc3e6ab12659a57c1a463fb37b92867df3d3b571bd72.png" src="../_images/6b42273848bd1206a969fc3e6ab12659a57c1a463fb37b92867df3d3b571bd72.png" />
<img alt="../_images/3fc4b040df6af84fc15b613cb6f3041672b447e9449cfc1c256472506438ce6e.png" src="../_images/3fc4b040df6af84fc15b613cb6f3041672b447e9449cfc1c256472506438ce6e.png" />
</div>
</div>
<p>Even for small levels of uncertainty (<span class="math notranslate nohighlight">\(\sigma \approx 0.1 \%\)</span>), we see large uncertainty in parameter estimates. The estimated reaction order <span class="math notranslate nohighlight">\(\alpha\)</span> is now <span class="math notranslate nohighlight">\(0.7 \pm 0.7\)</span>, decreasing our confidence that this reaction is first order in <span class="math notranslate nohighlight">\(A\)</span>. Similarly, we estimate bounds on the rate constant that span nearly 2 orders of magnitude <span class="math notranslate nohighlight">\((0.007 \leq k \ leq 0.14)\)</span>. For slightly larger values of standard deviation (but still very small levels of imprecision, such as $\sigma \approx 1 %), we begin seeing NAN errors that cause our linear regression analysis to fail. This seems like an outsized impact of 1% uncertainty in our concentration mesurements, and we should consider what is happening because it is a common issue in kinetic analysis, and it is one that (usually) has a straightforward resolution.</p>
<p>The problem here is not in our logic or in our math…every aspect of our analysis is correct. The problem lies in our data, specifically in our ability to measure exact concentrations in the laboratory. Although it does not appear to cause serious deviations in the <span class="math notranslate nohighlight">\(C_A\)</span> vs. <span class="math notranslate nohighlight">\(\tau\)</span> trend (relative to the exact solution), it causes substantial errors in rate estimates, especially those obtained at short residence times and/or large values of <span class="math notranslate nohighlight">\(C_A\)</span>. Here is the reason why:</p>
<p>Consider our definition of <span class="math notranslate nohighlight">\(r\)</span> in this CSTR, which arises from solving the material balance for species <span class="math notranslate nohighlight">\(A\)</span> in a CSTR operating at steady state. It is based on measuring the change in the concentration of species <span class="math notranslate nohighlight">\(A\)</span> relative to the feed at a given residence time:</p>
<div class="math notranslate nohighlight">
\[r = \frac{C_{Af} - C_A}{\tau}\]</div>
<p>If we operate our reactor at very large values of <span class="math notranslate nohighlight">\(Q_f\)</span>, this drives our space times close to zero. At a space time of zero, our fractional conversion will also approach zero for the reason that species are effectively spending no time in the reactor.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Convince yourself that, for <em>this</em> CSTR at steady state, <span class="math notranslate nohighlight">\(X_A = r\tau/C_{Af}\)</span></p>
</div>
<p>In the limit of zero conversion, we would expect that:</p>
<div class="math notranslate nohighlight">
\[C_{Af} \approx C_A\]</div>
<p>This means the two quantities in the numerator of the rate definition, <span class="math notranslate nohighlight">\(C_{Af} - C_A\)</span> are becoming nearly indistinguishable. Here’s where measurement uncertainty becomes important. It only takes a bit of uncertainty in our measurements before we’re getting results like <span class="math notranslate nohighlight">\(C_A &gt; C_{Af}\)</span> for very small values of <span class="math notranslate nohighlight">\(\tau\)</span>. Physically, that is impossible for this reaction, but our limits on precision make it something that we observe in noisy data at low conversion (small <span class="math notranslate nohighlight">\(\tau\)</span>). When we’re in this situation of trying to determine reaction rates at nearly zero conversion, the better approach is to do this based on a balance on our product. We will consider this approach next.</p>
</section>
</section>
<section id="example-problem-04-leveraging-product-concentrations-to-estimate-reaction-rate">
<h2>Example Problem 04: Leveraging Product Concentrations to estimate reaction rate<a class="headerlink" href="#example-problem-04-leveraging-product-concentrations-to-estimate-reaction-rate" title="Link to this heading">#</a></h2>
<p>Recall that the original problem statement indicated that we’d measured the concentration of product. We looked at this data early on in the analysis, but we have not used it yet.  Now, we’ll consider how this could be used (instead of the concentration of species <span class="math notranslate nohighlight">\(A\)</span>) to estimate reaction rates. This may be counterintuitive because we are used to experiments wherein we manipulate the concentration of reactant in order to determine the reaction order for that reactant. We are still doing that in this experiment, but we will use the effluent concentration of species <span class="math notranslate nohighlight">\(B\)</span> instead of the the effluent concentration of species <span class="math notranslate nohighlight">\(A\)</span> to estimate reaction rates. Although it seems minor, this will have a significant impact in our ability to tolerate measurement uncertainty in a kinetic analysis.  We’ll start by writing a balance on species <span class="math notranslate nohighlight">\(B\)</span>:</p>
<div class="math notranslate nohighlight">
\[0 = C_{Bf} - C_B + R_B\tau\]</div>
<p>Since <span class="math notranslate nohighlight">\(R_B = r\)</span>, this can be solved to give:</p>
<div class="math notranslate nohighlight">
\[r = \frac{C_B}{\tau}\]</div>
<p>This measn that, when we estimate the reaction rate, we are using the change in concentration of species <span class="math notranslate nohighlight">\(B\)</span> relative to zero (the inlet concentration of B). The measurement of <span class="math notranslate nohighlight">\(C_B\)</span> is still subject to imprecision and uncertainty as usual, but we are not subtracting two nearly identical values in the numerator. This leads to much greater precision in our estimates for rate of reaction, especially in the limit of zero conversion. In the code cell below, we add noisy values of <span class="math notranslate nohighlight">\(C_B\)</span> and proceed with using these to estimate reaction rates and compare the noisy data to the exact results presented earlier in the Notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#############################################################################################################</span>
<span class="c1"># Set the noise level for this experiment                                                                   #</span>
<span class="c1">#############################################################################################################</span>

<span class="n">noise_level</span> <span class="o">=</span> <span class="mf">10.0</span>   <span class="c1">#percent standard deviation on the mean.</span>

<span class="c1">#############################################################################################################</span>
<span class="c1"># Key the seed for the randon number generation to the noise level                                          #</span>
<span class="c1"># This ensures that, for a given noise level, the RNG will generate the same set of &quot;random&quot; noise values   #</span>
<span class="c1"># This is done so that each time we run the notebook, we get a predictable result                           #</span>
<span class="c1">#############################################################################################################</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">noise_level</span><span class="p">))</span>

<span class="c1">#############################################################################################################</span>
<span class="c1"># Add gaussian noise to CB data to simulate measurement uncertainty                                         #</span>
<span class="c1">#############################################################################################################</span>

<span class="n">noiseB</span>   <span class="o">=</span> <span class="n">CBtrue</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span> <span class="n">CBtrue</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">CBdatan</span> <span class="o">=</span> <span class="n">CBtrue</span> <span class="o">+</span> <span class="n">noiseB</span>

<span class="c1">#############################################################################################################</span>
<span class="c1"># Use noisy Concentration measurements to calculate rates; also calculate true rates based on exact CB, τ   #</span>
<span class="c1">#############################################################################################################</span>

<span class="n">rbtrue</span>  <span class="o">=</span> <span class="n">CBtrue</span><span class="o">/</span><span class="n">τtrue</span>
<span class="n">rbdatan</span> <span class="o">=</span> <span class="n">CBdatan</span><span class="o">/</span><span class="n">τdata</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Create scatterplot of CB vs. τ data; overlay &quot;true&quot; vs. &quot;noisy&quot;                                      #</span>
<span class="c1">########################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">τtrue</span><span class="p">,</span> <span class="n">CBtrue</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;perfect data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">τdata</span><span class="p">,</span> <span class="n">CBdatan</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;real data with </span><span class="si">{</span><span class="n">noise_level</span><span class="si">}</span><span class="s1">% standard deviation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;tau (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CB (M)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;CB vs. space time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Create scatterplot of r vs. CA data; overlay &quot;true&quot; vs. &quot;noisy&quot;                                      #</span>
<span class="c1">########################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">CAtrue</span><span class="p">,</span> <span class="n">rbtrue</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;perfect data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">CAdatan</span><span class="p">,</span> <span class="n">rbdatan</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;real data with </span><span class="si">{</span><span class="n">noise_level</span><span class="si">}</span><span class="s1">% standard deviation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;CA (M)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;rate (M/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;rate vs. CA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># Create scatterplot of ln(r) vs. ln(CA) data; overlay &quot;true&quot; vs. &quot;noisy&quot;                              #</span>
<span class="c1">########################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CAtrue</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rbtrue</span><span class="p">),</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;perfect data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CAdatan</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rbdatan</span><span class="p">),</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;real data with </span><span class="si">{</span><span class="n">noise_level</span><span class="si">}</span><span class="s1">% standard deviation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ln(CA)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ln(r)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;linearized rate vs. CA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">########################################################################################################</span>
<span class="c1"># If desired, uncomment lines below to print out true vs. truncated data and % error in CB and r       #</span>
<span class="c1">########################################################################################################</span>

<span class="c1"># display(np.vstack((CBtrue, CBdatan, (CBtrue - CBdatan)*100/CBtrue)).T)</span>
<span class="c1"># display(np.vstack((rbtrue, rbdatan, (rbtrue - rbdatan)*100/rbtrue)).T)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8c460bb4fa0404410e21da9d3367bc730ff8ac12927ec4735302b12da8b31bb0.png" src="../_images/8c460bb4fa0404410e21da9d3367bc730ff8ac12927ec4735302b12da8b31bb0.png" />
<img alt="../_images/4da45cad7d306c3e2aa62b8b27151233b8bd9469d90f66d176d1f79386e52445.png" src="../_images/4da45cad7d306c3e2aa62b8b27151233b8bd9469d90f66d176d1f79386e52445.png" />
<img alt="../_images/009cb4a0a0323c4b591ae4fa099d53f67c2f60fe298d89e159caa039e7b0ec39.png" src="../_images/009cb4a0a0323c4b591ae4fa099d53f67c2f60fe298d89e159caa039e7b0ec39.png" />
</div>
</div>
<section id="linear-regression-of-noisy-rates-based-on-product-concentration">
<h3>Linear Regression of noisy rates based on product concentration<a class="headerlink" href="#linear-regression-of-noisy-rates-based-on-product-concentration" title="Link to this heading">#</a></h3>
<p>We can see scatter in the data, but we do not see cases where rates take on a phyiscally unrealistic value – this is because we avoid subtracting <span class="math notranslate nohighlight">\((C_{Af} - C_A)\)</span> under conditions where the two numbers are statistically indistinguishable.  Let’s now try to process this data using linear regression and see how the noisy data impacts goodness-of-fit and uncertainty in parameter estimation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#####################################################################################################</span>
<span class="c1"># Define the xdata array and ydata array                                                            #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rbdatan</span><span class="p">)</span>
<span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CAdatan</span><span class="p">)</span>

<span class="c1">#####################################################################################################</span>
<span class="c1"># Define the X matrix and Y array                                                                   #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">Y</span>     <span class="o">=</span> <span class="n">ydata</span>
<span class="n">X</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#This creates the X matrix shown above, truncating at 1st order</span>

<span class="c1">#####################################################################################################</span>
<span class="c1"># Solve the least squares problem to find the best fit coefficients                                 #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">A</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@Y</span><span class="p">)</span> 

<span class="c1">#####################################################################################################</span>
<span class="c1"># Workup and analysis for quantifying and visualizing goodness of fit                               #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">Ypred</span>  <span class="o">=</span> <span class="n">X</span><span class="nd">@A</span>                          <span class="c1">#Calculate discrete array of predicted y values at each x value</span>
<span class="n">Ybar</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>               <span class="c1">#Calculate the mean of the measured y values, use for SST calculation</span>
<span class="n">Ndata</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>                   <span class="c1">#Calculate the number of data points/measurementws</span>
<span class="n">SSE1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ypred</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>       <span class="c1">#Calculate residual sum of squares using intuitive summation formula</span>
<span class="n">SSE2</span>   <span class="o">=</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">X</span><span class="nd">@A</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">@</span><span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">X</span><span class="nd">@A</span><span class="p">)</span>        <span class="c1">#Calculate residual sum of squares using matrix multiplication; equivalent to SSE1</span>
<span class="n">SST</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ybar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>        <span class="c1">#Calculate total sum of squares; assumes model is just y_pred = mean(ydata)</span>
<span class="n">MSE</span>    <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">Ndata</span>                   <span class="c1">#Calculate mean square error</span>
<span class="n">RMSE</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>                 <span class="c1">#Calculate root mean square error</span>
<span class="n">R2</span>     <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">SST</span>                 <span class="c1">#Calculate R2 (coefficient of determination)</span>
<span class="n">DOF</span>    <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>          <span class="c1">#Count degrees of freedom</span>
<span class="n">s2</span>     <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">DOF</span>                     <span class="c1">#Estimate variance</span>
<span class="n">COV</span>    <span class="o">=</span> <span class="n">s2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">)</span>      <span class="c1">#Generate the covariance matrix for this fit</span>
<span class="n">m</span>      <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                         <span class="c1">#This is a linear model; with the way we define the X matrix, slope is A[0], intercept is A[1]</span>
<span class="n">b</span>      <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                         <span class="c1">#This is a linear model; with the way we define the X matrix, slope is A[0], intercept is A[1] </span>
<span class="n">SEm</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>           <span class="c1">#For our definition of the X matrix, standard error in the slope is the first diagonal element in COV</span>
<span class="n">SEb</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>           <span class="c1">#For our definition of the X matrix, standard error in the intercept is the second diagonal element in COV</span>
<span class="n">tval</span>   <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">DOF</span><span class="p">)</span>      <span class="c1">#t distribution for 95% confidence interval t(1 - α/2, DOF), α = 0.05 for 95% confidence interval</span>
<span class="n">CIm</span>    <span class="o">=</span> <span class="n">SEm</span><span class="o">*</span><span class="n">tval</span>                     <span class="c1">#confidence interval on slope</span>
<span class="n">CIb</span>    <span class="o">=</span> <span class="n">SEb</span><span class="o">*</span><span class="n">tval</span>                     <span class="c1">#confidence interval on intercept</span>
<span class="n">α</span>      <span class="o">=</span> <span class="n">m</span>                            <span class="c1">#slope is equal to the reaction order</span>
<span class="n">k</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>                    <span class="c1">#y intercept is equal to ln(k)</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Printing results using f strings; create arrays of labels and values                     #</span>
<span class="c1">############################################################################################</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;SSE&#39;</span><span class="p">,</span> <span class="s1">&#39;SST&#39;</span><span class="p">,</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span><span class="s1">&#39;RMSE&#39;</span><span class="p">,</span> <span class="s1">&#39;R2&#39;</span><span class="p">,</span> <span class="s1">&#39;α&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span>  <span class="p">,</span>  <span class="n">b</span> <span class="p">,</span>  <span class="n">SSE1</span><span class="p">,</span>  <span class="n">SST</span> <span class="p">,</span> <span class="n">MSE</span> <span class="p">,</span> <span class="n">RMSE</span> <span class="p">,</span>  <span class="n">R2</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIm</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIb</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;α&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIm</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> (but is between </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">CIb</span><span class="p">)</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">CIb</span><span class="p">)</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Visualizing results; overlay data and regressed y(x)                                     #</span>
<span class="c1">############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;experimental rates&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">Ypred</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;linear fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.51</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ln(CA) mol/L&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ln(r) mol/L/s&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Visualizing results; plot of residual errors                                             #</span>
<span class="c1">############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ypred</span><span class="p">)</span><span class="o">/</span><span class="n">Y</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;residual error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">floor</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])),</span> <span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;zero error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.51</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ln(CA) mol/L&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;% Residual Error in ln (r)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Plot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>m    =  9.89e-01 +/- 1.52e-01
b    = -3.74e+00 +/- 3.13e-01
SSE  =      0.06
SST  =      1.48
MSE  =      0.01
RMSE =      0.07
R2   =      0.96
α    =  9.89e-01 +/- 1.52e-01
k    =  2.37e-02 (but is between 1.73e-02 and 3.24e-02)
</pre></div>
</div>
<img alt="../_images/0f7ab82673ef1cf45161fec958723c6a0089db80b9ad8d51ef2c4da2d8c421e5.png" src="../_images/0f7ab82673ef1cf45161fec958723c6a0089db80b9ad8d51ef2c4da2d8c421e5.png" />
<img alt="../_images/31957c3ccc6ece634d5e1001600e95db220b3ca5e80a5d738ea249df2cd41aa6.png" src="../_images/31957c3ccc6ece634d5e1001600e95db220b3ca5e80a5d738ea249df2cd41aa6.png" />
</div>
</div>
<p>Unlike the above analysis based on changes in reactant concentration, here, we can tolerate pretty large levels of imprecision – say standard deviations of roughly 10% – and still obtain reasonable estimates for both the reaction order <span class="math notranslate nohighlight">\((\alpha = 0.99 \pm 0.15)\)</span> and rate constant <span class="math notranslate nohighlight">\((0.017 \ \mathrm{s^{-1}} \leq k \leq 0.032 \ \mathrm{s^{-1}})\)</span>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Measuring precise changes in the concentration of a reactant as the conversion of that reactant approaches zero is very difficult. When working with real data at low conversion, it is far better to define the rate in terms of product concentration!</p>
</div>
</section>
</section>
<section id="example-problem-05">
<h2>Example Problem 05<a class="headerlink" href="#example-problem-05" title="Link to this heading">#</a></h2>
<p>We next consider a data set where not much has been done systematically. A student has performed a kinetic study of the following reaction using a CSTR.</p>
<div class="math notranslate nohighlight">
\[A + 2B \longrightarrow 3C\]</div>
<p>They varied space time (by varying feed flowrate), and they also seem to have been randomly changing the feed concentrations of both <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> with every change in space time. We can propose that the reaction is irreversible and that the rate of reaction depends on concentrations of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> in a power law model:</p>
<div class="math notranslate nohighlight">
\[r = kC_A^\alpha C_B^\beta\]</div>
<p>Please estimate <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(\alpha\)</span>, and <span class="math notranslate nohighlight">\(\beta\)</span>.</p>
<p>The data obtained by the student are attached as CSV file. Our lives will be much easier if we first learn how to import that data into Python (as opposed to manually defining numpy arrays containing that data).</p>
<section id="importing-into-a-dataframe-with-pandas">
<h3>Importing into a dataframe with pandas<a class="headerlink" href="#importing-into-a-dataframe-with-pandas" title="Link to this heading">#</a></h3>
<p>The code in the cell below will import the data as a dataframe using the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> package, which has the display characteristics of a table or spreadsheet. We are using a data frame here primarily to see the data that we have on hand with nice formatting. A minor secondary reason to use dataframes and <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is that these tools are very popular in data analytics, so some exposure is worthwhile even if we do not necessarily <em>need</em> dataframes or <code class="docutils literal notranslate"><span class="pre">pandas</span></code> for this exercise. This data includes residence times (<span class="math notranslate nohighlight">\(\tau\)</span>); feed concentrations of A, B, and C (<span class="math notranslate nohighlight">\(C_{Af}\)</span> and <span class="math notranslate nohighlight">\(C_{Bf}\)</span>); fractional conversion of A measured at at the reactor exit; and effluent concentrations of <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, and <span class="math notranslate nohighlight">\(C\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">dataframe1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;CSTRDATA32.csv&quot;</span><span class="p">)</span>
<span class="n">dataframe1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tau (min)</th>
      <th>Caf (mol/L)</th>
      <th>CBf (mol/L)</th>
      <th>CCf (mol/L)</th>
      <th>XA</th>
      <th>CA (mol/L)</th>
      <th>CB (mol/L)</th>
      <th>CC (mol/L)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>34.877</td>
      <td>0.40</td>
      <td>1.55</td>
      <td>0.0</td>
      <td>0.894</td>
      <td>0.042</td>
      <td>0.824</td>
      <td>1.077</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.103</td>
      <td>0.83</td>
      <td>2.38</td>
      <td>0.0</td>
      <td>0.141</td>
      <td>0.727</td>
      <td>2.209</td>
      <td>0.366</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.646</td>
      <td>0.27</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>0.158</td>
      <td>0.218</td>
      <td>0.923</td>
      <td>0.118</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.923</td>
      <td>0.68</td>
      <td>2.16</td>
      <td>0.0</td>
      <td>0.439</td>
      <td>0.392</td>
      <td>1.507</td>
      <td>0.846</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.217</td>
      <td>0.39</td>
      <td>0.94</td>
      <td>0.0</td>
      <td>0.057</td>
      <td>0.362</td>
      <td>0.806</td>
      <td>0.061</td>
    </tr>
    <tr>
      <th>5</th>
      <td>8.653</td>
      <td>0.68</td>
      <td>1.56</td>
      <td>0.0</td>
      <td>0.613</td>
      <td>0.246</td>
      <td>0.753</td>
      <td>1.371</td>
    </tr>
    <tr>
      <th>6</th>
      <td>36191.127</td>
      <td>0.06</td>
      <td>0.13</td>
      <td>0.0</td>
      <td>0.881</td>
      <td>0.007</td>
      <td>0.025</td>
      <td>0.170</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.774</td>
      <td>0.40</td>
      <td>1.42</td>
      <td>0.0</td>
      <td>0.278</td>
      <td>0.296</td>
      <td>1.125</td>
      <td>0.363</td>
    </tr>
    <tr>
      <th>8</th>
      <td>423.825</td>
      <td>0.10</td>
      <td>0.34</td>
      <td>0.0</td>
      <td>0.820</td>
      <td>0.018</td>
      <td>0.188</td>
      <td>0.254</td>
    </tr>
    <tr>
      <th>9</th>
      <td>8.683</td>
      <td>0.22</td>
      <td>0.85</td>
      <td>0.0</td>
      <td>0.533</td>
      <td>0.098</td>
      <td>0.605</td>
      <td>0.366</td>
    </tr>
    <tr>
      <th>10</th>
      <td>31.499</td>
      <td>0.62</td>
      <td>1.30</td>
      <td>0.0</td>
      <td>0.687</td>
      <td>0.199</td>
      <td>0.495</td>
      <td>1.217</td>
    </tr>
    <tr>
      <th>11</th>
      <td>3.866</td>
      <td>0.92</td>
      <td>2.29</td>
      <td>0.0</td>
      <td>0.631</td>
      <td>0.338</td>
      <td>1.156</td>
      <td>1.875</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.665</td>
      <td>0.90</td>
      <td>3.42</td>
      <td>0.0</td>
      <td>0.722</td>
      <td>0.254</td>
      <td>2.092</td>
      <td>1.862</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.158</td>
      <td>0.45</td>
      <td>1.53</td>
      <td>0.0</td>
      <td>0.102</td>
      <td>0.409</td>
      <td>1.509</td>
      <td>0.134</td>
    </tr>
    <tr>
      <th>14</th>
      <td>32.585</td>
      <td>0.08</td>
      <td>0.28</td>
      <td>0.0</td>
      <td>0.359</td>
      <td>0.049</td>
      <td>0.224</td>
      <td>0.085</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.405</td>
      <td>0.45</td>
      <td>1.37</td>
      <td>0.0</td>
      <td>0.172</td>
      <td>0.378</td>
      <td>1.221</td>
      <td>0.225</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.008</td>
      <td>0.87</td>
      <td>2.76</td>
      <td>0.0</td>
      <td>0.021</td>
      <td>0.831</td>
      <td>2.732</td>
      <td>0.057</td>
    </tr>
    <tr>
      <th>17</th>
      <td>192.999</td>
      <td>0.08</td>
      <td>0.27</td>
      <td>0.0</td>
      <td>0.649</td>
      <td>0.030</td>
      <td>0.165</td>
      <td>0.154</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1.786</td>
      <td>0.17</td>
      <td>0.57</td>
      <td>0.0</td>
      <td>0.144</td>
      <td>0.150</td>
      <td>0.534</td>
      <td>0.073</td>
    </tr>
    <tr>
      <th>19</th>
      <td>14.878</td>
      <td>0.74</td>
      <td>1.89</td>
      <td>0.0</td>
      <td>0.755</td>
      <td>0.182</td>
      <td>0.798</td>
      <td>1.662</td>
    </tr>
    <tr>
      <th>20</th>
      <td>16.254</td>
      <td>0.32</td>
      <td>1.12</td>
      <td>0.0</td>
      <td>0.713</td>
      <td>0.088</td>
      <td>0.673</td>
      <td>0.721</td>
    </tr>
    <tr>
      <th>21</th>
      <td>457.388</td>
      <td>0.71</td>
      <td>1.50</td>
      <td>0.0</td>
      <td>0.894</td>
      <td>0.075</td>
      <td>0.247</td>
      <td>1.858</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2.080</td>
      <td>0.87</td>
      <td>1.97</td>
      <td>0.0</td>
      <td>0.481</td>
      <td>0.454</td>
      <td>1.072</td>
      <td>1.247</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0.292</td>
      <td>0.86</td>
      <td>2.56</td>
      <td>0.0</td>
      <td>0.298</td>
      <td>0.575</td>
      <td>2.009</td>
      <td>0.782</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="converting-the-dataframe-to-a-numpy-array">
<h3>Converting the dataframe to a numpy array<a class="headerlink" href="#converting-the-dataframe-to-a-numpy-array" title="Link to this heading">#</a></h3>
<p>We need to do some calculations on this data. It is generally easier to do math on arrays than it is to do math on Data Frames. To facilitate this, we will use a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> function called <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.to_numpy()</span></code> to convert the dataframe into a 2D numpy array. Once this is done, we can work with the array as usual.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######################################################################################################</span>
<span class="c1"># Convert the dataframe to a numpy array; this allows us to do array calculations as normal          #</span>
<span class="c1">######################################################################################################</span>

<span class="n">data</span>      <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">dataframe1</span><span class="p">)</span>

<span class="c1">######################################################################################################</span>
<span class="c1"># Store the variouscolumns in appropriately labelled arrays; not necessary, but more readable        #</span>
<span class="c1">######################################################################################################</span>

<span class="n">taudata</span>   <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">CAfdata</span>   <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">CBfdata</span>   <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">CCfdata</span>   <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">XAdata</span>    <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">CAdata</span>    <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">CBdata</span>    <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">CCdata</span>    <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculating-reaction-rates">
<h3>Calculating Reaction Rates<a class="headerlink" href="#calculating-reaction-rates" title="Link to this heading">#</a></h3>
<p>The first thing we would like to do is estimate rates of reaction. As discussed earlier in this notebook, when we are working with a single reaction, it is usually preferable to estimate reaction rates from measured product concentrations. This is especially true at short space times and low conversions, where the differences between reactant concentrations are small, and we can see that experimental imprecision leads to challenges in regression analysis.  For this reason, we’ll write a balance on species <span class="math notranslate nohighlight">\(C\)</span>, the product of this reaction:</p>
<div class="math notranslate nohighlight">
\[0 = C_{Cf} - C_C + R_C\tau\]</div>
<p>From the data table, we know that <span class="math notranslate nohighlight">\(C_{Cf} = 0\)</span> in all experiments. We also know that <span class="math notranslate nohighlight">\(R_C = 3r\)</span>. We make these substitutions and solve the material balance for <span class="math notranslate nohighlight">\(r\)</span> to find:</p>
<div class="math notranslate nohighlight">
\[r = \frac{C_C}{3\tau}\]</div>
<p>This is the calculation we’d like to perform first – estimate the reaction rate at each condition based on product concentration. In the cell below, we will convert the DataFrame to a numpy array, construct arrays for each quantity, and then calculate reaction rates. Once this is done, we’ll add the calculated rates as an additional column in the 2D array and convert this back to a Data Frame for display.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######################################################################################################</span>
<span class="c1"># Calculate rates of reaction in each experiment                                                     #</span>
<span class="c1">######################################################################################################</span>

<span class="n">rdata</span>     <span class="o">=</span> <span class="n">CCdata</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="n">taudata</span>

<span class="c1">######################################################################################################</span>
<span class="c1">######################################################################################################</span>
<span class="c1"># Next few lines are only really for displaying as data frame, not necessary for calculations        #</span>
<span class="c1">######################################################################################################</span>
<span class="c1">######################################################################################################</span>

<span class="c1">######################################################################################################</span>
<span class="c1"># Stack column of rates as a new column in the &quot;data&quot; array; need to reshape 1D array to column      #</span>
<span class="c1">######################################################################################################</span>

<span class="n">data_all</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">rdata</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rdata</span><span class="p">),</span> <span class="mi">1</span><span class="p">)])</span>

<span class="c1">######################################################################################################</span>
<span class="c1"># Create a list with column labels from original data frame                                          #</span>
<span class="c1">######################################################################################################</span>

<span class="n">header</span>    <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataframe1</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1">######################################################################################################</span>
<span class="c1"># Append the label for rate with appropriate units to the header                                     #</span>
<span class="c1">######################################################################################################</span>

<span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;r (mol/L/min)&#39;</span><span class="p">)</span>

<span class="c1">######################################################################################################</span>
<span class="c1"># Convert revised data (with rate measurements) to a dataframe; pass header as column labels         #</span>
<span class="c1">######################################################################################################</span>

<span class="n">dataframe2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_all</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">header</span><span class="p">)</span>
<span class="n">dataframe2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tau (min)</th>
      <th>Caf (mol/L)</th>
      <th>CBf (mol/L)</th>
      <th>CCf (mol/L)</th>
      <th>XA</th>
      <th>CA (mol/L)</th>
      <th>CB (mol/L)</th>
      <th>CC (mol/L)</th>
      <th>r (mol/L/min)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>34.877</td>
      <td>0.40</td>
      <td>1.55</td>
      <td>0.0</td>
      <td>0.894</td>
      <td>0.042</td>
      <td>0.824</td>
      <td>1.077</td>
      <td>0.010293</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.103</td>
      <td>0.83</td>
      <td>2.38</td>
      <td>0.0</td>
      <td>0.141</td>
      <td>0.727</td>
      <td>2.209</td>
      <td>0.366</td>
      <td>1.184466</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.646</td>
      <td>0.27</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>0.158</td>
      <td>0.218</td>
      <td>0.923</td>
      <td>0.118</td>
      <td>0.060888</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.923</td>
      <td>0.68</td>
      <td>2.16</td>
      <td>0.0</td>
      <td>0.439</td>
      <td>0.392</td>
      <td>1.507</td>
      <td>0.846</td>
      <td>0.305525</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.217</td>
      <td>0.39</td>
      <td>0.94</td>
      <td>0.0</td>
      <td>0.057</td>
      <td>0.362</td>
      <td>0.806</td>
      <td>0.061</td>
      <td>0.093702</td>
    </tr>
    <tr>
      <th>5</th>
      <td>8.653</td>
      <td>0.68</td>
      <td>1.56</td>
      <td>0.0</td>
      <td>0.613</td>
      <td>0.246</td>
      <td>0.753</td>
      <td>1.371</td>
      <td>0.052814</td>
    </tr>
    <tr>
      <th>6</th>
      <td>36191.127</td>
      <td>0.06</td>
      <td>0.13</td>
      <td>0.0</td>
      <td>0.881</td>
      <td>0.007</td>
      <td>0.025</td>
      <td>0.170</td>
      <td>0.000002</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.774</td>
      <td>0.40</td>
      <td>1.42</td>
      <td>0.0</td>
      <td>0.278</td>
      <td>0.296</td>
      <td>1.125</td>
      <td>0.363</td>
      <td>0.156331</td>
    </tr>
    <tr>
      <th>8</th>
      <td>423.825</td>
      <td>0.10</td>
      <td>0.34</td>
      <td>0.0</td>
      <td>0.820</td>
      <td>0.018</td>
      <td>0.188</td>
      <td>0.254</td>
      <td>0.000200</td>
    </tr>
    <tr>
      <th>9</th>
      <td>8.683</td>
      <td>0.22</td>
      <td>0.85</td>
      <td>0.0</td>
      <td>0.533</td>
      <td>0.098</td>
      <td>0.605</td>
      <td>0.366</td>
      <td>0.014050</td>
    </tr>
    <tr>
      <th>10</th>
      <td>31.499</td>
      <td>0.62</td>
      <td>1.30</td>
      <td>0.0</td>
      <td>0.687</td>
      <td>0.199</td>
      <td>0.495</td>
      <td>1.217</td>
      <td>0.012879</td>
    </tr>
    <tr>
      <th>11</th>
      <td>3.866</td>
      <td>0.92</td>
      <td>2.29</td>
      <td>0.0</td>
      <td>0.631</td>
      <td>0.338</td>
      <td>1.156</td>
      <td>1.875</td>
      <td>0.161666</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.665</td>
      <td>0.90</td>
      <td>3.42</td>
      <td>0.0</td>
      <td>0.722</td>
      <td>0.254</td>
      <td>2.092</td>
      <td>1.862</td>
      <td>0.372773</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.158</td>
      <td>0.45</td>
      <td>1.53</td>
      <td>0.0</td>
      <td>0.102</td>
      <td>0.409</td>
      <td>1.509</td>
      <td>0.134</td>
      <td>0.282700</td>
    </tr>
    <tr>
      <th>14</th>
      <td>32.585</td>
      <td>0.08</td>
      <td>0.28</td>
      <td>0.0</td>
      <td>0.359</td>
      <td>0.049</td>
      <td>0.224</td>
      <td>0.085</td>
      <td>0.000870</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.405</td>
      <td>0.45</td>
      <td>1.37</td>
      <td>0.0</td>
      <td>0.172</td>
      <td>0.378</td>
      <td>1.221</td>
      <td>0.225</td>
      <td>0.185185</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.008</td>
      <td>0.87</td>
      <td>2.76</td>
      <td>0.0</td>
      <td>0.021</td>
      <td>0.831</td>
      <td>2.732</td>
      <td>0.057</td>
      <td>2.375000</td>
    </tr>
    <tr>
      <th>17</th>
      <td>192.999</td>
      <td>0.08</td>
      <td>0.27</td>
      <td>0.0</td>
      <td>0.649</td>
      <td>0.030</td>
      <td>0.165</td>
      <td>0.154</td>
      <td>0.000266</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1.786</td>
      <td>0.17</td>
      <td>0.57</td>
      <td>0.0</td>
      <td>0.144</td>
      <td>0.150</td>
      <td>0.534</td>
      <td>0.073</td>
      <td>0.013624</td>
    </tr>
    <tr>
      <th>19</th>
      <td>14.878</td>
      <td>0.74</td>
      <td>1.89</td>
      <td>0.0</td>
      <td>0.755</td>
      <td>0.182</td>
      <td>0.798</td>
      <td>1.662</td>
      <td>0.037236</td>
    </tr>
    <tr>
      <th>20</th>
      <td>16.254</td>
      <td>0.32</td>
      <td>1.12</td>
      <td>0.0</td>
      <td>0.713</td>
      <td>0.088</td>
      <td>0.673</td>
      <td>0.721</td>
      <td>0.014786</td>
    </tr>
    <tr>
      <th>21</th>
      <td>457.388</td>
      <td>0.71</td>
      <td>1.50</td>
      <td>0.0</td>
      <td>0.894</td>
      <td>0.075</td>
      <td>0.247</td>
      <td>1.858</td>
      <td>0.001354</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2.080</td>
      <td>0.87</td>
      <td>1.97</td>
      <td>0.0</td>
      <td>0.481</td>
      <td>0.454</td>
      <td>1.072</td>
      <td>1.247</td>
      <td>0.199840</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0.292</td>
      <td>0.86</td>
      <td>2.56</td>
      <td>0.0</td>
      <td>0.298</td>
      <td>0.575</td>
      <td>2.009</td>
      <td>0.782</td>
      <td>0.892694</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="parameter-estimation">
<h3>Parameter Estimation<a class="headerlink" href="#parameter-estimation" title="Link to this heading">#</a></h3>
<p>At this point in the analysis, we have data from 23 different experiments. The critical information obtained from these experiments is that, for each experiment, we know <span class="math notranslate nohighlight">\(C_A\)</span> and <span class="math notranslate nohighlight">\(C_B\)</span> inside of the reactor (since CSTRs are well mixed, effluent concentrations are the same as reactor concentrations), and we know the rate of reaction at each <span class="math notranslate nohighlight">\((C_A, C_B)\)</span> pair. We want to use this information to estimate <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(\alpha\)</span>, and <span class="math notranslate nohighlight">\(\beta\)</span>. Our conventional wisdom is that, to determine a parameter, you need to vary the quantity influenced that parameter while holding everything else constant. For example, if you wanted to know <span class="math notranslate nohighlight">\(\alpha\)</span>, the most straightforward experiment would be one that measures <span class="math notranslate nohighlight">\(r\)</span> for various values of <span class="math notranslate nohighlight">\(C_A\)</span> while holding <span class="math notranslate nohighlight">\(C_B\)</span> constant.  This would allow you to isolate the impact of <span class="math notranslate nohighlight">\(C_A\)</span> on reaction rate and therefore estimate <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<p>The data here was not obtained in that fashion – instead, we have rates measured in 23 different experiments, and the concentrations of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are both varying in each experiment. This means there is no good way for us to isolate the dependence of one from the other. We will consider two different approaches that will allow us to extract parameter estimates from this type of data set.  The first is nonlinear regresion, and the second is multiple linear regression.</p>
<section id="parameter-estimation-using-nonlinear-regression">
<h4>Parameter Estimation Using Nonlinear Regression<a class="headerlink" href="#parameter-estimation-using-nonlinear-regression" title="Link to this heading">#</a></h4>
<p>One solution is to use nonlinear regression to minimize an objective function created by calculating the residual sum of squares between measured rates and model predicted rates.  The general approach is that we need to write an objective function that will calculate the quantity that we would like to minimize (here, residual sum of squares) as a function of the parameter(s) that we would like to minimize with respect to. Here, we have a multivariate optimization problem in that we would like to minimize residual sum of squares with respect to <span class="math notranslate nohighlight">\((k, \alpha, \beta)\)</span>. We therefore need to construct a multivariate objective function and use <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code>. We introduced the optimization of univariate scalar functions in <a class="reference external" href="https://jqbond.github.io/CEN587/Notebooks/587-N28.html">Notebook 28</a>, and optimization is covered more broadly in <a class="reference external" href="https://jqbond.github.io/CEN587/Supplements/587-S10.html">Python Supplement 10 - minimizing univariate functions</a> and <a class="reference external" href="https://jqbond.github.io/CEN587/Supplements/587-S11.html">Python Supplement 11 - Minimizing Multivariate Functions</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">OBJ</span><span class="p">(</span><span class="n">par</span><span class="p">):</span>
    <span class="n">k</span>     <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">beta</span>  <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="n">CA</span>  <span class="o">=</span> <span class="n">CAdata</span>
    <span class="n">CB</span>  <span class="o">=</span> <span class="n">CBdata</span>
    
    <span class="n">rmod</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">CA</span><span class="o">**</span><span class="n">alpha</span><span class="o">*</span><span class="n">CB</span><span class="o">**</span><span class="n">beta</span>
    <span class="n">rexp</span> <span class="o">=</span> <span class="n">rdata</span>
    <span class="n">SSE</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">rmod</span> <span class="o">-</span> <span class="n">rexp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">SSE</span>

<span class="n">par0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ans</span>  <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">OBJ</span><span class="p">,</span> <span class="n">par0</span><span class="p">)</span>
<span class="n">k_opt</span><span class="p">,</span> <span class="n">α_opt</span><span class="p">,</span> <span class="n">β_opt</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">x</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; k = </span><span class="si">{</span><span class="n">k_opt</span><span class="si">:</span><span class="s1">8.2E</span><span class="si">}</span><span class="s1">, α = </span><span class="si">{</span><span class="n">α_opt</span><span class="si">:</span><span class="s1">3.2f</span><span class="si">}</span><span class="s1">, β = </span><span class="si">{</span><span class="n">β_opt</span><span class="si">:</span><span class="s1">3.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> k = 3.02E-01, α = 0.99, β = 2.22
</pre></div>
</div>
</div>
</div>
<p>From the above analysis, we conclude that:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    k &amp;\approx 0.302 \\
    \alpha &amp;\approx 1 \\
    \beta &amp;\approx 2
\end{align*}\]</div>
</section>
<section id="estimating-parameters-using-multiple-linear-regression">
<h4>Estimating Parameters using Multiple Linear Regression<a class="headerlink" href="#estimating-parameters-using-multiple-linear-regression" title="Link to this heading">#</a></h4>
<p>Alternatively, we can linearize this problem.  We know that the rate of reaction should be given by a power law:</p>
<div class="math notranslate nohighlight">
\[r = k{C_A}^\alpha {C_B}^\beta\]</div>
<p>This can be linearized as usual by taking logarithms of both sides to give:</p>
<div class="math notranslate nohighlight">
\[\ln(r) = \alpha \ln(C_A) + \beta \ln(C_B) + \ln(k)\]</div>
<p>Putting this into matrix form, we would have:</p>
<div class="math notranslate nohighlight">
\[XA = Y\]</div>
<p>Where</p>
<p><span class="math notranslate nohighlight">\(X\)</span> is a vandermonde type matrix in which each row is:</p>
<div class="math notranslate nohighlight">
\[[i,:] = \begin{bmatrix} \ln(C_A)_i &amp; \ln(C_B)_i &amp; 1 \end{bmatrix}\]</div>
<p>And where</p>
<div class="math notranslate nohighlight">
\[\begin{split}A = \begin{bmatrix} \alpha \\ \beta \\ \ln(k) \end{bmatrix}\end{split}\]</div>
<p>And where <span class="math notranslate nohighlight">\(Y\)</span> is a vector of our observable measurements, in this case, ln(r), so each entry is given by:</p>
<div class="math notranslate nohighlight">
\[Y[i] = \ln(r)_i\]</div>
<p>With these definitions, we can perform linear regression as usual. The caveate is that we need to create the <span class="math notranslate nohighlight">\(X\)</span> matrix manually because <code class="docutils literal notranslate"><span class="pre">numpy.vander()</span></code> is constructed for polynomial regression using univariate polynomials (e.g., functions of only 1 independent variable). Here, we have two independent variables, <span class="math notranslate nohighlight">\(\ln(CA)\)</span> and <span class="math notranslate nohighlight">\(\ln(C_B)\)</span>, and we need to construct the <span class="math notranslate nohighlight">\(X\)</span> matrix accordingly. Once this is done, we solve for the linear least squares solution as usual.</p>
<div class="math notranslate nohighlight">
\[\hat{A} = (X^\prime X)^{-1}X^\prime Y\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#####################################################################################################</span>
<span class="c1"># Define the X matrix and Y array                                                                   #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">X</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">rdata</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CAdata</span><span class="p">)</span>
<span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">CBdata</span><span class="p">)</span>
<span class="n">Y</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rdata</span><span class="p">)</span>

<span class="c1">#####################################################################################################</span>
<span class="c1"># Solve the least squares problem to find the best fit coefficients                                 #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@Y</span><span class="p">)</span> 

<span class="c1">#####################################################################################################</span>
<span class="c1"># Workup and analysis for quantifying and visualizing goodness of fit                               #</span>
<span class="c1">#####################################################################################################</span>

<span class="n">Ypred</span>  <span class="o">=</span> <span class="n">X</span><span class="nd">@A</span>                          <span class="c1">#Calculate discrete array of predicted y values at each x value</span>
<span class="n">Ybar</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>               <span class="c1">#Calculate the mean of the measured y values, use for SST calculation</span>
<span class="n">Ndata</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>                   <span class="c1">#Calculate the number of data points/measurementws</span>
<span class="n">SSE1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ypred</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>       <span class="c1">#Calculate residual sum of squares using intuitive summation formula</span>
<span class="n">SSE2</span>   <span class="o">=</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">X</span><span class="nd">@A</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">@</span><span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">X</span><span class="nd">@A</span><span class="p">)</span>        <span class="c1">#Calculate residual sum of squares using matrix multiplication; equivalent to SSE1</span>
<span class="n">SST</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ybar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>        <span class="c1">#Calculate total sum of squares; assumes model is just y_pred = mean(ydata)</span>
<span class="n">MSE</span>    <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">Ndata</span>                   <span class="c1">#Calculate mean square error</span>
<span class="n">RMSE</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>                 <span class="c1">#Calculate root mean square error</span>
<span class="n">R2</span>     <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">SST</span>                 <span class="c1">#Calculate R2 (coefficient of determination)</span>
<span class="n">DOF</span>    <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>          <span class="c1">#Count degrees of freedom</span>
<span class="n">s2</span>     <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">DOF</span>                     <span class="c1">#Estimate variance</span>
<span class="n">COV</span>    <span class="o">=</span> <span class="n">s2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">)</span>      <span class="c1">#Generate the covariance matrix for this fit</span>
<span class="n">α</span>     <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                          <span class="c1">#first coefficient is α</span>
<span class="n">β</span>     <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                          <span class="c1">#second coefficient is β</span>
<span class="n">b</span>     <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>                          <span class="c1">#third coefficient is intercept/bias = ln(k)</span>
<span class="n">SEα</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>            <span class="c1">#Standard error in α</span>
<span class="n">SEβ</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>            <span class="c1">#Standard error in β</span>
<span class="n">SEb</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>            <span class="c1">#Standard error in y-intercept</span>
<span class="n">tval</span>  <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">DOF</span><span class="p">)</span>       <span class="c1">#t distribution value for 95% confidence intervals</span>
<span class="n">CIα</span>   <span class="o">=</span> <span class="n">SEα</span><span class="o">*</span><span class="n">tval</span>                      <span class="c1">#95% confidence interval on α</span>
<span class="n">CIβ</span>   <span class="o">=</span> <span class="n">SEβ</span><span class="o">*</span><span class="n">tval</span>                      <span class="c1">#95% confidence interval on β</span>
<span class="n">CIb</span>   <span class="o">=</span> <span class="n">SEb</span><span class="o">*</span><span class="n">tval</span>                      <span class="c1">#95% confidence interval on y-intercept</span>
<span class="n">k</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Printing results using f strings; create arrays of labels and values                     #</span>
<span class="c1">############################################################################################</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SSE&#39;</span><span class="p">,</span> <span class="s1">&#39;SST&#39;</span><span class="p">,</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span><span class="s1">&#39;RMSE&#39;</span><span class="p">,</span> <span class="s1">&#39;R2&#39;</span><span class="p">,</span> <span class="s1">&#39;α&#39;</span><span class="p">,</span> <span class="s1">&#39;β&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span> <span class="n">SSE1</span><span class="p">,</span>  <span class="n">SST</span> <span class="p">,</span> <span class="n">MSE</span> <span class="p">,</span> <span class="n">RMSE</span> <span class="p">,</span>  <span class="n">R2</span> <span class="p">,</span>  <span class="n">α</span> <span class="p">,</span>  <span class="n">β</span> <span class="p">,</span>  <span class="n">k</span> <span class="p">]</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;α&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIα</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;β&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIβ</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIb</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2e</span><span class="si">}</span><span class="s1"> (but is between </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">CIb</span><span class="p">)</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">CIb</span><span class="p">)</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">9.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Visualizing results; parity plot                                                         #</span>
<span class="c1">############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Ypred</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;estimated rates&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">Y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">Y</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">Y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">Y</span><span class="p">)],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;linear fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Measured ln(r)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Predicted ln(r)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Parity Plot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">14.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">14.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Visualizing results; plot of residual errors                                             #</span>
<span class="c1">############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Ypred</span><span class="p">),</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;residual error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;zero error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Experiment Number&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Percent Residual Error&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Plot&#39;</span><span class="p">)</span>
<span class="c1">#plt.xlim(-14.0, 2.0)</span>
<span class="c1">#plt.ylim(-14.0, 2.0)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SSE  =      0.26
SST  =    328.63
MSE  =      0.02
RMSE =      0.15
R2   =      1.00
α    =  9.93e-01 +/- 1.72e-01
β    =  2.03e+00 +/- 2.00e-01
k    =  3.45e-01 (but is between 2.65e-01 and 4.48e-01)
</pre></div>
</div>
<img alt="../_images/2d102705c726a112d2abcd0763ff0b1414c7882f28937e23d83d0dca78f1d62b.png" src="../_images/2d102705c726a112d2abcd0763ff0b1414c7882f28937e23d83d0dca78f1d62b.png" />
<img alt="../_images/6b0e51d9578fb352247645ccb34544e6551f0b86726ddd6a3a834f3311901f87.png" src="../_images/6b0e51d9578fb352247645ccb34544e6551f0b86726ddd6a3a834f3311901f87.png" />
</div>
</div>
<p>From this analysis, we conclude that</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    0.265 &amp;\leq \ k \leq 0.448 \ \mathrm{L^2 mol^{-2} min^{-1}}\\
    \alpha &amp;= 0.99 \pm 0.17 \\
    \beta &amp;= 2.03 \pm 0.20 
\end{align*}\]</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="587-N42.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Kinetics IV</p>
      </div>
    </a>
    <a class="right-next"
       href="587-N44.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Kinetics V</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-01-analysis-of-perfect-data">Example Problem 01: Analysis of Perfect Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-01">Solution to Example Problem 01</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimation-of-reaction-rates-in-a-cstr-at-steady-state">Estimation of reaction rates in a CSTR at Steady State</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression-on-perfect-data-generated-by-solving-material-balance">Linear Regression on Perfect Data (generated by solving material balance)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-02-analysis-of-slightly-more-realistic-data">Example Problem 02: Analysis of (Slightly) More Realistic Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression-on-data-rounded-to-instrument-precision">Linear Regression on Data Rounded to Instrument Precision</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-03-processing-noisy-data-simulating-a-real-experiment">Example 03: Processing Noisy Data (simulating a real experiment)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression-on-noisy-data">Linear Regression on Noisy Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-04-leveraging-product-concentrations-to-estimate-reaction-rate">Example Problem 04: Leveraging Product Concentrations to estimate reaction rate</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression-of-noisy-rates-based-on-product-concentration">Linear Regression of noisy rates based on product concentration</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-05">Example Problem 05</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-into-a-dataframe-with-pandas">Importing into a dataframe with pandas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-the-dataframe-to-a-numpy-array">Converting the dataframe to a numpy array</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-reaction-rates">Calculating Reaction Rates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-estimation">Parameter Estimation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-estimation-using-nonlinear-regression">Parameter Estimation Using Nonlinear Regression</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-parameters-using-multiple-linear-regression">Estimating Parameters using Multiple Linear Regression</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jesse Q. Bond, Syracuse University
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>