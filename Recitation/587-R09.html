
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Reactors with Recycle &#8212; Kinetics and Reaction Engineering</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Interpolation and Regression" href="587-R10.html" />
    <link rel="prev" title="Optimization" href="587-R08.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/JQB.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Kinetics and Reaction Engineering</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Chapter1.html">
   Python Supplements
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S01.html">
     The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S02.html">
     Data Structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S03.html">
     Arrays and Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S04.html">
     For Loops and Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S05.html">
     Logical Tests and Comparisons
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S06.html">
     While Loops in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S07.html">
     Functions, D&amp;D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S08.html">
     The Fall of Acererak
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S09.html">
     Root Finding: Univariate Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S10.html">
     Minimizing a Univariate Function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S11.html">
     Minimizing Multivariate Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S12.html">
     Systems of Nonlinear Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S13.html">
     Least Squares Revisited
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S14.html">
     ODE Solvers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S15.html">
     Quadrature
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Chapter2.html">
   Lectures
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L01.html">
     Introduction and Stoichiometry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L02.html">
     Extent and Conversion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L03.html">
     Algebraic and Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L04.html">
     Chemical Equilibrium I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L05.html">
     Chemical Equilibrium II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L06.html">
     Chemical Equilibrium III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L07.html">
     Chemical Equilibrium IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L08.html">
     Chemical Equilibrium V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L09.html">
     Chemical and Phase Equilibria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L10.html">
     Material Balances I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L11.html">
     Material Balances II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L12.html">
     Material Balances III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L13.html">
     Material Balances IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L14.html">
     Material Balances V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L15.html">
     Material Balances VI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L16.html">
     Material Balances VII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L17.html">
     Material Balances VIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L18.html">
     Material Balances IX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L19.html">
     Material Balances X
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L20.html">
     Material Balances XI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L21.html">
     Material Balances XII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L22.html">
     Material Balances XIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L23.html">
     Material Balances XIV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L24.html">
     Material Balances XV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L25.html">
     Material Balances XVI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L26.html">
     Material Balances XVII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L27.html">
     Material Balances XVIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L28.html">
     Kinetics I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L29.html">
     Kinetics II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L30.html">
     Kinetics III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L31.html">
     Kinetics IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L32.html">
     Kinetics V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L33.html">
     Kinetics VI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L34.html">
     Kinetics VII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L35.html">
     Kinetics VIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L36.html">
     Kinetics IX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L37.html">
     Kinetics X
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L38.html">
     Kinetics XI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L39.html">
     Energy Balances I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L40.html">
     Energy Balances II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L41.html">
     Energy Balances III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L42.html">
     Energy Balances IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Lectures/587-L43.html">
     Energy Balances VI
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../Chapter3.html">
   Recitations
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="587-R01.html">
     Jupyter and Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-R02.html">
     Solving Algebraic Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-R03.html">
     Chemical Equilibrium
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-R04.html">
     Solving ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-R05.html">
     Chemical/Phase Equilibria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-R06.html">
     CSTRs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-R07.html">
     Python tips and tricks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-R08.html">
     Optimization
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Reactors with Recycle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-R10.html">
     Interpolation and Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-R11.html">
     Nonlinear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-R12.html">
     Parameter Estimation I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-R13.html">
     Parameter Estimation II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-R14.html">
     Energy Balances
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/jqbond/AICHE2022_Python/main?urlpath=tree/Recitation/587-R09.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/jqbond/AICHE2022_Python"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/jqbond/AICHE2022_Python/issues/new?title=Issue%20on%20page%20%2FRecitation/587-R09.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Recitation/587-R09.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-01-a-recap-of-the-propane-dehydrogenation-example">
   Problem 01: A Recap of the Propane Dehydrogenation Example
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-the-in-class-example">
     Solution to the in class example
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis-of-the-overall-process">
       Analysis of the overall process
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis-of-the-splitter">
       Analysis of the Splitter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis-of-the-separator">
       Analysis of the separator
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis-of-the-mixer">
       Analysis of the mixer
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis-of-the-reactor">
       Analysis of the reactor
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solve-the-pfr-balance">
       Solve the PFR Balance
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#this-was-an-easy-problem">
     This was an easy problem…
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-02">
   Problem 02
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-02">
     Solution to Example Problem 02
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-mixer">
       Balance on Mixer
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-cstr">
       Balance on CSTR
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-separator">
       Balance on Separator
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-splitter">
       Balance on Splitter
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-03">
   Problem 03
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-03">
     Solution to Example Problem 03
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Balance on Mixer
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-pfr-400l">
       Balance on PFR (400L)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Balance on Separator
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Balance on Splitter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#recycle-specification">
       Recycle Specification
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#other-information">
       Other Information
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#taking-stock-of-the-situation">
       Taking stock of the situation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#resolving-the-pfr-balance-symbolically">
       Resolving the PFR balance (symbolically)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-04">
   Problem 04
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Solution to Example Problem 03
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Balance on Mixer
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Balance on PFR (400L)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       Balance on Separator
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Balance on Splitter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       Recycle Specification
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       Other Information
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       Taking stock of the situation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#resolving-the-pfr-balance-numerically">
       Resolving the PFR balance (numerically)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Reactors with Recycle</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-01-a-recap-of-the-propane-dehydrogenation-example">
   Problem 01: A Recap of the Propane Dehydrogenation Example
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-the-in-class-example">
     Solution to the in class example
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis-of-the-overall-process">
       Analysis of the overall process
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis-of-the-splitter">
       Analysis of the Splitter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis-of-the-separator">
       Analysis of the separator
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis-of-the-mixer">
       Analysis of the mixer
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis-of-the-reactor">
       Analysis of the reactor
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solve-the-pfr-balance">
       Solve the PFR Balance
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#this-was-an-easy-problem">
     This was an easy problem…
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-02">
   Problem 02
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-02">
     Solution to Example Problem 02
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-mixer">
       Balance on Mixer
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-cstr">
       Balance on CSTR
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-separator">
       Balance on Separator
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-splitter">
       Balance on Splitter
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-03">
   Problem 03
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-03">
     Solution to Example Problem 03
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Balance on Mixer
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#balance-on-pfr-400l">
       Balance on PFR (400L)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Balance on Separator
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Balance on Splitter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#recycle-specification">
       Recycle Specification
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#other-information">
       Other Information
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#taking-stock-of-the-situation">
       Taking stock of the situation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#resolving-the-pfr-balance-symbolically">
       Resolving the PFR balance (symbolically)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-04">
   Problem 04
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Solution to Example Problem 03
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Balance on Mixer
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Balance on PFR (400L)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       Balance on Separator
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Balance on Splitter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       Recycle Specification
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       Other Information
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       Taking stock of the situation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#resolving-the-pfr-balance-numerically">
       Resolving the PFR balance (numerically)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="reactors-with-recycle">
<h1>Reactors with Recycle<a class="headerlink" href="#reactors-with-recycle" title="Permalink to this headline">#</a></h1>
<p>During L26, we considered the idea that a reactor-with-recycle process could be used to attain high overall (process-level) conversion for reactions that are somehow limited to low single pass (once through the reactor) conversion.  The scenario we considered in class was an equilibrium-limited reaction (propane dehydrogenation), but reactor-with-recycle schemes can also be used to improve overall yields when dealing with sequential reactions.  Specifically, it allows one to operate the reactor at relatively low single-pass conversion to avoid secondary reactions, but it recycles the remainder to allow a high overall conversion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
</pre></div>
</div>
</div>
</div>
<section id="problem-01-a-recap-of-the-propane-dehydrogenation-example">
<h2>Problem 01: A Recap of the Propane Dehydrogenation Example<a class="headerlink" href="#problem-01-a-recap-of-the-propane-dehydrogenation-example" title="Permalink to this headline">#</a></h2>
<p>Returning to the the schematic we worked with in class (Note that flowrates are relabelled with numbers 0 to 5 instead of letters):</p>
<a class="reference internal image-reference" href="Recitation/PFRRecycle.jpg"><img alt="Recitation/PFRRecycle.jpg" src="Recitation/PFRRecycle.jpg" style="width: 700px; height: 500px;" /></a>
<p>We will  operate the PFR at 8.2 atm and 500K, and we are feeding propane into the <em>process</em> at 10 moles per minute.  Under these conditions, we know that:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    k_f  &amp;= 0.7  \ \textrm{min}^{-1} \\
    K_C &amp;= 0.05 \ \textrm{mol} \ \textrm{L}^{-1}\\	
\end{align*}\]</div>
<ol class="simple">
<li><p>Determine the minimum recycle ratio required to achieve an overall propylene yield of 95% during propane dehydrogenation.</p></li>
<li><p>For this recycle ratio, determine the size of PFR required to achieve an overall propylene yield of 95%.</p></li>
</ol>
<section id="solution-to-the-in-class-example">
<h3>Solution to the in class example<a class="headerlink" href="#solution-to-the-in-class-example" title="Permalink to this headline">#</a></h3>
<section id="analysis-of-the-overall-process">
<h4>Analysis of the overall process<a class="headerlink" href="#analysis-of-the-overall-process" title="Permalink to this headline">#</a></h4>
<p>If we draw a black box around the whole process, we know that it must achieve 95% conversion of the propane fed into the process at a flowrate of 10 mol/min.  We can therefore define the exit flowrate of propane in terms of the inlet flowrate and the overall conversion</p>
<div class="math notranslate nohighlight">
\[F_{A4} = F_{A0}\left(1 - X_{A_{ov}}\right)\]</div>
</section>
<section id="analysis-of-the-splitter">
<h4>Analysis of the Splitter<a class="headerlink" href="#analysis-of-the-splitter" title="Permalink to this headline">#</a></h4>
<p>A balance on the splitter gives:</p>
<div class="math notranslate nohighlight">
\[0 = F_{A3} - F_{A4} - F_{A5}\]</div>
<p>We can express the recycle flowrate as a fraction of the flow into the splitter, i.e.,</p>
<div class="math notranslate nohighlight">
\[F_{A5} = \alpha F_{A3}\]</div>
<p>Substituting this into the splitter balance, we find:</p>
<div class="math notranslate nohighlight">
\[0 = F_{A3} - F_{A4} - \alpha F_{A3}\]</div>
<p>We can solve for <span class="math notranslate nohighlight">\(F_{A3}\)</span> to find:</p>
<div class="math notranslate nohighlight">
\[F_{A3} = \frac{1}{1 - \alpha}F_{A4}\]</div>
<p>And we can substitute this back into the definition for <span class="math notranslate nohighlight">\(F_{A5}\)</span>:</p>
<div class="math notranslate nohighlight">
\[F_{A5} = \frac{\alpha}{1 - \alpha} F_{A4}\]</div>
</section>
<section id="analysis-of-the-separator">
<h4>Analysis of the separator<a class="headerlink" href="#analysis-of-the-separator" title="Permalink to this headline">#</a></h4>
<p>A balance on the separator is straightforward and tells us that:</p>
<div class="math notranslate nohighlight">
\[F_{A2} = F_{A3}\]</div>
</section>
<section id="analysis-of-the-mixer">
<h4>Analysis of the mixer<a class="headerlink" href="#analysis-of-the-mixer" title="Permalink to this headline">#</a></h4>
<p>A balance on the mixer will give us the combined feed rate into the reactor, <span class="math notranslate nohighlight">\(F_{A0}\)</span></p>
<div class="math notranslate nohighlight">
\[F_{A1} = F_{A0} + F_{A5}\]</div>
</section>
<section id="analysis-of-the-reactor">
<h4>Analysis of the reactor<a class="headerlink" href="#analysis-of-the-reactor" title="Permalink to this headline">#</a></h4>
<p>If we look at the reactor, we can define a single pass fractional conversion in terms of <span class="math notranslate nohighlight">\(F_{A1}\)</span> and <span class="math notranslate nohighlight">\(F_{A2}\)</span>:</p>
<div class="math notranslate nohighlight">
\[X_{SP} = \frac{F_{A1} - F_{A2}}{F_{A1}}\]</div>
<p>We still have a degree of freedom in this system, so we can’t solve it just yet.  But, once we specify the recycle ratio, we can fully solve for all flowrates and the single pass conversion through the PFR. The way I’m approaching the analysis here is that we know the equilibrium limit on this PFR at 500K and 8.2 atm is ~ 44% conversion, so we just have to find a recycle ratio that will allow us to operate with a PFR below 44% conversion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">α</span>   <span class="o">=</span> <span class="mf">0.96</span>
<span class="n">XOV</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">FA0</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">#mol/min</span>
<span class="n">FA4</span> <span class="o">=</span> <span class="n">FA0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">XOV</span><span class="p">)</span>
<span class="n">FA3</span> <span class="o">=</span> <span class="n">FA4</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">α</span><span class="p">)</span>
<span class="n">FA2</span> <span class="o">=</span> <span class="n">FA3</span>
<span class="n">FA5</span> <span class="o">=</span> <span class="n">α</span><span class="o">*</span><span class="n">FA3</span>
<span class="n">FA1</span> <span class="o">=</span> <span class="n">FA0</span> <span class="o">+</span> <span class="n">FA5</span>
<span class="n">XSP</span> <span class="o">=</span> <span class="p">(</span><span class="n">FA1</span> <span class="o">-</span> <span class="n">FA2</span><span class="p">)</span><span class="o">/</span><span class="n">FA1</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;α&#39;</span><span class="p">,</span> <span class="s1">&#39;FA0&#39;</span><span class="p">,</span> <span class="s1">&#39;FA1&#39;</span><span class="p">,</span> <span class="s1">&#39;FA2&#39;</span><span class="p">,</span> <span class="s1">&#39;FA3&#39;</span><span class="p">,</span> <span class="s1">&#39;FA4&#39;</span><span class="p">,</span> <span class="s1">&#39;FA5&#39;</span><span class="p">,</span> <span class="s1">&#39;XSP&#39;</span><span class="p">,</span> <span class="s1">&#39;XOV&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">α</span><span class="p">,</span> <span class="n">FA0</span><span class="p">,</span> <span class="n">FA1</span><span class="p">,</span> <span class="n">FA2</span><span class="p">,</span> <span class="n">FA3</span><span class="p">,</span> <span class="n">FA4</span><span class="p">,</span> <span class="n">FA5</span><span class="p">,</span> <span class="n">XSP</span><span class="p">,</span> <span class="n">XOV</span><span class="p">]</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;XSP&#39;</span> <span class="ow">or</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;XOV&#39;</span> <span class="ow">or</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;α&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">3s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">5.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">3s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">5.2f</span><span class="si">}</span><span class="s1"> mol/min&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>α   =  0.96
FA0 = 10.00 mol/min
FA1 = 22.00 mol/min
FA2 = 12.50 mol/min
FA3 = 12.50 mol/min
FA4 =  0.50 mol/min
FA5 = 12.00 mol/min
XSP =  0.43
XOV =  0.95
</pre></div>
</div>
</div>
</div>
</section>
<section id="solve-the-pfr-balance">
<h4>Solve the PFR Balance<a class="headerlink" href="#solve-the-pfr-balance" title="Permalink to this headline">#</a></h4>
<p>Now that we know the recycle ratio (and therefore the feed into the reactor, <span class="math notranslate nohighlight">\(F_{A0}\)</span>), we can solve the material balance to determine the PFR size required to achieve a single pass conversion of 0.4318</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kf</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1">#1/min</span>
<span class="n">KC</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="c1">#mol/L</span>
<span class="n">kr</span> <span class="o">=</span> <span class="n">kf</span><span class="o">/</span><span class="n">KC</span> <span class="c1">#L/mol/min</span>
<span class="n">T</span>  <span class="o">=</span> <span class="mi">500</span> <span class="c1">#K</span>
<span class="n">P</span>  <span class="o">=</span> <span class="mf">8.2</span> <span class="c1">#atm</span>
<span class="n">R</span>  <span class="o">=</span> <span class="mf">0.08206</span> <span class="c1">#L*atm/mol/K</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">P01</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">par</span><span class="p">):</span>
    <span class="n">FA</span><span class="p">,</span> <span class="n">FB</span><span class="p">,</span> <span class="n">FC</span> <span class="o">=</span> <span class="n">var</span>
    <span class="n">kf</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">par</span>
    
    <span class="n">FT</span> <span class="o">=</span> <span class="n">FA</span> <span class="o">+</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">FC</span>
    
    <span class="n">Q</span>  <span class="o">=</span> <span class="n">FT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>
    
    <span class="n">CA</span> <span class="o">=</span> <span class="n">FA</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CB</span> <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CC</span> <span class="o">=</span> <span class="n">FC</span><span class="o">/</span><span class="n">Q</span>
    
    <span class="n">r</span>  <span class="o">=</span> <span class="n">kf</span><span class="o">*</span><span class="n">CA</span> <span class="o">-</span> <span class="n">kr</span><span class="o">*</span><span class="n">CB</span><span class="o">*</span><span class="n">CC</span>
    
    <span class="n">RA</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span>
    <span class="n">RB</span> <span class="o">=</span>  <span class="n">r</span>
    <span class="n">RC</span> <span class="o">=</span>  <span class="n">r</span>
    
    <span class="n">dA</span> <span class="o">=</span> <span class="n">RA</span>
    <span class="n">dB</span> <span class="o">=</span> <span class="n">RB</span>
    <span class="n">dC</span> <span class="o">=</span> <span class="n">RC</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="n">dA</span><span class="p">,</span> <span class="n">dB</span><span class="p">,</span> <span class="n">dC</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FAf</span> <span class="o">=</span> <span class="n">FA1</span> <span class="c1">#mol/min</span>
<span class="n">FBf</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">FCf</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Vspan</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">)</span>
<span class="n">var0</span>  <span class="o">=</span> <span class="p">(</span><span class="n">FAf</span><span class="p">,</span> <span class="n">FBf</span><span class="p">,</span> <span class="n">FCf</span><span class="p">)</span>
<span class="n">par0</span>  <span class="o">=</span> <span class="p">(</span><span class="n">kf</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
<span class="n">ans2</span>  <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">P01</span><span class="p">,</span> <span class="n">Vspan</span><span class="p">,</span> <span class="n">var0</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">par0</span><span class="p">,</span> <span class="p">),</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span>  <span class="mf">1e-8</span><span class="p">)</span>

<span class="n">V</span>     <span class="o">=</span> <span class="n">ans2</span><span class="o">.</span><span class="n">t</span>
<span class="n">FA</span>    <span class="o">=</span> <span class="n">ans2</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">FB</span>    <span class="o">=</span> <span class="n">ans2</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">FC</span>    <span class="o">=</span> <span class="n">ans2</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>

<span class="n">XA</span>    <span class="o">=</span> <span class="p">(</span><span class="n">FAf</span> <span class="o">-</span> <span class="n">FA</span><span class="p">)</span><span class="o">/</span><span class="n">FAf</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">XA</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">Vspan</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Conversion of A&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">itp1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">XA</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The Volume required for a PFR single pass conversion of XA = </span><span class="si">{</span><span class="n">XSP</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1"> is </span><span class="si">{</span><span class="n">itp1</span><span class="p">(</span><span class="n">XSP</span><span class="p">)</span><span class="si">:</span><span class="s1">0.0f</span><span class="si">}</span><span class="s1">L&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-R09_7_0.png" src="../_images/587-R09_7_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The Volume required for a PFR single pass conversion of XA = 0.4318 is 242L
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="this-was-an-easy-problem">
<h3>This was an easy problem…<a class="headerlink" href="#this-was-an-easy-problem" title="Permalink to this headline">#</a></h3>
<p>The above example is probably the simplest possible scenario that we can consider in that we are given the overall process level conversion (0.95) and allowed to vary the recycle ratio until we find the point where the single pass reactor level conversion is within the equilibrium limit.</p>
<p>This case is straightforward for the following reasons:</p>
<ol class="simple">
<li><p>Because we have a specification on the overall conversion of the process (95%), it is straightforward to calculate <span class="math notranslate nohighlight">\(F_{A3}\)</span>:</p></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-0492c00a-3101-4b7e-91a2-59b1ca15f18a">
<span class="eqno">(215)<a class="headerlink" href="#equation-0492c00a-3101-4b7e-91a2-59b1ca15f18a" title="Permalink to this equation">#</a></span>\[\begin{align}
    F_{A_3} = F_{Af}(1 - X_{A_{ov}})\\
    F_{A_3} = 0.5 \ \textrm{mol} \ \textrm{min}^{-1}
\end{align}\]</div>
<ol class="simple">
<li><p>Since we were given the freedom to adjust the recycle ratio to reduce the necessary single pass conversion, we can set the recycle ratio to a value–here we found that <span class="math notranslate nohighlight">\(\alpha = 0.96\)</span> will permit the PFR to operate at a conversion that is less than the equilibrium limit.  Once <span class="math notranslate nohighlight">\(\alpha\)</span> is specified, the balance on the splitter to gives:</p></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-757b5b72-0327-438f-b8c9-e6d1c164bc61">
<span class="eqno">(216)<a class="headerlink" href="#equation-757b5b72-0327-438f-b8c9-e6d1c164bc61" title="Permalink to this equation">#</a></span>\[\begin{align}
    F_{A2} &amp;= \frac{F_{A3}}{1 - \alpha} \\
    F_{AR} &amp;= \frac{\alpha}{1 - \alpha} F_{A3} \\
\end{align}\]</div>
<p>Since <span class="math notranslate nohighlight">\(F_{A3}\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> are known here, we can solve to get:</p>
<div class="amsmath math notranslate nohighlight" id="equation-abd77c71-fc1c-4ae0-bf27-7087528f467d">
<span class="eqno">(217)<a class="headerlink" href="#equation-abd77c71-fc1c-4ae0-bf27-7087528f467d" title="Permalink to this equation">#</a></span>\[\begin{align}
    F_{A_2} = 12.5 \ \textrm{mol} \ \textrm{min}^{-1}\\
    F_{A_R} = 12.0 \ \textrm{mol} \ \textrm{min}^{-1}\\
\end{align}\]</div>
<ol class="simple">
<li><p>A balance on the separator then tells us that:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[F_{A1} = F_{A2} = 12.5 \ \textrm{mol} \ \textrm{min}^{-1}\]</div>
<ol class="simple">
<li><p>A balance on the mixer gives us:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[F_{A0} = F_{AF} + F_{AR} = 22.0 \ \textrm{mol} \ \textrm{min}^{-1}\]</div>
<ol class="simple">
<li><p>Since we know the flowrate of propane coming into and out of the reactor, we can calculate the single pass conversion in the reactor:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[X_{A_sp} = 0.432\]</div>
<p>So, basically, with those specifications, we can easily figure out the molar flowrate of A at every point in the PFD, and we can easily size a PFR that operates at 8.2 atm and 500K with an inlet propane flowrate of 22 moles per minute to accomplish 43.2% conversion.</p>
<p>Today, we’ll look at problems that are conceptually no more difficult, but are actually much more challenging to solve in practice.</p>
</section>
</section>
<section id="problem-02">
<h2>Problem 02<a class="headerlink" href="#problem-02" title="Permalink to this headline">#</a></h2>
<p>We will use the same, very simple, very perfect recycle scheme illustrated above for this problem, but for now, we’ll replace the PFR with a CSTR.</p>
<a class="reference internal image-reference" href="Recitation/CSTRRecycle.jpg"><img alt="Recitation/CSTRRecycle.jpg" src="Recitation/CSTRRecycle.jpg" style="width: 700px; height: 500px;" /></a>
<p>In order to facilitate a relatively straightforward solution, we going to run a much simpler reaction–the irreversible conversion of A into B:</p>
<div class="math notranslate nohighlight">
\[A \longrightarrow B\]</div>
<p>This reaction occurs in the gas phase, it has a rate constant <span class="math notranslate nohighlight">\(k = 10 \ \textrm{s}^{-1}\)</span> and we run it without a diluent, i.e., we feed Pure species A into the process at a rate of 100 moles per second.  The entire process is carried out at T = 573K and P = 1.0 atm.  If the volume of the CSTR is 400L, and we recycle 50% of the unreacted species A, calculate the single pass and overall conversion of A achieved in this process.</p>
<p>The challenge here is that we cannot easily calculate the flowrates of A coming out of the splitter, so we end up needing to solve a large system of equations simultaneously…</p>
<section id="solution-to-example-problem-02">
<h3>Solution to Example Problem 02<a class="headerlink" href="#solution-to-example-problem-02" title="Permalink to this headline">#</a></h3>
<p>The balances on all of our unit operations are the same; we can write four of them, one on each unit:</p>
<section id="balance-on-mixer">
<h4>Balance on Mixer<a class="headerlink" href="#balance-on-mixer" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[ 0 = F_{A0} + F_{A5} - F_{A1} \]</div>
</section>
<section id="balance-on-cstr">
<h4>Balance on CSTR<a class="headerlink" href="#balance-on-cstr" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[ 0 = F_{A1} - F_{A2} + R_{A2}V \]</div>
</section>
<section id="balance-on-separator">
<h4>Balance on Separator<a class="headerlink" href="#balance-on-separator" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[ 0 = F_{A2} - F_{A3} \]</div>
</section>
<section id="balance-on-splitter">
<h4>Balance on Splitter<a class="headerlink" href="#balance-on-splitter" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[ 0 = F_{A3} - F_{A4} - F_{A5} \]</div>
<p>As far as I can tell, we have the following information available to us:</p>
<div class="amsmath math notranslate nohighlight" id="equation-de03f307-ad42-4850-83f9-2512f286cf38">
<span class="eqno">(218)<a class="headerlink" href="#equation-de03f307-ad42-4850-83f9-2512f286cf38" title="Permalink to this equation">#</a></span>\[\begin{align}
    k &amp;= 10 \ \mathrm{s^{-1}} \\
    T &amp;= 573 \ \mathrm{K} \\
    P &amp;= 1.0 \ \mathrm{atm} \\
    V &amp;= 400 \ \mathrm{L} \\
    F_{A0} &amp;= 100 \ \mathrm{mol \ s^{-1}} 
\end{align}\]</div>
<p>Looking at the above set of equations, we have 5 unknown flowrates (<span class="math notranslate nohighlight">\(F_{A1}\)</span>, <span class="math notranslate nohighlight">\(F_{A2}\)</span>, <span class="math notranslate nohighlight">\(F_{A3}\)</span>, <span class="math notranslate nohighlight">\(F_{A4}\)</span>, <span class="math notranslate nohighlight">\(F_{A5}\)</span>) and one unknown production rate (<span class="math notranslate nohighlight">\(R_{A2}\)</span>).  I can specify the production rate in terms of molar flowrates and volumetric flowrates:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f0b397c3-d0c6-4aa1-9eac-389e9f5100ff">
<span class="eqno">(219)<a class="headerlink" href="#equation-f0b397c3-d0c6-4aa1-9eac-389e9f5100ff" title="Permalink to this equation">#</a></span>\[\begin{align}
    R_{A2} &amp;= -r_2 \\
    r_2 &amp;= kC_{A2} \\
    C_{A2} &amp;= \frac{F_{A2}}{Q_2}
\end{align}\]</div>
<p>We can simplify the problem a bit by realizing that there is no change in the number of moles for this reaction, so the volumetric flowrate entering the CSTR (<span class="math notranslate nohighlight">\(Q_1\)</span>) is the same as the volumetric flowrate exiting the reactor (<span class="math notranslate nohighlight">\(Q_2\)</span>). The only species entering the CSTR is A, so we can then calculate the volumetric flowrate entirely based on the flowrate of species A into the reactor, <span class="math notranslate nohighlight">\(F_{A1}\)</span>:</p>
<div class="math notranslate nohighlight">
\[Q_1 = \frac{F_{A1} RT}{P}\]</div>
<p>k, R, T, and P are all known to us, so now we’ve defined the production rate in terms of molar flowrates.  This leaves us with 5 total unknowns in the problem, so we need one more equation.  We can get it from the specification that the recycle ratio at the splitter is 0.5:</p>
<p>The recycle ratio is defined as:</p>
<div class="math notranslate nohighlight">
\[\alpha = \frac{F_{A5}}{F_{A3}}\]</div>
<p>An easy way to add that constraint to the problem is to reformulate it as an algebraic equation whose left hand size is zero:</p>
<div class="math notranslate nohighlight">
\[ 0 = F_{A5} - F_{A3}\alpha\]</div>
<p>So now we have 5 equations and 5 unknowns; we can solve this with <code class="docutils literal notranslate"><span class="pre">opt.root()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FA0</span> <span class="o">=</span> <span class="mi">100</span>     <span class="c1">#moles per second</span>
<span class="n">k</span>   <span class="o">=</span> <span class="mi">10</span>      <span class="c1">#1/sec</span>
<span class="n">T</span>   <span class="o">=</span> <span class="mi">573</span>     <span class="c1">#K</span>
<span class="n">P</span>   <span class="o">=</span> <span class="mf">1.0</span>     <span class="c1">#atm</span>
<span class="n">R</span>   <span class="o">=</span> <span class="mf">0.08206</span> <span class="c1">#L*atm/mol/K</span>
<span class="n">V</span>   <span class="o">=</span> <span class="mi">400</span>     <span class="c1">#L</span>
<span class="n">α</span>   <span class="o">=</span> <span class="mf">0.5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">P02</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">par</span><span class="p">):</span>
    <span class="n">FA1</span><span class="p">,</span> <span class="n">FA2</span><span class="p">,</span> <span class="n">FA3</span><span class="p">,</span> <span class="n">FA4</span><span class="p">,</span> <span class="n">FA5</span> <span class="o">=</span> <span class="n">var</span>
    <span class="n">FA0</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">α</span> <span class="o">=</span> <span class="n">par</span>
        
    <span class="n">Q1</span>  <span class="o">=</span> <span class="n">FA1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span> <span class="c1">#volumetric flowrate into CSTR</span>
    <span class="n">Q2</span>  <span class="o">=</span> <span class="n">Q1</span>        <span class="c1">#A --&gt; B so Q1 = Q2</span>
    <span class="n">CA2</span> <span class="o">=</span> <span class="n">FA2</span><span class="o">/</span><span class="n">Q2</span>    <span class="c1">#Concentration of A in CSTR</span>
    <span class="n">r</span>   <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">CA2</span><span class="p">;</span>    <span class="c1">#rate of reaction in CSTR</span>
    <span class="n">RA2</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span>        <span class="c1">#Production rate of A in CSTR</span>
    
    <span class="n">LHS1</span> <span class="o">=</span> <span class="n">FA0</span> <span class="o">+</span> <span class="n">FA5</span> <span class="o">-</span> <span class="n">FA1</span>
    <span class="n">LHS2</span> <span class="o">=</span> <span class="n">FA1</span> <span class="o">-</span> <span class="n">FA2</span> <span class="o">+</span> <span class="n">RA2</span><span class="o">*</span><span class="n">V</span>
    <span class="n">LHS3</span> <span class="o">=</span> <span class="n">FA2</span> <span class="o">-</span> <span class="n">FA3</span>
    <span class="n">LHS4</span> <span class="o">=</span> <span class="n">FA3</span> <span class="o">-</span> <span class="n">FA5</span> <span class="o">-</span> <span class="n">FA4</span>
    <span class="n">LHS5</span> <span class="o">=</span> <span class="n">FA5</span> <span class="o">-</span> <span class="n">α</span><span class="o">*</span><span class="n">FA3</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">LHS1</span><span class="p">,</span> <span class="n">LHS2</span><span class="p">,</span> <span class="n">LHS3</span><span class="p">,</span> <span class="n">LHS4</span><span class="p">,</span> <span class="n">LHS5</span><span class="p">]</span>

<span class="n">var_guess</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">par0</span> <span class="o">=</span> <span class="p">(</span><span class="n">FA0</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">α</span><span class="p">)</span>
<span class="n">ans2</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">P02</span><span class="p">,</span> <span class="n">var_guess</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">par0</span><span class="p">,</span> <span class="p">))</span>
<span class="n">FA1</span><span class="p">,</span> <span class="n">FA2</span><span class="p">,</span> <span class="n">FA3</span><span class="p">,</span> <span class="n">FA4</span><span class="p">,</span> <span class="n">FA5</span> <span class="o">=</span> <span class="n">ans2</span><span class="o">.</span><span class="n">x</span>

<span class="n">XSP</span>    <span class="o">=</span> <span class="p">(</span><span class="n">FA1</span> <span class="o">-</span> <span class="n">FA2</span><span class="p">)</span><span class="o">/</span><span class="n">FA1</span>
<span class="n">XOV</span>    <span class="o">=</span> <span class="p">(</span><span class="n">FA0</span>  <span class="o">-</span> <span class="n">FA4</span><span class="p">)</span><span class="o">/</span><span class="n">FA0</span>
<span class="n">alpha</span>  <span class="o">=</span> <span class="n">FA5</span><span class="o">/</span><span class="n">FA3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;XSP = </span><span class="si">{</span><span class="n">XSP</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">, XOV = </span><span class="si">{</span><span class="n">XOV</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">, and α = </span><span class="si">{</span><span class="n">α</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XSP = 0.368, XOV = 0.538, and α = 0.50
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="problem-03">
<h2>Problem 03<a class="headerlink" href="#problem-03" title="Permalink to this headline">#</a></h2>
<p>Now let’s swap the CSTR out for a Plug Flow reactor and work through how that changes the problem.</p>
<a class="reference internal image-reference" href="Recitation/PFRRecycle.jpg"><img alt="Recitation/PFRRecycle.jpg" src="Recitation/PFRRecycle.jpg" style="width: 700px; height: 500px;" /></a>
<p>We’ll continue with the simple reaction above:</p>
<div class="math notranslate nohighlight">
\[A \longrightarrow B\]</div>
<p>This problem has identicial specifications to Problem 1 otherwise. The reaction has a rate constant <span class="math notranslate nohighlight">\(k = 10 \ \textrm{s}^{-1}\)</span>, and we run it without a diluent. For this process, we are feeding species A in at a rate of 100 moles per second.  The entire process is carried out at T = 573K and P = 1.0 atm. If the volume of the PFR is 400L, and we recycle 50% of the unreacted species A, calculate the single pass and overall conversion of A achieved in this process.</p>
<p>The approach is very similar to the one above in that we have a system of equations.  The additional twist from working with a PFR is that we now have to solve a differential equation in one of our unit balances…</p>
<section id="solution-to-example-problem-03">
<h3>Solution to Example Problem 03<a class="headerlink" href="#solution-to-example-problem-03" title="Permalink to this headline">#</a></h3>
<p>We start in exactly the same way, by writing balances on each unit operation; this gives us a set of algebraic equations and one problematic ODE that we have to solve to model the PFR behavior.</p>
<section id="id1">
<h4>Balance on Mixer<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[ 0 = F_{A0} + F_{A5} - F_{A1} \]</div>
</section>
<section id="balance-on-pfr-400l">
<h4>Balance on PFR (400L)<a class="headerlink" href="#balance-on-pfr-400l" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[ \frac{dF_A}{dV} = R_A \]</div>
</section>
<section id="id2">
<h4>Balance on Separator<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[ 0 = F_{A2} - F_{A3} \]</div>
</section>
<section id="id3">
<h4>Balance on Splitter<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[ 0 = F_{A3} - F_{A4} - F_{A5} \]</div>
</section>
<section id="recycle-specification">
<h4>Recycle Specification<a class="headerlink" href="#recycle-specification" title="Permalink to this headline">#</a></h4>
<p>We also have the recycle specification, which hasn’t changed from the last problem:</p>
<div class="math notranslate nohighlight">
\[ 0 = F_{A5} - F_{A3}\alpha\]</div>
</section>
<section id="other-information">
<h4>Other Information<a class="headerlink" href="#other-information" title="Permalink to this headline">#</a></h4>
<p>We additionally have the following information available to us:</p>
<div class="amsmath math notranslate nohighlight" id="equation-55766b65-39da-48e9-bf93-7b5b5c815f48">
<span class="eqno">(220)<a class="headerlink" href="#equation-55766b65-39da-48e9-bf93-7b5b5c815f48" title="Permalink to this equation">#</a></span>\[\begin{align}
    k &amp;= 10 \ \mathrm{s^{-1}} \\
    T &amp;= 573 \ \mathrm{K} \\
    P &amp;= 1.0 \ \mathrm{atm} \\
    V &amp;= 400 \ \mathrm{L} \\
    F_{A0} &amp;= 100 \ \mathrm{mol \ s^{-1}} 
\end{align}\]</div>
</section>
<section id="taking-stock-of-the-situation">
<h4>Taking stock of the situation<a class="headerlink" href="#taking-stock-of-the-situation" title="Permalink to this headline">#</a></h4>
<p>Looking at the above set of equations, we have five unknown flowrates (<span class="math notranslate nohighlight">\(F_{A1}\)</span>, <span class="math notranslate nohighlight">\(F_{A2}\)</span>, <span class="math notranslate nohighlight">\(F_{A3}\)</span>, <span class="math notranslate nohighlight">\(F_{A4}\)</span>, <span class="math notranslate nohighlight">\(F_{A5}\)</span>), four algebraic equations, and one differential equation. Before we get started, realize that, generally speaking, we can specify the production rate in terms of molar flowrates and volumetric flowrates:</p>
<div class="amsmath math notranslate nohighlight" id="equation-b6c8f4bf-d339-4a11-a479-1128886bf5a6">
<span class="eqno">(221)<a class="headerlink" href="#equation-b6c8f4bf-d339-4a11-a479-1128886bf5a6" title="Permalink to this equation">#</a></span>\[\begin{align}
    R_A &amp;= -r \\
    r &amp;= kC_A \\
    C_A &amp;= \frac{F_A}{Q} \\
    Q &amp;= \frac{F_T RT}{P}
\end{align}\]</div>
<p>So nothing in the production rate really adds additional unknowns or state variables (molar flowrates) to the problem.</p>
</section>
<section id="resolving-the-pfr-balance-symbolically">
<h4>Resolving the PFR balance (symbolically)<a class="headerlink" href="#resolving-the-pfr-balance-symbolically" title="Permalink to this headline">#</a></h4>
<p>We don’t know the value of <span class="math notranslate nohighlight">\(F_{A1}\)</span> (the flowrate of reactant into the PFR) at this point, but that shouldn’t stop us from developing a symbolic solution for the PFR in terms of <span class="math notranslate nohighlight">\(F_{A1}\)</span>.  Specifically, we have as our starting point:</p>
<div class="math notranslate nohighlight">
\[ \frac{dF_A}{dV} = R_A \]</div>
<p>We can express the production rate in terms of a rate law and thus species concentrations as suggested above:</p>
<div class="math notranslate nohighlight">
\[ \frac{dF_A}{dV} = -kC_A \]</div>
<p>And then:</p>
<div class="math notranslate nohighlight">
\[ \frac{dF_A}{dV} = -k\frac{F_A}{Q} \]</div>
<p>For this problem, since there is no change in the number of moles throughout the PFR, we know that Q is fixed at the feed volumetric flowrate (to the reactor), i.e., <span class="math notranslate nohighlight">\(Q_1\)</span>.</p>
<div class="math notranslate nohighlight">
\[ \frac{dF_A}{dV} = -\frac{k}{Q_1}F_A \]</div>
<p>This is now a separable differential equation:</p>
<div class="math notranslate nohighlight">
\[ \frac{1}{F_A} dF_A = -\frac{k}{Q_1} dV \]</div>
<p>And we can solve it by integrating both the left and right hand sides over relavant limits:</p>
<div class="math notranslate nohighlight">
\[ \int_{F_{A1}}^{F_{A2}} \frac{1}{F_A} dF_A = \int_{0}^{V}-\frac{k}{Q_1} dV \]</div>
<p>This gives us the following analytical solution:</p>
<div class="math notranslate nohighlight">
\[F_{A2} = F_{A1}\exp{\left(-\frac{k}{Q_1}V\right)}\]</div>
<p>That gives us our fifth algebraic equation:</p>
<div class="math notranslate nohighlight">
\[0 = F_{A2} - F_{A1}\exp{\left(-\frac{k}{Q_1}V\right)}\]</div>
<p>Now we have 5 equations and 5 unknowns (<span class="math notranslate nohighlight">\(F_{A1}\)</span>, <span class="math notranslate nohighlight">\(F_{A2}\)</span>, <span class="math notranslate nohighlight">\(F_{A3}\)</span>, <span class="math notranslate nohighlight">\(F_{A4}\)</span>, <span class="math notranslate nohighlight">\(F_{A5}\)</span>); we can solve this with <code class="docutils literal notranslate"><span class="pre">opt.root()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">P03</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">par</span><span class="p">):</span>
    <span class="n">FA1</span><span class="p">,</span> <span class="n">FA2</span><span class="p">,</span> <span class="n">FA3</span><span class="p">,</span> <span class="n">FA4</span><span class="p">,</span> <span class="n">FA5</span> <span class="o">=</span> <span class="n">var</span>
    <span class="n">FA0</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">α</span> <span class="o">=</span> <span class="n">par</span>
    
    <span class="n">Q1</span>  <span class="o">=</span> <span class="n">FA1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span><span class="p">;</span>
       
    <span class="n">LHS1</span> <span class="o">=</span> <span class="n">FA0</span> <span class="o">+</span> <span class="n">FA5</span> <span class="o">-</span> <span class="n">FA1</span>
    <span class="n">LHS2</span> <span class="o">=</span> <span class="n">FA2</span> <span class="o">-</span> <span class="n">FA1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">/</span><span class="n">Q1</span><span class="o">*</span><span class="n">V</span><span class="p">)</span>
    <span class="n">LHS3</span> <span class="o">=</span> <span class="n">FA2</span> <span class="o">-</span> <span class="n">FA3</span>
    <span class="n">LHS4</span> <span class="o">=</span> <span class="n">FA3</span> <span class="o">-</span> <span class="n">FA5</span> <span class="o">-</span> <span class="n">FA4</span>
    <span class="n">LHS5</span> <span class="o">=</span> <span class="n">FA5</span> <span class="o">-</span> <span class="n">α</span><span class="o">*</span><span class="n">FA3</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">LHS1</span><span class="p">,</span> <span class="n">LHS2</span><span class="p">,</span> <span class="n">LHS3</span><span class="p">,</span> <span class="n">LHS4</span><span class="p">,</span> <span class="n">LHS5</span><span class="p">]</span>

<span class="n">var_guess</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">par0</span> <span class="o">=</span> <span class="p">(</span><span class="n">FA0</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">α</span><span class="p">)</span>
<span class="n">ans3</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">P03</span><span class="p">,</span> <span class="n">var_guess</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">par0</span><span class="p">,</span> <span class="p">))</span>
<span class="n">FA1</span><span class="p">,</span> <span class="n">FA2</span><span class="p">,</span> <span class="n">FA3</span><span class="p">,</span> <span class="n">FA4</span><span class="p">,</span> <span class="n">FA5</span> <span class="o">=</span> <span class="n">ans3</span><span class="o">.</span><span class="n">x</span>

<span class="n">XSP</span>    <span class="o">=</span> <span class="p">(</span><span class="n">FA1</span> <span class="o">-</span> <span class="n">FA2</span><span class="p">)</span><span class="o">/</span><span class="n">FA1</span>
<span class="n">XOV</span>    <span class="o">=</span> <span class="p">(</span><span class="n">FA0</span>  <span class="o">-</span> <span class="n">FA4</span><span class="p">)</span><span class="o">/</span><span class="n">FA0</span>
<span class="n">alpha</span>  <span class="o">=</span> <span class="n">FA5</span><span class="o">/</span><span class="n">FA3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;XSP = </span><span class="si">{</span><span class="n">XSP</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">, XOV = </span><span class="si">{</span><span class="n">XOV</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">, and α = </span><span class="si">{</span><span class="n">α</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XSP = 0.463, XOV = 0.633, and α = 0.50
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="problem-04">
<h2>Problem 04<a class="headerlink" href="#problem-04" title="Permalink to this headline">#</a></h2>
<p>For the above case, things aren’t so bad because we have first order kinetics and a constant volumetric flowrate, which means that we can solve the differential equation (balance on the PFR) analytically and just replace the algebraic equation from our CSTR system with one that describes the PFR.</p>
<p>What happens if we have to deal with more difficult kinetics?  For this example, we’ll stick with the simple reaction:</p>
<div class="math notranslate nohighlight">
\[A \longrightarrow B\]</div>
<p>But we’ll say that it has the rate law below:</p>
<div class="math notranslate nohighlight">
\[r = \frac{kC_A}{1+KC_A}\]</div>
<p>Where <span class="math notranslate nohighlight">\(k = 10 \ \textrm{s}^{-1}\)</span> as before and <span class="math notranslate nohighlight">\(K = 17.5 \ \textrm{L} \ \textrm{mol}^{-1}\)</span>.  Otherwise, the problem is identical. For this process, we are feeding species A in at a rate of 100 moles per second.  The entire process is carried out at T = 573K and P = 1.0 atm. If the volume of the PFR is 400L, and we recycle 50% of the unreacted species A, calculate the single pass and overall conversion of A achieved in this process.</p>
<p>We still need to solve a system of algebraic equations as above, but the catch now is that the differential equation that describes the PFR balance is much more difficult to solve.  In fact, I don’t know an analytical solution offhand, so we have to use numerical methods to integrate it.  For this solution, we’ll use <code class="docutils literal notranslate"><span class="pre">solve_ivp()</span></code> because it is relatively easy to implement a Runge-Kutta method here since we know the upper limit of integration (V = 400L).</p>
<section id="id4">
<h3>Solution to Example Problem 03<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>We start in exactly the same way, by writing balances on each unit operation; this gives us a set of algebraic equations and one problematic ODE that we have to solve to model the PFR behavior.  This is the same general situation as above, but here, we cannot solve the ODE analytically, and we need to use a numerical method.  This is an illustration of how you might do that.</p>
<section id="id5">
<h4>Balance on Mixer<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[ 0 = F_{A0} + F_{A5} - F_{A1} \]</div>
</section>
<section id="id6">
<h4>Balance on PFR (400L)<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[ \frac{dF_A}{dV} = R_A \]</div>
</section>
<section id="id7">
<h4>Balance on Separator<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[ 0 = F_{A2} - F_{A3} \]</div>
</section>
<section id="id8">
<h4>Balance on Splitter<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[ 0 = F_{A3} - F_{A4} - F_{A5} \]</div>
</section>
<section id="id9">
<h4>Recycle Specification<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h4>
<p>We also have the recycle specification, which hasn’t changed from the last problem:</p>
<div class="math notranslate nohighlight">
\[ 0 = F_{A5} - F_{A3}\alpha\]</div>
</section>
<section id="id10">
<h4>Other Information<a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h4>
<p>We additionally have the following information available to us:</p>
<div class="amsmath math notranslate nohighlight" id="equation-04fed2a8-69c9-4359-9cf2-7b882e1bbcfc">
<span class="eqno">(222)<a class="headerlink" href="#equation-04fed2a8-69c9-4359-9cf2-7b882e1bbcfc" title="Permalink to this equation">#</a></span>\[\begin{align}
    k &amp;= 10 \ \mathrm{s^{-1}} \\
    K &amp;= 17.5 \ \mathrm{mol \ L^{-1}} \\
    T &amp;= 573 \ \mathrm{K} \\
    P &amp;= 1.0 \ \mathrm{atm} \\
    V &amp;= 400 \ \mathrm{L} \\
    F_{A0} &amp;= 100 \ \mathrm{mol \ s^{-1}} 
\end{align}\]</div>
</section>
<section id="id11">
<h4>Taking stock of the situation<a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h4>
<p>Looking at the above set of equations, we have five unknown flowrates (<span class="math notranslate nohighlight">\(F_{A1}\)</span>, <span class="math notranslate nohighlight">\(F_{A2}\)</span>, <span class="math notranslate nohighlight">\(F_{A3}\)</span>, <span class="math notranslate nohighlight">\(F_{A4}\)</span>, <span class="math notranslate nohighlight">\(F_{A5}\)</span>), four algebraic equations, and one differential equation.</p>
</section>
<section id="resolving-the-pfr-balance-numerically">
<h4>Resolving the PFR balance (numerically)<a class="headerlink" href="#resolving-the-pfr-balance-numerically" title="Permalink to this headline">#</a></h4>
<p>We don’t know the value of <span class="math notranslate nohighlight">\(F_{A1}\)</span> (the flowrate of reactant into the PFR) at this point. In the context of the algebraic equations above, it is an <em>unknown</em>. If we’re clever about it, we can actually embed a numerical solution of that ODE into our system of algebraic equations in order to solve this problem….As above, our starting point:</p>
<div class="math notranslate nohighlight">
\[ \frac{dF_A}{dV} = R_A \]</div>
<p>We can express the production rate in terms of a rate law and thus species concentrations as suggested above:</p>
<div class="math notranslate nohighlight">
\[ \frac{dF_A}{dV} = -\frac{kC_A}{1+KC_A} \]</div>
<p>And then:</p>
<div class="math notranslate nohighlight">
\[C_A = \frac{F_A}{Q}\]</div>
<p>For this problem, since there is no change in the number of moles throughout the PFR, we know that Q is fixed at the feed volumetric flowrate (to the reactor), i.e., <span class="math notranslate nohighlight">\(Q_1\)</span>.</p>
<div class="math notranslate nohighlight">
\[C_A = \frac{F_A}{Q_1}\]</div>
<p>We can’t go any further – we’ll have to solve this numerically now.  The key thing to remember is that the inlet flowrate to the PFR is unknown…so the algebraic solver is iterating the value of <span class="math notranslate nohighlight">\(F_{A1}\)</span> until it finds a solution to our 5 equations.  But the balance on the PFR has to be evaluated numerically; hence the need to use a <code class="docutils literal notranslate"><span class="pre">solve_ivp()</span></code> solution on every pass through the algebraic equations.</p>
<p>Now we have 5 equations and 5 unknowns (<span class="math notranslate nohighlight">\(F_{A1}\)</span>, <span class="math notranslate nohighlight">\(F_{A2}\)</span>, <span class="math notranslate nohighlight">\(F_{A3}\)</span>, <span class="math notranslate nohighlight">\(F_{A4}\)</span>, <span class="math notranslate nohighlight">\(F_{A5}\)</span>); we can solve this with <code class="docutils literal notranslate"><span class="pre">opt.root()</span></code> as long as we use <code class="docutils literal notranslate"><span class="pre">solve_ivp()</span></code> to solve the material balance on the PFR for each value of <span class="math notranslate nohighlight">\(F_{A1}\)</span> on each iteration of the <code class="docutils literal notranslate"><span class="pre">opt.root()</span></code> solver
<br>
<br>
<br></p>
<div style="font-size: 75px;text-align: center;"> &#129327;</div>
<br>
<p><strong>Notes:</strong></p>
<ol class="simple">
<li><p>If I had been given the single pass conversion instead, it would be slightly easier to use quadgk for this particular problem</p></li>
<li><p>If I have a more difficult reaction (nonconstant Q, multiple reactions, etc.), it would be necessary to use solve_ivp or something similar, so I think this is the more general approach.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FA0</span> <span class="o">=</span> <span class="mi">100</span>     <span class="c1">#moles per second</span>
<span class="n">k</span>   <span class="o">=</span> <span class="mi">10</span>      <span class="c1">#1/sec</span>
<span class="n">T</span>   <span class="o">=</span> <span class="mi">573</span>     <span class="c1">#K</span>
<span class="n">P</span>   <span class="o">=</span> <span class="mf">1.0</span>     <span class="c1">#atm</span>
<span class="n">R</span>   <span class="o">=</span> <span class="mf">0.08206</span> <span class="c1">#L*atm/mol/K</span>
<span class="n">V</span>   <span class="o">=</span> <span class="mi">400</span>     <span class="c1">#L</span>
<span class="n">α</span>   <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">K</span>   <span class="o">=</span> <span class="mf">17.5</span>    <span class="c1">#mol/L</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">P04</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">par</span><span class="p">):</span>
    <span class="n">FA1</span><span class="p">,</span> <span class="n">FA2</span><span class="p">,</span> <span class="n">FA3</span><span class="p">,</span> <span class="n">FA4</span><span class="p">,</span> <span class="n">FA5</span> <span class="o">=</span> <span class="n">var</span>
    <span class="n">FA0</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">par</span>
    
    <span class="n">Q1</span>  <span class="o">=</span> <span class="n">FA1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>
    
    <span class="n">vspan</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
    <span class="n">var0</span>  <span class="o">=</span> <span class="n">FA1</span>
    <span class="n">par0</span>  <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">Q1</span><span class="p">)</span>
    <span class="n">ans</span>   <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">odemodel</span><span class="p">,</span> <span class="n">vspan</span><span class="p">,</span> <span class="p">[</span><span class="n">var0</span><span class="p">],</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">par0</span><span class="p">,</span> <span class="p">))</span>
    <span class="n">FPFR</span>  <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
      
    <span class="n">LHS1</span> <span class="o">=</span> <span class="n">FA0</span> <span class="o">+</span> <span class="n">FA5</span> <span class="o">-</span> <span class="n">FA1</span>
    <span class="n">LHS2</span> <span class="o">=</span> <span class="n">FA2</span> <span class="o">-</span> <span class="n">FPFR</span>
    <span class="n">LHS3</span> <span class="o">=</span> <span class="n">FA2</span> <span class="o">-</span> <span class="n">FA3</span>
    <span class="n">LHS4</span> <span class="o">=</span> <span class="n">FA3</span> <span class="o">-</span> <span class="n">FA5</span> <span class="o">-</span> <span class="n">FA4</span>
    <span class="n">LHS5</span> <span class="o">=</span> <span class="n">FA5</span> <span class="o">-</span> <span class="n">α</span><span class="o">*</span><span class="n">FA3</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">LHS1</span><span class="p">,</span> <span class="n">LHS2</span><span class="p">,</span> <span class="n">LHS3</span><span class="p">,</span> <span class="n">LHS4</span><span class="p">,</span> <span class="n">LHS5</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">odemodel</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">par</span><span class="p">):</span>
    <span class="n">FA</span> <span class="o">=</span> <span class="n">var</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">Q1</span> <span class="o">=</span> <span class="n">par</span>
    <span class="n">CA</span> <span class="o">=</span> <span class="n">FA</span><span class="o">/</span><span class="n">Q1</span>
    <span class="n">D</span>   <span class="o">=</span> <span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">CA</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">CA</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">D</span>

<span class="n">var_guess</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">par0</span> <span class="o">=</span> <span class="p">(</span><span class="n">FA0</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="n">ans4</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">P04</span><span class="p">,</span> <span class="n">var_guess</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">par0</span><span class="p">,</span> <span class="p">))</span>
<span class="n">FA1</span><span class="p">,</span> <span class="n">FA2</span><span class="p">,</span> <span class="n">FA3</span><span class="p">,</span> <span class="n">FA4</span><span class="p">,</span> <span class="n">FA5</span> <span class="o">=</span> <span class="n">ans4</span><span class="o">.</span><span class="n">x</span>

<span class="n">XSP</span>    <span class="o">=</span> <span class="p">(</span><span class="n">FA1</span> <span class="o">-</span> <span class="n">FA2</span><span class="p">)</span><span class="o">/</span><span class="n">FA1</span>
<span class="n">XOV</span>    <span class="o">=</span> <span class="p">(</span><span class="n">FA0</span>  <span class="o">-</span> <span class="n">FA4</span><span class="p">)</span><span class="o">/</span><span class="n">FA0</span>
<span class="n">alpha</span>  <span class="o">=</span> <span class="n">FA5</span><span class="o">/</span><span class="n">FA3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;XSP = </span><span class="si">{</span><span class="n">XSP</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">, XOV = </span><span class="si">{</span><span class="n">XOV</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">, and α = </span><span class="si">{</span><span class="n">α</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XSP = 0.359, XOV = 0.528, and α = 0.50
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Recitation"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="587-R08.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Optimization</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="587-R10.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Interpolation and Regression</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Jesse Q. Bond, Syracuse University<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>