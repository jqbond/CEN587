
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Lecture 06 &#8212; CEN 587 Fall 2022</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Lecture 07: Ammonia Equilibrium - Part 2" href="F22-587-L07.html" />
    <link rel="prev" title="Lecture 05" href="F22-587-L05.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/JQB.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CEN 587 Fall 2022</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="Lectures.html">
   Lectures
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L01.html">
     Lecture 01: Introduction and Stoichiometry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L02.html">
     Lecture 02: Extent and Conversion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L03.html">
     Lecture 03: Solving problems with numerical methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L04.html">
     Lecture 04
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L05.html">
     Lecture 05
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Lecture 06
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L07.html">
     Lecture 07: Ammonia Equilibrium - Part 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L08.html">
     Lecture 08: Multi-reaction equilibria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L09.html">
     Lecture 09: Chemical and Phase equilibria
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Recitations.html">
   Recitations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-R01-Solution.html">
     Recitation 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-R02-Solution.html">
     Recitation 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-R03-Solution.html">
     Recitation 03
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/jqbond/2022CEN587/main?urlpath=tree/docs/F22-587-L06.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/jqbond/2022CEN587"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/jqbond/2022CEN587/issues/new?title=Issue%20on%20page%20%2FF22-587-L06.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/F22-587-L06.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#equilibrium-example-1">
   Equilibrium Example 1
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#is-the-standard-state-reaction-endothermic-or-exothermic">
     Is the standard state reaction endothermic or exothermic?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#does-the-reaction-lead-to-an-increase-or-decrease-in-entropy">
     Does the reaction lead to an increase or decrease in entropy?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#is-the-reaction-thermodynamically-favorable-at-reaction-conditions">
     Is the reaction (thermodynamically) favorable at reaction conditions?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-composition-do-i-expect-at-chemical-equilibrium">
     What composition do I expect at chemical equilibrium?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-the-equilibrium-composition">
     Calculating the Equilibrium Composition
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solution-to-example-1">
   Solution to Example 1
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#expressing-mole-fractions-as-functions-of-extent">
     Expressing Mole Fractions as functions of Extent
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solve-using-numerical-methods-good-approach">
     Solve using numerical methods (good approach)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solve-using-numerical-methods-better-approach">
     Solve using numerical methods (better approach?)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-using-numerical-methods-fancy-approach">
     Solving using numerical methods (fancy approach!)
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Lecture 06</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#equilibrium-example-1">
   Equilibrium Example 1
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#is-the-standard-state-reaction-endothermic-or-exothermic">
     Is the standard state reaction endothermic or exothermic?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#does-the-reaction-lead-to-an-increase-or-decrease-in-entropy">
     Does the reaction lead to an increase or decrease in entropy?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#is-the-reaction-thermodynamically-favorable-at-reaction-conditions">
     Is the reaction (thermodynamically) favorable at reaction conditions?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-composition-do-i-expect-at-chemical-equilibrium">
     What composition do I expect at chemical equilibrium?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-the-equilibrium-composition">
     Calculating the Equilibrium Composition
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solution-to-example-1">
   Solution to Example 1
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#expressing-mole-fractions-as-functions-of-extent">
     Expressing Mole Fractions as functions of Extent
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solve-using-numerical-methods-good-approach">
     Solve using numerical methods (good approach)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solve-using-numerical-methods-better-approach">
     Solve using numerical methods (better approach?)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-using-numerical-methods-fancy-approach">
     Solving using numerical methods (fancy approach!)
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="lecture-06">
<h1>Lecture 06<a class="headerlink" href="#lecture-06" title="Permalink to this headline">#</a></h1>
<p>This lecture begins our consideration of example problems so that we can get some practice with Chemical Equilibrium.</p>
<section id="equilibrium-example-1">
<h2>Equilibrium Example 1<a class="headerlink" href="#equilibrium-example-1" title="Permalink to this headline">#</a></h2>
<p>Consider the gas-phase reaction of molecular nitrogen with molecular hydrogen to produce ammonia:</p>
<div class="math notranslate nohighlight">
\[N_2 (g) + 3H_2 (g) \leftrightharpoons 2N\!H_3 (g) \label{eq1}\tag{1}\]</div>
<p>It is occuring in a batch reactor at 298K and 1 bar.</p>
<p>This reaction is reversible such that, depending on the reaction conditions, ammonia decomposition may also occur favorably to form Hydrogen and Nitrogen. Before we even dig into solving problems with it, we’ll ask a few concept questions about ammonia synthesis at these conditions (298K, 1 bar).</p>
<p>Something to notice before we move one:  When we consider equilibrium problems, we always need to be clear on our reference states.  This is a gas phase reaction occuring at 298K and 1 bar.  Our reference state for gas phase species in equilibrium problems is always: the gas as a pure species at the reaction temperature and 1 bar pressure.  So, here, our standard state is pure species at 298K and 1 bar.</p>
<section id="is-the-standard-state-reaction-endothermic-or-exothermic">
<h3>Is the standard state reaction endothermic or exothermic?<a class="headerlink" href="#is-the-standard-state-reaction-endothermic-or-exothermic" title="Permalink to this headline">#</a></h3>
<p>To answer this question, we need to figure out the standard state enthalpy change of reaction, <span class="math notranslate nohighlight">\(\Delta H^\circ\)</span>.  This will be at 298K and 1 bar and based on pure species reference states.  To facilitate, we can look up (or perhaps remember for <span class="math notranslate nohighlight">\(H_2\)</span> and <span class="math notranslate nohighlight">\(N_2\)</span>), the following values (I looked up <span class="math notranslate nohighlight">\(N \! H_3\)</span> data on Nist Webbook):</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Species</p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\({H_j}^\circ\)</span> (kJ mol<span class="math notranslate nohighlight">\(^{-1}\)</span>)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(H_2\)</span> (g)</p></td>
<td class="text-align:center"><p>0</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(N_2\)</span> (g)</p></td>
<td class="text-align:center"><p>0</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(N\!H_3\)</span> (g)</p></td>
<td class="text-align:center"><p>-45.94</p></td>
</tr>
</tbody>
</table>
<p>With that data on hand, it is straightforward to calculate a standard state reaction enthalpy using Hess’ Law:</p>
<div class="math notranslate nohighlight">
\[\Delta H^\circ = 2{H_{N\!H_3}}^\circ -{H_{N_2}}^\circ - 3{H_{H_2}}^\circ \label{eq2}\tag{2}\]</div>
<p>That comes to:</p>
<div class="math notranslate nohighlight">
\[\Delta H^\circ = -91.88 \ \textrm{kJ} \ \textrm{mol}^{-1} \label{eq3}\tag{3}\]</div>
<p>This is actually a relatively exothermic reaction!</p>
<div class="alert alert-block alert-success">
Negative values of $\Delta H$ are favorable from a thermodynamic perspective, so we would say that ammonia synthesis in the gas phase is enthalpically favorable at 298K and 1 bar.
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HN2</span>  <span class="o">=</span> <span class="mi">0</span>
<span class="n">HH2</span>  <span class="o">=</span> <span class="mi">0</span>
<span class="n">HNH3</span> <span class="o">=</span> <span class="o">-</span><span class="mf">45.940</span> <span class="c1">#kJ/mol</span>
<span class="n">DH</span>   <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">HNH3</span> <span class="o">-</span> <span class="n">HN2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">HH2</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Delta H is </span><span class="si">{</span><span class="n">DH</span><span class="si">:</span><span class="s1">4.2f</span><span class="si">}</span><span class="s1"> kJ/mole at 298K and 1 bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Delta H is -91.88 kJ/mole at 298K and 1 bar
</pre></div>
</div>
</div>
</div>
</section>
<section id="does-the-reaction-lead-to-an-increase-or-decrease-in-entropy">
<h3>Does the reaction lead to an increase or decrease in entropy?<a class="headerlink" href="#does-the-reaction-lead-to-an-increase-or-decrease-in-entropy" title="Permalink to this headline">#</a></h3>
<p>We take a similar approach and look up entropy data in the standard state to calculate an entropy change of reaction.  These values are added to our table below.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Species</p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\({H_j}^\circ\)</span> (kJ mol<span class="math notranslate nohighlight">\(^{-1}\)</span>)</p></th>
<th class="text-align:left head"><p><span class="math notranslate nohighlight">\({S_j}^\circ\)</span> (J mol<span class="math notranslate nohighlight">\(^{-1}\)</span> K<span class="math notranslate nohighlight">\(^{-1}\)</span>)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(N_2\)</span> (g)</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:left"><p>191.61</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(H_2\)</span> (g)</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:left"><p>130.68</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(N\!H_3\)</span> (g)</p></td>
<td class="text-align:center"><p>-45.94</p></td>
<td class="text-align:left"><p>192.77</p></td>
</tr>
</tbody>
</table>
<p>As above, we calculate the entropy change using Hess’ law:</p>
<div class="math notranslate nohighlight">
\[\Delta S^\circ = 2{S_{N\!H_3}}^\circ -{S_{N_2}}^\circ - 3{S_{H_2}}^\circ \label{eq4}\tag{4}\]</div>
<p>And we find:</p>
<div class="math notranslate nohighlight">
\[\Delta S^\circ = -198.11 \ \textrm{J} \ \textrm{mol}^{-1} \ \textrm{K}^{-1} \label{eq5}\tag{5}\]</div>
<p>Wow!  This is a huge loss of entropy.  This is actually very unfavorable!</p>
<div class = "alert alert-block alert-danger">
From an entropic perspective, ammonia synthesis at 298K and 1 bar is not favorable at all!
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SN2</span>  <span class="o">=</span> <span class="mf">191.61</span> <span class="c1">#J/mol/K</span>
<span class="n">SH2</span>  <span class="o">=</span> <span class="mf">130.68</span> <span class="c1">#J/mol/K</span>
<span class="n">SNH3</span> <span class="o">=</span> <span class="mf">192.77</span> <span class="c1">#J/mol/K</span>
<span class="n">DS</span>   <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">SNH3</span> <span class="o">-</span> <span class="n">SN2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">SH2</span> <span class="c1">#J/mol/K</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Delta S is </span><span class="si">{</span><span class="n">DS</span><span class="si">:</span><span class="s1">6.2f</span><span class="si">}</span><span class="s1"> J/mol/K at 298K and 1 bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Delta S is -198.11 J/mol/K at 298K and 1 bar
</pre></div>
</div>
</div>
</div>
</section>
<section id="is-the-reaction-thermodynamically-favorable-at-reaction-conditions">
<h3>Is the reaction (thermodynamically) favorable at reaction conditions?<a class="headerlink" href="#is-the-reaction-thermodynamically-favorable-at-reaction-conditions" title="Permalink to this headline">#</a></h3>
<p>As we found above, ammonia synthesis at 298K and 1 bar is very favorable from an enthalpic perspective (<span class="math notranslate nohighlight">\(\Delta H^\circ = -91.8\)</span> kJ/mol) and very unfavorable from an entropic perspective (<span class="math notranslate nohighlight">\(\Delta S^\circ = -198.1\)</span> J/mol/K). So how do we determine if the overall reaction is favorable?  We have to consider Gibbs free energy, which accounts for both enthalpic and entropic driving forces:</p>
<div class="math notranslate nohighlight">
\[\Delta G = \Delta H - T \Delta S \label{eq6}\tag{6}\]</div>
<p>Using this expression, we find:</p>
<div class="math notranslate nohighlight">
\[\Delta G^\circ = -32,843 \ \textrm{J} \ \textrm{mol}^{-1} = -32.843 \ \textrm{kJ} \ \textrm{mol}^{-1} \label{eq7}\tag{7}\]</div>
<p>Note that the enthalpies we looked up were in kJ/mol, and the entropies were in J/mol/K, so we converted accordingly to get the correct Gibbs free energy.</p>
<p>This is an extremely favorable Gibbs free energy change.</p>
<div class = "alert alert-block alert-info">
Reactions with negative changes in Gibbs free energy are generally classified as "favorable." A Gibbs free energy changes less than maybe -30 kJ/mole is so favorable that it is almost at the point where we can consider it irreverisble.  In other words, the reaction between $N_2$ and $H_2$ at 298K and 1 bar is <b>extremely</b> favorable.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span>  <span class="o">=</span> <span class="mi">298</span> <span class="c1">#K</span>
<span class="n">DG</span> <span class="o">=</span> <span class="n">DH</span><span class="o">*</span><span class="mi">1000</span> <span class="o">-</span> <span class="n">T</span><span class="o">*</span><span class="n">DS</span> <span class="c1">#J/mol</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Delta G is </span><span class="si">{</span><span class="n">DG</span><span class="si">:</span><span class="s1">5.0f</span><span class="si">}</span><span class="s1"> J/mol at 298K and 1 bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Delta G is -32843 J/mol at 298K and 1 bar
</pre></div>
</div>
</div>
</div>
</section>
<section id="what-composition-do-i-expect-at-chemical-equilibrium">
<h3>What composition do I expect at chemical equilibrium?<a class="headerlink" href="#what-composition-do-i-expect-at-chemical-equilibrium" title="Permalink to this headline">#</a></h3>
<p>And what is the fractional conversion of <span class="math notranslate nohighlight">\(N_2\)</span> at chemical equilibrium?</p>
<p>Without doing any calculations, just looking at that free energy change, I would expect mostly ammonia at chemical equilibrium.  This means that I’m expecting a high fractional conversion on <span class="math notranslate nohighlight">\(N_2\)</span>.  We can be a bit more quantitative by looking at the equilibrium constant, <span class="math notranslate nohighlight">\(K\)</span>, which gives us an idea of how favorable a reaction is.  For comparison, a reaction with <span class="math notranslate nohighlight">\(K = 1\)</span> is considered neither favorable or unfavorable…for an <span class="math notranslate nohighlight">\(A \leftrightharpoons B\)</span> type reaction, it will give equal amounts of reactants and products at equilibrium (if starting with pure A).</p>
<p><strong>Calculating the Equilibrium Constant</strong></p>
<p>We calculate the equilibrium constant for this reaction using:</p>
<div class="math notranslate nohighlight">
\[K = \exp\left(\frac{-\Delta G^\circ}{RT}\right) \label{eq8}\tag{8}\]</div>
<p>In other words, we calculate the equilibrium constant at our standard state conditions for this reaction, where we know <span class="math notranslate nohighlight">\(\Delta G = -32,843\)</span> J/mol. Making appropriate substitutions (T = 298 and R = 8.314 J/mol/K), we find:</p>
<div class="math notranslate nohighlight">
\[K = 5.72\times10^5 \label{eq9}\tag{9}\]</div>
<div class = "alert alert-block alert-success">
Consistent with our analysis of the Gibbs free energy change, this is extremely favorable, and we should expect almost 100% conversion of $N_2$ at chemical equilibrium.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">DG</span><span class="o">/</span><span class="mf">8.314</span><span class="o">/</span><span class="mi">298</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The Thermodynamic Equilibrium Constant for this reaction is K = </span><span class="si">{</span><span class="n">K</span><span class="si">:</span><span class="s1">6.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The Thermodynamic Equilibrium Constant for this reaction is K = 571610
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculating-the-equilibrium-composition">
<h3>Calculating the Equilibrium Composition<a class="headerlink" href="#calculating-the-equilibrium-composition" title="Permalink to this headline">#</a></h3>
<p>Assume that a vessel (e.g., a batch reactor) is initially charged with N<span class="math notranslate nohighlight">\(_2\)</span> and H<span class="math notranslate nohighlight">\(_2\)</span> in a stoichiometric ratio (1:3).  The vessel is held at 298K and 1 bar. Assuming that the system is allowed to reach chemical equilibrium, calculate the composition of the gas-phase mixture and the equilibrium fractional conversion of Nitrogen.   Note that fractional conversion of a species <span class="math notranslate nohighlight">\(j\)</span> is defined as is conventional according to the equation below in terms of either inlet and outlet moles or the extent of reaction.</p>
<div class="math notranslate nohighlight">
\[\chi_j = \frac{n_{j_{0}} - n_{j}}{n_{j_{0}}} = \frac{-\nu_{j} \cdot \varepsilon}{n_{j_{0}}} \label{eq10}\tag{10}\]</div>
<p>and the extent of any given reaction can be formally defined in terms of any species participating in that reaction as below:</p>
<div class="math notranslate nohighlight">
\[\varepsilon = \frac{n_j - n_{j_0}}{\nu_j} \label{eq11}\tag{11}\]</div>
</section>
</section>
<section id="solution-to-example-1">
<h2>Solution to Example 1<a class="headerlink" href="#solution-to-example-1" title="Permalink to this headline">#</a></h2>
<p>When we want to solve for the equilibrium composition of a mixture, and all we have are thermodynamic data available, we always start here:</p>
<div class="math notranslate nohighlight">
\[\exp\left(\frac{-\Delta G^\circ}{RT}\right) = K = \prod_{j = 1}^{N_S}a_j^{\nu_j} \label{eq12}\tag{12}\]</div>
<p>In Equations <a class="reference external" href="#mjx-eqn-eq8">8</a> and <a class="reference external" href="#mjx-eqn-eq9">9</a> above, we solved for the standard state Gibbs free energy and the equilibrium constant for this reaction in its standard state (298K, 1 bar, pure gases reacting).</p>
<div class="math notranslate nohighlight">
\[K = 5.72\times10^5\]</div>
<p>Now we need to work through the right hand side of Equation (\ref{eq12}) and express  thermodynamic activities in terms of species composition.  We will start here:</p>
<div class="math notranslate nohighlight">
\[K = \prod_{j = 1}^{N_S}a_j^{\nu_j} \label{eq13}\tag{13}\]</div>
<p>We can apply this equation to the specific example of ammonia synthesis to find:</p>
<div class="math notranslate nohighlight">
\[K = \frac{{a_{N\!H_3}}^{2}}{{a_{N_2}}{a_{H_2}}^3} \label{eq14}\tag{14}\]</div>
<p>Now, we recall our definitions for thermodynamic activities of gases in a mixture:</p>
<div class="math notranslate nohighlight">
\[a_j = \frac{\hat{f}_j}{f_j^\circ} \label{eq15}\tag{15}\]</div>
<p>The numerator is the fugacity of species <span class="math notranslate nohighlight">\(j\)</span> under reaction conditions <span class="math notranslate nohighlight">\((T = 298K, P = 1 bar, \chi_j = ?)\)</span>. The denominator is the fugacity of species <span class="math notranslate nohighlight">\(j\)</span> in its reference state. Our reference state for gas-phase species is a pure species at 1 bar and the reaction temperature (T = 298). Our convention for calculating fugacities of gases in a mixture uses the Lewis Randall rule.  With these things in mind, formally, we have:</p>
<div class="math notranslate nohighlight">
\[a_j = \frac{y_j \phi_j P}{y_j^\circ \phi_j^\circ  P^\circ} \label{eq16}\tag{16}\]</div>
<p>Looking at the numerator of Equation (\ref{eq16}), we are operating this reactor at 1 bar, so the fugacity coefficient for species <span class="math notranslate nohighlight">\(j\)</span> under reaction conditions, <span class="math notranslate nohighlight">\(\phi_j\)</span> is 1. Looking at the denominator, the reference state is a pure species, so <span class="math notranslate nohighlight">\(y_j^\circ = 1\)</span>.  Further, that pure species is at 1 bar, so <span class="math notranslate nohighlight">\(\phi_j^\circ = 1\)</span></p>
<p>This gives the usual result for low pressure gases:</p>
<div class="math notranslate nohighlight">
\[a_j = \frac{y_j P}{P^\circ} \label{eq17}\tag{17}\]</div>
<p>Now we apply this equation to all of the species participating in the reaction.  Notice that I’m still retaining <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(P^\circ\)</span> in my solution.  This helps me to keep it general, and to make sure that I take care to be dimensionally consistent.</p>
<p>If I wanted to solve this by hand or in a calculator, I’d probably start substituting these activity definitions in and simplifying the equation:</p>
<div class="math notranslate nohighlight">
\[K = \frac{\left(\frac{y_{N\!H_3}P}{P^\circ}\right)^2}{\left(\frac{y_{N_2}P}{P^\circ}\right) \left(\frac{y_{H_2}P}{P^\circ}\right)^3} \label{eq18}\tag{18}\]</div>
<p>We see multiple pressures and reference pressures that will cancel, giving:</p>
<div class="math notranslate nohighlight">
\[K = \frac{{y_{N\!H_3}}^2}{y_{N_2}{y_{H_2}}^3} \left(\frac{P^\circ}{P}\right)^2 \label{eq19}\tag{19}\]</div>
<p>Now we’re at a point that we can’t really go any further because we have 3 unknowns (<span class="math notranslate nohighlight">\(y_{N\!H_3}\)</span>, <span class="math notranslate nohighlight">\(y_{N_2}\)</span>, and <span class="math notranslate nohighlight">\(y_{H_2}\)</span>) and only 1 equation.  To go further, we need to relate mole fractions using stoichiometry.  We do this with either a fractional conversion or a reaction extent.</p>
<section id="expressing-mole-fractions-as-functions-of-extent">
<h3>Expressing Mole Fractions as functions of Extent<a class="headerlink" href="#expressing-mole-fractions-as-functions-of-extent" title="Permalink to this headline">#</a></h3>
<p>In general, the mole fraction for a species in the gas phase is defined as:</p>
<div class="math notranslate nohighlight">
\[y_j = \frac{N_j}{N_{\textrm{total}}} = \frac{N_j}{\sum_j N_j} \label{eq20}\tag{20}\]</div>
<p>We also remember that we can express the moles of each species at any point in the reaction, <span class="math notranslate nohighlight">\(N_j\)</span> in terms of the extent of reaction(s) that are occuring in that system.</p>
<div class="math notranslate nohighlight">
\[N_j = N_{j,0} + \nu_j \varepsilon \label{eq21}\tag{21}\]</div>
<p>I want to do this for all species in the reactor.  I also see that the total number of moles shows up in the definition of a mole fraction, so I need to track that quantity as well.  It is usually a good idea to organize all of this information in a mole table. For simplicity, I will relabel the compounds using N (N<span class="math notranslate nohighlight">\(_2\)</span>), H (H<span class="math notranslate nohighlight">\(_2\)</span>), and A (NH<span class="math notranslate nohighlight">\(_3\)</span>) just for cleaner notation in the table below.</p>
<div class="math notranslate nohighlight">
\[N (g) + 3H (g) \leftrightharpoons 2A (g) \label{eq22}\tag{22}\]</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Species</p></th>
<th class="text-align:center head"><p>In</p></th>
<th class="text-align:center head"><p>Change</p></th>
<th class="text-align:center head"><p>End</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>N<span class="math notranslate nohighlight">\(_2\)</span></p></td>
<td class="text-align:center"><p>NN0</p></td>
<td class="text-align:center"><p>-1<span class="math notranslate nohighlight">\(\varepsilon\)</span></p></td>
<td class="text-align:center"><p>NN0 - 1<span class="math notranslate nohighlight">\(\varepsilon\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>H<span class="math notranslate nohighlight">\(_2\)</span></p></td>
<td class="text-align:center"><p>NH0</p></td>
<td class="text-align:center"><p>-3<span class="math notranslate nohighlight">\(\varepsilon\)</span></p></td>
<td class="text-align:center"><p>NH0 - 3<span class="math notranslate nohighlight">\(\varepsilon\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>NH<span class="math notranslate nohighlight">\(_3\)</span></p></td>
<td class="text-align:center"><p>NA0</p></td>
<td class="text-align:center"><p>+2<span class="math notranslate nohighlight">\(\varepsilon\)</span></p></td>
<td class="text-align:center"><p>NA0 + 2<span class="math notranslate nohighlight">\(\varepsilon\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Total</p></td>
<td class="text-align:center"><p>NT0</p></td>
<td class="text-align:center"><p>-2<span class="math notranslate nohighlight">\(\varepsilon\)</span></p></td>
<td class="text-align:center"><p>NT0 - 2<span class="math notranslate nohighlight">\(\varepsilon\)</span></p></td>
</tr>
</tbody>
</table>
<p>We can make these substitutions into the definitions of mole fractions, ultimately finding:</p>
<div class="math notranslate nohighlight">
\[K = \frac{\left(N_{A,0} + 2\varepsilon\right)^2 \left(N_{T,0} - 2\varepsilon\right)^2}{\left(N_{N,0} - 1\varepsilon\right) \left(N_{H,0} - 3\varepsilon\right)^3} \left(\frac{P^\circ}{P}\right)^2 \label{eq23}\tag{23}\]</div>
</section>
<section id="solve-using-numerical-methods-good-approach">
<h3>Solve using numerical methods (good approach)<a class="headerlink" href="#solve-using-numerical-methods-good-approach" title="Permalink to this headline">#</a></h3>
<p>Inspection of this equation reveals that we know everything except for the extent of reaction.  1 Equation, 1 unknow.  This can be solved with numerical methods; see below, we can use <code class="docutils literal notranslate"><span class="pre">opt.newton</span></code> from the <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code> package since this is a univariate function where our only unknown is the extent of reaction, <span class="math notranslate nohighlight">\(\varepsilon\)</span>.</p>
<div class = "alert alert-block alert-info">
    <b>Notice:</b> In the cell below, we are NOT plugging in numbers to the equation as you'd have to do to solve in a calculator.  We are leaving it symbolic.  This gives us much more flexibility because the solution is now general, and we can easily solve for different reaction pressures or different starting quantities of Nitrogen, Hydrogen, and Ammonia!
    </div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>

<span class="n">NN0</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#mole</span>
<span class="n">NH0</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#moles</span>
<span class="n">NA0</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#moles</span>
<span class="n">NT0</span> <span class="o">=</span> <span class="n">NN0</span> <span class="o">+</span> <span class="n">NH0</span> <span class="o">+</span> <span class="n">NA0</span> <span class="c1">#moles</span>
<span class="n">P0</span>  <span class="o">=</span> <span class="mi">1</span> <span class="c1">#bar</span>
<span class="n">P</span>   <span class="o">=</span> <span class="mi">1</span> <span class="c1">#bar</span>

<span class="n">obj1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">ex</span><span class="p">:</span> <span class="p">(</span><span class="n">NA0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">ex</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">NT0</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">ex</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">NN0</span> <span class="o">-</span> <span class="n">ex</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">NH0</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">ex</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">P0</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">K</span>
<span class="n">ans</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">obj1</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="n">full_output</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The extent of reaction at Equilibrium is </span><span class="si">{</span><span class="n">ans</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The extent of reaction at Equilibrium is 0.968
</pre></div>
</div>
</div>
</div>
<p>Now that we know the reaction extent at equilibrium, it is easy enough to calculate the composition of the mixture by evaluating the molar quantities using our mole table and substituting them into the definition of mole fractions as in Equation <a class="reference external" href="#mjx-eqn-eq20">20</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yN</span> <span class="o">=</span> <span class="p">(</span><span class="n">NN0</span> <span class="o">-</span> <span class="n">ans</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NT0</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">ans</span><span class="p">)</span>
<span class="n">yH</span> <span class="o">=</span> <span class="p">(</span><span class="n">NH0</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">ans</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NT0</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">ans</span><span class="p">)</span>
<span class="n">yA</span> <span class="o">=</span> <span class="p">(</span><span class="n">NA0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">ans</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NT0</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">ans</span><span class="p">)</span>
<span class="n">XN</span> <span class="o">=</span> <span class="n">ans</span><span class="o">/</span><span class="n">NN0</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mole fractions for N2, H2, and NH3 are </span><span class="si">{</span><span class="n">yN</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">yH</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">yA</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The fractional conversion of N2 is </span><span class="si">{</span><span class="n">XN</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mole fractions for N2, H2, and NH3 are 0.015, 0.046, 0.938
The fractional conversion of N2 is 0.968
</pre></div>
</div>
</div>
</div>
</section>
<section id="solve-using-numerical-methods-better-approach">
<h3>Solve using numerical methods (better approach?)<a class="headerlink" href="#solve-using-numerical-methods-better-approach" title="Permalink to this headline">#</a></h3>
<p>Once you become more comfortable with functions and numerical methods, you can actually make very general solutions like the one I show below.  I usually prefer to solve the problems this way because the equations in the code are easy to recognize based on their physical meaning, so it is easier to debug a code that isn’t working. In contrast, with the equation we solved above, I can’t really recognize any specific terms in that equation all that well, so it is hard to debug if something goes wrong.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">EQ1</span><span class="p">(</span><span class="n">ex</span><span class="p">):</span>  <span class="c1">#note &quot;ex&quot; is the the name given to the function argument inside of the function</span>

    <span class="c1">#Specifications for this problem</span>
    <span class="n">P</span>   <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#bar</span>
    <span class="n">P0</span>  <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#bar</span>
    <span class="n">NN0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#moles</span>
    <span class="n">NH0</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="c1">#moles</span>
    <span class="n">NA0</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#moles</span>
    <span class="n">NT0</span> <span class="o">=</span> <span class="n">NN0</span> <span class="o">+</span> <span class="n">NH0</span> <span class="o">+</span> <span class="n">NA0</span>
    
    <span class="n">NN</span>  <span class="o">=</span> <span class="n">NN0</span> <span class="o">-</span> <span class="n">ex</span>
    <span class="n">NH</span>  <span class="o">=</span> <span class="n">NH0</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">ex</span>
    <span class="n">NA</span>  <span class="o">=</span> <span class="n">NA0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">ex</span>
    <span class="n">NT</span>  <span class="o">=</span> <span class="n">NN</span> <span class="o">+</span> <span class="n">NH</span> <span class="o">+</span> <span class="n">NA</span> <span class="c1">#This is equivalent to NT = NT0 - 2*ex</span>
    
    <span class="n">yN</span>  <span class="o">=</span> <span class="n">NN</span><span class="o">/</span><span class="n">NT</span>
    <span class="n">yH</span>  <span class="o">=</span> <span class="n">NH</span><span class="o">/</span><span class="n">NT</span>
    <span class="n">yA</span>  <span class="o">=</span> <span class="n">NA</span><span class="o">/</span><span class="n">NT</span>
    
    <span class="n">aN</span>  <span class="o">=</span> <span class="n">yN</span><span class="o">*</span><span class="n">P</span><span class="o">/</span><span class="n">P0</span>
    <span class="n">aH</span>  <span class="o">=</span> <span class="n">yH</span><span class="o">*</span><span class="n">P</span><span class="o">/</span><span class="n">P0</span>
    <span class="n">aA</span>  <span class="o">=</span> <span class="n">yA</span><span class="o">*</span><span class="n">P</span><span class="o">/</span><span class="n">P0</span>
    
    <span class="n">KCOMP</span> <span class="o">=</span> <span class="n">aA</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">aN</span><span class="o">/</span><span class="n">aH</span><span class="o">**</span><span class="mi">3</span> 
    <span class="n">K</span>     <span class="o">=</span> <span class="mf">5.72e5</span>
        
    <span class="k">return</span> <span class="n">KCOMP</span> <span class="o">-</span> <span class="n">K</span>  <span class="c1">#We want to find the value of extent where KCOMP - K = 0; this is in a good form for opt.newton</span>

<span class="n">ans</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">EQ1</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="n">full_output</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="c1">#This solves for the equilibrium extent</span>

<span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1">#Let&#39;s make sure it converged...</span>

<span class="c1">#The next lines use the equilibrium extent to evaluate the mole table and solve for conversion and mole fractions.</span>
<span class="n">NN</span> <span class="o">=</span> <span class="n">NN0</span> <span class="o">-</span> <span class="n">ans</span>
<span class="n">NH</span> <span class="o">=</span> <span class="n">NH0</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">ans</span>
<span class="n">NA</span> <span class="o">=</span> <span class="n">NA0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">ans</span>
<span class="n">NT</span> <span class="o">=</span> <span class="n">NN</span> <span class="o">+</span> <span class="n">NH</span> <span class="o">+</span> <span class="n">NA</span>
<span class="n">XN</span> <span class="o">=</span> <span class="p">(</span><span class="n">NN0</span> <span class="o">-</span> <span class="n">NN</span><span class="p">)</span><span class="o">/</span><span class="n">NN0</span>
<span class="n">yN</span> <span class="o">=</span> <span class="n">NN</span><span class="o">/</span><span class="n">NT</span>
<span class="n">yH</span> <span class="o">=</span> <span class="n">NH</span><span class="o">/</span><span class="n">NT</span>
<span class="n">yA</span> <span class="o">=</span> <span class="n">NA</span><span class="o">/</span><span class="n">NT</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Conversion of N2 is </span><span class="si">{</span><span class="n">XN</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">, yA is </span><span class="si">{</span><span class="n">yN</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">, yB is </span><span class="si">{</span><span class="n">yH</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">, and yC is </span><span class="si">{</span><span class="n">yA</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      converged: True
           flag: &#39;converged&#39;
 function_calls: 15
     iterations: 14
           root: 0.9681125978904322 

Conversion of N2 is 0.968, yA is 0.015, yB is 0.046, and yC is 0.938
</pre></div>
</div>
</div>
</div>
</section>
<section id="solving-using-numerical-methods-fancy-approach">
<h3>Solving using numerical methods (fancy approach!)<a class="headerlink" href="#solving-using-numerical-methods-fancy-approach" title="Permalink to this headline">#</a></h3>
<p>Ideally, you can start thinking about how to make these problem solutions more general.  The one below as it avoids my having to write code twice to calculate mole fractions and conversion…the trick to this one is defining a function that calculates “KCOMP” for any value of extent, and then uses that function to create an objective function for use with <code class="docutils literal notranslate"><span class="pre">opt.newton</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">KCOMP</span><span class="p">(</span><span class="n">ex</span><span class="p">):</span>

    <span class="n">P</span>   <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#bar</span>
    <span class="n">P0</span>  <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#bar</span>
    <span class="n">NN0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#moles</span>
    <span class="n">NH0</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="c1">#moles</span>
    <span class="n">NA0</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#moles</span>
    <span class="n">NT0</span> <span class="o">=</span> <span class="n">NN0</span> <span class="o">+</span> <span class="n">NH0</span> <span class="o">+</span> <span class="n">NA0</span>
    
    <span class="n">NN</span>  <span class="o">=</span> <span class="n">NN0</span> <span class="o">-</span> <span class="n">ex</span>
    <span class="n">NH</span>  <span class="o">=</span> <span class="n">NH0</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">ex</span>
    <span class="n">NA</span>  <span class="o">=</span> <span class="n">NA0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">ex</span>
    <span class="n">NT</span>  <span class="o">=</span> <span class="n">NN</span> <span class="o">+</span> <span class="n">NH</span> <span class="o">+</span> <span class="n">NA</span>
    
    <span class="n">yN</span>  <span class="o">=</span> <span class="n">NN</span><span class="o">/</span><span class="n">NT</span>
    <span class="n">yH</span>  <span class="o">=</span> <span class="n">NH</span><span class="o">/</span><span class="n">NT</span>
    <span class="n">yA</span>  <span class="o">=</span> <span class="n">NA</span><span class="o">/</span><span class="n">NT</span>
    
    <span class="n">aN</span>  <span class="o">=</span> <span class="n">yN</span><span class="o">*</span><span class="n">P</span><span class="o">/</span><span class="n">P0</span>
    <span class="n">aH</span>  <span class="o">=</span> <span class="n">yH</span><span class="o">*</span><span class="n">P</span><span class="o">/</span><span class="n">P0</span>
    <span class="n">aA</span>  <span class="o">=</span> <span class="n">yA</span><span class="o">*</span><span class="n">P</span><span class="o">/</span><span class="n">P0</span>
    
    <span class="n">KCOMP</span> <span class="o">=</span> <span class="n">aA</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">aN</span><span class="o">/</span><span class="n">aH</span><span class="o">**</span><span class="mi">3</span>
    
    <span class="n">y</span>     <span class="o">=</span> <span class="p">[</span><span class="n">yN</span><span class="p">,</span> <span class="n">yH</span><span class="p">,</span> <span class="n">yA</span><span class="p">]</span>
    <span class="n">XN</span>    <span class="o">=</span> <span class="p">(</span><span class="n">NN0</span> <span class="o">-</span> <span class="n">NN</span><span class="p">)</span><span class="o">/</span><span class="n">NN0</span>
    
    <span class="k">return</span> <span class="n">KCOMP</span><span class="p">,</span> <span class="n">XN</span><span class="p">,</span> <span class="n">y</span>

<span class="n">obj2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">var</span><span class="p">:</span> <span class="n">KCOMP</span><span class="p">(</span><span class="n">var</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">K</span>  <span class="c1">#Notice that I&#39;m using lambda syntax to create a function of the form accepted by opt.newton</span>

<span class="n">ans</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">obj2</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="n">full_output</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1">#Make sure that the solution converted</span>
<span class="n">KCOMP</span><span class="p">,</span> <span class="n">XN</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">KCOMP</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>  <span class="c1">#This sends the final value of extent (the &quot;answer&quot;) back to the KCOMP function to compute y and XA</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Conversion of N2 is </span><span class="si">{</span><span class="n">XN</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1"> and mole fractions for N2, H2, and NH3 are </span><span class="si">{</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      converged: True
           flag: &#39;converged&#39;
 function_calls: 15
     iterations: 14
           root: 0.9681071650390164 

Conversion of N2 is 0.968 and mole fractions for N2, H2, and NH3 are [0.015, 0.046, 0.938]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="F22-587-L05.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Lecture 05</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="F22-587-L07.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lecture 07: Ammonia Equilibrium - Part 2</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By JQB<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>