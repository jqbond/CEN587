
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Material Balances XI &#8212; Kinetics and Reaction Engineering</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Material Balances XII" href="587-L21.html" />
    <link rel="prev" title="Material Balances X" href="587-L19.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/JQB.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Kinetics and Reaction Engineering</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Chapter1.html">
   Python Supplements
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S01.html">
     The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S02.html">
     Data Structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S03.html">
     Arrays and Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S04.html">
     For Loops and Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S05.html">
     Logical Tests and Comparisons
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S06.html">
     While Loops in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S07.html">
     Functions, D&amp;D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S08.html">
     The Fall of Acererak
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S09.html">
     Root Finding: Univariate Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S10.html">
     Minimizing a Univariate Function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S11.html">
     Minimizing Multivariate Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S12.html">
     Systems of Nonlinear Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S13.html">
     Least Squares Revisited
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S14.html">
     ODE Solvers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Supplements/587-S15.html">
     Quadrature
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../Chapter2.html">
   Lectures
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="587-L01.html">
     Introduction and Stoichiometry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L02.html">
     Extent and Conversion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L03.html">
     Algebraic and Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L04.html">
     Chemical Equilibrium I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L05.html">
     Chemical Equilibrium II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L06.html">
     Chemical Equilibrium III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L07.html">
     Chemical Equilibrium IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L08.html">
     Chemical Equilibrium V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L09.html">
     Chemical and Phase Equilibria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L10.html">
     Material Balances I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L11.html">
     Material Balances II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L12.html">
     Material Balances III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L13.html">
     Material Balances IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L14.html">
     Material Balances V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L15.html">
     Material Balances VI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L16.html">
     Material Balances VII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L17.html">
     Material Balances VIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L18.html">
     Material Balances IX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L19.html">
     Material Balances X
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Material Balances XI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L21.html">
     Material Balances XII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L22.html">
     Material Balances XIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L23.html">
     Material Balances XIV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L24.html">
     Material Balances XV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L25.html">
     Material Balances XVI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L26.html">
     Material Balances XVII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L27.html">
     Material Balances XVIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L28.html">
     Kinetics I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L29.html">
     Kinetics II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L30.html">
     Kinetics III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L31.html">
     Kinetics IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L32.html">
     Kinetics V
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L33.html">
     Kinetics VI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L34.html">
     Kinetics VII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L35.html">
     Kinetics VIII
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L36.html">
     Kinetics IX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L37.html">
     Kinetics X
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L38.html">
     Kinetics XI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L39.html">
     Energy Balances I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L40.html">
     Energy Balances II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L41.html">
     Energy Balances III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L42.html">
     Energy Balances IV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="587-L43.html">
     Energy Balances VI
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Chapter3.html">
   Recitations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R01.html">
     Jupyter and Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R02.html">
     Solving Algebraic Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R03.html">
     Chemical Equilibrium
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R04.html">
     Solving ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R05.html">
     Chemical/Phase Equilibria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R06.html">
     CSTRs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R07.html">
     Python tips and tricks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R08.html">
     Optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R09.html">
     Reactors with Recycle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R10.html">
     Interpolation and Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R11.html">
     Nonlinear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R12.html">
     Parameter Estimation I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R13.html">
     Parameter Estimation II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Recitation/587-R14.html">
     Energy Balances
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/jqbond/2022CEN587/main?urlpath=tree/Lectures/587-L20.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/jqbond/2022CEN587"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/jqbond/2022CEN587/issues/new?title=Issue%20on%20page%20%2FLectures/587-L20.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Lectures/587-L20.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#levenspiel-plots">
   Levenspiel Plots
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-generic-cstr-balance">
     A generic CSTR Balance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-generic-pfr-balance">
     A Generic PFR Balance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-ideas">
     General Ideas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-general-rate-of-reaction">
     A general rate of reaction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-general-solution-for-cstr-volume">
     A general solution for CSTR volume
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-general-solution-for-pfr-volume">
     A general solution for PFR volume
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-comparison-of-cstr-and-pfr-volumes-for-a-first-order-reaction">
     A comparison of CSTR and PFR Volumes for a first order reaction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-comparison-of-cstr-and-pfr-volumes-for-a-zero-order-reaction">
     A comparison of CSTR and PFR Volumes for a zero order reaction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-comparison-of-cstr-and-pfr-volumes-for-a-1-order-reaction">
     A comparison of CSTR and PFR Volumes for a -1 order reaction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summarizing-observations">
     Summarizing Observations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rate-as-a-function-of-conversion">
     Rate as a function of conversion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualizing-how-rate-changes-as-a-function-of-conversion">
     Visualizing how rate changes as a function of conversion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-levenspiel-plot">
     The Levenspiel Plot
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Material Balances XI</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#levenspiel-plots">
   Levenspiel Plots
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-generic-cstr-balance">
     A generic CSTR Balance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-generic-pfr-balance">
     A Generic PFR Balance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-ideas">
     General Ideas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-general-rate-of-reaction">
     A general rate of reaction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-general-solution-for-cstr-volume">
     A general solution for CSTR volume
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-general-solution-for-pfr-volume">
     A general solution for PFR volume
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-comparison-of-cstr-and-pfr-volumes-for-a-first-order-reaction">
     A comparison of CSTR and PFR Volumes for a first order reaction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-comparison-of-cstr-and-pfr-volumes-for-a-zero-order-reaction">
     A comparison of CSTR and PFR Volumes for a zero order reaction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-comparison-of-cstr-and-pfr-volumes-for-a-1-order-reaction">
     A comparison of CSTR and PFR Volumes for a -1 order reaction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summarizing-observations">
     Summarizing Observations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rate-as-a-function-of-conversion">
     Rate as a function of conversion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualizing-how-rate-changes-as-a-function-of-conversion">
     Visualizing how rate changes as a function of conversion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-levenspiel-plot">
     The Levenspiel Plot
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="material-balances-xi">
<h1>Material Balances XI<a class="headerlink" href="#material-balances-xi" title="Permalink to this headline">#</a></h1>
<p>This lecture introduces Levenspiel Plots to compare sizing trends for a single CSTR and PFR for various reaction orders.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quadrature</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">ceil</span><span class="p">,</span> <span class="n">floor</span>
</pre></div>
</div>
</div>
</div>
<section id="levenspiel-plots">
<h2>Levenspiel Plots<a class="headerlink" href="#levenspiel-plots" title="Permalink to this headline">#</a></h2>
<p>We’re going to take a small break from the usual problem solutions and consider a graphical approach to reactor sizing. It is a pretty old method, but I think it helps to build some useful insight about how reactor size (or time required inside of the reactor) scale with the reaction rate.  It also helps us to visualize the differences between PFR and CSTR reactor sizes required to achieve the exact same conversion level for a given reaction.</p>
<p>We will also use these to help to visualize optimal strategies for reactor sequencing when our process involves more than one reactor (and sometimes more than one type of reactor).</p>
<p>To begin, we will write material balances on a CSTR and a PFR.  We’ll only use this approach for these two reactors, but the concepts are fairly general.</p>
<p>We’ll consider a simple, irreversible reaction:</p>
<div class="math notranslate nohighlight">
\[A \longrightarrow B\]</div>
<p>We’ll assume that its rate only depends on the concentration of species A and that the density of the fluid in the reactor is constant.  We will not specify a rate law yet as we want to look at some general concepts abour reactor sizing first.</p>
<section id="a-generic-cstr-balance">
<h3>A generic CSTR Balance<a class="headerlink" href="#a-generic-cstr-balance" title="Permalink to this headline">#</a></h3>
<p>If we write a balance on species A for a CSTR operating at steady state, we get:</p>
<div class="math notranslate nohighlight">
\[0 = F_{A,f} - F_A + R_AV\]</div>
<p>We really want to consider the size of the reactor in this analysis, so we’ll solve this balance for Volume:</p>
<div class="math notranslate nohighlight">
\[V = \frac{-(F_{A,f} - F_A)}{R_A}\]</div>
<p>For this simple reaction, we know that:</p>
<div class="math notranslate nohighlight">
\[R_A = -r\]</div>
<p>We have to recognize that the rate of reaction will <em>generally</em> depend on the fractional conversion of reactant, so I’m actually going to write this to show that functional dependence explicitly:</p>
<div class="math notranslate nohighlight">
\[R_A = -r \, (X_A)\]</div>
<p>We also can derive the following result from the definition of fractional conversion of A in a flow reactor:</p>
<div class="math notranslate nohighlight">
\[F_{A,f} - F_A = F_{A,f}X_A\]</div>
<p>Substituting those two results into the expression for Volume, we find:</p>
<div class="math notranslate nohighlight">
\[V = \frac{F_{A,f}X_A}{r \, (X_A)}\]</div>
<p>The numerator of that expression conceptually represents the extensive rate at which species A is consumed in the reactor.  The denominator represents the intensive rate of reaction (per unit volume). If we divde the quantity of species being consumed per time by the rate at which they are consumed per unit volume, we get the size of the system.</p>
</section>
<section id="a-generic-pfr-balance">
<h3>A Generic PFR Balance<a class="headerlink" href="#a-generic-pfr-balance" title="Permalink to this headline">#</a></h3>
<p>We start by writing the usual PFR balance on A:</p>
<div class="math notranslate nohighlight">
\[\frac{dF_A}{dV} = R_A\]</div>
<p>We express the Flowrate of A as a function of conversion:</p>
<div class="math notranslate nohighlight">
\[F_A = F_{A,f} - F_{A,f}X_A = F_{A,f} (1 - X_A)\]</div>
<p>And we know from the CSTR balance above that:</p>
<div class="math notranslate nohighlight">
\[R_A = -r \, (X_A)\]</div>
<p>Where, again, the <span class="math notranslate nohighlight">\(r \, (X_A)\)</span> term indicates explicitly that rate is a function of fractional conversion of A.  Making these substitutions into the material balance, we get</p>
<div class="math notranslate nohighlight">
\[\frac{dX_A}{dV} = \frac{r \, (X_A)}{F_{A,f}}\]</div>
<p>I’m going to rearrange that.</p>
<div class="math notranslate nohighlight">
\[dV = \frac{F_{A,f} \, dX_A}{r \, (X_A)}\]</div>
<p><strong>Note</strong>: That is actually a differential analog of the CSTR balance.  See below.</p>
<div class="math notranslate nohighlight">
\[V_\textrm{CSTR} = \frac{F_{A,f}X_A}{r \, (X_A)}\]</div>
<p>The PFR is basically the differential version of this.  The differential change in volume (dV) is equal to the differential quantity of species A that convert in the reactor divided by the intensive rate at which it is converted.  If we want to solve for the total PFR volume to compare to the total CSTR volume, we have to integrate the PFR balance above:</p>
<div class="math notranslate nohighlight">
\[\int_0^{V_\textrm{PFR}}dV = \int_0^{X_A}\frac{F_{A,f} \, dX_A}{r \, (X_A)}\]</div>
<p>The left hand side is easy to integrate, and we get the result that:</p>
<div class="math notranslate nohighlight">
\[V_\textrm{PFR} = \int_0^{X_A}\frac{F_{A,f} \, dX_A}{r \, (X_A)}\]</div>
<p>Again, loosely, the size of the PFR depends on the quantity of species that we are converting divided by the rate at which we convert them.</p>
</section>
<section id="general-ideas">
<h3>General Ideas<a class="headerlink" href="#general-ideas" title="Permalink to this headline">#</a></h3>
<p>What we see from these equations is that the size of the reactor (whether it is a PFR or a CSTR) scales directly with the quantity of “stuff” converted in that reactor, and it scales inversely with the rate of reaction.</p>
<p>In other words, the more “stuff” the reactor needs to convert, the larger it needs to be (everything else fixed). Analogously, the faster the reaction occurs (larger r), the smaller the reactor needs to be.  So those are the general things we need to think about when we consider reactor sizes and especially when we compare the performance of CSTRs and PFRs: how much extensive conversion does the reactor need to accomplish, and how quickly does the reaction occur inside of that reactor.</p>
<p>The differences between CSTRs and PFRs will depend on the reaction rate, specificially how the reaction rate changes as a function of fractional conversion.  Until we know that relationship, we can’t really compare the sizes of these two reactors.</p>
</section>
<section id="a-general-rate-of-reaction">
<h3>A general rate of reaction<a class="headerlink" href="#a-general-rate-of-reaction" title="Permalink to this headline">#</a></h3>
<p>For this simple reaction:</p>
<div class="math notranslate nohighlight">
\[A \longrightarrow B\]</div>
<p>We can propose that the rate of reaction scales with the concentration of A in some power law relationship.  Something like:</p>
<div class="math notranslate nohighlight">
\[r = k{C_A}^\alpha\]</div>
<p>Where <span class="math notranslate nohighlight">\(\alpha\)</span> is an unspecified reaction order (0, 1, -3, 0.5, etc.).  We know that we can express the concentration of A as a function of fractional conversion of A:</p>
<div class="math notranslate nohighlight">
\[C_A = \frac{F_A}{Q}\]</div>
<p>For a constant density flow reactor (we have made this assumption already):</p>
<div class="math notranslate nohighlight">
\[C_A = \frac{F_A}{Q_f}\]</div>
<p>And we can express the molar flowrate as a function of conversion:</p>
<div class="math notranslate nohighlight">
\[C_A = \frac{F_{A,f}(1 - X_A)}{Q_f}\]</div>
<p>We can see that this simplifies to the following (for a constant density flow reactor):</p>
<div class="math notranslate nohighlight">
\[C_A = C_{A,f} \, (1 - X_A)\]</div>
<p>We can substitute that into our rate expression:</p>
<div class="math notranslate nohighlight">
\[r = k{C_{A,f}}^\alpha \, (1 - X_A)^\alpha\]</div>
<p>Now with a power law expression, we can consider how rate of reaction changes as a function of fractional conversion.  This really depends on the value of <span class="math notranslate nohighlight">\(\alpha\)</span>, specifically, whether it is less than, greater than, or equal to zero.</p>
<p>Let’s consider these cases for numerical values of k = 1 and <span class="math notranslate nohighlight">\(C_{A,f} = 1\)</span>.  The rate constant will always have correct units so that we get the reaction rate in dimensions of moles per volume per time.</p>
<p>What we’ll do next is include this generic rate expression into our generic PFR and CSTR balances.  Then we’ll compare PFR and CSTR sizes as a function of fractional conversion, and see how trends change when we vary the reaction order (<span class="math notranslate nohighlight">\(\alpha\)</span>).</p>
</section>
<section id="a-general-solution-for-cstr-volume">
<h3>A general solution for CSTR volume<a class="headerlink" href="#a-general-solution-for-cstr-volume" title="Permalink to this headline">#</a></h3>
<p>Recall, our CSTR Balance is given by:</p>
<div class="math notranslate nohighlight">
\[V_\textrm{CSTR} = \frac{F_{A,f}X_A}{r \, (X_A)}\]</div>
<p>So, I’ll just write a function that calculates the CSTR Volume for any value of fractional conversion and alpha. Just for illustration of how to use this, we’ll calculate the CSTR volume required to achieve a conversion of 50% for a first order reaction (1 Liter).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">VCSTR</span><span class="p">(</span><span class="n">XA</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="n">FAf</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#mol/min</span>
    <span class="n">Qf</span>  <span class="o">=</span> <span class="mi">1</span> <span class="c1">#mol/min</span>
    <span class="n">CAf</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#mol/L</span>
    <span class="n">k</span>   <span class="o">=</span> <span class="mi">1</span> <span class="c1">#1/min</span>
    <span class="n">CA</span>  <span class="o">=</span> <span class="n">CAf</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">XA</span><span class="p">)</span>
    <span class="n">r</span>   <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">CA</span><span class="o">**</span><span class="n">alpha</span>
    <span class="n">V</span>   <span class="o">=</span> <span class="n">FAf</span><span class="o">*</span><span class="n">XA</span><span class="o">/</span><span class="n">r</span>
    <span class="k">return</span> <span class="n">V</span>
<span class="nb">print</span><span class="p">(</span><span class="n">VCSTR</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="a-general-solution-for-pfr-volume">
<h3>A general solution for PFR volume<a class="headerlink" href="#a-general-solution-for-pfr-volume" title="Permalink to this headline">#</a></h3>
<p>Next, we recall the solution for PFR volume:</p>
<div class="math notranslate nohighlight">
\[V_\textrm{PFR} = \int_0^{X_A}\frac{F_{A,f} \, dX_A}{r \, (X_A)}\]</div>
<p>We can replace the rate law with the generic function of XA and alpha as above.  We also need to integrate this equation to solve for the PFR volume, but this is straightforward with Gaussian Quadrature. See below; we’ll write this as a general function that takes the desired conversion and reaction order as arguments and then solves the corresponding definite integral to find the PFR Volume</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">VPFR</span><span class="p">(</span><span class="n">XA</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="n">FAf</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#mol/min</span>
    <span class="n">Qf</span>  <span class="o">=</span> <span class="mi">1</span> <span class="c1">#mol/min</span>
    <span class="n">CAf</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#mol/L</span>
    <span class="n">k</span>   <span class="o">=</span> <span class="mi">1</span> <span class="c1">#1/min</span>
    <span class="n">CA</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">X</span><span class="p">:</span> <span class="n">CAf</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">X</span><span class="p">)</span>
    <span class="n">r</span>   <span class="o">=</span> <span class="k">lambda</span> <span class="n">X</span><span class="p">:</span> <span class="n">k</span><span class="o">*</span><span class="n">CA</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">**</span><span class="n">alpha</span>
    
    <span class="n">intfun</span>   <span class="o">=</span> <span class="k">lambda</span> <span class="n">X</span><span class="p">:</span> <span class="n">FAf</span><span class="o">/</span><span class="n">r</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">vol</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quadrature</span><span class="p">(</span><span class="n">intfun</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">XA</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">vol</span>
<span class="nb">print</span><span class="p">(</span><span class="n">VPFR</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6931471805400136
</pre></div>
</div>
</div>
</div>
</section>
<section id="a-comparison-of-cstr-and-pfr-volumes-for-a-first-order-reaction">
<h3>A comparison of CSTR and PFR Volumes for a first order reaction<a class="headerlink" href="#a-comparison-of-cstr-and-pfr-volumes-for-a-first-order-reaction" title="Permalink to this headline">#</a></h3>
<p>Now that we have those general functions set up, we will compare results for a few different reaction orders. There are a handful of ways we can do this.  For the CSTR, I’ll just pass a numpy array of desired conversions into the VCSTR function.  For the PFR, I’ll have to use a loop since quadrature won’t take an array as an argument (upper limit of integration).  I’ll use a list comprehension for this, which is basically a shorthand for loop.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">order</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">XAset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">VCSTRset</span> <span class="o">=</span> <span class="n">VCSTR</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
<span class="n">templist</span> <span class="o">=</span> <span class="p">[</span><span class="n">VPFR</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">XAset</span><span class="p">]</span> 
<span class="n">VPFRset</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">templist</span><span class="p">)</span>
<span class="c1">#Create and format figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">VCSTRset</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CSTR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">VPFRset</span><span class="p">,</span>  <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PFR&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Volume Comparison for an order </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1"> reaction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;XA&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L20_8_0.png" src="../_images/587-L20_8_0.png" />
</div>
</div>
</section>
<section id="a-comparison-of-cstr-and-pfr-volumes-for-a-zero-order-reaction">
<h3>A comparison of CSTR and PFR Volumes for a zero order reaction<a class="headerlink" href="#a-comparison-of-cstr-and-pfr-volumes-for-a-zero-order-reaction" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">order</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">XAset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">VCSTRset</span> <span class="o">=</span> <span class="n">VCSTR</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
<span class="n">templist</span> <span class="o">=</span> <span class="p">[</span><span class="n">VPFR</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">XAset</span><span class="p">]</span> 
<span class="n">VPFRset</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">templist</span><span class="p">)</span>
<span class="c1">#Create and format figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">VCSTRset</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CSTR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">VPFRset</span><span class="p">,</span>  <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PFR&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Volume Comparison for an order </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1"> reaction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;XA&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L20_10_0.png" src="../_images/587-L20_10_0.png" />
</div>
</div>
</section>
<section id="a-comparison-of-cstr-and-pfr-volumes-for-a-1-order-reaction">
<h3>A comparison of CSTR and PFR Volumes for a -1 order reaction<a class="headerlink" href="#a-comparison-of-cstr-and-pfr-volumes-for-a-1-order-reaction" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">order</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">XAset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">VCSTRset</span> <span class="o">=</span> <span class="n">VCSTR</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
<span class="n">templist</span> <span class="o">=</span> <span class="p">[</span><span class="n">VPFR</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">XAset</span><span class="p">]</span> 
<span class="n">VPFRset</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">templist</span><span class="p">)</span>
<span class="c1">#Create and format figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">VCSTRset</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CSTR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">VPFRset</span><span class="p">,</span>  <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PFR&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.76</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Volume Comparison for an order </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1"> reaction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;XA&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L20_12_0.png" src="../_images/587-L20_12_0.png" />
</div>
</div>
</section>
<section id="summarizing-observations">
<h3>Summarizing Observations<a class="headerlink" href="#summarizing-observations" title="Permalink to this headline">#</a></h3>
<p>If you completed the Unit 03 Assignment correctly, you should have found the same trends.  For positive order reactions, the PFR will always be smaller than the CSTR.  For negative order reactions, the PFR will always be larger than the CSTR.  For 0 order reactions, the two reactors will have identical volumes.</p>
<p>Now we’re going to figure out why this happens.</p>
<p>A good place to start this discussion is with our generic CSTR and PFR balances that are solved for Volume (in general terms):</p>
<p><strong>CSTR Volume</strong></p>
<div class="math notranslate nohighlight">
\[V_\textrm{CSTR} = \frac{F_{A,f}X_A}{r \, (X_A)}\]</div>
<p><strong>PFR Volume</strong></p>
<div class="math notranslate nohighlight">
\[V_\textrm{PFR} = \int_0^{X_A}\frac{F_{A,f} \, dX_A}{r \, (X_A)}\]</div>
<p>Looking at those again, we remind ourselves that the size of the reactor will scale directly with the quantity of species A converted and it will scale inversely with the rate at which A is converted.  The numerator term is pretty easy to visualize:</p>
<div class="math notranslate nohighlight">
\[F_{A,f}X_A\]</div>
<p>It represents the quantity of species A consumed (in units of moles per time).  Since <span class="math notranslate nohighlight">\(F_{A,f}\)</span> is constant, this quantity only changes in response to changes in the conversion that we want to achieve in that reactor.  As conversion increases, the quantity of species A converted increases.</p>
</section>
<section id="rate-as-a-function-of-conversion">
<h3>Rate as a function of conversion<a class="headerlink" href="#rate-as-a-function-of-conversion" title="Permalink to this headline">#</a></h3>
<p>The denominator is a bit less easy to visualize.  To do so, we need to define a rate law.  We will again assume arbitrary power law kinetics and that the rate only depends on the concentration of species A:</p>
<div class="math notranslate nohighlight">
\[r(X_A) = k{C_A}^\alpha\]</div>
<p>And as above, we can express the concentration of A in terms of fractional conversion as follows (for a constant density flow reactor):</p>
<div class="math notranslate nohighlight">
\[r(X_A) = k{C_{A,f}}^\alpha \, {(1 - X_A)}^\alpha\]</div>
<p>With that, we can define a general rate equation that calculates reaction rate as a function of fractional conversion for any reaction order (in A).  See below; once defined we use it to calculate the rate of reaction for a first order reaction at 50% conversion of A.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">r</span><span class="p">(</span><span class="n">XA</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="n">k</span>   <span class="o">=</span> <span class="mi">1</span>
    <span class="n">CAf</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">CA</span>  <span class="o">=</span> <span class="n">CAf</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">XA</span><span class="p">)</span>
    <span class="n">r</span>   <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">CA</span><span class="o">**</span><span class="n">alpha</span>
    <span class="k">return</span> <span class="n">r</span>
<span class="n">r</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualizing-how-rate-changes-as-a-function-of-conversion">
<h3>Visualizing how rate changes as a function of conversion<a class="headerlink" href="#visualizing-how-rate-changes-as-a-function-of-conversion" title="Permalink to this headline">#</a></h3>
<p>With that defined, we’ll use it with a loop to illustrate how reaction rate changes as a function for various reaction orders.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XAset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> 

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">r</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">alpha</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>  

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Rates vs. conversion for various orders&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;rate (mol/L/min)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;XA&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L20_16_0.png" src="../_images/587-L20_16_0.png" />
</div>
</div>
<p>Although we only show a few reaction orders in the plot, the trends are completely general. Basically:</p>
<ol class="simple">
<li><p>For <span class="math notranslate nohighlight">\(\alpha &gt; 0\)</span>, the rate of reaction decreases with increasing fractional conversion of A (as CA decreases)</p></li>
<li><p>For <span class="math notranslate nohighlight">\(\alpha = 0\)</span>, the rate of reaction is independent of fractional conversion of A</p></li>
<li><p>For <span class="math notranslate nohighlight">\(\alpha &lt; 0\)</span>, the rate of reaction increases with increasing fractional conversion of A (as CA decreases)</p></li>
</ol>
</section>
<section id="the-levenspiel-plot">
<h3>The Levenspiel Plot<a class="headerlink" href="#the-levenspiel-plot" title="Permalink to this headline">#</a></h3>
<p>Now we’ll take a look at the balances for the CSTR and the PFR:</p>
<div class="math notranslate nohighlight">
\[V_\textrm{CSTR} = \frac{F_{A,f}}{r \, (X_A)}X_A\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[V_\textrm{PFR} = \int_0^{X_A}\frac{F_{A,f}}{r \, (X_A)}dX_A\]</div>
<p>We see that the size of the reactor scales with the ratio of the feed rate of A and the rate of reaction.  Above, we created functions that describe the rate of reaction for various reaction orders. We’ll do something similar here and call it a Levenspiel plot.  The quantity of interest for us is the ratio, <span class="math notranslate nohighlight">\(F_{A,f}/r \, (X_A)\)</span>, so we’ll write that in a function and then plot it vs. fractional conversion.</p>
<p>Specifically:</p>
<div class="math notranslate nohighlight">
\[\frac{F_{A,f}}{r \, (X_A)} = \frac{F_{A,f}}{k{C_{A,f}}^\alpha \, (1 - X_A)^\alpha}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">LEV</span><span class="p">(</span><span class="n">XA</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="n">k</span>   <span class="o">=</span> <span class="mi">1</span> <span class="c1">#units to vary with reaction order so that r = mol/L/min</span>
    <span class="n">CAf</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#mol/L</span>
    <span class="n">FAf</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#mol/min</span>
    <span class="n">CA</span>  <span class="o">=</span> <span class="n">CAf</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">XA</span><span class="p">)</span>
    <span class="n">r</span>   <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">CA</span><span class="o">**</span><span class="n">alpha</span>
    <span class="k">return</span> <span class="n">FAf</span><span class="o">/</span><span class="n">r</span>

<span class="n">XAset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">LEV</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">alpha</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Levenspiel Plots for various reaction orders&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;FAf/r (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;XA&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L20_18_0.png" src="../_images/587-L20_18_0.png" />
</div>
</div>
<p>Remember: the figure above is basically showing you how inverse rate changes as a function of fractional conversion.  For positive order kinetics, inverse rate gets bigger as a function of conversion.  For negative order kinetics, inverse rate gets smaller as a function of conversion.  For zero order kinetics, inverse rate is constant as a function of conversion.</p>
<p>To use the plots and to start understanding the trends, we’ll focus on the first order case.  Before we do, let’s recall some results for CSTR and PFR volumes required to achieve specific conversions for the first order case.  I’ll ask for volumes required for conversions of 0.2, 0.5, and 0.9.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XAtest</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="n">VCtest</span> <span class="o">=</span> <span class="p">[</span><span class="n">VCSTR</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">XAtest</span><span class="p">]</span> <span class="c1">#I&#39;m using a comprehension here; shorthand for loop</span>
<span class="n">VPtest</span> <span class="o">=</span> <span class="p">[</span><span class="n">VPFR</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">XAtest</span><span class="p">]</span>  <span class="c1">#another list comprehension</span>

<span class="k">for</span> <span class="n">XA</span><span class="p">,</span> <span class="n">VC</span><span class="p">,</span> <span class="n">VP</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">XAtest</span><span class="p">,</span> <span class="n">VCtest</span><span class="p">,</span> <span class="n">VPtest</span><span class="p">):</span>  <span class="c1">#zip is handy; it let&#39;s you iterate over values in multiple sets.</span>
    <span class="k">if</span> <span class="n">XA</span> <span class="o">==</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;For a first order reaction with the specified parameters...&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;To achieve a conversion of </span><span class="si">{</span><span class="n">XA</span><span class="si">:</span><span class="s1">3.2f</span><span class="si">}</span><span class="s1">, the CSTR volume is </span><span class="si">{</span><span class="n">VC</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">L and the PFR volume is </span><span class="si">{</span><span class="n">VP</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1">L&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For a first order reaction with the specified parameters...
To achieve a conversion of 0.05, the CSTR volume is 0.053L and the PFR volume is 0.051L
To achieve a conversion of 0.10, the CSTR volume is 0.111L and the PFR volume is 0.105L
To achieve a conversion of 0.20, the CSTR volume is 0.250L and the PFR volume is 0.223L
To achieve a conversion of 0.30, the CSTR volume is 0.429L and the PFR volume is 0.357L
To achieve a conversion of 0.50, the CSTR volume is 1.000L and the PFR volume is 0.693L
To achieve a conversion of 0.75, the CSTR volume is 3.000L and the PFR volume is 1.386L
To achieve a conversion of 0.90, the CSTR volume is 9.000L and the PFR volume is 2.303L
</pre></div>
</div>
</div>
</div>
<p>Now that we have specific volumes in mind for these various cases, we can proceed with the Levenspiel Plot analysis.  We’ll go back again to the balances on the CSTR and PFR that we have solved for volume:</p>
<p>Now we’ll take a look at the balances for the CSTR and the PFR.  We will look at the CSTR first.</p>
<div class="math notranslate nohighlight">
\[V_\textrm{CSTR} = \frac{F_{A,f}}{r \, (X_A)}X_A\]</div>
<p>Notice:  this is actually the product of our “LEV” function, <span class="math notranslate nohighlight">\(F_{A,f}/r \, (X_A)\)</span>, and the fractional conversion achieved in that reactor.  Since we assume a CSTR is perfectly mixed, the relevant reaction rate is specified at the exit composition (exit conversion).  This is to say that the entire volume of a CSTR is at an identical conversion value because it is perfectly mixed.  That means the rate of reaction in a CSTR is uniform throughout, and that the rate of reaction is <strong>calculated at the exit conditions of the CSTR</strong>.  In a graphical context, if we plot our “LEV” function against fractional conversion, then the volume of a CSTR is given by the product of the “LEV” function value at a specific conversion (i.e., the “y” axis on our plot) and the value of fractional conversion at the reactor exit (i.e., the “x” axis on our plot).  It looks like a rectangle defined by the exit conditions on the Levenspiel plot.</p>
<p>In the PFR, we see that the right hand side involves the product of our “LEV” function, <span class="math notranslate nohighlight">\(F_{A,f}/r \, (X_A)\)</span> and a differential change in fractional conversion.  To determine the PFR volume, we have to evaluate the integral on the right hand side.  Specifically, we are integrating our “LEV” function, <span class="math notranslate nohighlight">\(F_{A,f}/r \, (X_A)\)</span>, as a function of fractional conversion. This allows us to account for the way a PFR operates, which is to incrementally increase conversion from inlet to exit through a series of axial slices.  In a graphical context, the volume of the PFR represents the area under the curve in a Levenspiel plot.</p>
<div class="math notranslate nohighlight">
\[V_\textrm{PFR} = \int_0^{X_A}\frac{F_{A,f}}{r \, (X_A)}dX_A\]</div>
<p>So, graphing our “LEV” function vs. fractional conversion for a first order reaction gives us our “Levenspiel Plot” for this case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XAset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">LEV</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Levenspiel Plots for a first order reaction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;FAf/r (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;XA&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L20_22_0.png" src="../_images/587-L20_22_0.png" />
</div>
</div>
<p>We’ll add a bit of detail to that plot.  Specifically, we’ll add a vertical line at XA = 0.9, and we’ll add a horizontal line at the corresponding value of FAf/r.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XAset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">LEV</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">LEV</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;CSTR volume given by red box&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">11.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Levenspiel Plots for a first order reaction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;FAf/r (L)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;XA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L20_24_0.png" src="../_images/587-L20_24_0.png" />
</div>
</div>
<p>The volume of the CSTR is given by the product of FAf/r and XA at the exit.  Here, we see those numbers are 10L and 0.9.  Multiply them together, and we get the CSTR volume is 9.0L just as we did in the analytical solution.</p>
<p>In contrast, if we wanted to get the PFR volume, we’d need to take the integral of FAf/r from XA = 0 to XA = 0.9, i.e., we would have to find the area under the curve shown in the figure above.  We’ll add that illustration to show the PFR volume on the Levenspiel plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">order</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">XAset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">XAPFR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">LEV</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">order</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">XAPFR</span><span class="p">,</span> <span class="n">LEV</span><span class="p">(</span><span class="n">XAPFR</span><span class="p">,</span> <span class="n">order</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">LEV</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">order</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">LEV</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">order</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;CSTR volume given by red box&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">11.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;PFR volume given by shaded area&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Levenspiel Plots for a </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1"> order reaction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;FAf/r (L)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;XA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">LEV</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">order</span><span class="p">))))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L20_26_0.png" src="../_images/587-L20_26_0.png" />
</div>
</div>
<p>There are a lot of ways to do the integral, but since we have a function for the Levenspiel plot, using quadrature to integrate it is straightforward.  See below — we find that it is 2.3 liters just like in the solution above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrand</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">LEV</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">VPFR_quad</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quadrature</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>
<span class="n">VPFR_quad</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.3025850836843293
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">order</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">XAset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">LEV</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">order</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">LEV</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">order</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">LEV</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">order</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">LEV</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">order</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="c1">#plt.annotate(&#39;CSTR volume given by red box&#39;, (0.2, 11.5))</span>
<span class="c1">#plt.annotate(&#39;PFR volume given by shaded area&#39;, (0.35, 0.5))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Levenspiel Plots for a </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1"> order reaction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;FAf/r (L)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;XA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">LEV</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">order</span><span class="p">))))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L20_29_0.png" src="../_images/587-L20_29_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">order</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">XAset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">LEV</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">order</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">LEV</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">order</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">LEV</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">order</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">LEV</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">order</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">#plt.annotate(&#39;CSTR volume given by red box&#39;, (0.2, 11.5))</span>
<span class="c1">#plt.annotate(&#39;PFR volume given by shaded area&#39;, (0.35, 0.5))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Levenspiel Plots for a </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1"> order reaction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;FAf/r (L)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;XA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">LEV</span><span class="p">(</span><span class="n">XAset</span><span class="p">,</span> <span class="n">order</span><span class="p">))))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/587-L20_30_0.png" src="../_images/587-L20_30_0.png" />
</div>
</div>
<p>The <strong>reason</strong> that we observe these differences has to do with the fundamental difference in the way that PFRs and CSTRs and CSTRs operate. With a PFR, the conversion (and concentration) change gradually as we go from the inlet of the reactor to the exit of the reactor.  The PFR begins operation at a very high concentration of A at the inlet, and it gradually approaches a low concentration of A at the exit.  So the rate of reaction incrementally changes down the length of the PFR.</p>
<p>For a positive order reaction, the rate <em>decreases</em> down the length of the PFR.  For a zero order reaction, the rate is <em>constant</em> down the length of the PFR. For a negative order reaction, the rate <em>increases</em> down the length of the PFR.  In all cases, we have to average these effects by integrating with respect to the differential changes in volume that occur as we move from one axial slice to the next down the length of the PFR.</p>
<p>A CSTR is the exact opposite.  As soon as the feed enters the CSTR, it is instantly mixed, and the inside of the CSTR all exists as the same conditions as at the CSTR exit.  So whatever the exit concentration is, that is the concentration inside the CSTR. As a result, the CSTR always operates at the lowest possible value of concentration for the specified level of conversion.  In other words, it operates entirely at the conversion we have specified for the system.  For a positive order reaction, this means that the rate is at the minimum possible value (lowest CA).  For a zero order reaction, the rate is independent of conversion/concentration, so operating at a conversion of 90% gives you the same rate you’d see at a conversion of 0%.  For negative order reaction, rate increases with conversion, so the CSTR operates at minimum concentration of A, which gives a maximum reaction rate!</p>
<p>For a positive order reaction, on average, the PFR will always have the higher rate across the reactor volume–it starts at a high rate and finishes at the minimum rate.  The CSTR operates entirely at the minimum rate, so it’s average reaction rate is always lower for a positive order reaction.  The converse is true for a negative order reaction–the rate will gradually increase down the length of the PFR, whereas the CSTR operates entirely at the exit conversion and thus the maximum rate.  For a zero order reaction, rate is independent of conversion, and PFRs and CSTRs will have the same average rate.</p>
<p>Since the size of a system is determined by the ratio of the “stuff” that gets converted to the rate at which it gets converted, it is easy to predict PFR and CSTR sizing trends once we grasp the above concepts.  PFRs will always be smaller for positive order reactions because, on average, they have a higher reaction rate than a CSTR achieving the same conversion.  In contrast, for negative order reactions, PFRs will always be larger because, on average, they have a lower reaction rate than a CSTR achieving the same conversion.  For zero order reactions, they will be the exact same size because the rates are equal in the two systems.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="587-L19.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Material Balances X</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="587-L21.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Material Balances XII</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Jesse Q. Bond, Syracuse University<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>