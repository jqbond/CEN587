
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Material Balances XVIII &#8212; Kinetics and Reaction Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Notebooks/587-N36';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Lectures" href="../Chapter2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/JQB.png" class="logo__image only-light" alt="Kinetics and Reaction Engineering - Home"/>
    <script>document.write(`<img src="../_static/JQB.png" class="logo__image only-dark" alt="Kinetics and Reaction Engineering - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../Chapter2.html">Lectures</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Material Balances XVIII</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jqbond/CEN587/main?urlpath=tree/Notebooks/587-N36.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jqbond/CEN587" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jqbond/CEN587/issues/new?title=Issue%20on%20page%20%2FNotebooks/587-N36.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Notebooks/587-N36.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Material Balances XVIII</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-working-with-equilibrium-constraints-in-propane-dehydrogenation">Recap: Working with Equilibrium Constraints in Propane Dehydrogenation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-01">Example Problem 01</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-review-of-the-pfr-balance">A Review of the PFR Balance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-the-pfr-balance-to-model-a-membrane-reactor">Modifying the PFR balance to model a membrane reactor</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#units-in-the-membrane-reactor-balance">Units in the Membrane Reactor Balance</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-steady-state-balance-on-a-well-mixed-volume-element-in-a-membrane-reactor">The steady state balance on a well-mixed volume element in a membrane reactor</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-the-diffusion-rate">Defining the diffusion rate</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-01">Solution to Example Problem 01</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-02">Example Problem 02</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-02">Solution to Example Problem 02</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-03">Example Problem 03</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-03">Solution to Example Problem 03</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="material-balances-xviii">
<h1>Material Balances XVIII<a class="headerlink" href="#material-balances-xviii" title="Link to this heading">#</a></h1>
<p>This Notebook considers design of and applications for membrane reactors. It specifically considers the use of a membrane reactor to mitigate the challenging equilibrium limitation in propane dehydrogenation. Previously, we considered how one might use product separation and reactant recycle to achieve high overall conversions. Membrane reactors are an alternative strategy for product removal to drive high conversions of propane despite unfavorable thermodyanmics. This Notebook also introduces the Ergun Equation for calculating pressure differentials across packed bed reactors.</p>
<section id="recap-working-with-equilibrium-constraints-in-propane-dehydrogenation">
<h2>Recap: Working with Equilibrium Constraints in Propane Dehydrogenation<a class="headerlink" href="#recap-working-with-equilibrium-constraints-in-propane-dehydrogenation" title="Link to this heading">#</a></h2>
<p>In the last few Notebooks (<a class="reference external" href="https://jqbond.github.io/CEN587/Notebooks/587-N33.html">Notebook 33</a>, <a class="reference external" href="https://jqbond.github.io/CEN587/Notebooks/587-N34.html">Notebook 34</a>, and <a class="reference external" href="https://jqbond.github.io/CEN587/Notebooks/587-N35.html">Notebook 35</a>), we have considered in detail the impact of equilibrium limitations for a thermodynamically unfavorable reaction like propane dehydrogenation at 500K. To this point, we have considered:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://jqbond.github.io/CEN587/Notebooks/587-N33.html#example-problem-03">Decreasing pressure and adding a diluent to allow high single pass conversions</a>. This will work, but it requires a very large reactor <span class="math notranslate nohighlight">\((V \approx 30,000\mathrm{L})\)</span>.</p></li>
<li><p><a class="reference external" href="https://jqbond.github.io/CEN587/Notebooks/587-N34.html#example-problem-01">Adding a separator, splitter, and mixer and operating the PFR with recycle</a>. This will allow us to operate the PFR at relatively low single pass conversions, giving a relatively small reactor <span class="math notranslate nohighlight">\((V \approx 250L)\)</span>, but we have to invest in separations and recycle, which will add considerable to captial and operating costs.</p></li>
</ol>
<p>Now, we’ll consider the use of a membrane reactor for propane dehydrogenation. Membrane reactors can be useful for reactions where selectivity control is challenging, and they can also help to mitigate equilibrium constraints if we design them for product removal. This is the strategy that we will use for propane dehydrogenation in this Notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">opt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">interp1d</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-problem-01">
<h2>Example Problem 01<a class="headerlink" href="#example-problem-01" title="Link to this heading">#</a></h2>
<p>We will carry out propane dehydrogenation in a membrane reactor. Specifically we will design our reactor such that there is an internal tube into which we feed pure propane at <span class="math notranslate nohighlight">\(P = 8.2 \ \mathrm{atm}\)</span> and a flowrate of <span class="math notranslate nohighlight">\(F_{A0} = 10 \ \mathrm{mol \ min^{-1}}\)</span>. This internal tube is surrounded by an external tube into which we feed pure <span class="math notranslate nohighlight">\(N_2\)</span> at 1 atm and a very high flowrate. A key detail about this membrane reactor is that the wall of the inner tube is made from a special, porous membrane that allows <span class="math notranslate nohighlight">\(H_2\)</span> diffusion across the membrane (out of the inner tube), but will not allow diffusion of any other component. In this configuration, the pressure of <span class="math notranslate nohighlight">\(H_2\)</span> inside of the inner reactor is always higher than the pressure of <span class="math notranslate nohighlight">\(H_2\)</span> in the annulus, so <span class="math notranslate nohighlight">\(H_2\)</span> will diffuse out of the reactor and into the annulus, where it is rapidly diluted by <span class="math notranslate nohighlight">\(N_2\)</span>. Because we are using a very high <span class="math notranslate nohighlight">\(N_2\)</span> flowrate in the annulus, we can assume that the concentration (partial pressure) of <span class="math notranslate nohighlight">\(H_2\)</span> in the annulus is always approximately zero, even though <span class="math notranslate nohighlight">\(H_2\)</span> is continuously diffusing out of the reactor and into the annulus.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Since we’re removing a product <span class="math notranslate nohighlight">\((H_2)\)</span>, we do not need to feed a diluent or reduce pressure to achieve the desired 95% conversion of propane in a single pass!</p>
</div>
<p>Rate and equilibrium constants remain the same because we haven’t changed the temperature. We are additionally given a lumped mass transfer coefficient that describes the rate of <span class="math notranslate nohighlight">\(H_2\)</span> diffusion across the membrane.</p>
<div class="amsmath math notranslate nohighlight" id="equation-6096bf4d-1851-460c-9052-50450fff389f">
<span class="eqno">(1)<a class="headerlink" href="#equation-6096bf4d-1851-460c-9052-50450fff389f" title="Permalink to this equation">#</a></span>\[\begin{align}
    k_f  &amp;= 0.7  \ \textrm{min}^{-1} \\
    K_C &amp;= 0.05 \ \textrm{mol} \ \textrm{L}^{-1}\\
    k_{C_C}a &amp;= 0.2 \ \textrm{min}^{-1}				
\end{align}			\]</div>
<p>How large does this membrane reactor need to be to achieve 95% conversion of propane?</p>
<section id="a-review-of-the-pfr-balance">
<h3>A Review of the PFR Balance<a class="headerlink" href="#a-review-of-the-pfr-balance" title="Link to this heading">#</a></h3>
<p>Recall from <a class="reference external" href="https://jqbond.github.io/CEN587/Notebooks/587-N15.html">Notebook 15</a> how we originally developed the PFR balance by considering a single cross sectional element with a volume of <span class="math notranslate nohighlight">\(\Delta V\)</span>. In the case of a PFR, we assume that inside of that cross section has a uniform Temperature, Pressure, Composition (and therefore reaction rate). So, within that uniform cross section, the rate of generation or consumption by chemical reaction, <span class="math notranslate nohighlight">\(G_j\)</span>, is given by:</p>
<div class="math notranslate nohighlight">
\[G_j = R_j\Delta V\]</div>
<p>If the PFR is operating at steady state, we can write a balance on that well-mixed cross section:</p>
<div class="math notranslate nohighlight">
\[ 0 = F_j\big|_V - F_j\big|_{V+\Delta V} + R_j \Delta V\]</div>
<p>Next, we divide the whole equation by <span class="math notranslate nohighlight">\(\Delta V\)</span>:</p>
<div class="math notranslate nohighlight">
\[ 0 = \frac{F_j\big|_V - F_j\big|_{V+\Delta V}}{\Delta V} + R_j\]</div>
<p>We next assume that the PFR is comprised of an an infinite number of cross sections, which means that the volume of each cross section approaches zero, i.e., <span class="math notranslate nohighlight">\(\Delta V \longrightarrow 0\)</span>.  This is essentially the definition of a derivative, which gives:</p>
<div class="math notranslate nohighlight">
\[ 0 = -\frac{dF_j}{dV} + R_j\]</div>
<p>In PFR analysis, we typically rearrange this equation to get:</p>
<div class="math notranslate nohighlight">
\[\frac{dF_j}{dV} = R_j\]</div>
</section>
<section id="modifying-the-pfr-balance-to-model-a-membrane-reactor">
<h3>Modifying the PFR balance to model a membrane reactor<a class="headerlink" href="#modifying-the-pfr-balance-to-model-a-membrane-reactor" title="Link to this heading">#</a></h3>
<p>When we have a membrane reactor, we modify the PFR balance slightly to allow that species <span class="math notranslate nohighlight">\(j\)</span> can diffuse into or out of the well-mixed volume element, <span class="math notranslate nohighlight">\(\Delta V\)</span>.  We define the rate of diffusion across the membrane <em><strong>per unit volume of reactor</strong></em> as:</p>
<div class="math notranslate nohighlight">
\[\bar{R}_j = W_j \, a\]</div>
<p>Here, <span class="math notranslate nohighlight">\(W_j\)</span> is the flux of species <span class="math notranslate nohighlight">\(j\)</span> across the membrane and <span class="math notranslate nohighlight">\(a\)</span> is the ratio of surface area to volume for that membrane.</p>
<section id="units-in-the-membrane-reactor-balance">
<h4>Units in the Membrane Reactor Balance<a class="headerlink" href="#units-in-the-membrane-reactor-balance" title="Link to this heading">#</a></h4>
<p>We need to discuss dimensions.  <span class="math notranslate nohighlight">\(\bar{R_j}\)</span> will have the same units as our intensive reaction rates, <span class="math notranslate nohighlight">\(r_i\)</span> and our intensive species production rates, <span class="math notranslate nohighlight">\(R_j\)</span>.  For example:</p>
<div class="math notranslate nohighlight">
\[\bar{R}_j \ [=]\ \mathrm{\frac{mol}{m^3 \, s}}\]</div>
<p>We recall from heat and mass transfer that fluxes have units of moles per area per time; for example:</p>
<div class="math notranslate nohighlight">
\[W_j \ [=] \ \mathrm{\frac{mol}{m^2 \, s}}\]</div>
<p>And the surface area to volume ratio, <span class="math notranslate nohighlight">\(a\)</span> will have units of area per volume, which reduces to inverse length, for example:</p>
<div class="math notranslate nohighlight">
\[a = \mathrm{\frac{Area}{Volume}} \ [=] \ \frac{m^2}{m^3} \ [=] \ \frac{1}{m}\]</div>
<p>With these definitions and unit conventions in mind, we see that the product of <span class="math notranslate nohighlight">\(W_j a\)</span> gives the correct units on <span class="math notranslate nohighlight">\(\bar{R}_j\)</span>:</p>
<div class="math notranslate nohighlight">
\[\bar{R}_j = W_j \, a \ [=] \ \mathrm{\frac{mol}{m^2 \, s}} \ \frac{1}{m} \ [=] \ \mathrm{\frac{mol}{m^3 \, s}}\]</div>
</section>
<section id="the-steady-state-balance-on-a-well-mixed-volume-element-in-a-membrane-reactor">
<h4>The steady state balance on a well-mixed volume element in a membrane reactor<a class="headerlink" href="#the-steady-state-balance-on-a-well-mixed-volume-element-in-a-membrane-reactor" title="Link to this heading">#</a></h4>
<p>With the above in mind, we can write the following balance to describe flow in, flow out, and reaction into the well-mixed volume element, <span class="math notranslate nohighlight">\(\Delta V\)</span>:</p>
<div class="math notranslate nohighlight">
\[ 0 = F_j\big|_V - F_j\big|_{V+\Delta V} + R_j \Delta V + \bar{R}_j \Delta V\]</div>
<p>Dividing the equation through by <span class="math notranslate nohighlight">\(\Delta V\)</span> and allowing <span class="math notranslate nohighlight">\(\Delta V \rightarrow \infty\)</span> gives the membrane reactor balance:</p>
<div class="math notranslate nohighlight">
\[\frac{dF_j}{dV} = R_j + \bar{R}_j\]</div>
</section>
<section id="defining-the-diffusion-rate">
<h4>Defining the diffusion rate<a class="headerlink" href="#defining-the-diffusion-rate" title="Link to this heading">#</a></h4>
<p>Now that we have a general balance, the only thing that remains is to express the diffusion rate in terms of species concentrations (or partial pressures) similar to the way we have always expressed intensive production rates in terms of species concentrations (or partial pressures). From our courses in heat and mass transer, we can recall that flux across a boundary can be calculated as:</p>
<div class="math notranslate nohighlight">
\[W_j = k_{C_j}(C_{j_s} - C_j)\]</div>
<p>In the context of the membrane reactor, consistent with sign conventions on flowrates and production rates, we define flux <em><strong>into the reactor</strong></em> as positive and <em><strong>out of the reactor</strong></em> as negative. <span class="math notranslate nohighlight">\(k_{C_j}\)</span> is a mass transfer coefficient for species <span class="math notranslate nohighlight">\(j\)</span>; <span class="math notranslate nohighlight">\(C_{j_s}\)</span> is the concentration of species <span class="math notranslate nohighlight">\(j\)</span> in the annular <em><strong>space</strong></em> surrounding the inner reactor tube, and <span class="math notranslate nohighlight">\(C_j\)</span> is the concentration of species <span class="math notranslate nohighlight">\(j\)</span> inside of the reactor. We can see that in cases where <span class="math notranslate nohighlight">\(C_j &gt; C_{j_s}\)</span>, diffusion will occur from the reactor to the annulus and have a negative sign. Mass transfer coefficients always have units of length-per-time, thus the product of <span class="math notranslate nohighlight">\(k_{C_j}\)</span> and concentration gives a flux in the correct units of moles per area per time.</p>
<p>For a cylinder such as this membrane reactor, the ratio of area to volume is:</p>
<div class="math notranslate nohighlight">
\[a = \frac{2 \pi r L}{\pi r^2 L} = \frac{2}{r}\]</div>
<p>Ultimately, we can define the rate of diffusion across the membrane as:</p>
<div class="math notranslate nohighlight">
\[\bar{R}_j = k_{C_j}a(C_{j_s} - C_j)\]</div>
<p>And we note that the product <span class="math notranslate nohighlight">\(k_{C_j}a\)</span> is frequently lumped and given in problem statements (such as this one).</p>
</section>
</section>
<section id="solution-to-example-problem-01">
<h3>Solution to Example Problem 01<a class="headerlink" href="#solution-to-example-problem-01" title="Link to this heading">#</a></h3>
<p>With the above derivations for membrane reactor balances in mind, we can write material balances for all 3 species in this reactor:</p>
<div class="amsmath math notranslate nohighlight" id="equation-eef89389-105d-4e29-ac6f-3ed6d8eb63b8">
<span class="eqno">(2)<a class="headerlink" href="#equation-eef89389-105d-4e29-ac6f-3ed6d8eb63b8" title="Permalink to this equation">#</a></span>\[\begin{align}
    \frac{dF_A}{dV} &amp;= R_A \\
    \frac{dF_B}{dV} &amp;= R_B \\
    \frac{dF_C}{dV} &amp;= R_C + \bar{R}_C\\
\end{align}\]</div>
<p>Next, we begin the usual steps of defining the right hand side of each ODE in terms of constants, state variables, and the independent variable (V):</p>
<div class="amsmath math notranslate nohighlight" id="equation-da0cc9e6-26d5-447b-919a-224607e0344b">
<span class="eqno">(3)<a class="headerlink" href="#equation-da0cc9e6-26d5-447b-919a-224607e0344b" title="Permalink to this equation">#</a></span>\[\begin{align}
    R_A &amp;= -r \\
    R_B &amp;=  r \\
    R_C &amp;=  r 
\end{align}\]</div>
<p>We know that this reaction has elementary kinetics so:</p>
<div class="math notranslate nohighlight">
\[r = k_fC_A - k_rC_BC_C\]</div>
<p>Concentrations can be defined in terms of flowrates:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ca89eba3-6373-4b14-9f64-54ec3c3286cb">
<span class="eqno">(4)<a class="headerlink" href="#equation-ca89eba3-6373-4b14-9f64-54ec3c3286cb" title="Permalink to this equation">#</a></span>\[\begin{align}
    C_A &amp;= F_A/Q \\
    C_B &amp;= F_B/Q \\
    C_C &amp;= F_C/Q 
\end{align}\]</div>
<p>Where:</p>
<div class="math notranslate nohighlight">
\[Q = \frac{F_T R T}{P}\]</div>
<p>And:</p>
<div class="math notranslate nohighlight">
\[F_T = F_A + F_B + F_C\]</div>
<p>Finally:</p>
<div class="math notranslate nohighlight">
\[\bar{R}_j = k_{C_C}a(C_{C_s} - C_C)\]</div>
<p>The lumped mass transfer coefficient/area product is given in the problem statement, and we can assume that the concentration of C in the annular space is zero due to the large excess of <span class="math notranslate nohighlight">\(N_2\)</span> in the annulus.  With that, we can solve the problem using <code class="docutils literal notranslate"><span class="pre">solve_ivp()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#############################################################################</span>
<span class="c1"># Defining global constants for Example Problem 01                          #</span>
<span class="c1">#############################################################################</span>

<span class="n">kf</span>  <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1">#1/min</span>
<span class="n">KC</span>  <span class="o">=</span> <span class="mf">0.05</span> <span class="c1">#mol/L</span>
<span class="n">kr</span>  <span class="o">=</span> <span class="n">kf</span><span class="o">/</span><span class="n">KC</span> <span class="c1">#L/mol/min</span>
<span class="n">kca</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1">#1/min</span>
<span class="n">CCs</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">T</span>   <span class="o">=</span> <span class="mi">500</span> <span class="c1">#K</span>
<span class="n">P</span>   <span class="o">=</span> <span class="mf">8.2</span> <span class="c1">#atm</span>
<span class="n">R</span>   <span class="o">=</span> <span class="mf">0.08206</span> <span class="c1">#L*atm/mol/K</span>
<span class="n">FA0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1">#mol/min</span>
<span class="n">FB0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">FC0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">XA_target</span> <span class="o">=</span> <span class="mf">0.95</span>

<span class="c1">#############################################################################</span>
<span class="c1"># Define the system of ODEs that describe this membrane reactor             #</span>
<span class="c1"># Function has the form f(V, [FA, FB, FC])                                  #</span>
<span class="c1"># It returns [dFAdV, dFBdV, dFCdV]                                          #</span>
<span class="c1">#############################################################################</span>

<span class="k">def</span><span class="w"> </span><span class="nf">P01</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
    <span class="n">FA</span><span class="p">,</span> <span class="n">FB</span><span class="p">,</span> <span class="n">FC</span> <span class="o">=</span> <span class="n">var</span>   
    <span class="n">FT</span> <span class="o">=</span> <span class="n">FA</span> <span class="o">+</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">FC</span>
    <span class="n">Q</span>  <span class="o">=</span> <span class="n">FT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>
    <span class="n">CA</span> <span class="o">=</span> <span class="n">FA</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CB</span> <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CC</span> <span class="o">=</span> <span class="n">FC</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">r</span>  <span class="o">=</span> <span class="n">kf</span><span class="o">*</span><span class="n">CA</span> <span class="o">-</span> <span class="n">kr</span><span class="o">*</span><span class="n">CB</span><span class="o">*</span><span class="n">CC</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span>
    <span class="n">RB</span> <span class="o">=</span>  <span class="n">r</span>
    <span class="n">RC</span> <span class="o">=</span>  <span class="n">r</span>
    <span class="n">RCbar</span> <span class="o">=</span> <span class="n">kca</span><span class="o">*</span><span class="p">(</span><span class="n">CCs</span> <span class="o">-</span> <span class="n">CC</span><span class="p">)</span>
    <span class="n">dA</span> <span class="o">=</span> <span class="n">RA</span>
    <span class="n">dB</span> <span class="o">=</span> <span class="n">RB</span>
    <span class="n">dC</span> <span class="o">=</span> <span class="n">RC</span> <span class="o">+</span> <span class="n">RCbar</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dA</span><span class="p">,</span> <span class="n">dB</span><span class="p">,</span> <span class="n">dC</span><span class="p">]</span>

<span class="c1">#############################################################################</span>
<span class="c1"># Set integration span and initial state of the system                      #</span>
<span class="c1">#############################################################################</span>

<span class="c1"># Vspan = (0.0, 100.0)</span>
<span class="n">Vspan</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5000.0</span><span class="p">)</span>
<span class="n">var0</span>  <span class="o">=</span> <span class="p">(</span><span class="n">FA0</span><span class="p">,</span> <span class="n">FB0</span><span class="p">,</span> <span class="n">FC0</span><span class="p">)</span>
<span class="n">ans2</span>  <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">P01</span><span class="p">,</span> <span class="n">Vspan</span><span class="p">,</span> <span class="n">var0</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span>  <span class="mf">1e-8</span><span class="p">)</span>

<span class="c1">#############################################################################</span>
<span class="c1"># Extract flowrate information from the solution structure                  #</span>
<span class="c1">#############################################################################</span>

<span class="n">V</span>     <span class="o">=</span> <span class="n">ans2</span><span class="o">.</span><span class="n">t</span>
<span class="n">FA</span>    <span class="o">=</span> <span class="n">ans2</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">FB</span>    <span class="o">=</span> <span class="n">ans2</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">FC</span>    <span class="o">=</span> <span class="n">ans2</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="c1">#############################################################################</span>
<span class="c1"># Calculate fractional conversion of propane                                #</span>
<span class="c1">#############################################################################</span>

<span class="n">XA</span>    <span class="o">=</span> <span class="p">(</span><span class="n">FA0</span> <span class="o">-</span> <span class="n">FA</span><span class="p">)</span><span class="o">/</span><span class="n">FA0</span>

<span class="c1">#############################################################################</span>
<span class="c1"># Construct interpolating polynomial approximation for V(XA); find V(0.95)  #</span>
<span class="c1">#############################################################################</span>

<span class="n">itp1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">XA</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="n">Vopt</span> <span class="o">=</span> <span class="n">itp1</span><span class="p">(</span><span class="n">XA_target</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The Membrane Reactor Volume required for XA = </span><span class="si">{</span><span class="n">XA_target</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1"> is </span><span class="si">{</span><span class="n">Vopt</span><span class="si">:</span><span class="s1">0.0f</span><span class="si">}</span><span class="s1">L&#39;</span><span class="p">)</span>

<span class="c1">#############################################################################</span>
<span class="c1"># Graph propane conversion vs. membrane reactor volume                      #</span>
<span class="c1">#############################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">XA</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">Vspan</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Conversion of A&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The Membrane Reactor Volume required for XA = 0.95 is 3054L
</pre></div>
</div>
<img alt="../_images/051c30948954870e83f4f71a50c0aa2efdc3e579d9ca1d324432ff205c197779.png" src="../_images/051c30948954870e83f4f71a50c0aa2efdc3e579d9ca1d324432ff205c197779.png" />
</div>
</div>
</section>
</section>
<section id="example-problem-02">
<h2>Example Problem 02<a class="headerlink" href="#example-problem-02" title="Link to this heading">#</a></h2>
<p>Now let’s consider packed bed reactor performance.  For this problem, we’ll carry out ethylene hydrogenation (reaction 1). A side reaction, ethylene dimerization (reaction 2) also occurs under these conditions. Overall reactions for each are given below.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    C_2H_4 + H_2 &amp;\longrightarrow C_2H_6 \\
    2C_2H_4 &amp;\longrightarrow C_4H_8			
\end{align*}			\]</div>
<p>Both reactions occur in the gas phase, and each has an elementary rate law. Additional parameters and operating conditions are specified below.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    k_1  &amp;= 10 \ \textrm{L}^{2} \ \textrm{mol}^{-1} \ \textrm{kg}^{-1} \ \textrm{sec}^{-1} \\
    k_2  &amp;= 1 \ \textrm{L}^{2} \ \textrm{mol}^{-1} \ \textrm{kg}^{-1} \ \textrm{sec}^{-1} \\
    F_{A_f} &amp;= 100 \ \textrm{mol} \ \textrm{sec}^{-1} \\				
    F_{B_f} &amp;= 100 \ \textrm{mol} \ \textrm{sec}^{-1} \\
    T &amp;= 573 \ \textrm{K} \\
    P &amp;= 10 \ \textrm{bar}
\end{align*}			\]</div>
<p>If the reactor operates isobarically, calculate the mass of catalyst required to achieve an ethylene conversion of 70%.</p>
<section id="solution-to-example-problem-02">
<h3>Solution to Example Problem 02<a class="headerlink" href="#solution-to-example-problem-02" title="Link to this heading">#</a></h3>
<p>We start by writing material balances on each species. Recall that in a packed bed, our independent variable is catalyst mass, <span class="math notranslate nohighlight">\(W\)</span>, and we report reaction rates per unit mass of catalyst, <span class="math notranslate nohighlight">\(r^\prime\)</span>.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \frac{dF_A}{dW} &amp;= {R_A}^\prime \\
    \frac{dF_B}{dW} &amp;= {R_B}^\prime \\
    \frac{dF_C}{dW} &amp;= {R_C}^\prime \\
    \frac{dF_D}{dW} &amp;= {R_D}^\prime \\
\end{align*}\]</div>
<p>Where the prime (<span class="math notranslate nohighlight">\(^\prime\)</span>) superscript just means that intensive rates are specified per unit mass of catalyst.  Otherwise, intensive production rates are defined as usual.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    {R_A}^\prime &amp;= -{r_1}^{\prime} -2{r_2}^{\prime} \\
    {R_B}^\prime &amp;= -{r_1}^{\prime} \\
    {R_C}^\prime &amp;= {r_1}^{\prime} \\
    {R_D}^\prime &amp;= {r_2}^{\prime} \\
\end{align*}\]</div>
<p>These reactions have elementary kinetics, so:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    {r_1}^{\prime} &amp;= k_1C_AC_B \\
    {r_2}^{\prime} &amp;= k_2C_A^2 \\
\end{align*}\]</div>
<p>We define concentrations in terms of flowrates (dependent variables) as usual; technically, we only need concentrations for <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> to evaluate the rate expressions.:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    C_A &amp;= F_A/Q \\
    C_B &amp;= F_B/Q \\
\end{align*}\]</div>
<p>Since this is a gas-phase reaction at modest pressure (and we don’t have a better equation of state on hand), we will define <span class="math notranslate nohighlight">\(Q\)</span> using the ideal gas law:</p>
<div class="math notranslate nohighlight">
\[Q = \frac{F_TRT}{P}\]</div>
<p>We know the reactor is isobaric, so the pressure in this reactor is always equal to 10 bar. At this point, everything on the right-hand side of our ODEs is defined in terms of constants and our state variables, so we can solve with <code class="docutils literal notranslate"><span class="pre">solve_ivp()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################################</span>
<span class="c1"># Defining global constants for Example Problem 02                #</span>
<span class="c1">###################################################################</span>

<span class="n">FAf</span> <span class="o">=</span> <span class="mi">100</span>        <span class="c1">#mol/s</span>
<span class="n">FBf</span> <span class="o">=</span> <span class="mi">100</span>        <span class="c1">#mol/s</span>
<span class="n">FCf</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c1">#mol/s</span>
<span class="n">FDf</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c1">#mol/s</span>
<span class="n">P</span>   <span class="o">=</span> <span class="mf">1.0e6</span>      <span class="c1">#Pa, 10 bar</span>
<span class="n">R</span>   <span class="o">=</span> <span class="mi">8314</span>       <span class="c1">#L*Pa/mol/K</span>
<span class="n">T</span>   <span class="o">=</span> <span class="mi">573</span>        <span class="c1">#K</span>
<span class="n">k1</span>  <span class="o">=</span> <span class="mi">10</span>         <span class="c1">#L^2/mol/kg/sec</span>
<span class="n">k2</span>  <span class="o">=</span> <span class="mi">1</span>          <span class="c1">#L^2/mol/kg/sec</span>
<span class="n">XA_target</span> <span class="o">=</span> <span class="mf">0.7</span>

<span class="c1">###################################################################</span>
<span class="c1"># Define ODE system that describes the packed bed                 #</span>
<span class="c1"># function has the form f(W, [FA, FB, FC, FD])                    #</span>
<span class="c1"># function returns [dFAdW, dFBdW, dFCdW, dFDdW]                   #</span>
<span class="c1">###################################################################</span>

<span class="k">def</span><span class="w"> </span><span class="nf">P02</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
    <span class="n">FA</span><span class="p">,</span> <span class="n">FB</span><span class="p">,</span> <span class="n">FC</span><span class="p">,</span> <span class="n">FD</span> <span class="o">=</span> <span class="n">var</span> <span class="c1">#all flowrates in mol/s</span>
    
    <span class="n">FT</span> <span class="o">=</span> <span class="n">FA</span> <span class="o">+</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">FC</span> <span class="o">+</span> <span class="n">FD</span>
    <span class="n">Q</span>  <span class="o">=</span> <span class="n">FT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>       <span class="c1">#vol flow rate, L/sec</span>
    <span class="n">CA</span> <span class="o">=</span> <span class="n">FA</span><span class="o">/</span><span class="n">Q</span>          <span class="c1">#Concentration of A, mol/L</span>
    <span class="n">CB</span> <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">Q</span>          <span class="c1">#Concentration of B, mol/L</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="n">k1</span><span class="o">*</span><span class="n">CA</span><span class="o">*</span><span class="n">CB</span>      <span class="c1">#Rate of reaction 1, mol/kg/sec</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">k2</span><span class="o">*</span><span class="n">CA</span><span class="o">**</span><span class="mi">2</span>      <span class="c1">#Rate of reaction 2, mol/kg/sec</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="o">-</span><span class="n">r1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">r2</span>
    <span class="n">RB</span> <span class="o">=</span> <span class="o">-</span><span class="n">r1</span>
    <span class="n">RC</span> <span class="o">=</span>  <span class="n">r1</span>
    <span class="n">RD</span> <span class="o">=</span>  <span class="n">r2</span>
    
    <span class="n">dFAdW</span> <span class="o">=</span> <span class="n">RA</span>
    <span class="n">dFBdW</span> <span class="o">=</span> <span class="n">RB</span>
    <span class="n">dFCdW</span> <span class="o">=</span> <span class="n">RC</span>
    <span class="n">dFDdW</span> <span class="o">=</span> <span class="n">RD</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dFAdW</span><span class="p">,</span> <span class="n">dFBdW</span><span class="p">,</span> <span class="n">dFCdW</span><span class="p">,</span> <span class="n">dFDdW</span><span class="p">]</span>

<span class="c1">####################################################################</span>
<span class="c1"># Define integration span and initial system state                 #</span>
<span class="c1">####################################################################</span>

<span class="n">wspan</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2500</span><span class="p">)</span>
<span class="n">var0</span> <span class="o">=</span> <span class="p">(</span><span class="n">FAf</span><span class="p">,</span> <span class="n">FBf</span><span class="p">,</span> <span class="n">FCf</span><span class="p">,</span> <span class="n">FDf</span><span class="p">)</span>

<span class="c1">####################################################################</span>
<span class="c1"># Integrate the ODE system using solve_ivp()                       #</span>
<span class="c1">####################################################################</span>

<span class="n">ans02</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">P02</span><span class="p">,</span> <span class="n">wspan</span><span class="p">,</span> <span class="n">var0</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">)</span>

<span class="c1">####################################################################</span>
<span class="c1"># Extract significant quantities from solution structure           #</span>
<span class="c1">####################################################################</span>

<span class="n">W</span>   <span class="o">=</span> <span class="n">ans02</span><span class="o">.</span><span class="n">t</span>
<span class="n">FA</span>  <span class="o">=</span> <span class="n">ans02</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">####################################################################</span>
<span class="c1"># Calculate fractional conversion of ethane                        #</span>
<span class="c1">####################################################################</span>

<span class="n">XA</span>  <span class="o">=</span> <span class="p">(</span><span class="n">FAf</span> <span class="o">-</span> <span class="n">FA</span><span class="p">)</span><span class="o">/</span><span class="n">FAf</span>

<span class="c1">####################################################################</span>
<span class="c1"># Construct an interpolating polynomial approximation for W(XA)    #</span>
<span class="c1"># find W(0.7)                                                      #</span>
<span class="c1">####################################################################</span>

<span class="n">itp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">XA</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The mass of catalyst required to achieve XA = </span><span class="si">{</span><span class="n">XA_target</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1"> is W = </span><span class="si">{</span><span class="n">itp</span><span class="p">(</span><span class="n">XA_target</span><span class="p">)</span><span class="si">:</span><span class="s1">0.0f</span><span class="si">}</span><span class="s1"> kg&#39;</span><span class="p">)</span> 

<span class="c1">####################################################################</span>
<span class="c1"># Graph XA vs. W                                                   #</span>
<span class="c1">####################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">XA</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">wspan</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Catalys Mass (kg)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Conversion of A&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The mass of catalyst required to achieve XA = 0.70 is W = 957 kg
</pre></div>
</div>
<img alt="../_images/4de5a5ddc53ef4c02fdc22616c7a254ff588886e5e7e7d56b8cfd631982dffca.png" src="../_images/4de5a5ddc53ef4c02fdc22616c7a254ff588886e5e7e7d56b8cfd631982dffca.png" />
</div>
</div>
</section>
</section>
<section id="example-problem-03">
<h2>Example Problem 03<a class="headerlink" href="#example-problem-03" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example uses the approach and notation presented in <em>Elements of Chemical Reaction Engineering</em> by Scott Fogler.</p>
</div>
<p>The packed bed reactor described in Example Problem 02 above is no longer isobaric. Assume that the pressure gradient in the packed bed can be modeled using the Ergun equation.  For this example, we are given the lumped Ergun Equation parameter as:</p>
<div class="math notranslate nohighlight">
\[\frac{\beta}{A_c\rho_b} = 303.975 \ \textrm{Pa} \ \mathrm{kg^{-1}}\]</div>
<p>Calculate the mass of catalyst required to achieve an ethylene conversion of 70%.</p>
<section id="solution-to-example-problem-03">
<h3>Solution to Example Problem 03<a class="headerlink" href="#solution-to-example-problem-03" title="Link to this heading">#</a></h3>
<p>For this, we develop the material balances on all species as in Example 02, but we will hit a minor snag because the reactor isn’t isobaric.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \frac{dF_A}{dW} &amp;= {R_A}^\prime \\
    \frac{dF_B}{dW} &amp;= {R_B}^\prime \\
    \frac{dF_C}{dW} &amp;= {R_C}^\prime \\
    \frac{dF_D}{dW} &amp;= {R_D}^\prime \\
\end{align*}\]</div>
<p>Intensive production rates remain the same as in the prior example:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    {R_A}^\prime &amp;= -{r_1}^{\prime} -2{r_2}^{\prime} \\
    {R_B}^\prime &amp;= -{r_1}^{\prime} \\
    {R_C}^\prime &amp;= {r_1}^{\prime} \\
    {R_D}^\prime &amp;= {r_2}^{\prime} \\
\end{align*}\]</div>
<p>Reactions still have elementary kinetics, so the rate laws are the same as above:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    {r_1}^{\prime} &amp;= k_1C_AC_B \\
    {r_2}^{\prime} &amp;= k_2C_A^2 \\
\end{align*}\]</div>
<p>We still define concentrations in terms of flowrates:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    C_A &amp;= F_A/Q \\
    C_B &amp;= F_B/Q \\
\end{align*}\]</div>
<p>And we define <span class="math notranslate nohighlight">\(Q\)</span> using the ideal gas law:</p>
<div class="math notranslate nohighlight">
\[Q = \frac{F_TRT}{P}\]</div>
<p>Here, we find a complication because Pressure is changing as a function of catalyst mass as we move down the length of the reactor. We need some way to model this.  We will use the Ergun equation, which is commonly used to calculate the pressure drop across a packed bed. In its full glory, the Ergun equation looks like this:</p>
<div class="math notranslate nohighlight">
\[\frac{dP}{dz} = \Bigg[-\frac{G}{g_c D_p}\left(\frac{1 - \phi}{\phi^3}\right) \left(\frac{150(1-\phi)\mu}{D_p} + 1.75G\right)\Bigg]\frac{1}{\rho}\]</div>
<p>A couple of things to note.  First, that equation <em>looks</em> intimidating.  There are lots of parameters in it. Second, from a differential equations perspective, it tells us how pressure changes as a function of bed length, <span class="math notranslate nohighlight">\(z\)</span>. We’ll have to resolve these things before we can use it.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will not be that hard despite the complexity of the Ergun equation!</p>
</div>
<p>Since this is not a fluids, unit operations, or heterogeneous catalysis class, we aren’t especially concerned with what all of the parameters mean or how we might estimate their values.  Generally, they characterize the velocity and viscosity of the fluid phase; the solid particle size; and the amount of empty space in the bed. The good news for us is that all of the parameters inside of the brackets are determined at the inlet conditions or based on fixed properties of the catalyst bed. This means they do not vary as a function of position in the packed bed.  Practically speaking, then:</p>
<div class="math notranslate nohighlight">
\[\frac{dP}{dz} = -\left[\mathrm{constant}\right]\frac{1}{\rho}\]</div>
<p>The <span class="math notranslate nohighlight">\(\rho\)</span> here is gas density, which does change as a function of position in the catalyst bed.  At steady state, we can write the following total mass balance:</p>
<div class="math notranslate nohighlight">
\[0 = Q_f\rho_f - Q\rho\]</div>
<p>Where the subscript <span class="math notranslate nohighlight">\(f\)</span> designates feed conditions and the quantities without a subscript refer to a position in the bed.  With this established, we can express the position-dependent gas density, <span class="math notranslate nohighlight">\(\rho\)</span>, as:</p>
<div class="math notranslate nohighlight">
\[\rho = \frac{Q_f\rho_f}{Q}\]</div>
<p>This is convenient because we have already defined <span class="math notranslate nohighlight">\(Q\)</span> using the ideal gas law.  Substituting this definition into the Ergun Equation, we get:</p>
<div class="math notranslate nohighlight">
\[\frac{dP}{dz} = -\left[\frac{\mathrm{constant}}{\rho_f}\right]\frac{Q}{Q_f}\]</div>
<p>Everything in the brackets is a constant; we’ll call it <span class="math notranslate nohighlight">\(\beta\)</span>, which is the Fogler notation for this lumped parameter for the Ergun Equation.</p>
<div class="math notranslate nohighlight">
\[\frac{dP}{dz} = -\beta\frac{Q}{Q_f}\]</div>
<p>Next, we have to deal with the mismatch of independent variables (<span class="math notranslate nohighlight">\(z\)</span> vs <span class="math notranslate nohighlight">\(W\)</span>).  To do this, we first express the mass of catalyst in terms of the volume of catalyst and the density of the catalyst:</p>
<div class="math notranslate nohighlight">
\[W_{\mathrm{cat}} = V_{\mathrm{cat}} \rho_{\mathrm{cat}}\]</div>
<p>Now we need to relate that volume of the catalyst to the volume of the tube that contains the catalyst.  This is where the void fraction comes in. First, we establish that the bed is comprised of catalyst and void space:</p>
<div class="math notranslate nohighlight">
\[V_{\mathrm{tube}} = V_{\mathrm{cat}} + V_{\mathrm{void}}\]</div>
<p>Next, we define a void fraction:</p>
<div class="math notranslate nohighlight">
\[\phi = \frac{V_{\mathrm{void}}}{V_{\mathrm{tube}}}\]</div>
<p>By extension, the remainder of space must be occupied by catalyst:</p>
<div class="math notranslate nohighlight">
\[(1 - \phi) = \frac{V_{\mathrm{cat}}}{V_{\mathrm{tube}}}\]</div>
<p>Then:</p>
<div class="math notranslate nohighlight">
\[V_{\mathrm{cat}} = V_{\mathrm{tube}}(1 - \phi)\]</div>
<p>We know the geometric definition for the volume of a cylinder, i.e., <span class="math notranslate nohighlight">\(V = A_{xc}z\)</span>.  Then:</p>
<div class="math notranslate nohighlight">
\[V_{\mathrm{cat}} = A_{xc} z(1 - \phi)\]</div>
<p>It follows then that the mass of catalyst is given by:</p>
<div class="math notranslate nohighlight">
\[W_{\mathrm{cat}} = A_{xc} z(1 - \phi) \rho_{\mathrm{cat}}\]</div>
<p>In catalysis, we frequently define a “bed density” as follows:</p>
<div class="math notranslate nohighlight">
\[\rho_b = (1 - \phi) \rho_{\mathrm{cat}}\]</div>
<p>This gives:</p>
<div class="math notranslate nohighlight">
\[W_{\mathrm{cat}} = A_{xc} z\rho_b\]</div>
<p>We solve this for <span class="math notranslate nohighlight">\(z\)</span>:</p>
<div class="math notranslate nohighlight">
\[z = \frac{W_{\mathrm{cat}}}{A_{xc} \rho_b}\]</div>
<p>At this point, we drop some of the cumbersome labels and say:</p>
<div class="math notranslate nohighlight">
\[z = \frac{W}{A_c \rho_b}\]</div>
<p>We substitute this into our differential equation, <span class="math notranslate nohighlight">\(dP/dz\)</span> to get:</p>
<div class="math notranslate nohighlight">
\[\frac{dP}{dz} = A_c \rho_b \frac{dP}{dW}\]</div>
<p>Substituting this into the lumped Ergun Equation gives:</p>
<div class="math notranslate nohighlight">
\[\frac{dP}{dW} = -\frac{\beta}{A_c \rho_b}\frac{Q}{Q_f}\]</div>
<p>We are given the value of that parameter group in the problem statement, so this is now just a fifth ODE that we solve simultaneously with our material balances using <code class="docutils literal notranslate"><span class="pre">solve_ivp()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################################</span>
<span class="c1"># Defining global constants for Example Problem 02                #</span>
<span class="c1">###################################################################</span>

<span class="n">FAf</span> <span class="o">=</span> <span class="mi">100</span>        <span class="c1">#mol/s</span>
<span class="n">FBf</span> <span class="o">=</span> <span class="mi">100</span>        <span class="c1">#mol/s</span>
<span class="n">FCf</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c1">#mol/s</span>
<span class="n">FDf</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c1">#mol/s</span>
<span class="n">FTf</span> <span class="o">=</span> <span class="n">FAf</span> <span class="o">+</span> <span class="n">FBf</span> <span class="o">+</span> <span class="n">FCf</span> <span class="o">+</span> <span class="n">FDf</span>
<span class="n">Pf</span>  <span class="o">=</span> <span class="mf">1.0e6</span>      <span class="c1">#Pa, 10 bar</span>
<span class="n">R</span>   <span class="o">=</span> <span class="mi">8314</span>       <span class="c1">#L*Pa/mol/K</span>
<span class="n">T</span>   <span class="o">=</span> <span class="mi">573</span>        <span class="c1">#K</span>
<span class="n">Qf</span>  <span class="o">=</span> <span class="n">FTf</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">Pf</span>
<span class="n">k1</span>  <span class="o">=</span> <span class="mi">10</span>         <span class="c1">#L^2/mol/kg/sec</span>
<span class="n">k2</span>  <span class="o">=</span> <span class="mi">1</span>          <span class="c1">#L^2/mol/kg/sec</span>
<span class="n">Ergun</span> <span class="o">=</span> <span class="mf">303.975</span>  <span class="c1">#Pa/kg</span>
<span class="n">XA_target</span> <span class="o">=</span> <span class="mf">0.7</span>

<span class="c1">###################################################################</span>
<span class="c1"># Define the ODE system for the PBR with pressure drop            #</span>
<span class="c1"># function has the form f(W, [FA, FB, FC, FD, P])                 #</span>
<span class="c1"># function returns [dFAdW, dFBdW, dFCdW, dFDdW, dPdW]             #</span>
<span class="c1">###################################################################</span>

<span class="k">def</span><span class="w"> </span><span class="nf">P03</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
    <span class="n">FA</span><span class="p">,</span> <span class="n">FB</span><span class="p">,</span> <span class="n">FC</span><span class="p">,</span> <span class="n">FD</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">var</span> <span class="c1">#all flowrates in mol/s</span>
    <span class="n">FT</span> <span class="o">=</span> <span class="n">FA</span> <span class="o">+</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">FC</span> <span class="o">+</span> <span class="n">FD</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">FT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>       <span class="c1">#vol flow rate, L/sec</span>
    <span class="n">CA</span> <span class="o">=</span> <span class="n">FA</span><span class="o">/</span><span class="n">Q</span>          <span class="c1">#Concentration of A, mol/L</span>
    <span class="n">CB</span> <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">Q</span>          <span class="c1">#Concentration of B, mol/L</span>
    <span class="n">CC</span> <span class="o">=</span> <span class="n">FC</span><span class="o">/</span><span class="n">Q</span>          <span class="c1">#Concentration of C, mol/L</span>
    <span class="n">CD</span> <span class="o">=</span> <span class="n">FD</span><span class="o">/</span><span class="n">Q</span>          <span class="c1">#Concentration of D, mol/L</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="n">k1</span><span class="o">*</span><span class="n">CA</span><span class="o">*</span><span class="n">CB</span>      <span class="c1">#Rate of reaction 1, mol/kg/sec</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">k2</span><span class="o">*</span><span class="n">CA</span><span class="o">**</span><span class="mi">2</span>      <span class="c1">#Rate of reaction 2, mol/kg/sec</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="o">-</span><span class="n">r1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">r2</span>
    <span class="n">RB</span> <span class="o">=</span> <span class="o">-</span><span class="n">r1</span>
    <span class="n">RC</span> <span class="o">=</span>  <span class="n">r1</span>
    <span class="n">RD</span> <span class="o">=</span>  <span class="n">r2</span>
    <span class="n">dFAdW</span> <span class="o">=</span> <span class="n">RA</span>
    <span class="n">dFBdW</span> <span class="o">=</span> <span class="n">RB</span>
    <span class="n">dFCdW</span> <span class="o">=</span> <span class="n">RC</span>
    <span class="n">dFDdW</span> <span class="o">=</span> <span class="n">RD</span>
    <span class="n">dPdW</span>  <span class="o">=</span> <span class="o">-</span><span class="n">Ergun</span><span class="o">*</span><span class="n">Q</span><span class="o">/</span><span class="n">Qf</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dFAdW</span><span class="p">,</span> <span class="n">dFBdW</span><span class="p">,</span> <span class="n">dFCdW</span><span class="p">,</span> <span class="n">dFDdW</span><span class="p">,</span> <span class="n">dPdW</span><span class="p">]</span>

<span class="c1">###################################################################</span>
<span class="c1"># Define integration span and starting values for state variables #</span>
<span class="c1">###################################################################</span>

<span class="n">wspan</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="n">var0</span>  <span class="o">=</span> <span class="p">(</span><span class="n">FAf</span><span class="p">,</span> <span class="n">FBf</span><span class="p">,</span> <span class="n">FCf</span><span class="p">,</span> <span class="n">FDf</span><span class="p">,</span> <span class="n">Pf</span><span class="p">)</span>

<span class="c1">###################################################################</span>
<span class="c1"># Integrate the ODE system using solve_ivp()                      #</span>
<span class="c1">###################################################################</span>

<span class="n">ans03</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">P03</span><span class="p">,</span> <span class="n">wspan</span><span class="p">,</span> <span class="n">var0</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">)</span>

<span class="c1">###################################################################</span>
<span class="c1"># Extract relevant information from the solution structure        #</span>
<span class="c1">###################################################################</span>

<span class="n">W</span>   <span class="o">=</span> <span class="n">ans03</span><span class="o">.</span><span class="n">t</span>
<span class="n">FA</span>  <span class="o">=</span> <span class="n">ans03</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">P</span>   <span class="o">=</span> <span class="n">ans03</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

<span class="c1">###################################################################</span>
<span class="c1"># Calculate ethane conversion                                     #</span>
<span class="c1">###################################################################</span>

<span class="n">XA</span>  <span class="o">=</span> <span class="p">(</span><span class="n">FAf</span> <span class="o">-</span> <span class="n">FA</span><span class="p">)</span><span class="o">/</span><span class="n">FAf</span>

<span class="c1">###################################################################</span>
<span class="c1"># Construct W(XA); find W(0.7)                                    #</span>
<span class="c1">###################################################################</span>

<span class="n">itp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">XA</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The mass of catalyst required to achieve XA = </span><span class="si">{</span><span class="n">XA_target</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1"> is W = </span><span class="si">{</span><span class="n">itp</span><span class="p">(</span><span class="n">XA_target</span><span class="p">)</span><span class="si">:</span><span class="s1">0.0f</span><span class="si">}</span><span class="s1"> kg&#39;</span><span class="p">)</span> 

<span class="c1">###################################################################</span>
<span class="c1"># Graph XA vs W                                                   #</span>
<span class="c1">###################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">XA</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">wspan</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Catalys Mass (kg)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Conversion of A&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">###################################################################</span>
<span class="c1"># Graph P vs W                                                   #</span>
<span class="c1">###################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">P</span><span class="o">/</span><span class="mf">1e6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">wspan</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Catalys Mass (kg)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure (MPa)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The mass of catalyst required to achieve XA = 0.70 is W = 1581 kg
</pre></div>
</div>
<img alt="../_images/4d55d1e7af8d7eb4a0113f50d718a5ec2a44d36d928bb0742c9878e45df94e3e.png" src="../_images/4d55d1e7af8d7eb4a0113f50d718a5ec2a44d36d928bb0742c9878e45df94e3e.png" />
<img alt="../_images/dcfbc14062367174ee31029cc4a5fcbaaf5628346db91f5991d6152e507b1d7c.png" src="../_images/dcfbc14062367174ee31029cc4a5fcbaaf5628346db91f5991d6152e507b1d7c.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../Chapter2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lectures</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-working-with-equilibrium-constraints-in-propane-dehydrogenation">Recap: Working with Equilibrium Constraints in Propane Dehydrogenation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-01">Example Problem 01</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-review-of-the-pfr-balance">A Review of the PFR Balance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-the-pfr-balance-to-model-a-membrane-reactor">Modifying the PFR balance to model a membrane reactor</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#units-in-the-membrane-reactor-balance">Units in the Membrane Reactor Balance</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-steady-state-balance-on-a-well-mixed-volume-element-in-a-membrane-reactor">The steady state balance on a well-mixed volume element in a membrane reactor</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-the-diffusion-rate">Defining the diffusion rate</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-01">Solution to Example Problem 01</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-02">Example Problem 02</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-02">Solution to Example Problem 02</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-03">Example Problem 03</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-03">Solution to Example Problem 03</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jesse Q. Bond, Syracuse University
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>