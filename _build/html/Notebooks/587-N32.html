
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Material Balances XVI &#8212; Kinetics and Reaction Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Notebooks/587-N32';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Lectures" href="../Chapter2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/JQB.png" class="logo__image only-light" alt="Kinetics and Reaction Engineering - Home"/>
    <script>document.write(`<img src="../_static/JQB.png" class="logo__image only-dark" alt="Kinetics and Reaction Engineering - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../Chapter2.html">Lectures</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Material Balances XVI</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jqbond/CEN587/main?urlpath=tree/Notebooks/587-N32.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jqbond/CEN587" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jqbond/CEN587/issues/new?title=Issue%20on%20page%20%2FNotebooks/587-N32.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Notebooks/587-N32.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Material Balances XVI</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-01">Example Problem 01</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-01">Solution to Example Problem 01</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-02">Example Problem 02</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-02">Solution to Example Problem 02</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#instantaneous-selectivity">Instantaneous Selectivity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#case-1">Case 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#case-2">Case 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#case-3">Case 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#case-4">Case 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#case-5">Case 5</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#case-5a">Case 5a</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#case-5b">Case 5b</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#case-5c">Case 5c</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="material-balances-xvi">
<h1>Material Balances XVI<a class="headerlink" href="#material-balances-xvi" title="Link to this heading">#</a></h1>
<p>This lecture continues with a discussion of yield, selectivity, and optimization. We also discuss instantaneous selectivity and how we can use it to inform reactor selection and ideal operating conditions. Today, we will take a closer look at differences in yield and selectivity observed in different types of flow reactors, and we will discuss reasons why selectivity might depend on our choice of reactor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">opt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">interp1d</span>
</pre></div>
</div>
</div>
</div>
<section id="example-problem-01">
<h2>Example Problem 01<a class="headerlink" href="#example-problem-01" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is Example 4.5 from <em>Chemical Reactor Analysis and Design Fundamentals, 2nd ed.</em> by Rawlings and Ekerdt. This problem was already solved in <a class="reference external" href="https://jqbond.github.io/CEN587/Notebooks/587-N29.html">Notebook 29</a>, and we defined overall yields and selectivities in <a class="reference external" href="https://jqbond.github.io/CEN587/Notebooks/587-N30.html">Notebook 30</a> We will present a brief review of the solution and then expand our analysis to include a discussion of instantaneous selectivity and how reactor choice might be an important consideration in optimizing product yields.</p>
</div>
<p>You are carrying out Benzene Pyrolysis in a Plug Flow Reactor operating at 1033K and 1.0 atm.  The two reactions occurring in this system are benzene coupling to form diphenyl and hydrogen followed by a secondary reaction between benzene and diphenyl to form triphenyl and hydrogen:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
&amp;2B \longleftrightarrow D + H_2\\
&amp;B + D \longleftrightarrow T + H_2
\end{align*}\]</div>
<p>Both reactions are reversible and <em><strong>follow elementary rate laws</strong></em>.  Rate constants and equilibrium concentration ratios (<span class="math notranslate nohighlight">\(K_C\)</span>) are given below.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
&amp;k_1 = 7.0 \ \times 10^5 \ \textrm{L} \ \textrm{mol}^{-1} \ \textrm{h}^{-1}\\
&amp;k_2 = 4.0 \ \times 10^5 \ \textrm{L} \ \textrm{mol}^{-1} \ \textrm{h}^{-1}\\
&amp;K_{C_1} = 0.31\\
&amp;K_{C_2} = 0.48
\end{align*}\]</div>
<p>If pure benzene is fed into the reactor at 60,000 moles per hour, find the PFR volume required to maximize the yield to diphenyl.</p>
<section id="solution-to-example-problem-01">
<h3>Solution to Example Problem 01<a class="headerlink" href="#solution-to-example-problem-01" title="Link to this heading">#</a></h3>
<p>Even though there are multiple reactions, we approach this problem the same way as usual: we write a material balance on Benzene.</p>
<div class="math notranslate nohighlight">
\[\frac{dF_B}{dV} = R_B\]</div>
<p>We generally know that <span class="math notranslate nohighlight">\(R_B\)</span> is going to be a complex function of concentrations of all of the species present in this system.  That means we can’t solve the above balance on Benzene without also solving balances on Diphenyl, Hydrogen, and Triphenyl <em>at the same time</em>, i.e., we have to solve the coupled system of differential equations below:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \frac{dF_B}{dV} &amp;= R_B \\
    \frac{dF_D}{dV} &amp;= R_D \\
    \frac{dF_H}{dV} &amp;= R_H \\
    \frac{dF_T}{dV} &amp;= R_T \\
\end{align*}\]</div>
<p>So, we’ve got 4 differential equations that tell us how 4 dependent variables (<span class="math notranslate nohighlight">\(F_B\)</span>, <span class="math notranslate nohighlight">\(F_D\)</span>, <span class="math notranslate nohighlight">\(F_H\)</span>, <span class="math notranslate nohighlight">\(F_T\)</span>) change as a function of the one independent variable, <span class="math notranslate nohighlight">\(V\)</span>.  We can solve this system <em>if</em> we can define everything on the right hand sides of the above equations (<span class="math notranslate nohighlight">\(R_B\)</span>, <span class="math notranslate nohighlight">\(R_D\)</span>, <span class="math notranslate nohighlight">\(R_H\)</span>, and <span class="math notranslate nohighlight">\(R_T\)</span>) in terms of <span class="math notranslate nohighlight">\(F_B\)</span>, <span class="math notranslate nohighlight">\(F_D\)</span>, <span class="math notranslate nohighlight">\(F_H\)</span>, <span class="math notranslate nohighlight">\(F_T\)</span>, and/or <span class="math notranslate nohighlight">\(V\)</span>.</p>
<p>We know how to do this!!</p>
<p>Generally:</p>
<div class="math notranslate nohighlight">
\[R_j = \sum_i \nu_{i,j} r_i\]</div>
<p>So:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    R_B &amp;= -2r_1 - r_2 \\
    R_D &amp;=  r_1 - r_2 \\
    R_H &amp;=  r_2 + r_2 \\
    R_T &amp;=  r_2 \\
\end{align*}\]</div>
<p>We next define reaction rates:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    r_1 &amp;= k_{1,f}C_B^2 - k_{1,r}C_HC_D \\
    r_2 &amp;= k_{2,f}C_BC_D - k_{2,r}C_HC_T \\
\end{align*}\]</div>
<p>We define concentrations in terms of molar flowrates:</p>
<div class="math notranslate nohighlight">
\[C_j = \frac{F_j}{Q}\]</div>
<p>This introduces the volumetric flowrate, <span class="math notranslate nohighlight">\(Q\)</span>, into the system.  Fortunately, this is a gas phase reaction at low pressure, so we know we can define <span class="math notranslate nohighlight">\(Q\)</span> in terms of the total molar flowrate:</p>
<div class="math notranslate nohighlight">
\[Q = \frac{F_{tot}RT}{P}\]</div>
<p>Where total molar flowrate is defined in terms of individual species flowrates, i.e., our state variables.</p>
<div class="math notranslate nohighlight">
\[F_{tot} = \sum_j F_j\]</div>
<p><strong>Yield of Diphenyl with respect to Benzene</strong></p>
<p>According to the first reaction, each diphenyl produced will consume two benzenes, so the correct definition for yield according to the equations in the preceding section is:</p>
<div class="math notranslate nohighlight">
\[Y_{D/B} = \frac{2F_D}{F_{Bf}}\]</div>
<p><strong>Yield of Triphenyl with respect to Benzene</strong></p>
<p>The coefficients are less clear for triphenyl since each triphenyl consumes one diphenyl…which consumes two benzenes.  The easiest way to handle the yield definition for a sequential reaction like this is to add the overall reactions so that we can relate triphenyl directly to benzene:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
   &amp;2B \leftrightarrow D + H \\
   &amp;B + D \leftrightarrow T + H \\
        \hline
    &amp;3B \leftrightarrow T + 2H \\
\end{align*}\]</div>
<p>From that overall equation, it becomes clear that it takes 3 benzenes to make one triphenyl, so the yield definition is:</p>
<div class="math notranslate nohighlight">
\[Y_{T/B} = \frac{3F_T}{F_{Bf}}\]</div>
<p>We extend these ideas to the selectivity definitions, which quantify the percentage of consumed reactant that went to produce diphenyl or triphenyl.</p>
<p><strong>Selectivity to diphenyl with respect to benzene:</strong></p>
<div class="math notranslate nohighlight">
\[S_{D/B} = \frac{2F_D}{F_{Bf} - F_B}\]</div>
<p><strong>Selectivity to triphenyl with respect to benzene:</strong></p>
<div class="math notranslate nohighlight">
\[S_{T/B} = \frac{3F_T}{F_{Bf} - F_B}\]</div>
<p>With that, we’ve defined out system of ODES fully as a function of molar flowrates and reactor volume.  We can solve this numerically using solve_ivp.  See below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#############################################################</span>
<span class="c1"># Constants from problem statement; define as globals       #</span>
<span class="c1">#############################################################</span>

<span class="n">T</span>   <span class="o">=</span> <span class="mi">1033</span>    <span class="c1">#K</span>
<span class="n">P</span>   <span class="o">=</span> <span class="mf">1.0</span>     <span class="c1">#atm</span>
<span class="n">R</span>   <span class="o">=</span> <span class="mf">0.08206</span> <span class="c1">#L*atm/mol/K</span>
<span class="n">k1f</span> <span class="o">=</span> <span class="mf">7.0e5</span>   <span class="c1">#L/mol/h</span>
<span class="n">k2f</span> <span class="o">=</span> <span class="mf">4.0e5</span>   <span class="c1">#L/mol/h</span>
<span class="n">KC1</span> <span class="o">=</span> <span class="mf">0.31</span>
<span class="n">KC2</span> <span class="o">=</span> <span class="mf">0.48</span>
<span class="n">k1r</span> <span class="o">=</span> <span class="n">k1f</span><span class="o">/</span><span class="n">KC1</span> <span class="c1">#L/mol/h</span>
<span class="n">k2r</span> <span class="o">=</span> <span class="n">k2f</span><span class="o">/</span><span class="n">KC2</span> <span class="c1">#L/mol/h</span>
<span class="n">FBf</span> <span class="o">=</span> <span class="mi">60000</span>   <span class="c1">#mol/h</span>
<span class="n">FDf</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">FHf</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">FTf</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1">##############################################################</span>
<span class="c1"># Define ODE system in a function                            #</span>
<span class="c1"># Function has typical form f(V, [FB, FD, FH, FT])           #</span>
<span class="c1"># It returns [dFB/dV, dFD/dV, dFH/dV, dFT/dV]                #</span>
<span class="c1">##############################################################</span>

<span class="k">def</span><span class="w"> </span><span class="nf">P01</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
    
    <span class="c1">#unpack state-dependent variables in var</span>
    <span class="n">FB</span><span class="p">,</span> <span class="n">FD</span><span class="p">,</span> <span class="n">FH</span><span class="p">,</span> <span class="n">FT</span> <span class="o">=</span> <span class="n">var</span>
    
    <span class="c1"># The above is functionally equivalent to</span>
    <span class="c1"># FB = var[0]</span>
    <span class="c1"># FD = var[1]</span>
    <span class="c1"># FH = var[2]</span>
    <span class="c1"># FT = var[3]</span>
      
    <span class="c1">#total molar flowrate, function of individual molar flowrates</span>
    <span class="n">FTOT</span> <span class="o">=</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">FD</span> <span class="o">+</span> <span class="n">FH</span> <span class="o">+</span> <span class="n">FT</span>
    
    <span class="c1">#volumetric flowrate</span>
    <span class="n">Q</span>    <span class="o">=</span> <span class="n">FTOT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>
    
    <span class="c1">#Define concentrations</span>
    <span class="n">CB</span>   <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CD</span>   <span class="o">=</span> <span class="n">FD</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CH</span>   <span class="o">=</span> <span class="n">FH</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CT</span>   <span class="o">=</span> <span class="n">FT</span><span class="o">/</span><span class="n">Q</span>
    
    <span class="c1">#now that we have concentrations, we define reaction rates</span>
    <span class="n">r1</span>   <span class="o">=</span> <span class="n">k1f</span><span class="o">*</span><span class="n">CB</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">k1r</span><span class="o">*</span><span class="n">CD</span><span class="o">*</span><span class="n">CH</span>
    <span class="n">r2</span>   <span class="o">=</span> <span class="n">k2f</span><span class="o">*</span><span class="n">CB</span><span class="o">*</span><span class="n">CD</span> <span class="o">-</span> <span class="n">k2r</span><span class="o">*</span><span class="n">CT</span><span class="o">*</span><span class="n">CH</span>
    
    <span class="c1">#With reaction rates, you can define production rates</span>
    <span class="n">RB</span>   <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RD</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RH</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span>
    <span class="n">RT</span>   <span class="o">=</span>         <span class="n">r2</span>
    
    <span class="c1">#For a PFR, dFj/dV = Rj, so these are our derivatives of FB, FD, FH, FT</span>
    <span class="n">D1</span>   <span class="o">=</span> <span class="n">RB</span>
    <span class="n">D2</span>   <span class="o">=</span> <span class="n">RD</span>
    <span class="n">D3</span>   <span class="o">=</span> <span class="n">RH</span>
    <span class="n">D4</span>   <span class="o">=</span> <span class="n">RT</span>
    
    <span class="c1">#return derivatives of each dependent variable w.r.t. volume</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">,</span> <span class="n">D3</span><span class="p">,</span> <span class="n">D4</span><span class="p">]</span>

<span class="c1">############################################################################</span>
<span class="c1"># Set starting state and integration span for solve_ivp()                  #</span>
<span class="c1">############################################################################</span>
<span class="n">vspan</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
<span class="n">var0</span>    <span class="o">=</span> <span class="p">[</span><span class="n">FBf</span><span class="p">,</span> <span class="n">FDf</span><span class="p">,</span> <span class="n">FHf</span><span class="p">,</span> <span class="n">FTf</span><span class="p">]</span>

<span class="c1">############################################################################</span>
<span class="c1"># Solve using solve_ivp()                                                  #</span>
<span class="c1">############################################################################</span>
<span class="n">solP01</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">P01</span><span class="p">,</span> <span class="n">vspan</span><span class="p">,</span> <span class="n">var0</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">)</span>

<span class="c1">############################################################################</span>
<span class="c1"># Extract necessary data from the solution structure.                      #</span>
<span class="c1">############################################################################</span>
<span class="n">Vout</span>    <span class="o">=</span> <span class="n">solP01</span><span class="o">.</span><span class="n">t</span>
<span class="n">FBout</span>   <span class="o">=</span> <span class="n">solP01</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">FDout</span>   <span class="o">=</span> <span class="n">solP01</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">FHout</span>   <span class="o">=</span> <span class="n">solP01</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">FTout</span>   <span class="o">=</span> <span class="n">solP01</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="c1">############################################################################</span>
<span class="c1"># Calculate conversion, selectivities, and yields                          #</span>
<span class="c1">############################################################################</span>
<span class="n">XBout</span>   <span class="o">=</span> <span class="p">(</span><span class="n">FBf</span> <span class="o">-</span> <span class="n">FBout</span><span class="p">)</span><span class="o">/</span><span class="n">FBf</span>
<span class="n">YDB</span>     <span class="o">=</span> <span class="n">FDout</span><span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="n">FBf</span>
<span class="n">YTB</span>     <span class="o">=</span> <span class="n">FTout</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="n">FBf</span>
<span class="n">SDB</span>     <span class="o">=</span> <span class="n">FDout</span><span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">FBf</span> <span class="o">-</span> <span class="n">FBout</span><span class="p">)</span>
<span class="n">STB</span>     <span class="o">=</span> <span class="n">FTout</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">FBf</span> <span class="o">-</span> <span class="n">FBout</span><span class="p">)</span>

<span class="c1">############################################################################</span>
<span class="c1"># Plot yield and conversion vs. reactor volume                             # </span>
<span class="c1">############################################################################</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Conversion and Diphenyl Yield in a PFR&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">XBout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Conversion&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">YDB</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Yield to D&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">YTB</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Yield to T&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">vspan</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Benzene Conversion/Diphenyl Yield&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">############################################################################</span>
<span class="c1"># Create a continuous interpolating polynomial approximation for YDB(V)    #</span>
<span class="c1">############################################################################</span>
<span class="n">YvVolP</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">YDB</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>

<span class="c1">############################################################</span>
<span class="c1"># Define objective function to minimize                    #</span>
<span class="c1">############################################################</span>

<span class="n">obj</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">V</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">YvVolP</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>

<span class="c1">############################################################</span>
<span class="c1"># Find the value of V that minimizes obj(V)                #</span>
<span class="c1">############################################################</span>

<span class="n">opt_ans</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

<span class="c1">############################################################</span>
<span class="c1"># Display answers                                          #</span>
<span class="c1">############################################################</span>

<span class="nb">print</span><span class="p">(</span><span class="n">opt_ans</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The maximum yield is </span><span class="si">{</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">opt_ans</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1"> at a PFR volume of </span><span class="si">{</span><span class="n">opt_ans</span><span class="o">.</span><span class="n">x</span><span class="si">:</span><span class="s1">3.0f</span><span class="si">}</span><span class="s1">L&#39;</span><span class="p">)</span>


<span class="c1">############################################################</span>
<span class="c1"># Graph the objective function vs. volume; confirm minimum #</span>
<span class="c1">############################################################</span>
<span class="n">vset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vset</span><span class="p">,</span> <span class="n">obj</span><span class="p">(</span><span class="n">vset</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;objective function value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">opt_ans</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">vspan</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">opt_ans</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;-YDB&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\jqbon\AppData\Local\Temp\ipykernel_10696\4035293566.py:93: RuntimeWarning: invalid value encountered in divide
  SDB     = FDout*2/(FBf - FBout)
C:\Users\jqbon\AppData\Local\Temp\ipykernel_10696\4035293566.py:94: RuntimeWarning: invalid value encountered in divide
  STB     = FTout*3/(FBf - FBout)
</pre></div>
</div>
<img alt="../_images/76d35e6c69110a8ecde9b41be0578464624d3ff746cdb7f03f9bf819f8d01123.png" src="../_images/76d35e6c69110a8ecde9b41be0578464624d3ff746cdb7f03f9bf819f8d01123.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> message: 
          Optimization terminated successfully;
          The returned value satisfies the termination criteria
          (using xtol = 1.48e-08 )
 success: True
     fun: -0.40944519130527224
       x: 487.88217559536014
     nit: 10
    nfev: 17
The maximum yield is 0.409 at a PFR volume of 488L
</pre></div>
</div>
<img alt="../_images/c2c235b014e4cf8580ea0ef428db6f524ea8fc520f715e51b89bc2998a260637.png" src="../_images/c2c235b014e4cf8580ea0ef428db6f524ea8fc520f715e51b89bc2998a260637.png" />
</div>
</div>
</section>
</section>
<section id="example-problem-02">
<h2>Example Problem 02<a class="headerlink" href="#example-problem-02" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is Example 4.5 from <em>Chemical Reactor Analysis and Design Fundamentals, 2nd ed.</em> by Rawlings and Ekerdt adapted for a CSTR. This problem was already solved in <a class="reference external" href="https://jqbond.github.io/CEN587/Notebooks/587-N29.html">Notebook 29</a>. We will present a brief review of the solution, add definitions of overall yield and selectivity, and then highlight differences between this CSTR case and that of the PFR considered in <a class="reference internal" href="#example-problem-01"><span class="xref myst">Example Problem 01</span></a>.</p>
</div>
<p>You are carrying out Benzene Pyrolysis in a CSTR operating at 1033K and 1.0 atm.  The two reactions occurring in this system are benzene coupling to form diphenyl and hydrogen followed by a secondary reaction between benzene and diphenyl to form triphenyl and hydrogen:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
&amp;2B \longleftrightarrow D + H_2\\
&amp;B + D \longleftrightarrow T + H_2
\end{align*}\]</div>
<p>Both reactions are reversible and follow elementary rate laws.  Rate constants and equilibrium concentration ratios (<span class="math notranslate nohighlight">\(K_C\)</span>) are given below.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
&amp;k_1 = 7.0 \ \times 10^5 \ \textrm{L} \ \textrm{mol}^{-1} \ \textrm{h}^{-1}\\
&amp;k_2 = 4.0 \ \times 10^5 \ \textrm{L} \ \textrm{mol}^{-1} \ \textrm{h}^{-1}\\
&amp;K_{C_1} = 0.31\\
&amp;K_{C_2} = 0.48
\end{align*}\]</div>
<p>If pure benzene is fed into the reactor at 60,000 moles per hour, find the CSTR volume required to maximize diphenyl yield.</p>
<section id="solution-to-example-problem-02">
<h3>Solution to Example Problem 02<a class="headerlink" href="#solution-to-example-problem-02" title="Link to this heading">#</a></h3>
<p>If we consider a material balance on Benzene in a CSTR at steady state:</p>
<div class="math notranslate nohighlight">
\[0 = F_{B,f} - F_B + R_BV\]</div>
<p>We notice the production rate of <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(R_B\)</span> in this expression, and we might already anticipate that it is going to be a complicated function of the concentrations of all species present in this system. We know this is going to happen because species <span class="math notranslate nohighlight">\(B\)</span> is participating in two different reactions, each with a different rate expression that depends on concentrations of various species. Once we consider the two rate laws in detail, we conclude that <span class="math notranslate nohighlight">\(R_B\)</span> will depend on the concentrations of diphenyl, triphenyl, and hydrogen. This means that there are many “unknowns” hidden in the definition of <span class="math notranslate nohighlight">\(R_B\)</span>, and we cannot solve this single equation in isolation. We need to somehow define the concentrations of all species…</p>
<p>The easiest way to do this is to recognize that we can write a single, independent balance for each component:</p>
<div class="amsmath math notranslate nohighlight" id="equation-5f81fc20-b97d-414f-9d94-d5d72fbf3267">
<span class="eqno">(1)<a class="headerlink" href="#equation-5f81fc20-b97d-414f-9d94-d5d72fbf3267" title="Permalink to this equation">#</a></span>\[\begin{align}
    0 &amp;= F_{B,f} - F_B + R_BV \\
    0 &amp;= F_{D,f} - F_D + R_DV \\
    0 &amp;= F_{H,f} - F_H + R_HV \\
    0 &amp;= F_{T,f} - F_T + R_TV \\
\end{align}\]</div>
<p>One way to think about this is as a system of four equations written in terms of five unknowns (<span class="math notranslate nohighlight">\(F_B\)</span>, <span class="math notranslate nohighlight">\(F_D\)</span>, <span class="math notranslate nohighlight">\(F_H\)</span>, <span class="math notranslate nohighlight">\(F_T\)</span>, and <span class="math notranslate nohighlight">\(V\)</span>).  We can say this because although we don’t “know” the production rates for each species, <span class="math notranslate nohighlight">\(R_j\)</span>, we <em><strong>can</strong></em> express all of them as functions of species flow rates. In <a class="reference internal" href="#"><span class="xref myst">Notebook 29</span></a>, our goal was to solve for the CSTR volume required to achieve 50% conversion of benzene. Here, we have a slightly different goal, which is to find the CSTR volume that optimizes diphenyl yield. We don’t know what that optimium yield is at the outset of the problem, so we will use the following conceptual approach – we will guess a volume, and we will solve for the resultant diphenyl yield at that volume. In this way, we can eventually find the volume that optimizes diphenyl yield. The key thing to recognize is that once we specify volume, we have reduced the problem to four unknowns (<span class="math notranslate nohighlight">\(F_B\)</span>, <span class="math notranslate nohighlight">\(F_D\)</span>, <span class="math notranslate nohighlight">\(F_H\)</span>, <span class="math notranslate nohighlight">\(F_T\)</span>), and the above system of equations can be solved using a nonlinear algebraic equation solver.</p>
<p>To he only remaining task is to ensure that we’ve defined the right hand side of each equation in terms of constants and species flowrates (our four unknowns). If we can accomplish that, then the problem can be solved with <code class="docutils literal notranslate"><span class="pre">opt.root()</span></code>. We start with the definition for production rate:</p>
<div class="math notranslate nohighlight">
\[R_j = \sum_i \nu_{i,j} r_i\]</div>
<p>Applying this to each species:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    R_B &amp;= -2r_1 - r_2 \\
    R_D &amp;=  r_1 - r_2 \\
    R_H &amp;=  r_2 + r_2 \\
    R_T &amp;=  r_2 \\
\end{align*}\]</div>
<p>We next define reaction rates:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    r_1 &amp;= k_{1,f}C_B^2 - k_{1,r}C_HC_D \\
    r_2 &amp;= k_{2,f}C_BC_D - k_{2,r}C_HC_T \\
\end{align*}\]</div>
<p>We define concentrations in terms of molar flowrates:</p>
<div class="math notranslate nohighlight">
\[C_j = \frac{F_j}{Q}\]</div>
<p>This introduces the unknown volumetric flowrate, <span class="math notranslate nohighlight">\(Q\)</span>. Fortunately, this is a gas phase reaction at low pressure, so we know we can define <span class="math notranslate nohighlight">\(Q\)</span> in terms of the total molar flowrate:</p>
<div class="math notranslate nohighlight">
\[Q = \frac{F_{tot}RT}{P}\]</div>
<p>Where the total molar flowrate is given by the sum of all component molar flowrates.</p>
<div class="math notranslate nohighlight">
\[F_{tot} = \sum_j F_j\]</div>
<p><strong>Yield of Diphenyl with respect to Benzene</strong></p>
<p>According to the first reaction, each diphenyl produced will consume two benzenes, so the correct definition for yield according to the equations in the preceding section is:</p>
<div class="math notranslate nohighlight">
\[Y_{D/B} = \frac{2F_D}{F_{Bf}}\]</div>
<p><strong>Yield of Triphenyl with respect to Benzene</strong></p>
<p>We add the overall reactions so that we can relate triphenyl directly to benzene:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
   &amp;2B \leftrightarrow D + H \\
   &amp;B + D \leftrightarrow T + H \\
        \hline
    &amp;3B \leftrightarrow T + 2H \\
\end{align*}\]</div>
<p>From this, it is clear that it takes 3 benzenes to make one triphenyl, so the correct definition of triphenyl yield is:</p>
<div class="math notranslate nohighlight">
\[Y_{T/B} = \frac{3F_T}{F_{Bf}}\]</div>
<p>We extend these ideas to the selectivity definitions, which quantify the percentage of consumed reactant that went to produce diphenyl or triphenyl.</p>
<p><strong>Selectivity to diphenyl with respect to benzene:</strong></p>
<div class="math notranslate nohighlight">
\[S_{D/B} = \frac{2F_D}{F_{Bf} - F_B}\]</div>
<p><strong>Selectivity to triphenyl with respect to benzene:</strong></p>
<div class="math notranslate nohighlight">
\[S_{T/B} = \frac{3F_T}{F_{Bf} - F_B}\]</div>
<p>We set this up below as a system of five equations written in terms of five unknowns. Then we solve it using <code class="docutils literal notranslate"><span class="pre">opt.root()</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the cell below, we will show a couple of strategies for optimization. The first is actually similar to what we did in the PFR solution. We will obtain a large array of dipheynyl yields at many different CSTR volumes; then we will create a continuous interpolating polynomial function to approximate YDB(V) and optimize that using <code class="docutils literal notranslate"><span class="pre">opt.minimize_scalar()</span></code>. This approach is nice because it also allows us to generate a graph of YDB(V) results for direct comparison with behavior as a function of Volume in a PFR.</p>
<p>One might consider an alternate approach, which is to create an objective function that directly returns YDB(V) upon solution of the system of algebraic equations using <code class="docutils literal notranslate"><span class="pre">opt.root()</span></code>. This is a less straighforward approach because it involves wrapping an oprimization routine around a nonlinear equation solver, which is not something we usually think to do when we are first learning these methods. That said, this approach is useful and extensible, so we provide the alternate solution here. Neither is necessarily better or worse. Both will give a correct answer, but one might be more efficient or easier to use in certain instances, so it is worth being familiar with both methods.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################################</span>
<span class="c1"># Define the system of equations in form compatible with opt.root()                           #</span>
<span class="c1"># Function has the form f([FB, FD, FH, FT], V)                                                #</span>
<span class="c1"># We are passing volume as an extra parameter to facilitate optimization                      #</span>
<span class="c1"># By specifying volume, we have reduced the problem to 4 unknowns (FB, FD, FH, FT)            #</span>
<span class="c1">###############################################################################################</span>

<span class="k">def</span><span class="w"> </span><span class="nf">P02</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
    <span class="c1">#unknowns in the array var</span>
    <span class="n">FB</span><span class="p">,</span> <span class="n">FD</span><span class="p">,</span> <span class="n">FH</span><span class="p">,</span> <span class="n">FT</span> <span class="o">=</span> <span class="n">var</span>
                   
    <span class="c1">#Total molar flowrate</span>
    <span class="n">FTOT</span> <span class="o">=</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">FD</span> <span class="o">+</span> <span class="n">FH</span> <span class="o">+</span> <span class="n">FT</span>
    
    <span class="c1">#Volumetric flowrate</span>
    <span class="n">Q</span>    <span class="o">=</span> <span class="n">FTOT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>
    
    <span class="c1">#Define species concentrations</span>
    <span class="n">CB</span>   <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CD</span>   <span class="o">=</span> <span class="n">FD</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CH</span>   <span class="o">=</span> <span class="n">FH</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CT</span>   <span class="o">=</span> <span class="n">FT</span><span class="o">/</span><span class="n">Q</span>
    
    <span class="c1">#Define reaction rates</span>
    <span class="n">r1</span>   <span class="o">=</span> <span class="n">k1f</span><span class="o">*</span><span class="n">CB</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">k1r</span><span class="o">*</span><span class="n">CD</span><span class="o">*</span><span class="n">CH</span>
    <span class="n">r2</span>   <span class="o">=</span> <span class="n">k2f</span><span class="o">*</span><span class="n">CB</span><span class="o">*</span><span class="n">CD</span> <span class="o">-</span> <span class="n">k2r</span><span class="o">*</span><span class="n">CT</span><span class="o">*</span><span class="n">CH</span>
    
    <span class="c1">#Define species production rates</span>
    <span class="n">RB</span>   <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RD</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RH</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span>
    <span class="n">RT</span>   <span class="o">=</span>         <span class="n">r2</span>
       
    <span class="c1">#Write the five equations to be solved.</span>
    <span class="n">F1</span>   <span class="o">=</span> <span class="n">FBf</span> <span class="o">-</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">RB</span><span class="o">*</span><span class="n">V</span>
    <span class="n">F2</span>   <span class="o">=</span> <span class="n">FDf</span> <span class="o">-</span> <span class="n">FD</span> <span class="o">+</span> <span class="n">RD</span><span class="o">*</span><span class="n">V</span>
    <span class="n">F3</span>   <span class="o">=</span> <span class="n">FHf</span> <span class="o">-</span> <span class="n">FH</span> <span class="o">+</span> <span class="n">RH</span><span class="o">*</span><span class="n">V</span>
    <span class="n">F4</span>   <span class="o">=</span> <span class="n">FTf</span> <span class="o">-</span> <span class="n">FT</span> <span class="o">+</span> <span class="n">RT</span><span class="o">*</span><span class="n">V</span>

    <span class="c1">#Return the left hand side of each of the four constraint equations</span>
    <span class="c1">#When the problem is solved, these should all be zero.</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">,</span> <span class="n">F3</span><span class="p">,</span> <span class="n">F4</span><span class="p">]</span>

<span class="c1">##########################################################################################################</span>
<span class="c1"># Create a list of volumes we&#39;re interested in solving; our choice, let&#39;s go from 0.01 to 5000L          #</span>
<span class="c1"># Do this in 500 elements. We&#39;re going solve the above system for 500 different volumes                  #</span>
<span class="c1"># We will create a loop that will solve for each volume in V using opt.root() on each pass               #</span>
<span class="c1"># Each volume is passed to the system of equations as an extra parameter using the args keyword          #</span>
<span class="c1">##########################################################################################################</span>

<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span> <span class="c1"># Set of volumes we will solve system at.</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">V</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span>        <span class="c1"># Pre-allocate an array to store solutions [FB, FD, FH, FT] at each Volume; shape will be (500, 4)</span>

<span class="c1">##########################################################################################################</span>
<span class="c1"># Use a for loop to solve a new instance of the system of equations for each volume in V                 #</span>
<span class="c1"># Store the result on each pass in F[i, :]                                                               #</span>
<span class="c1">##########################################################################################################</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vol</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">V</span><span class="p">):</span> 
    <span class="n">var0</span>    <span class="o">=</span> <span class="p">(</span><span class="n">FBf</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">FBf</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">FBf</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">FBf</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">solP02</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">P02</span><span class="p">,</span> <span class="n">var0</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">vol</span><span class="p">,))</span> <span class="c1"># Let&#39;s handle passing the extra volume parameter with the args keyword!</span>
    <span class="k">if</span> <span class="n">solP02</span><span class="o">.</span><span class="n">success</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: opt.root() failed to converge!&quot;</span><span class="p">)</span> <span class="c1"># It is useful to add a warning that will trigger if there is a problem!</span>
    <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>  <span class="o">=</span> <span class="n">solP02</span><span class="o">.</span><span class="n">x</span>


<span class="c1">##########################################################################################################</span>
<span class="c1"># The loop is complete, now extract molar flowrates at each volume in V                                  #</span>
<span class="c1">##########################################################################################################</span>
<span class="n">FB</span> <span class="o">=</span> <span class="n">F</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">FD</span> <span class="o">=</span> <span class="n">F</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">FH</span> <span class="o">=</span> <span class="n">F</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">FT</span> <span class="o">=</span> <span class="n">F</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>

<span class="c1">##########################################################################################################</span>
<span class="c1"># Calculate conversion, selectivities, and yields                                                        #</span>
<span class="c1">##########################################################################################################</span>
<span class="n">XBout</span>   <span class="o">=</span> <span class="p">(</span><span class="n">FBf</span> <span class="o">-</span> <span class="n">FB</span><span class="p">)</span><span class="o">/</span><span class="n">FBf</span>
<span class="n">YDB</span>     <span class="o">=</span> <span class="n">FD</span><span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="n">FBf</span>
<span class="n">YTB</span>     <span class="o">=</span> <span class="n">FT</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="n">FBf</span>
<span class="n">DB</span>     <span class="o">=</span> <span class="n">FDout</span><span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">FBf</span> <span class="o">-</span> <span class="n">FBout</span><span class="p">)</span>
<span class="n">STB</span>     <span class="o">=</span> <span class="n">FTout</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">FBf</span> <span class="o">-</span> <span class="n">FBout</span><span class="p">)</span>

<span class="c1">##########################################################################################################</span>
<span class="c1"># Plot conversion and yield vs. reactor volume                                                           #</span>
<span class="c1">##########################################################################################################</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Conversion and Diphenyl Yield in a PFR&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">XBout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Conversion&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">YDB</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Yield to D&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">YTB</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Yield to T&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">V</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Benzene Conversion/Diphenyl Yield&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">############################################################################</span>
<span class="c1"># Create a continuous interpolating polynomial approximation for YDB(V)    #</span>
<span class="c1">############################################################################</span>
<span class="n">YvVolC</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">YDB</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>

<span class="c1">############################################################</span>
<span class="c1"># Define objective function to minimize                    #</span>
<span class="c1">############################################################</span>

<span class="n">obj</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">V</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">YvVolC</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>

<span class="c1">############################################################</span>
<span class="c1"># Find the value of V that minimizes obj(V)                #</span>
<span class="c1">############################################################</span>

<span class="n">opt_ans</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;bounded&#39;</span><span class="p">,</span> <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">5000</span><span class="p">])</span>

<span class="c1">############################################################</span>
<span class="c1"># Display answers                                          #</span>
<span class="c1">############################################################</span>

<span class="nb">print</span><span class="p">(</span><span class="n">opt_ans</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The maximum yield is </span><span class="si">{</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">opt_ans</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s1">3.3f</span><span class="si">}</span><span class="s1"> at a CSTR volume of </span><span class="si">{</span><span class="n">opt_ans</span><span class="o">.</span><span class="n">x</span><span class="si">:</span><span class="s1">3.0f</span><span class="si">}</span><span class="s1">L&#39;</span><span class="p">)</span>


<span class="c1">############################################################</span>
<span class="c1"># Graph the objective function vs. volume; confirm minimum #</span>
<span class="c1">############################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">obj</span><span class="p">(</span><span class="n">V</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;objective function value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">opt_ans</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">vspan</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">opt_ans</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">V</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;-YDB&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\jqbon\AppData\Local\Temp\ipykernel_10696\2377870078.py:81: RuntimeWarning: invalid value encountered in divide
  DB     = FDout*2/(FBf - FBout)
C:\Users\jqbon\AppData\Local\Temp\ipykernel_10696\2377870078.py:82: RuntimeWarning: invalid value encountered in divide
  STB     = FTout*3/(FBf - FBout)
</pre></div>
</div>
<img alt="../_images/b2ff489af66fd0caada3f6451d7fc7a4fbbf66c6f5b39cf090ab165ec11d19b1.png" src="../_images/b2ff489af66fd0caada3f6451d7fc7a4fbbf66c6f5b39cf090ab165ec11d19b1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> message: Solution found.
 success: True
  status: 0
     fun: -0.32567292226582656
       x: 1404.1121230635288
     nit: 16
    nfev: 16
The maximum yield is 0.326 at a CSTR volume of 1404L
</pre></div>
</div>
<img alt="../_images/7d1c44f6b7a55edd4e6d669e10843f33e3edd43936024a4577e555c38a331ae3.png" src="../_images/7d1c44f6b7a55edd4e6d669e10843f33e3edd43936024a4577e555c38a331ae3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">indexC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">YDB</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The maximum diphenyl yield in a CSTR is </span><span class="si">{</span><span class="n">YDB</span><span class="p">[</span><span class="n">indexC</span><span class="p">]</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1"> at a Volume of </span><span class="si">{</span><span class="n">V</span><span class="p">[</span><span class="n">indexC</span><span class="p">]</span><span class="si">:</span><span class="s1">0.0f</span><span class="si">}</span><span class="s1">L.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The maximum diphenyl yield in a CSTR is 0.326 at a Volume of 1403L.
</pre></div>
</div>
</div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The main takeaway: we see that the PFR is intrinsically more selective for diphenyl production than the CSTR. We might not have expected this at first! Next, we’ll learn why that is so. This will help us to understand how to make intuitive predictions about which reactors will be more selective (for parallel reactions like this one) without needing to solve material balances. It will <em><strong>not</strong></em> always be the case that the PFR is the more selective reactor.</p>
</div>
</section>
</section>
<section id="instantaneous-selectivity">
<h2>Instantaneous Selectivity<a class="headerlink" href="#instantaneous-selectivity" title="Link to this heading">#</a></h2>
<p>When we start working with multiple reactions, we have consider many aspects of reactor operation in order to maximize yield and selectivity to a desired product and minimize side reactions. Thus far, we’ve only really considered how temperature, pressure, composition, mixing, and reactor selection impact reactor size, but now we have to consider how these things impact the quantity of each product that forms. We have already considered how, in the case of series (sequential) reaction, space time/reactor volume are critical for achieving optimum yields to an intermediate. Other important decisions will be the <em><strong>type of reactor</strong></em> that we use and our <em><strong>selection of operating conditions</strong></em>. We can build the necessary insights about how to make good decisions by considering a new metric, called <em><strong>instantaneous selectivity</strong></em> for the case of two, irreversible parallel reactions. Although reactions are often considerably more complex (series, equilibrium limited, etc.), the insights we gain from this exercise are universal.</p>
<p>Let’s start with a general definition of instantaneous selectivity. Whereas overall yields and selectivities are defined in terms of extensive molar quantities (total moles, molar flowrates), instantaneous selectivities are defined in terms of production rates. Specifically, we define the instantaneous selectivity as a ratio of the rate at which one species is formed or consumed to the rate at which another species is formed or consumed. We will give the instantaneous selectivity a symbol <span class="math notranslate nohighlight">\(\tilde{S}\)</span>, and we will always define the instantaneous selectivity of one species, <span class="math notranslate nohighlight">\(j\)</span>, with respect to another species, <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(\tilde{S}_{j/k}\)</span>.</p>
<p>For the remainder of this notebook, we will consider two irreversible reactions that occur in parallel. <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> can react to form a desired product, <span class="math notranslate nohighlight">\(D\)</span>, or they can react to form an undesired product, <span class="math notranslate nohighlight">\(U\)</span>:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    A + B \longrightarrow D \\
    A + B \longrightarrow U \\
\end{align*}\]</div>
<p>We define the “instantaneous selectivity of <span class="math notranslate nohighlight">\(D\)</span> with respect to <span class="math notranslate nohighlight">\(U\)</span>” as the rate at which <span class="math notranslate nohighlight">\(D\)</span> is produced, <span class="math notranslate nohighlight">\(R_D\)</span>, divided by the rate at which <span class="math notranslate nohighlight">\(U\)</span> is produced, <span class="math notranslate nohighlight">\(R_U\)</span>:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = \frac{R_D}{R_U}\]</div>
<p>“Instantaneous selectivity” is a general concept comprising a ratio of production rates, and we can define it in terms of any two species of interst. For example, we could the instantaneous selectivity of <span class="math notranslate nohighlight">\(D\)</span> with respect to <span class="math notranslate nohighlight">\(A\)</span> as:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/A} = \frac{R_D}{R_A}\]</div>
<p>The instantaneous selectivity of <span class="math notranslate nohighlight">\(U\)</span> with respect to <span class="math notranslate nohighlight">\(B\)</span> as:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{U/B} = \frac{R_U}{R_B}\]</div>
<p>The instantaneous selectivity of <span class="math notranslate nohighlight">\(B\)</span> with respect to <span class="math notranslate nohighlight">\(A\)</span> as:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{B/A} = \frac{R_B}{R_A}\]</div>
<p>And the instantaneous selectivity of <span class="math notranslate nohighlight">\(A\)</span> with respect to both <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(D\)</span> as:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{A/UD} = \frac{R_A}{R_U + R_D}\]</div>
<p>We can define an instantaneous selectivity for any ratio of rates that are important in our system. Here, we only have two parallel reactions, and we’re only making <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(D\)</span>, so the most informative instantaneous selectivity to consider is the rate at which <span class="math notranslate nohighlight">\(D\)</span> forms relative to the rate at which <span class="math notranslate nohighlight">\(U\)</span> forms, i.e., <span class="math notranslate nohighlight">\(\tilde{S}_{D/U}\)</span>. Ideally, we would like to maximize this quantity:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = \frac{R_D}{R_U}\]</div>
<p>We can gain insight into how we might maximize this quantity by expressing production rates as functions of reaction rates:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = \frac{r_1}{r_2}\]</div>
<p>To go further, we need to consider the specific rate law for each reaction. We can address all necessary conceptual arguments if we stay general and say that rates are given by distinct power law expressions:</p>
<div class="amsmath math notranslate nohighlight" id="equation-1a660cee-a077-41fc-a4d9-cf7817b45382">
<span class="eqno">(2)<a class="headerlink" href="#equation-1a660cee-a077-41fc-a4d9-cf7817b45382" title="Permalink to this equation">#</a></span>\[\begin{align}
    r_1 = k_1{C_A}^{\alpha_1}{C_B}^{\beta_1} \\
    r_2 = k_2{C_A}^{\alpha_2}{C_B}^{\beta_2} \\
\end{align}\]</div>
<p>The reaction orders are as yet unspecified. We will also state explicitly that <span class="math notranslate nohighlight">\(k_1\)</span> and <span class="math notranslate nohighlight">\(k_2\)</span> are functions of temperature, and their dependencies are given by Arrhenius expressions:</p>
<div class="amsmath math notranslate nohighlight" id="equation-78cf953a-9fa6-461b-b283-ba4bd86e3ca1">
<span class="eqno">(3)<a class="headerlink" href="#equation-78cf953a-9fa6-461b-b283-ba4bd86e3ca1" title="Permalink to this equation">#</a></span>\[\begin{align}
    k_1 = A_1 \exp \left(\frac{-E_{A1}}{RT}\right) \\
    \\
    k_2 = A_2 \exp \left(\frac{-E_{A2}}{RT}\right) \\
\end{align}\]</div>
<p>We can substitute these definitions into the instantaneous selectivity expression:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = \frac{k_1{C_A}^{\alpha_1}{C_B}^{\beta_1}}{k_2{C_A}^{\alpha_2}{C_B}^{\beta_2}}\]</div>
<p>This can also be expressed as follows, which highlights the fact that <em><strong>differences</strong></em> in reaction orders and rate constants are important in determining instantaneous selectivities.</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = \frac{k_1}{k_2}{C_A}^{(\alpha_1 - \alpha_2)}{C_B}^{(\beta_1 - \beta_1)}\]</div>
<p>We cannot gain further insight until we know more about the reaction orders and rate constants, so now we’ll define specific cases we need to consider, and we will work through them in sequence.</p>
<section id="case-1">
<h3>Case 1<a class="headerlink" href="#case-1" title="Link to this heading">#</a></h3>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    k_1 &amp;= k_2 \\ 
    \alpha_1 &amp;&gt; \alpha_2 \\ 
    \beta_1 &amp;&gt; \beta_2
\end{align*}\]</div>
<p>For this scenario, we conclude that:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\((\alpha_1 - \alpha_2) = |a|\)</span> (a positive number)</p></li>
<li><p><span class="math notranslate nohighlight">\((\beta_1 - \beta_2) = |b|\)</span> (a positive number)</p></li>
<li><p>rate constants cancel from the instantaneous selectivity expression</p></li>
</ol>
<p>This gives:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = {C_A}^{|a|}{C_B}^{|b|}\]</div>
<p>Where both <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are positive. We consider limiting behavior:</p>
<p>As <span class="math notranslate nohighlight">\(C_A, C_B \longrightarrow 0\)</span>, <span class="math notranslate nohighlight">\(\tilde{S}_{D/U} \longrightarrow 0\)</span><br />
As <span class="math notranslate nohighlight">\(C_A, C_B \longrightarrow \infty\)</span>, <span class="math notranslate nohighlight">\(\tilde{S}_{D/U} \longrightarrow \infty\)</span></p>
<p>In this case, we can favor selectivity to the desired product by making <span class="math notranslate nohighlight">\(C_A\)</span> and <span class="math notranslate nohighlight">\(C_B\)</span> as large as possible. For this reason, we would chose a reactor and a set of operating conditions that (1) maximize starting reactant concentrations and (2) maintains reactant concentrations as high as possible for as long (clock time or space time) as possible.</p>
<ol class="arabic simple">
<li><p><strong>Reactor Selection</strong>: Consider a PFR or a Batch Reactor; CSTR is a poor choice for selectivity.</p></li>
<li><p><strong>Operating conditions</strong>: Gas Phase (high pressure, no diluent); liquid phase (high concentration; no solvent)</p></li>
<li><p><strong>Caveats</strong>: Safety, pumping, miscibility, side reactions, deactivation, etc.</p></li>
</ol>
</section>
<section id="case-2">
<h3>Case 2<a class="headerlink" href="#case-2" title="Link to this heading">#</a></h3>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    k_1 &amp;= k_2 \\
    \alpha_1 &amp;&lt; \alpha_2 \\ 
    \beta_1 &amp;&lt; \beta_2
\end{align*}\]</div>
<p>For this scenario, we conclude that:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\((\alpha_1 - \alpha_2) = -|a|\)</span> (a negative number)</p></li>
<li><p><span class="math notranslate nohighlight">\((\beta_1 - \beta_2) = -|b|\)</span> (a negative number)</p></li>
<li><p>rate constants cancel from the instantaneous selectivity expression</p></li>
</ol>
<p>This gives:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = {C_A}^{-|a|}{C_B}^{-|b|}\]</div>
<p>We rearrange this to shows the relationship between species selectivity and species concentration more clearly:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = \frac{1}{{C_A}^{|a|}{C_B}^{|b|}}\]</div>
<p>We consider limiting behavior:</p>
<p>As <span class="math notranslate nohighlight">\(C_A, C_B \longrightarrow 0\)</span>, <span class="math notranslate nohighlight">\(\tilde{S}_{D/U} \longrightarrow \infty\)</span><br />
As <span class="math notranslate nohighlight">\(C_A, C_B \longrightarrow \infty\)</span>, <span class="math notranslate nohighlight">\(\tilde{S}_{D/U} \longrightarrow 0\)</span></p>
<p>In this case, we can favor selectivity to the desired product by making <span class="math notranslate nohighlight">\(C_A\)</span> and <span class="math notranslate nohighlight">\(C_B\)</span> as small as possible. For this reason, we want to chose a reactor and a set of operating conditions that allows us to (1) operate at minimum starting concentrations of reacting species and (2) maintain maintain reactant concentrations as low as possible.</p>
<ol class="arabic simple">
<li><p><strong>Reactor Selection</strong>: Consider a CSTR; PFRs and Batch reactors go from high concentration to low concentration and will be worse for selectivity.</p></li>
<li><p><strong>Operating Conditions</strong>: Gas Phase (low pressure, add diluent <span class="math notranslate nohighlight">\(N_2\)</span> or other inert); liquid phase (low concentration in a solvent)</p></li>
<li><p><strong>Caveats</strong>: As concentrations go to zero, rates also go to zero, and reactor volume goes to infinity.</p></li>
</ol>
</section>
<section id="case-3">
<h3>Case 3<a class="headerlink" href="#case-3" title="Link to this heading">#</a></h3>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    k_1 &amp;= k_2 \\
    \alpha_1 &amp;&gt; \alpha_2 \\
    \beta_1 &amp;&lt; \beta_2
\end{align*}\]</div>
<p>For this scenario, we conclude that:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\((\alpha_1 - \alpha_2) = |a|\)</span>, (a positive number)</p></li>
<li><p><span class="math notranslate nohighlight">\((\beta_1 - \beta_2) = -|b|\)</span>, (a negative number)</p></li>
<li><p>rate constants cancel from the instantaneous selectivity expression</p></li>
</ol>
<p>This gives:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = {C_A}^{|a|}{C_B}^{-|b|}\]</div>
<p>We rearrange to show the relationship between selectivity and concentration more clearly:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = \frac{{C_A}^{|a|}}{{C_B}^{|b|}}\]</div>
<p>In this case, we see that we want to make <span class="math notranslate nohighlight">\(C_A\)</span> as high as possible and <span class="math notranslate nohighlight">\(C_B\)</span> as low as possible. Mindful of that goal, we might conclude that none of our conventional CSTR, PFR, or Batch reactor options make much sense here. In theory, We <em>could</em> operate any of those reactors in that way (high <span class="math notranslate nohighlight">\(C_A\)</span> and low <span class="math notranslate nohighlight">\(C_B\)</span>), but we would end up having very low conversion of <span class="math notranslate nohighlight">\(A\)</span> per pass (since <span class="math notranslate nohighlight">\(B\)</span> would be so dilute), and we would end up needing to operate with a large recycle. We would probably achieve high selectivity to <span class="math notranslate nohighlight">\(D\)</span> in this way, but the reactor configuration would be too expensive to be practical. In this type of system, there is a good argument for less conventional reactor designs:</p>
<ol class="arabic simple">
<li><p><strong>Semi-batch reactor (liquids)</strong>: We would fill with species <span class="math notranslate nohighlight">\(A\)</span> initially and make its concentration as high as possible; then we would add <span class="math notranslate nohighlight">\(B\)</span> incrementally at a low flowrate.</p></li>
<li><p><strong>Membrane reactor (gases)</strong>: We would flow species <span class="math notranslate nohighlight">\(A\)</span> at high pressure/concentration through an inner tube, and we would allow species <span class="math notranslate nohighlight">\(B\)</span> to diffuse into the reactor across a membrane.</p></li>
</ol>
</section>
<section id="case-4">
<h3>Case 4<a class="headerlink" href="#case-4" title="Link to this heading">#</a></h3>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    k_1 &amp;= k_2 \\
    \alpha_1 &amp;&lt; \alpha_2 \\
    \beta_1 &amp;&gt; \beta_2
\end{align*}\]</div>
<p>For this scenario, we conclude that:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\((\alpha_1 - \alpha_2) = -|a|\)</span>, (a negative number)</p></li>
<li><p><span class="math notranslate nohighlight">\((\beta_1 - \beta_2) = |b|\)</span>, (a positive number)</p></li>
<li><p>rate constants cancel from the instantaneous selectivity expression</p></li>
</ol>
<p>This gives:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = {C_A}^{-|a|}{C_B}^{|b|}\]</div>
<p>We rearrange to show the dependency more clearly:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = \frac{{C_B}^{|b|}}{{C_A}^{|a|}}\]</div>
<p>This is the mirror image of Case 3, and we make similar conclusions.</p>
<ol class="arabic simple">
<li><p><strong>Semi-batch reactor (liquids)</strong>: We would fill with species <span class="math notranslate nohighlight">\(B\)</span> initially and make its concentration as high as possible; then we would add <span class="math notranslate nohighlight">\(A\)</span> incrementally at a low flowrate.</p></li>
<li><p><strong>Membrane reactor (gases)</strong>: We would flow species <span class="math notranslate nohighlight">\(B\)</span> at high pressure/concentration through an inner tube, and we would allow species <span class="math notranslate nohighlight">\(A\)</span> to diffuse into the reactor across a membrane.</p></li>
</ol>
</section>
<section id="case-5">
<h3>Case 5<a class="headerlink" href="#case-5" title="Link to this heading">#</a></h3>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    k_1 &amp;\neq k_2 \\
    \alpha_1 &amp;= \alpha_2 \\
    \beta_1 &amp;= \beta_2
\end{align*}\]</div>
<p>For this scenario, we conclude that:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\((\alpha_1 - \alpha_2) = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((\beta_1 - \beta_2) = 0\)</span></p></li>
<li><p>rate constants remain in the instantaneous selectivity expression</p></li>
</ol>
<p>This gives:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = \frac{k_1}{k_2}\]</div>
<p>To go further, we have to express the rate constants in terms of their Arrhenius parameters:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = \frac{A_1 \exp \left(\frac{-E_{A1}}{RT}\right)}{A_2 \exp \left(\frac{-E_{A2}}{RT}\right)}\]</div>
<p>Which we can also express as:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = \frac{A_1}{A_2}\exp \left(\frac{-\left(E_{A1} - E_{A2}\right)}{RT}\right)\]</div>
<p>In general, pre-exponential factors (<span class="math notranslate nohighlight">\(A_1\)</span> and <span class="math notranslate nohighlight">\(A_2\)</span>) and barriers (<span class="math notranslate nohighlight">\(E_{A1}\)</span> and <span class="math notranslate nohighlight">\(E_{A2}\)</span>) are weak functions of temperature, so we can consider them to be constant as we vary the reaction temperature. Because pre-exponential factors, in particular, are not a function of temperature, their ratio never changes as we vary the reaction temperature.For simplicity, we’ll say it is constant:</p>
<div class="math notranslate nohighlight">
\[\frac{A_1}{A_2} = A\]</div>
<p>Then:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = A\exp \left(\frac{-\left(E_{A1} - E_{A2}\right)}{RT}\right)\]</div>
<p>From this, we can see that reaction temperature is the critical operating condition for tuning instantaneous selectivity. This result makes clear that, in this case, where reaction orders are identical, adjusting pressure and concentration will have no impact on instantaneous selectivity. The question of how temperature impacts instantaneous selectivity is determined by the difference in barriers for the two reactions.  We will consider a few sub-cases:</p>
<section id="case-5a">
<h4>Case 5a<a class="headerlink" href="#case-5a" title="Link to this heading">#</a></h4>
<p><span class="math notranslate nohighlight">\(E_{A1} = E_{A2}\)</span></p>
<p>If the two barriers are equal, we find that our selectivity expression becomes:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = A\exp \left(0\right) = A\]</div>
<p>Here, we can change temperature all we want to. The rates of each reaction will increase and decrease in exactly the same way, and instantaneous selectivity will not change as a function of temperature.</p>
</section>
<section id="case-5b">
<h4>Case 5b<a class="headerlink" href="#case-5b" title="Link to this heading">#</a></h4>
<p><span class="math notranslate nohighlight">\(E_{A1} &gt; E_{A2}\)</span></p>
<p>In this case, <span class="math notranslate nohighlight">\((E_{A1} - E_{A2}) = |E|\)</span>, a positive number.  Then:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = A\exp \left(\frac{-|E|}{RT}\right)\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = \frac{A}{\exp \left(\frac{|E|}{RT}\right)}\]</div>
<p>Examining limiting behavior, we find:</p>
<p>As <span class="math notranslate nohighlight">\(T \longrightarrow 0\)</span>, <span class="math notranslate nohighlight">\(\tilde{S}_{D/U} \longrightarrow 0\)</span><br />
As <span class="math notranslate nohighlight">\(T \longrightarrow \infty\)</span>, <span class="math notranslate nohighlight">\(\tilde{S}_{D/U} \longrightarrow A\)</span></p>
<ol class="arabic simple">
<li><p>We should operate at the maximum temperature possible to maximize selectivity toward the desired product</p></li>
<li><p>As temperature increases, it favors the higher barrier process.</p></li>
<li><p><strong>Caveat</strong>: cost of heating; as temperature gets too high, we usually “turn on” more side reactions, coking, deactivation, etc.</p></li>
</ol>
</section>
<section id="case-5c">
<h4>Case 5c<a class="headerlink" href="#case-5c" title="Link to this heading">#</a></h4>
<p><span class="math notranslate nohighlight">\(E_{A1} &lt; E_{A2}\)</span></p>
<p>We find that <span class="math notranslate nohighlight">\((E_{A1} - E_{A2}) = -|E|\)</span>, a negative number.  So:</p>
<div class="math notranslate nohighlight">
\[\tilde{S}_{D/U} = A\exp \left(\frac{E}{RT}\right)\]</div>
<p>Examining limiting behavior, we find:</p>
<p>As <span class="math notranslate nohighlight">\(T \longrightarrow 0\)</span>, <span class="math notranslate nohighlight">\(\tilde{S}_{D/U} \longrightarrow \infty\)</span><br />
As <span class="math notranslate nohighlight">\(T \longrightarrow \infty\)</span>, <span class="math notranslate nohighlight">\(\tilde{S}_{D/U} \longrightarrow A\)</span></p>
<ol class="arabic simple">
<li><p>We want to operate at the lowest temperature possible to maximize selectivity toward the desired product</p></li>
<li><p>Increasing temperature favors the higher barrier process.</p></li>
<li><p><strong>Caveat</strong>: as Temperature goes to zero, so does reaction rate, so there are practical limits to this strategy.</p></li>
</ol>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../Chapter2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lectures</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-01">Example Problem 01</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-01">Solution to Example Problem 01</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-02">Example Problem 02</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-example-problem-02">Solution to Example Problem 02</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#instantaneous-selectivity">Instantaneous Selectivity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#case-1">Case 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#case-2">Case 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#case-3">Case 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#case-4">Case 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#case-5">Case 5</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#case-5a">Case 5a</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#case-5b">Case 5b</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#case-5c">Case 5c</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jesse Q. Bond, Syracuse University
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>