
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Interpolation and Regression &#8212; Kinetics and Reaction Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Notebooks/587-N37';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Useful Ancillary Skills for Regression" href="587-N38.html" />
    <link rel="prev" title="Lectures" href="../Chapter2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/JQB.png" class="logo__image only-light" alt="Kinetics and Reaction Engineering - Home"/>
    <script>document.write(`<img src="../_static/JQB.png" class="logo__image only-dark" alt="Kinetics and Reaction Engineering - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../Chapter2.html">Lectures</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Interpolation and Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="587-N38.html">Useful Ancillary Skills for Regression</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jqbond/CEN587/main?urlpath=tree/Notebooks/587-N37.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jqbond/CEN587" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jqbond/CEN587/issues/new?title=Issue%20on%20page%20%2FNotebooks/587-N37.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Notebooks/587-N37.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Interpolation and Regression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolation-vs-regression">Interpolation vs. Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-utility-of-functions">The Utility of Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#univariate-functions-f-x">Univariate Functions f(x)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zero-order">Zero order</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#first-order">First order</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#second-order">Second order</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#third-order">Third order</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fourth-order">Fourth order</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nth-order">nth order</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-modelling-the-inverse-problem">Data Modelling: The Inverse Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-data-into-a-system-of-equations">Converting data into a system of equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-quadratic-example">A Quadratic Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-matrix-vector-representation-of-the-inverse-problem">A Matrix/Vector representation of the Inverse Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-representation-of-the-2nd-order-problem">Matrix representation of the 2nd order problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-matrix-representation-of-higher-order-models">General Matrix Representation of higher order models</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-the-data">Fitting the data</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-x-matrix">Creating the X matrix</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-the-y-array">Constructing the Y array</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-for-the-unknown-coefficients">Solving for the unknown coefficients</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-the-interpolating-polynomial">Constructing the interpolating polynomial</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#now-pump-the-brakes">Now pump the brakes…</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-call-a-vandermonde-matrix-a-vandermonde-matrix">Let’s call a Vandermonde Matrix a Vandermonde Matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression">Linear Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-a-first-order-linear-model-to-the-data">Fitting a first order (linear) model to the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-a-second-order-quadratic-model-to-the-data">Fitting a second order (quadratic) model to the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-a-third-order-model-to-the-data">Fitting a third order model to the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-fall-2025">For Fall 2025:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-useful-things-to-accompany-regression">Extra, useful things to accompany regression</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fyi-python-will-do-all-this-stuff-for-you-if-you-want">FYI, Python will do all this stuff for you if you want…</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="interpolation-and-regression">
<h1>Interpolation and Regression<a class="headerlink" href="#interpolation-and-regression" title="Link to this heading">#</a></h1>
<p>We are at the point in the course where we need to have a somewhat serious conversation about data fitting and inverse problems. We have dabbled in the methods through our use of interpolating polynomials to backfill ODE solutions and identify points in time or space where we achieved some targeted metric in conversion, yield, and/or selectivity.  In these cases, it was generally sufficient that we used Python’s tools for 1D interpolation, even if we did not entirely understand how they work.  Now, we need to move into the analysis of kinetic data obtained in batch reactors, and it becomes important that we understand the mechanics. “Data fitting” requires us to consider the “inverse problem” of what we are used to solving. Here, we attempt to discern the models (functions) and parameter values (rate constants, reaction orders, etc.) that describe the behaviors that we observe in a system. Generally, this comprises data fitting, model reconciliation, regression, and parameter estimation. In theory, you have already learned these topics in prior courses in statistics and experimental methods. In practice, the topics are nuanced, and they can be applied in many ways to many fields of analysis. We will all benefit from learning the basics again.</p>
<p>We have many options for data fitting; a lot of them are built into Python, and we’ll use them extensively. These include familiar tools like <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.interp1D()</span></code>, <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.CubicSpline()</span></code>, and <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code>. We’ll also look at some new tools for curve fitting like <code class="docutils literal notranslate"><span class="pre">np.polyfit()</span></code>. More recently in the wider world, there has been a lot of development around using artificial intelligence for parameter estimation (this is the gist of machine learning). The core tools for machine learning are based on fundamental concepts in regression analysis, so future work in AI and Machine Learning benefits from a strong foundation in the methods of interpolation and regression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">opt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">ceil</span><span class="p">,</span> <span class="n">floor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</pre></div>
</div>
</div>
</div>
<section id="interpolation-vs-regression">
<h2>Interpolation vs. Regression<a class="headerlink" href="#interpolation-vs-regression" title="Link to this heading">#</a></h2>
<p>In this Notebook, we will (eventually)do a deep dive into <em><strong>linear regression</strong></em>. The methods we discuss here are the same as those that operate behind the scenes when you use Excel’s trendlines or Python’s <code class="docutils literal notranslate"><span class="pre">np.polyfit()</span></code>. These concepts also form the basis of advanced modelling-and-prediction algorithms used in Machine Learning. If you can understand how to build interpolating polynomials and regression polynomials (and how the two are different) using linear algebra, this will provide an excellent foundation for work in data analytics. Before we get into mathematical details, we should discuss some fundamental ideas about interpolation and regression. These techniques both involve similar mechanics, and they involve developing a model that describes observed data, but they have some key differences.</p>
<p>When we develop an <em><strong>interpolating function</strong></em>, we build a model that <em><strong>passes exactly through all of the data points that we have available</strong></em>. Typically, we use these to infer un-measured values that are <em><strong>between the limits of values that we have measured</strong></em>.  Think about linear interpolation to find a value between two points on a steam table as an example.  Or, if you like, think about how we’ve used interpolating polynomials in this course to find, say, the Volume required to achieve a specific fractional conversion after integrating a PFR model with numerical methods.</p>
<p>When we perform <em><strong>regression</strong></em>, we build a model that <em><strong>minimizes the error between it and the measurements we’ve made</strong></em>.  It will not pass through all data points; in fact, it may not pass through any of our measured data points. Regressed models are what we use when we have overdetermined systems. They still provide predictive power in that they will let us predict the state of our system for a given set of inputs, and we should still generally only use them for interpolation unless we know that the model we have developed is physics-based and extensible to states that we have not measured.</p>
<p>We’ll cover basic methods for polynomial interpolation first because this is ultimately just solving linear systems of equations. Once you understand how to construct interpolating polynomials, then linear regression is a straightforward extension of that. We will not cover the development of spline polynomials (piecewise polynomials) here, although we may still use them through Python’s interpolation packages.</p>
</section>
<section id="the-utility-of-functions">
<h2>The Utility of Functions<a class="headerlink" href="#the-utility-of-functions" title="Link to this heading">#</a></h2>
<p>It is worth refreshing our understanding of functions.  Basically, a function is something that maps the value of an input (e.g., <span class="math notranslate nohighlight">\(x\)</span>) to the value of an output (e.g., <span class="math notranslate nohighlight">\(y\)</span>). We can generalize this concept to any sort of process that we want to model, which is what makes the basic concept of a function so useful: if you have a function that accurately describes your system, then you can predict the metric of interest (here, “<span class="math notranslate nohighlight">\(y\)</span>”) for any value of input that your process takes (here, “<span class="math notranslate nohighlight">\(x\)</span>”).</p>
<p>You can think of this in terms of all kinds of processes. As a chemical engineer, I might be interested in how much benzene my reactor produces as a function of temperature. With that function in hand, I can easily model how changing <em><strong>temperature</strong></em> will impact <em><strong>benzene production</strong></em>. But this can really be any sort of model that captures either a fundamental dependence (change in rate constant with temperature) or a corrleation (let’s just say that the price of bitcoin varys as a function of rainfall in Myanmar because that’s as good a predictor of BTC price as anything else). Once you know how BTC price changes with fluctuations in Burmese precipitation, then you can predict the BTC price by monitoring something physically tangible (rainfall in Myanmar).</p>
<p>You get the idea: we use functions to build <em><strong>models</strong></em> that describe a process of interest. These models are always populated by one or more input variables (arguments) and one or more parameters that help us to define the shape of response in output variable as we vary an input variable.</p>
<section id="univariate-functions-f-x">
<h3>Univariate Functions f(x)<a class="headerlink" href="#univariate-functions-f-x" title="Link to this heading">#</a></h3>
<p>For now, we restrict consideration to univariate functions, which means a function that has only one input variable.  I will use <span class="math notranslate nohighlight">\(y = f(x)\)</span> for all examples. <em><strong>Univariate</strong></em> means that, once our function is parameterized, we only need the value of one input argument, <span class="math notranslate nohighlight">\(x\)</span>, to predict the value of <span class="math notranslate nohighlight">\(y\)</span>. We talk a lot about polynomials, which are functions of variable order, where order is the value of the highest exponent on <span class="math notranslate nohighlight">\(x\)</span> in your model. For example:</p>
<section id="zero-order">
<h4>Zero order<a class="headerlink" href="#zero-order" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[y(x) = 5x^0\]</div>
<p>The function is zero order because the exponent on <span class="math notranslate nohighlight">\(x\)</span> is <span class="math notranslate nohighlight">\(0\)</span>, and <span class="math notranslate nohighlight">\(x^0 = 1\)</span>. In practice, we’d never write <span class="math notranslate nohighlight">\(x^0\)</span> since we know that it is just equal to <span class="math notranslate nohighlight">\(1\)</span>, but it is helpful to begin with a rigorous illustration of what a zero-order polynomial in <span class="math notranslate nohighlight">\(x\)</span> actually means. This will lead naturally to characterizing the behavior of higher order polynomials.</p>
<div class="math notranslate nohighlight">
\[y(x) = 5\]</div>
<p>One might describe this model as one where the value of y is predicted for a given value of x by (1) raising <span class="math notranslate nohighlight">\(x\)</span> to the zero power and then (2) multiplying that result by a constant parameter, <span class="math notranslate nohighlight">\(5\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">####################################################################</span>
<span class="c1"># Create an array of x values, which will be &quot;inputs&quot; to model     #</span>
<span class="c1">####################################################################</span>

<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="c1">####################################################################</span>
<span class="c1"># Map input values of x to resultant values of y for y = 5         #</span>
<span class="c1">####################################################################</span>

<span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span> <span class="o">+</span> <span class="mf">5.0</span>

<span class="c1">####################################################################</span>
<span class="c1"># Graph y(x) for input array x0                                    #</span>
<span class="c1">####################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;A zero order polynomial&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b18d83de17da940e8b5a828e642a12000bd21f8c833e075ab4f98084c82efc51.png" src="../_images/b18d83de17da940e8b5a828e642a12000bd21f8c833e075ab4f98084c82efc51.png" />
</div>
</div>
</section>
<section id="first-order">
<h4>First order<a class="headerlink" href="#first-order" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[y(x) = 10x^1 + 5x^0 = 10x +5\]</div>
<p>The highest exponent on <span class="math notranslate nohighlight">\(x\)</span> here is <span class="math notranslate nohighlight">\(1\)</span>, so this is a first order polynomial. When something has a highest order <span class="math notranslate nohighlight">\(1\)</span>, we call it a linear model because, when you graph it, it is a straight line. We see that this is a univariate function that takes a single input argument <span class="math notranslate nohighlight">\(x\)</span>. It is also populated by two constant parameters – in this linear model, we would call the constant “5” the y-intercept, and we would call the constant coefficient of <span class="math notranslate nohighlight">\(x^1\)</span> <span class="math notranslate nohighlight">\((10)\)</span> the slope. We should be able to see that if we pass a value of <span class="math notranslate nohighlight">\(x\)</span> into this function, it will generate the corresponding value of <span class="math notranslate nohighlight">\(y\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">####################################################################</span>
<span class="c1"># Define an array of x values that will be &quot;inputs&quot; to model       #</span>
<span class="c1">####################################################################</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1">####################################################################</span>
<span class="c1"># Define function to map x value to corresponding y value          #</span>
<span class="c1">####################################################################</span>

<span class="n">y1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span>

<span class="c1">####################################################################</span>
<span class="c1"># Graph y vs. x for the linear model                               #</span>
<span class="c1">####################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;A first order polynomial&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8a558a6d3f68e6c29c2d542fabbf6c2522e21260152d4ef5c892ec2c40acd0a1.png" src="../_images/8a558a6d3f68e6c29c2d542fabbf6c2522e21260152d4ef5c892ec2c40acd0a1.png" />
</div>
</div>
</section>
<section id="second-order">
<h4>Second order<a class="headerlink" href="#second-order" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[y(x) = 0.5x^2 + 10x^1 + 5x^0 = 0.5x^2 + 10x + 5\]</div>
<p>Here, we have a second order (quadratic) since the leading term has an exponent of <span class="math notranslate nohighlight">\(2\)</span> on <span class="math notranslate nohighlight">\(x\)</span>. We have now introduced curvature to the model and can visualize the result in the cell below. Before proceeding, consider that since we know the numerical values of all constants in this model, passing a value of <span class="math notranslate nohighlight">\(x\)</span> to this function will generate the corresponding value of <span class="math notranslate nohighlight">\(y\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">####################################################################</span>
<span class="c1"># Define an array of x values that will be &quot;inputs&quot; to model       #</span>
<span class="c1">####################################################################</span>

<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1">####################################################################</span>
<span class="c1"># Define function to map x value to corresponding y value          #</span>
<span class="c1">####################################################################</span>

<span class="n">y2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span>

<span class="c1">####################################################################</span>
<span class="c1"># Graph y vs x                                                     #</span>
<span class="c1">####################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">(</span><span class="n">x2</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;A second order polynomial&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6ec64542df24153b046ba0c2787b077151162ddeab7f4af032d842fc9b2febd0.png" src="../_images/6ec64542df24153b046ba0c2787b077151162ddeab7f4af032d842fc9b2febd0.png" />
</div>
</div>
<p>We can proceed indefinitely with polynomials and, at this point, can probably imagine imagine 3rd, 4th, and a general “nth” order polynomial:</p>
</section>
<section id="third-order">
<h4>Third order<a class="headerlink" href="#third-order" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[y(x) = -0.75x^3 + 0.5x^2 + 10x + 5\]</div>
</section>
<section id="fourth-order">
<h4>Fourth order<a class="headerlink" href="#fourth-order" title="Link to this heading">#</a></h4>
<p>Wwe can visualize the increasing complexity and curvature of <span class="math notranslate nohighlight">\(3^{rd}\)</span> and <span class="math notranslate nohighlight">\(4^{th}\)</span> order polynomials in the cell below.</p>
<div class="math notranslate nohighlight">
\[y(x) = 0.035x^4 - 0.75x^3 + 0.5x^2 + 10x + 5\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">########################################################################</span>
<span class="c1"># Define an array of x values that will be &quot;inputs&quot; to 3rd order model #</span>
<span class="c1">########################################################################</span>

<span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1">########################################################################</span>
<span class="c1"># Define a 3rd order function to map x value to corresponding y value  #</span>
<span class="c1">########################################################################</span>

<span class="n">y3</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.75</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span> 

<span class="c1">########################################################################</span>
<span class="c1"># Graph 3rd order polynomial on domain for x3                          #</span>
<span class="c1">########################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">(</span><span class="n">x3</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x3</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;A third order polynomial&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">########################################################################</span>
<span class="c1"># Define an array of x values that will be &quot;inputs&quot; to 4th order model #</span>
<span class="c1">########################################################################</span>

<span class="n">x4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1">########################################################################</span>
<span class="c1"># Define a 4th order function to map x value to corresponding y value  #</span>
<span class="c1">########################################################################</span>

<span class="n">y4</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.035</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mf">0.75</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span> 

<span class="c1">########################################################################</span>
<span class="c1"># Graph 4th order polynomial on domain for x4                          #</span>
<span class="c1">########################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">(</span><span class="n">x4</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x4</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;A fourth order polynomial&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/684ecd359e23757a046375cf4a255a1b1944a04a3720669ddb649435435e1e6c.png" src="../_images/684ecd359e23757a046375cf4a255a1b1944a04a3720669ddb649435435e1e6c.png" />
<img alt="../_images/566adfe32d8eed9551fe154d3aec961864dc5ae1efb47cb39b2b4fcce351d257.png" src="../_images/566adfe32d8eed9551fe154d3aec961864dc5ae1efb47cb39b2b4fcce351d257.png" />
</div>
</div>
</section>
<section id="nth-order">
<h4>nth order<a class="headerlink" href="#nth-order" title="Link to this heading">#</a></h4>
<p>Although it is a bit abstract, it will become conceptually and mathematically useful if we can define the general functional form of an <span class="math notranslate nohighlight">\(n^{th}\)</span> order polynomial:</p>
<div class="math notranslate nohighlight">
\[y(x) = \alpha_{n}x^{n} + \alpha_{n-1}x^{n-1} \ ... \ + \ 0.035x^4 - 0.75x^3 + 0.5x^2 + 10x + 5\]</div>
</section>
</section>
</section>
<section id="data-modelling-the-inverse-problem">
<h2>Data Modelling: The Inverse Problem<a class="headerlink" href="#data-modelling-the-inverse-problem" title="Link to this heading">#</a></h2>
<p>Above, we simply showed that given a fully-parameterized function (a model), we can then use it to predict the value of the output for any value of input supplied to that function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By “fully parameterized function,” we mean a function in which the numerical value and dimensions are known for all constants that appear in the function. These include slopes, y-intercepts, and any coefficient that appears in the model.  The argument of the function (<span class="math notranslate nohighlight">\(x\)</span> in the above illustrations) is not a parameter – it is an input that we supply to the function.</p>
</div>
<p>When we set out to analyze data, we are in the inverse position in that we do not yet have a fully parameterized model. We may not even know what type of function we should use to model our data, and we definitely do not know the values of any constant parameters that might appear in that as yet unknown function. Usually, at the start of a data analysis problem, we will only have a discrete set of observed values of our output (e.g., <span class="math notranslate nohighlight">\(y\)</span> or the price of BTC) that we have measured at various values of our input (e.g., <span class="math notranslate nohighlight">\(x\)</span> or rainfall in Myanmar). We would <em><strong>like to have</strong></em> a function (model) that tells us explicitly how our output (BTC price) changes as a function of our input (Burmese rainfall), but the key is that we have only data and we do not know the function or its parameters yet - we have to build the model by analyzing the data. <em><strong>This is the core of the inverse problem</strong></em> in data analysis.</p>
<p>Before proceeding, we should consider the difference between interpolation and extrapolation.  <em><strong>Interpolation</strong></em> is the process of inferring the value of an output, <span class="math notranslate nohighlight">\(y\)</span>, for a value of input, <span class="math notranslate nohighlight">\(x\)</span>, that we did not test; however, the untested input lies <em><strong>between</strong></em> input values that we did test (i.e., between measurements we have already made). <em><strong>Extrapolation</strong></em> is the process of forecasting the value of an output, <span class="math notranslate nohighlight">\(y\)</span>, at a value of input, <span class="math notranslate nohighlight">\(x\)</span> that we did not test <em><strong>and lies outside</strong></em> of the range of input values that we have tested. Interpolation is always safer than extrapolation, but you can see why the ability to extrapolate to input values that you haven’t measured would be useful:</p>
<p>“Wow, it has never rained 145 inches in Burma in a day before! I wonder what this will do to the price of BTC?”</p>
<p>Loosely, we will look at two possible approaches to developing a model from data. The first is to construct an “interpolating polynomial,” which we will define loosely as a function that passes exactly through each data point of interest. The second is a “regression polynomial,” which we will loosely define as a function that produces the line of best fit through all data of interest. By “best fit,” we mean the model that gives the least possible error between our measurement and our prediction of that measurement. Regardless of the approach, it is most intuitive to start by framing this problem using systems of equations. This will form a solid foundation for the more complicated topics in model fitting and parameter estimation.</p>
<section id="converting-data-into-a-system-of-equations">
<h3>Converting data into a system of equations<a class="headerlink" href="#converting-data-into-a-system-of-equations" title="Link to this heading">#</a></h3>
<p>The basic idea is that we are in a situation where we have data available to us. We can imagine sourcing this data oin many ways. For example, we could design an experiment in which we adjust values of our input, <span class="math notranslate nohighlight">\(x\)</span>, and we mesure values of the response, <span class="math notranslate nohighlight">\(y\)</span>. In some cases, we may be working with systems for which extensive data already exists through measurements made by others. In these cases, we might mine databases to find values of an output, <span class="math notranslate nohighlight">\(y\)</span>, at varying values of an input, <span class="math notranslate nohighlight">\(x\)</span>. The general conceputal idea is that we want to amass as much data as we can that would inform us about how the a value of an output of interest (e.g., the price of BTC) changes upon varying the value of an input. In the general sense, an input for this model could be anything that we expect will determine the value of our output in some way (e.g., rainfall in Myanmar).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For now, we’ll keep it simple: we will have an output of interest called <span class="math notranslate nohighlight">\(y\)</span> and a significant input <span class="math notranslate nohighlight">\(x\)</span>. In familiar terms, these would be the dependent variable, <span class="math notranslate nohighlight">\(y\)</span>, and independent variable, <span class="math notranslate nohighlight">\(x\)</span>. For reasons that may become apparent as we move forward, the minimum size set of data that we will consider is one comprised of 2 measurements (two <span class="math notranslate nohighlight">\((x,y)\)</span> pairs). The reason we are starting with 2 data points is that if we only make a single measurement, (say <span class="math notranslate nohighlight">\(y = 5\)</span> when <span class="math notranslate nohighlight">\(x = 7\)</span>), then the only valid prediction that we can is that <span class="math notranslate nohighlight">\(y = 5\)</span> when <span class="math notranslate nohighlight">\(x = 7\)</span>. There is no way for us to build additional insights about the value that <span class="math notranslate nohighlight">\(y\)</span> might take at a different value of <span class="math notranslate nohighlight">\(x\)</span>. Once we get to two measurements, we can start to build more useful models. The mathematical reason for this will become more clear once we look at the methodology.</p>
</div>
<p>We have two <span class="math notranslate nohighlight">\((x,y)\)</span> measurements. Specifically, when <span class="math notranslate nohighlight">\(x = 1\)</span>, <span class="math notranslate nohighlight">\(y = 4\)</span> and when <span class="math notranslate nohighlight">\(x = 2\)</span>, <span class="math notranslate nohighlight">\(y = 7\)</span>.  More concisely, these are two <span class="math notranslate nohighlight">\((x,y)\)</span> pairs: <span class="math notranslate nohighlight">\((1,4)\)</span> and <span class="math notranslate nohighlight">\((2,7)\)</span>.</p>
<p>Let’s put those on a scatter plot!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1"># Define x,y data sets                                                #</span>
<span class="c1">#######################################################################</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>

<span class="c1">#######################################################################</span>
<span class="c1"># Graph y vs x                                                        #</span>
<span class="c1">#######################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7b06dd059a15d51789af14e0e3ffcf439001a2025647d76918fe4b5d1529c237.png" src="../_images/7b06dd059a15d51789af14e0e3ffcf439001a2025647d76918fe4b5d1529c237.png" />
</div>
</div>
<p>Looking at the data points in the graph above, we can intuit something very fundamental about data fitting. It should be visually very clear now that if we intend to draw a straight line (a linear model!) through these two data points, there is <em><strong>exactly one line that will pass through both points</strong></em>. If, on the other hand, we want to put a curved line through them…well…there are an infinite number of quadratic, cubic, quartic, etc. functions (<span class="math notranslate nohighlight">\(2^{nd}\)</span>, <span class="math notranslate nohighlight">\(3^{rd}\)</span>, and <span class="math notranslate nohighlight">\(4^{th}\)</span> order models) that will pass exactly through both points. Conversely, if we were to attempt to draw a horizontal line (a zero order model) through both points, we find that no such line exists!</p>
<p>There is a really clear mathematical reason for this – it has to do with the system being fully determined (first order), overdetermined (zero order) or underdetermined (2nd order or higher). We can demonstrate this by using a proposed model (function) to convert our data into a system of equations. First, let’s combine our measured values with our proposal that a linear model (straight line) is an appropriate description of the relationship between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. The general equation for a line expressed with an unknown slope (m) and an unknown y-intercept (b) is:</p>
<div class="math notranslate nohighlight">
\[y(x) = mx^1+bx^0 = mx + b\]</div>
<p>With that equation in mind, we note that we have two measured <span class="math notranslate nohighlight">\((x,y)\)</span> pairs, and that these pairs can be substituted into the model function to construct a linear system of equations:</p>
<div class="amsmath math notranslate nohighlight" id="equation-1bcde9f8-2b14-41e2-a87c-a21b122eb465">
<span class="eqno">(1)<a class="headerlink" href="#equation-1bcde9f8-2b14-41e2-a87c-a21b122eb465" title="Permalink to this equation">#</a></span>\[\begin{align}
    4 = 1m+b\\
    7 = 2m+b\\
\end{align}\]</div>
<p>Now this looks like an algebra problem!! The nature of the inverse problem reveals itself – we know the values of the independent variables, <span class="math notranslate nohighlight">\(x\)</span>, and the corresponding values of the dependent variables, <span class="math notranslate nohighlight">\(y\)</span>, but <em><strong>we do not know the coefficients <span class="math notranslate nohighlight">\((m, b)\)</span> in the polynomial that describe the line</strong></em>.  The core of the inverse problem is to find these coefficients.  In this case, we have 2 equations, written in terms of 2 unknowns <span class="math notranslate nohighlight">\((m and b)\)</span>. The system of equations is fully determined, and there is one unique solution:</p>
<div class="amsmath math notranslate nohighlight" id="equation-e891df03-8e4b-4d00-84f3-74409139f988">
<span class="eqno">(2)<a class="headerlink" href="#equation-e891df03-8e4b-4d00-84f3-74409139f988" title="Permalink to this equation">#</a></span>\[\begin{align}
    m = 3\\
    b = 1\\
\end{align}\]</div>
<p>If we overlay our data on that line, we’ll find that it passes through both points exactly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###########################################################################</span>
<span class="c1"># Define (x,y) data pairs                                                 #</span>
<span class="c1">###########################################################################</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="c1">###########################################################################</span>
<span class="c1"># Define the parameterized first order model                              #</span>
<span class="c1">###########################################################################</span>

<span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">yline</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">m</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span>

<span class="c1">###########################################################################</span>
<span class="c1"># Use the first order model to graph values of y on domain x = [1, 2]     #</span>
<span class="c1">###########################################################################</span>

<span class="n">xline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">yline</span><span class="p">(</span><span class="n">xline</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4b2ff5b9b968d89041464fb957ec41c457ce6185d9d5393ea063dce20fc542ef.png" src="../_images/4b2ff5b9b968d89041464fb957ec41c457ce6185d9d5393ea063dce20fc542ef.png" />
</div>
</div>
<p>The above exercise illustrates the basic approach for constructing an “interpolating polynomial” that passes exactly through measured data and facilitates prediction of observables at points between the locations of our measurements. We have constructed a function (a line) that passes through each of point exactly. We should be able to visualize that, for the pair of data points considered here, there is one and only one line that passes exactly through each data point, and it is <span class="math notranslate nohighlight">\(y(x) = 3x + 1\)</span></p>
<p>To illustrate an overdetermined system, if we instead try propose that a zero order polynomial <span class="math notranslate nohighlight">\((y = C, \ \mathrm{where \ C \ is \ a \ constant})\)</span> could be used to describe the relationship between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, we would substitute our two <span class="math notranslate nohighlight">\((x,y)\)</span> pairs into the zero order model form to get:</p>
<div class="amsmath math notranslate nohighlight" id="equation-fd263a62-654a-4bd8-b236-fd3a346be95e">
<span class="eqno">(3)<a class="headerlink" href="#equation-fd263a62-654a-4bd8-b236-fd3a346be95e" title="Permalink to this equation">#</a></span>\[\begin{align}
    4 = C\\
    7 = C\\
\end{align}\]</div>
<p>We would conclude that there is no solution here. There is no constant, at least in normal mathematics, that simultaneously equals 4 and 7. That is to say, you need at least a first order polynomial to be able to pass through both data points.</p>
<p>To illustrate an underdetermined system, consider what happens if we try to fit a second order polynomial to this pair of data points. Recall that the general expression for a <span class="math notranslate nohighlight">\(2^{nd}\)</span> order polynomial is:</p>
<div class="math notranslate nohighlight">
\[y(x) = \alpha_2x^2 + \alpha_1x^1 + \alpha_0x^0 = \alpha_2x^2 + \alpha_1x + \alpha_0\]</div>
<p>We have two data points, so we could write two quadratic equations by substituting each <span class="math notranslate nohighlight">\((x,y)\)</span> into a quadratic function:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d2988941-9895-4786-99b1-448537ff0a55">
<span class="eqno">(4)<a class="headerlink" href="#equation-d2988941-9895-4786-99b1-448537ff0a55" title="Permalink to this equation">#</a></span>\[\begin{align}
    4 = 1\alpha_2 + 1\alpha_1 + \alpha_0\\
    7 = 4\alpha_2 + 2\alpha_1 +  \alpha_0\\
\end{align}\]</div>
<p>This system has no unique solution. There are 2 equations written in terms of 3 unknowns (<span class="math notranslate nohighlight">\(\alpha_0\)</span>, <span class="math notranslate nohighlight">\(\alpha_1\)</span>, and <span class="math notranslate nohighlight">\(\alpha_2\)</span>). The system is underdetermined (not enough constraints), and we can find an infinite number of (<span class="math notranslate nohighlight">\(\alpha_0\)</span>, <span class="math notranslate nohighlight">\(\alpha_1\)</span>, <span class="math notranslate nohighlight">\(\alpha_2\)</span>) sets that will create 2nd order polynomials that pass exactly through each point. So the corollary to the above statement about a 0 order polynomial is that there are an infinite number of 2nd order polynomials that will describe this data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These ideas generalize to larger and larger data sets. The general concept is that, when given <span class="math notranslate nohighlight">\(n+1\)</span> data points, you can fit an <span class="math notranslate nohighlight">\(n_{th}\)</span> order polynomial that passes exactly through those <span class="math notranslate nohighlight">\(n+1\)</span> data points. If your polynomial is lower order than <span class="math notranslate nohighlight">\(n\)</span>, the system is overdetermined (too many constraints), and you can’t find a unique solution. If your polynomial is higher order than <span class="math notranslate nohighlight">\(n\)</span>, the system is underdetermined (too few constraints), and you can’t find a unique solution.</p>
</div>
</section>
<section id="a-quadratic-example">
<h3>A Quadratic Example<a class="headerlink" href="#a-quadratic-example" title="Link to this heading">#</a></h3>
<p>Let’s work through a concrete illustration of the concept that you can find a unique, <span class="math notranslate nohighlight">\(n^{th}\)</span> order polynomial to pass exactly through <span class="math notranslate nohighlight">\(n+1\)</span> data points. We will consider the scenario where we have made 3 <span class="math notranslate nohighlight">\((x,y)\)</span> measurements:  (1,8), (2,4), and (3,6). Because we have 3 data points, we can find a unique, 2nd order (quadratic) polynomial that goes through each data point.</p>
<p>First, it’s always helpful to plot raw data. This provides us with an immediate sense of things like imprescision, scatter, and curvature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#########################################################################</span>
<span class="c1"># Defining the 3 (x,y) pairs comprising our data set                    #</span>
<span class="c1">#########################################################################</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="c1">#########################################################################</span>
<span class="c1"># Plotting the 3 (x,y) pairs                                            #</span>
<span class="c1">#########################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bf52e909327f174793639b4110f793002e382cc2dc57bfa40ea8b04ff0ea9b77.png" src="../_images/bf52e909327f174793639b4110f793002e382cc2dc57bfa40ea8b04ff0ea9b77.png" />
</div>
</div>
<p>If we inspect the graph above, we should be able to see that only a curved line will be able to pass through each of the 3 data points exactly–it is impossible to identify a straight line that will pass through each of these 3 data points. Let’s propose that a quadratic model can fit the data because this is the lowest order polynomial that will result in curvature. We start the same way that we did above when fitting a straight line: we use the data to make a system of quadratic equations by plugging <span class="math notranslate nohighlight">\((x,y)\)</span> pairs into the generic model for a <span class="math notranslate nohighlight">\(2^{nd}\)</span> order polynomial, i.e., <span class="math notranslate nohighlight">\(y(x) = \alpha_2x^2 + \alpha_1x^1 + \alpha_0x^0\)</span>.  Substituting our three <span class="math notranslate nohighlight">\((x,y)\)</span> pairs gives:</p>
<div class="amsmath math notranslate nohighlight" id="equation-126cf4fc-ecdf-45fb-ad8e-bc38972c89a4">
<span class="eqno">(5)<a class="headerlink" href="#equation-126cf4fc-ecdf-45fb-ad8e-bc38972c89a4" title="Permalink to this equation">#</a></span>\[\begin{align}
    8 = 1\alpha_2 + 1\alpha_1 + \alpha_0\\
    4 = 4\alpha_2 + 2\alpha_1 + \alpha_0\\
    6 = 9\alpha_2 + 3\alpha_1 + \alpha_0\\
\end{align}\]</div>
<p>Now we can see why we get a unique solution when fitting a <span class="math notranslate nohighlight">\(2^{nd}\)</span> order polynomial to <span class="math notranslate nohighlight">\(3\)</span> data points. The system of equations is fully determined–there are 3 equations and 3 unknowns (<span class="math notranslate nohighlight">\(\alpha_0\)</span>, <span class="math notranslate nohighlight">\(\alpha_1\)</span>, <span class="math notranslate nohighlight">\(\alpha_2\)</span>), so there is a unique set of (<span class="math notranslate nohighlight">\(\alpha_0\)</span>, <span class="math notranslate nohighlight">\(\alpha_1\)</span>, <span class="math notranslate nohighlight">\(\alpha_2\)</span>) values that define this data set. We find their numerical values by solving the system of equations (use whatever method you like) to get:</p>
<div class="amsmath math notranslate nohighlight" id="equation-9b726561-fc5a-4500-9761-b997bea7192c">
<span class="eqno">(6)<a class="headerlink" href="#equation-9b726561-fc5a-4500-9761-b997bea7192c" title="Permalink to this equation">#</a></span>\[\begin{align}
    \alpha_2 &amp;= 3\\
    \alpha_1 &amp;= -13\\
    \alpha_0 &amp;= 18\\
\end{align}\]</div>
<p>Below, we will overlay this polynomial with the original data set. Doing so, it is clear that the line passes exactly through each data point and <em>infers</em> the values of y between the measured data points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">############################################################################################</span>
<span class="c1"># Define model parameters, i.e., coefficients of the polynomial                            #</span>
<span class="c1">############################################################################################</span>

<span class="n">α2</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">α1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">13</span>
<span class="n">α0</span> <span class="o">=</span> <span class="mi">18</span>

<span class="c1">############################################################################################</span>
<span class="c1"># Define the second order polynomial function of x                                         #</span>
<span class="c1">############################################################################################</span>

<span class="n">yline</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">α2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">α1</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">α0</span>

<span class="c1">############################################################################################</span>
<span class="c1"># graph y(x) and 3 (x,y) pairs                                                             #</span>
<span class="c1">############################################################################################</span>

<span class="n">xline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">yline</span><span class="p">(</span><span class="n">xline</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9fe1c17f372f0f717df200040ffb1954eee818ccf4b9f9ad0abf8ace19654309.png" src="../_images/9fe1c17f372f0f717df200040ffb1954eee818ccf4b9f9ad0abf8ace19654309.png" />
</div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The above visualization should reinforce a few general concepts:</p>
<ol class="arabic simple">
<li><p>We have <span class="math notranslate nohighlight">\((n+1) = 3\)</span> data points available. This means that <span class="math notranslate nohighlight">\(n = 2\)</span>.</p></li>
<li><p>We cannot find any first <span class="math notranslate nohighlight">\((n-1)\)</span> order model that will pass through all three <span class="math notranslate nohighlight">\((n+1)\)</span> data points.</p></li>
<li><p>We can find a single second <span class="math notranslate nohighlight">\((n)\)</span> order polynomial that will pass through all three <span class="math notranslate nohighlight">\((n+1)\)</span> data points.</p></li>
<li><p>We can find an infinite number of third <span class="math notranslate nohighlight">\((n+1)\)</span> order or higher order polynomials that will pass through all three <span class="math notranslate nohighlight">\((n+1)\)</span> data points.</p></li>
<li><p>Only the quadratic <span class="math notranslate nohighlight">\(n^{th}\)</span> order is “just right” because the quadratic system of equations is fully determined.</p></li>
</ol>
<p>These are useful concepts, and the easiest way to generalize them to higher order systems (and minimize the tedium in solving algebraic equations on your part) is to take advantage of linear algebra.</p>
</div>
</section>
</section>
<section id="a-matrix-vector-representation-of-the-inverse-problem">
<h2>A Matrix/Vector representation of the Inverse Problem<a class="headerlink" href="#a-matrix-vector-representation-of-the-inverse-problem" title="Link to this heading">#</a></h2>
<p>Going back to the case of two <span class="math notranslate nohighlight">\((x,y)\)</span> pairs, <span class="math notranslate nohighlight">\((1,4)\)</span> and <span class="math notranslate nohighlight">\((2,7)\)</span>. Recall that we were able to find first order model <span class="math notranslate nohighlight">\(y(x) = mx+b\)</span> that passes through each <span class="math notranslate nohighlight">\((x,y)\)</span> pair. In doing so, we wrote the following two equations.</p>
<div class="amsmath math notranslate nohighlight" id="equation-fc93da64-76d3-4679-818b-9e78d59dc232">
<span class="eqno">(7)<a class="headerlink" href="#equation-fc93da64-76d3-4679-818b-9e78d59dc232" title="Permalink to this equation">#</a></span>\[\begin{align}
    4 = 1m+b\\
    7 = 2m+b\\
\end{align}\]</div>
<p>To support abstraction to higher order polynomials, we will now the coefficients formerly known as “m = slope” and “b = intercept” with <span class="math notranslate nohighlight">\(\alpha_i\)</span> values. Each <span class="math notranslate nohighlight">\(\alpha_i\)</span> is a constant-valued coefficient, and the subscript <span class="math notranslate nohighlight">\(i\)</span> represents the order of <span class="math notranslate nohighlight">\(x\)</span> that particular <span class="math notranslate nohighlight">\(\alpha\)</span> is multiplied by in the polynomial.</p>
<div class="amsmath math notranslate nohighlight" id="equation-f7b89f27-1aa1-4ee9-9156-ff00ded07b9b">
<span class="eqno">(8)<a class="headerlink" href="#equation-f7b89f27-1aa1-4ee9-9156-ff00ded07b9b" title="Permalink to this equation">#</a></span>\[\begin{align}
    4 = 1\alpha_1 + \alpha_0\\
    7 = 2\alpha_1 + \alpha_0\\
\end{align}\]</div>
<p>Let’s also rearrange the equations to be consistent with typical left hand side/right hand side notation for interpolation and regression problems:</p>
<div class="amsmath math notranslate nohighlight" id="equation-adb6790a-a3dd-4302-bb89-c0a3bd1108fa">
<span class="eqno">(9)<a class="headerlink" href="#equation-adb6790a-a3dd-4302-bb89-c0a3bd1108fa" title="Permalink to this equation">#</a></span>\[\begin{align}
    1\alpha_1 + 1\alpha_0 = 4\\
    2\alpha_1 + 1\alpha_0 = 7\\
\end{align}\]</div>
<p>We see this is nothing more than a system of equations that are all linear with respect to the coefficients. This is to say that, no matter the order on <span class="math notranslate nohighlight">\(x\)</span>, each of the <span class="math notranslate nohighlight">\(\alpha\)</span>’s has an exponent of 1. Realizing this, we can re-write this system of equations in Matrix/Vector notation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix} 1 &amp; 1 \\ 2 &amp; 1 \\ \end{bmatrix} \times 
\begin{bmatrix} \alpha_1 \\ \alpha_0 \end{bmatrix} = 
\begin{bmatrix} 4 \\ 7 \end{bmatrix}\end{split}\]</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We’ve all taken linear algebra before, but maybe it has been a minute. Here’s a refresher: the above equation involves matrix multiplication. In matrix multiplication, we work row by column. We multiply each element in row <span class="math notranslate nohighlight">\(i\)</span> by each element in column <span class="math notranslate nohighlight">\(j\)</span>, and we sum the array of values generated. The sum of this array is the <span class="math notranslate nohighlight">\([i,j]\)</span> element in the resultant product matrix.</p>
</div>
<p>Breaking down these terms, we should see that the matrix on the left corresponds to the value of <span class="math notranslate nohighlight">\(x\)</span> that is multiplied by each value of <span class="math notranslate nohighlight">\(\alpha\)</span>. We should notice that, technically, <span class="math notranslate nohighlight">\(\alpha_0\)</span> multiplies by <span class="math notranslate nohighlight">\(x^0\)</span>, but we usually call <span class="math notranslate nohighlight">\(x^0\)</span> 1 for simplicity. In the first row, we have values of <span class="math notranslate nohighlight">\(x_1\)</span>, which is the <span class="math notranslate nohighlight">\(x\)</span> in our first <span class="math notranslate nohighlight">\((x,y)\)</span> pair <span class="math notranslate nohighlight">\((1,4)\)</span>.  In the second row, we have values of <span class="math notranslate nohighlight">\(x_2\)</span>, which is the <span class="math notranslate nohighlight">\(x\)</span> in our second <span class="math notranslate nohighlight">\((x,y)\)</span> pair <span class="math notranslate nohighlight">\((2,7)\)</span>. If we multiply these <span class="math notranslate nohighlight">\(x\)</span> values by the coefficients as shown above, it gives us the values of <span class="math notranslate nohighlight">\(y_1\)</span> in the first row and <span class="math notranslate nohighlight">\(y_2\)</span> in the second row.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix} x_1^1 &amp; x_1^0 \\ x_2^1 &amp; x_2^0 \\ \end{bmatrix} \times 
\begin{bmatrix} \alpha_1 \\ \alpha_0 \end{bmatrix} = 
\begin{bmatrix} y_1 \\ y_2 \end{bmatrix}\end{split}\]</div>
<p>Usually, you’ll see this matrix equation in the shorthand:</p>
<div class="math notranslate nohighlight">
\[XA = Y\]</div>
<p>Where <span class="math notranslate nohighlight">\(X\)</span> is a matrix of input values raised to orders that appear in the model, <span class="math notranslate nohighlight">\(A\)</span> is a vector of coefficients that describe the specific behavior of the polynomial, and <span class="math notranslate nohighlight">\(Y\)</span> is a vector of measured outputs at each value of the input. Since we have measured values of X and Y, then <span class="math notranslate nohighlight">\(A\)</span> contains all of the unknowns (coefficients) in this system. This is where we leverage linear algebra to do the heavy lifting of solving for an interpolating polynomial. If this were a standard algebraic equation, we would solve for <span class="math notranslate nohighlight">\(A\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[A = Y/X\]</div>
<p>Matrices behave differently. Instead of the intuitive division operator, we don’t perform Matrix division per se. We multiply by the Matrix Inverse. It is helpful to to visualize this as solving for the unknown coefficient array, <span class="math notranslate nohighlight">\(A\)</span>, by multiplying both sides of our equation by the inverse of the <span class="math notranslate nohighlight">\(X\)</span> matrix in a series of steps:</p>
<div class="amsmath math notranslate nohighlight" id="equation-e5f9f7cd-b261-4b38-bef3-5c938d0e3f9f">
<span class="eqno">(10)<a class="headerlink" href="#equation-e5f9f7cd-b261-4b38-bef3-5c938d0e3f9f" title="Permalink to this equation">#</a></span>\[\begin{align}
    XA &amp;= Y\\
    X^{-1}XA &amp;= X^{-1}Y\\
    IA &amp;= X^{-1}Y\\
    A &amp;= X^{-1}Y\\
\end{align}\]</div>
<p>This is the Matrix equivalent of dividing both sides of the equation by <span class="math notranslate nohighlight">\(X\)</span>. In these equations, <span class="math notranslate nohighlight">\(I\)</span> is the identity matrix, which is the Matrix analog of the number 1 in that when we multiply <span class="math notranslate nohighlight">\(I\)</span> by a matrix or Vector, it returns the value of that Matrix or Vector unchanged, so we drop the <span class="math notranslate nohighlight">\(I\)</span> in the final line. Formally:</p>
<div class="math notranslate nohighlight">
\[\begin{split}IA = \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \\ \end{bmatrix} \times 
\begin{bmatrix} \alpha_1 \\ \alpha_0 \\ \end{bmatrix} = 
\begin{bmatrix} \alpha_1 \\ \alpha_0 \\ \end{bmatrix} = 
A\end{split}\]</div>
<p>We will apply this method in the cell below. We will create an <span class="math notranslate nohighlight">\(X\)</span> matrix and a <span class="math notranslate nohighlight">\(Y\)</span> vector, and then we will solve for <span class="math notranslate nohighlight">\(A\)</span> using a matrix inversion. Ultimately, we will find the exact same values of <span class="math notranslate nohighlight">\(\alpha_0\)</span> (intercept) and <span class="math notranslate nohighlight">\(\alpha_1\)</span> (slope) that we got above. This is just a more succinct operation; moreover, the approach is easily generalized to higher order models.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Instead of actually performing a full matrix inversion as suggested by the equations above, it is more efficient to use routines built into our programming language when we solve linear systems of equations. Matrix inversions are computationally expensive, and, at least historically, this was a concern in writing efficient code. Most languages have more efficient algorithms in place that avoid full matrix inversion.</p>
<p>For example, Matlab and Julia use a “left divide operator” for solving matrix equations.</p>
<div class="math notranslate nohighlight">
\[A = X \ \backslash \ Y\]</div>
<p>In Python, we use a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> feature, specifically <code class="docutils literal notranslate"><span class="pre">numpyp.linalg.solve(X,</span> <span class="pre">Y)</span></code></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######################################################################</span>
<span class="c1"># Create the X matrix; it contains all independent variable values   #</span>
<span class="c1"># Each value appears raised to orders specified by the polynomial    #</span>
<span class="c1">######################################################################</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">######################################################################</span>
<span class="c1"># Create the Y array; these are our observations/measurements        #</span>
<span class="c1">######################################################################</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">######################################################################</span>
<span class="c1"># Solve for A; A = X^-1*Y                                            #</span>
<span class="c1">######################################################################</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">α1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">α0</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;α1 = </span><span class="si">{</span><span class="n">α1</span><span class="si">:</span><span class="s1">n</span><span class="si">}</span><span class="s1"> and α0 = </span><span class="si">{</span><span class="n">α0</span><span class="si">:</span><span class="s1">n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1 1]
 [2 1]] 

[4 7] 

[3. 1.]
α1 = 3 and α0 = 1
</pre></div>
</div>
</div>
</div>
<section id="matrix-representation-of-the-2nd-order-problem">
<h3>Matrix representation of the 2nd order problem<a class="headerlink" href="#matrix-representation-of-the-2nd-order-problem" title="Link to this heading">#</a></h3>
<p>Matrix representation become much more useful when we got to higher order polynomials, where the size of the system is large and the algebra is tedious. Let’s see if we can begin to generalize the result by applying the approach to the second order example involving 3 <span class="math notranslate nohighlight">\((x,y)\)</span> pairs. Recall: we are trying to fit a second (<span class="math notranslate nohighlight">\(n_{th}\)</span> order) polynomial to 3 <span class="math notranslate nohighlight">\((n+1) data points (\)</span>n+1$ data points): (1,8), (2,4), and (3,6)</p>
<p>We can substitute <span class="math notranslate nohighlight">\((x,y)\)</span> pairs into a general quadtratic expression to generate the following system of equations:</p>
<div class="amsmath math notranslate nohighlight" id="equation-3c3a90e2-2012-4263-a26c-e82953f6e4db">
<span class="eqno">(11)<a class="headerlink" href="#equation-3c3a90e2-2012-4263-a26c-e82953f6e4db" title="Permalink to this equation">#</a></span>\[\begin{align}
    8 = \alpha_0 + 1\alpha_1 + 1\alpha_2\\
    4 = \alpha_0 + 2\alpha_1 + 4\alpha_2\\
    6 = \alpha_0 + 3\alpha_1 + 9\alpha_2\\
\end{align}\]</div>
<p>Which we can then put into the matrix form we developed in the previous cell:</p>
<div class="amsmath math notranslate nohighlight" id="equation-737a4664-4e2d-414a-897f-4c71547b07f5">
<span class="eqno">(12)<a class="headerlink" href="#equation-737a4664-4e2d-414a-897f-4c71547b07f5" title="Permalink to this equation">#</a></span>\[\begin{align}
    1\alpha_2 + 1\alpha_1 + 1\alpha_0 = 8\\
    4\alpha_2 + 2\alpha_1 + 1\alpha_0 = 4\\
    9\alpha_2 + 3\alpha_1 + 1\alpha_0 = 6\\
\end{align}\]</div>
<p>And then:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix} 1 &amp; 1 &amp; 1 \\ 4 &amp; 2 &amp; 1 \\ 9 &amp; 3 &amp; 1 \end{bmatrix} \times 
\begin{bmatrix} \alpha_2 \\ \alpha_1 \\ \alpha_0 \\ \end{bmatrix} = 
\begin{bmatrix} 8 \\ 4 \\ 6 \\ \end{bmatrix}\end{split}\]</div>
<p>It is important to realize that the above is just numbers, <span class="math notranslate nohighlight">\((x,y)\)</span> paris, plugged into the more general form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix} x_1^2 &amp; x_1^1 &amp; x_1^0 \\ x_2^2 &amp; x_2^1 &amp; x_2^0 \\ x_3^2 &amp; x_3^1 &amp; x_3^0 \\ \end{bmatrix} \times 
\begin{bmatrix} \alpha_2 \\ \alpha_1 \\ \alpha_0 \\ \end{bmatrix} = 
\begin{bmatrix} y_1 \\ y_2 \\ y_3 \\ \end{bmatrix}\end{split}\]</div>
<p>And so, we again arrive at:</p>
<div class="math notranslate nohighlight">
\[XA = Y\]</div>
<p>We can solve this by matrix inversion to find all unknown coefficients, which we recall should be <span class="math notranslate nohighlight">\((-18, 13, 3)\)</span></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>A key insight is that, although our models are nonlinear in <span class="math notranslate nohighlight">\(x\)</span>, all of our <span class="math notranslate nohighlight">\(x\)</span> values are known. We are solving for coefficients, <span class="math notranslate nohighlight">\(\alpha\)</span>, and the equations that we generate in during polynomial interpolation and regression are <strong>always</strong> linear in the coefficients. This means that we can always use matrix methods to solve for unknown coefficients when we construct interpolating polynomials or regression polynomials.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######################################################################</span>
<span class="c1"># Create the X matrix; it contains all independent variable values   #</span>
<span class="c1"># Each value appears raised to orders specified by the polynomial    #</span>
<span class="c1">######################################################################</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">######################################################################</span>
<span class="c1"># Create the Y array; these are our observations/measurements        #</span>
<span class="c1">######################################################################</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">######################################################################</span>
<span class="c1"># Solve for A; A = X^-1*Y                                            #</span>
<span class="c1">######################################################################</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">α2</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">α1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">α0</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;α2 = </span><span class="si">{</span><span class="n">α2</span><span class="si">:</span><span class="s1">n</span><span class="si">}</span><span class="s1">, α1 = </span><span class="si">{</span><span class="n">α1</span><span class="si">:</span><span class="s1">n</span><span class="si">}</span><span class="s1">, and α0 = </span><span class="si">{</span><span class="n">α0</span><span class="si">:</span><span class="s1">n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1 1 1]
 [4 2 1]
 [9 3 1]] 

[8 4 6] 

[  3. -13.  18.]
α2 = 3, α1 = -13, and α0 = 18
</pre></div>
</div>
</div>
</div>
</section>
<section id="general-matrix-representation-of-higher-order-models">
<span id="general-representation"></span><h3>General Matrix Representation of higher order models<a class="headerlink" href="#general-matrix-representation-of-higher-order-models" title="Link to this heading">#</a></h3>
<p>These methods and concepts are pretty awesome because they are <em><strong>completely</strong></em> general. We have considerable flexibility in constructing models to match our data. For any polynomial model, no matter how nonlinear it is, the problem is always linear in coefficients, so we can use matrix inversion to solve for their values. We can do this for any <span class="math notranslate nohighlight">\(n_{th}\)</span> order polynomial I wish:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix} x_1^{n} &amp; x_1^{n-1} &amp; \cdots &amp; x_1^3 &amp; x_1^2 &amp;  x_1^1 &amp; x_1^0 \\ x_2^{n} &amp; x_2^{n-1} &amp; \cdots &amp; x_2^3 &amp; x_2^2 &amp;  x_2^1 &amp; x_2^0 \\ x_3^{n} &amp; x_3^{n-1} &amp; \cdots &amp; x_3^3 &amp; x_3^2 &amp;  x_3^1 &amp; x_3^0 \\ \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\ x_{n}^{n} &amp; x_{n}^{n-1} &amp; \cdots &amp; x_{n}^3 &amp; x_{n}^2 &amp;  x_{n}^1 &amp; x_{n}^0 \\ x_{n+1}^{n} &amp; x_{n+1}^{n-1} &amp; \cdots &amp; x_{n+1}^3 &amp; x_{n+1}^2 &amp;  x_{n+1}^1 &amp; x_{n+1}^0 \end{bmatrix} \times 
\begin{bmatrix} \alpha_n \\ \alpha_{n-1} \\ \vdots \\ \alpha_3 \\ \alpha_2 \\ \alpha_1 \\ \alpha_0 \\ \end{bmatrix} = 
\begin{bmatrix} y_1 \\ y_2 \\ y_3 \\ \vdots \\ y_{n} \\ y_{n+1} \end{bmatrix}\end{split}\]</div>
<p>It looks complicated, but realize that it is an expression for a generic, <span class="math notranslate nohighlight">\(n^{th}\)</span> order polynomial fit to <span class="math notranslate nohighlight">\(n+1\)</span> <span class="math notranslate nohighlight">\((x,y)\)</span> pairs. And again: no matter how nonlinear my model is in <em><strong><span class="math notranslate nohighlight">\(X\)</span></strong></em>, we are solving the inverse problem of trying to find coefficients from known values of X and Y.  The problem is <em><strong>always linear in the coefficients, so we can use matrix methods</strong></em>. The most tedious part of these problems is generating the <span class="math notranslate nohighlight">\(X\)</span> matrix from your input values. It is not too bad if you have good support for vectorized operations in your programming language.  For example, let’s say we want to fit a 10th order polynomial to 11 <span class="math notranslate nohighlight">\((x,y)\)</span> pairs that I’m going to generate randomly.  We’ll walk through the way you’d construct the <span class="math notranslate nohighlight">\(X\)</span> matrix and <span class="math notranslate nohighlight">\(Y\)</span> vector from this data. Once you do that, we will see that solving the problem for 11 data points (and a 10th order polynomial) is just a matrix inversion as usual.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When we construct an interpolating polynomial using these methods, the <span class="math notranslate nohighlight">\(X\)</span> matrix will always be square.  The number of rows/columns will be equal to the number of data points or measurements that we have available.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#########################################################################################################################</span>
<span class="c1"># set the seed for randon number generation; this ensures we get the same &quot;random&quot; number set each time we run the cell #</span>
<span class="c1">#########################################################################################################################</span>
 
<span class="n">rng</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>

<span class="c1">#########################################################################################################################</span>
<span class="c1"># Generate 11 random x values and 11 random y values; print the results to screen                                       #</span>
<span class="c1">#########################################################################################################################</span>

<span class="n">xdata</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ydata</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">#########################################################################################################################</span>
<span class="c1"># Graph the 11 random (x,y) pairs on a scatterplot                                                                      #</span>
<span class="c1">#########################################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.22733602 0.31675834 0.79736546 0.67625467 0.39110955 0.33281393
 0.59830875 0.18673419 0.67275604 0.94180287 0.24824571] 

[0.94888115 0.66723745 0.09589794 0.44183967 0.88647992 0.6974535
 0.32647286 0.73392816 0.22013496 0.08159457 0.1598956 ] 
</pre></div>
</div>
<img alt="../_images/4c1fbcafc46057bae90a71319f178706eccc5a5c3770f91931466615a763a47e.png" src="../_images/4c1fbcafc46057bae90a71319f178706eccc5a5c3770f91931466615a763a47e.png" />
</div>
</div>
<section id="fitting-the-data">
<h4>Fitting the data<a class="headerlink" href="#fitting-the-data" title="Link to this heading">#</a></h4>
<p>Our data set is comprised of 11 <span class="math notranslate nohighlight">\((x,y)\)</span> pairs. We have 11 <span class="math notranslate nohighlight">\((n+1)\)</span> data points. This means that we can find one unique <span class="math notranslate nohighlight">\(10^{th}\)</span> order polynomial that passes through each of the 11 data points exactly.</p>
<section id="creating-the-x-matrix">
<h5>Creating the X matrix<a class="headerlink" href="#creating-the-x-matrix" title="Link to this heading">#</a></h5>
<p>Let’s create that <span class="math notranslate nohighlight">\(X\)</span> matrix representation of a 10th order polynomial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">####################################################################################################################</span>
<span class="c1"># Manual generation of the X matrix from xdata; each column corresponds to a specific power of x in the polynomial #</span>
<span class="c1">####################################################################################################################</span>

<span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="n">X1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xdata</span><span class="o">**</span><span class="mi">10</span>
<span class="n">X1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xdata</span><span class="o">**</span><span class="mi">9</span>
<span class="n">X1</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xdata</span><span class="o">**</span><span class="mi">8</span>
<span class="n">X1</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xdata</span><span class="o">**</span><span class="mi">7</span>
<span class="n">X1</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xdata</span><span class="o">**</span><span class="mi">6</span>
<span class="n">X1</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xdata</span><span class="o">**</span><span class="mi">5</span>
<span class="n">X1</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xdata</span><span class="o">**</span><span class="mi">4</span>
<span class="n">X1</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xdata</span><span class="o">**</span><span class="mi">3</span>
<span class="n">X1</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xdata</span><span class="o">**</span><span class="mi">2</span>
<span class="n">X1</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xdata</span>

<span class="c1">####################################################################################################################</span>
<span class="c1"># The lines below display the the result of each value in xdata raised to a specified power                        # </span>
<span class="c1"># These should be compared with the columns in the X matrix.                                                       # </span>
<span class="c1"># You should be able to identify columns that correspond to each power                                             #</span>
<span class="c1">####################################################################################################################</span>

<span class="n">power</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xdata</span><span class="o">**</span><span class="n">power</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xdata</span><span class="p">),</span><span class="mi">1</span><span class="p">)),</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]] 

[[0.   0.   0.   0.   0.   0.   0.   0.01 0.05 0.23 1.  ]
 [0.   0.   0.   0.   0.   0.   0.01 0.03 0.1  0.32 1.  ]
 [0.1  0.13 0.16 0.2  0.26 0.32 0.4  0.51 0.64 0.8  1.  ]
 [0.02 0.03 0.04 0.06 0.1  0.14 0.21 0.31 0.46 0.68 1.  ]
 [0.   0.   0.   0.   0.   0.01 0.02 0.06 0.15 0.39 1.  ]
 [0.   0.   0.   0.   0.   0.   0.01 0.04 0.11 0.33 1.  ]
 [0.01 0.01 0.02 0.03 0.05 0.08 0.13 0.21 0.36 0.6  1.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.01 0.03 0.19 1.  ]
 [0.02 0.03 0.04 0.06 0.09 0.14 0.2  0.3  0.45 0.67 1.  ]
 [0.55 0.58 0.62 0.66 0.7  0.74 0.79 0.84 0.89 0.94 1.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.02 0.06 0.25 1.  ]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="constructing-the-y-array">
<h5>Constructing the Y array<a class="headerlink" href="#constructing-the-y-array" title="Link to this heading">#</a></h5>
<p>We can also create the <span class="math notranslate nohighlight">\(Y\)</span> array – this is simply the array of observed values <span class="math notranslate nohighlight">\((y)\)</span> from our data set.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The order of the data is important – we need to remember that each value of our observable, measured quantity <span class="math notranslate nohighlight">\(&quot;y&quot;\)</span> is always observed at a correponding value of our input variable <span class="math notranslate nohighlight">\(&quot;x&quot;\)</span>. For this reason, the first row in our <span class="math notranslate nohighlight">\(X\)</span> array corresponds to the first value of <span class="math notranslate nohighlight">\(x\)</span> in our data set; the second row in our <span class="math notranslate nohighlight">\(X\)</span> array corresponds to the second value of <span class="math notranslate nohighlight">\(x\)</span> in our data set; and so on until we reach the <span class="math notranslate nohighlight">\(11^{th}\)</span> row, which corresponds to the <span class="math notranslate nohighlight">\(11^{th}\)</span> value of <span class="math notranslate nohighlight">\(x\)</span> in our data set. The entries in the <span class="math notranslate nohighlight">\(Y\)</span> array follow the same order – the first element is the value of <span class="math notranslate nohighlight">\(y\)</span> observed at the first value of <span class="math notranslate nohighlight">\(x\)</span>, the second element in <span class="math notranslate nohighlight">\(Y\)</span> is the value of <span class="math notranslate nohighlight">\(y\)</span> observed at the second value of <span class="math notranslate nohighlight">\(x\)</span>, and so on until we reach the <span class="math notranslate nohighlight">\(11^{th}\)</span> element in <span class="math notranslate nohighlight">\(Y\)</span> which is the value of <span class="math notranslate nohighlight">\(y\)</span> observed at the <span class="math notranslate nohighlight">\(11^{th}\)</span> value of <span class="math notranslate nohighlight">\(x\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1"># Y is the array of our measured or observed values                            #</span>
<span class="c1">################################################################################</span>

<span class="n">Y1</span> <span class="o">=</span> <span class="n">ydata</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.94888115 0.66723745 0.09589794 0.44183967 0.88647992 0.6974535
 0.32647286 0.73392816 0.22013496 0.08159457 0.1598956 ]
</pre></div>
</div>
</div>
</div>
</section>
<section id="solving-for-the-unknown-coefficients">
<h5>Solving for the unknown coefficients<a class="headerlink" href="#solving-for-the-unknown-coefficients" title="Link to this heading">#</a></h5>
<p>Now, solve for A using <code class="docutils literal notranslate"><span class="pre">np.linalg.solve()</span></code>; this will give us the 11 coefficients needed to describe a 10th order polynomial</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">Y1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1.90239510e+07  1.01073201e+08 -2.35197349e+08  3.15169115e+08
 -2.68926703e+08  1.52477761e+08 -5.81160612e+07  1.46917321e+07
 -2.35630364e+06  2.16419264e+05 -8.64128002e+03]
</pre></div>
</div>
</div>
</div>
</section>
<section id="constructing-the-interpolating-polynomial">
<h5>Constructing the interpolating polynomial<a class="headerlink" href="#constructing-the-interpolating-polynomial" title="Link to this heading">#</a></h5>
<p>Now, let’s use those coefficients to create a polynomial of 10th order that can accept vector arguments. We will do this by defining a lambda function. Once we build the function, we will pass a 100 element set of <span class="math notranslate nohighlight">\(x\)</span> values to create a smooth line between <span class="math notranslate nohighlight">\(x = 0\)</span> and <span class="math notranslate nohighlight">\(x = 1\)</span>. We will see that this line passes exactly through each of the 11 data points! We will make no comment yet as to what the line does between those measured points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################################################################</span>
<span class="c1"># Construct a 10th order polynomial using the coefficients that we solved for above               #</span>
<span class="c1">###################################################################################################</span>

<span class="n">yline</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">10</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">9</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">8</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">7</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">6</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>

<span class="c1">###################################################################################################</span>
<span class="c1"># Graph discrete (x,y) pairs from data set; overlay plot of continuous 10th order polynomial      #</span>
<span class="c1">###################################################################################################</span>

<span class="n">xline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">xdata</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xdata</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">yline</span><span class="p">(</span><span class="n">xline</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f54c1fb22f07a68985a6322f0418c43a15ebcc09ece86018ee5a856de8c79445.png" src="../_images/f54c1fb22f07a68985a6322f0418c43a15ebcc09ece86018ee5a856de8c79445.png" />
</div>
</div>
</section>
<section id="now-pump-the-brakes">
<h5>Now pump the brakes…<a class="headerlink" href="#now-pump-the-brakes" title="Link to this heading">#</a></h5>
<p>Let’s zoom out a bit and plot our data and the polynomial overlay on a larger y axis. As we do this, remember: the intent of this interpolating function that we have just constructed is that it is <em><strong>supposed to</strong></em> precisely describe the behavior of <span class="math notranslate nohighlight">\(y\)</span> as a function of <span class="math notranslate nohighlight">\(x\)</span> so that we can use it to predict values of <span class="math notranslate nohighlight">\(y\)</span> at values of <span class="math notranslate nohighlight">\(x\)</span> between the points we have measured.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################################</span>
<span class="c1"># Graphing function behavior on larger y limits; do we believe the predictions?                #</span>
<span class="c1">################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">yline</span><span class="p">(</span><span class="n">xline</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fdd08655160cf72d840917bb64567f82300223afb9cf54a42f690fb133071cad.png" src="../_images/fdd08655160cf72d840917bb64567f82300223afb9cf54a42f690fb133071cad.png" />
</div>
</div>
<p>This doesn’t inspire confidence. There is no reason to believe the y data should follow the behavior suggested by the dashed line in between the measured values. We should note that all of our measured <span class="math notranslate nohighlight">\(y\)</span> values were between 0 and 1. Without some insight to the contrary, it does not make sense that we would measure y <span class="math notranslate nohighlight">\(\approx\)</span> 5 at x <span class="math notranslate nohighlight">\(\approx\)</span> 0.5, or y <span class="math notranslate nohighlight">\(\approx\)</span> 30 at x <span class="math notranslate nohighlight">\(\approx\)</span> 0.9. This is a red flag in data fitting…</p>
<p>What has happened is that we have over-fit the available data, and our model is capturing the “wiggles” (noise, imprecision) in the data with a mathematically rigorous equation. The problem is that we have used such a high order polynomial here y values are going to be extremely sensitive to small changes in the input value of <span class="math notranslate nohighlight">\(x\)</span>. Further, our model will have considerable curvature, and we may see that the function changes “direction” (i.e., does y increase a function of x or decrease as a function of x?) numerous times within the x-domain that we’ve considered. The upshot is that it is very likely that this model will predict physically nonsensical values of <span class="math notranslate nohighlight">\(y\)</span> at any value of <span class="math notranslate nohighlight">\(x\)</span> that we did not (1) explicitly measure and (2) include in the data fitting exercise where we created the interpolating polynomial. Another danger associated with high order polynomials–they have limited predictive power outside of the range where we fit them.  All polynomials go to <span class="math notranslate nohighlight">\(\pm \infty\)</span> as the function arguments go to <span class="math notranslate nohighlight">\(\pm \infty\)</span>.  This actually happens really quickly for high order polynomials (see below for what happens when we try to use the model to predict what happens to y on the domain <span class="math notranslate nohighlight">\(x = (-2, 3)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#################################################################################################################</span>
<span class="c1"># Graphing function behavior on larger x and y limits; all polynomials go to +/- ∞ eventually. Does your data?  #</span>
<span class="c1">#################################################################################################################</span>

<span class="n">xline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">yline</span><span class="p">(</span><span class="n">xline</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8cbda96b78bd481e61f29593b9541c0ea44b8f2257c1488f64e8dd24afc20e73.png" src="../_images/8cbda96b78bd481e61f29593b9541c0ea44b8f2257c1488f64e8dd24afc20e73.png" />
</div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The take home message is that we should be careful not to overfit data. Just because we have 11 data points, it isn’t necessarily a good idea to fit a maximum order polynomial to them.  Also, we have to remember that these polynomials only describe what happens inside the limits where we have collected data.  Extrapolation beyond ranges where we’ve collected data is risky, and it is especially risky when we use complex, highly nonlinear models to describe the data.</p>
</div>
<figure class="align-default" id="ianmalcolm">
<a class="reference internal image-reference" href="../_images/ian-malcom-jurassic-park.gif"><img alt="../_images/ian-malcom-jurassic-park.gif" src="../_images/ian-malcom-jurassic-park.gif" style="width: 498.0px; height: 304.0px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Jurassic Park</span><a class="headerlink" href="#ianmalcolm" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
</section>
</section>
<section id="let-s-call-a-vandermonde-matrix-a-vandermonde-matrix">
<h2>Let’s call a Vandermonde Matrix a Vandermonde Matrix<a class="headerlink" href="#let-s-call-a-vandermonde-matrix-a-vandermonde-matrix" title="Link to this heading">#</a></h2>
<p>The “X” matrix we used above is something that is used so frequently in data fitting that it is a well-known concept. It is called the Vandermonde matrix, and most programming languages include algorithms to facilitate construction of Vandermonde matrices. In Python, we can use <code class="docutils literal notranslate"><span class="pre">numpy.vander()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##########################################################################################</span>
<span class="c1"># Constructing the X matrix using numpy.vander(); compare to manually generated X matrix #</span>
<span class="c1">##########################################################################################</span>

<span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.   0.   0.   0.   0.   0.   0.   0.01 0.05 0.23 1.  ]
 [0.   0.   0.   0.   0.   0.   0.01 0.03 0.1  0.32 1.  ]
 [0.1  0.13 0.16 0.2  0.26 0.32 0.4  0.51 0.64 0.8  1.  ]
 [0.02 0.03 0.04 0.06 0.1  0.14 0.21 0.31 0.46 0.68 1.  ]
 [0.   0.   0.   0.   0.   0.01 0.02 0.06 0.15 0.39 1.  ]
 [0.   0.   0.   0.   0.   0.   0.01 0.04 0.11 0.33 1.  ]
 [0.01 0.01 0.02 0.03 0.05 0.08 0.13 0.21 0.36 0.6  1.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.01 0.03 0.19 1.  ]
 [0.02 0.03 0.04 0.06 0.09 0.14 0.2  0.3  0.45 0.67 1.  ]
 [0.55 0.58 0.62 0.66 0.7  0.74 0.79 0.84 0.89 0.94 1.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.02 0.06 0.25 1.  ]] 

[[0.   0.   0.   0.   0.   0.   0.   0.01 0.05 0.23 1.  ]
 [0.   0.   0.   0.   0.   0.   0.01 0.03 0.1  0.32 1.  ]
 [0.1  0.13 0.16 0.2  0.26 0.32 0.4  0.51 0.64 0.8  1.  ]
 [0.02 0.03 0.04 0.06 0.1  0.14 0.21 0.31 0.46 0.68 1.  ]
 [0.   0.   0.   0.   0.   0.01 0.02 0.06 0.15 0.39 1.  ]
 [0.   0.   0.   0.   0.   0.   0.01 0.04 0.11 0.33 1.  ]
 [0.01 0.01 0.02 0.03 0.05 0.08 0.13 0.21 0.36 0.6  1.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.01 0.03 0.19 1.  ]
 [0.02 0.03 0.04 0.06 0.09 0.14 0.2  0.3  0.45 0.67 1.  ]
 [0.55 0.58 0.62 0.66 0.7  0.74 0.79 0.84 0.89 0.94 1.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.02 0.06 0.25 1.  ]] 

(11, 11)
</pre></div>
</div>
</div>
</div>
</section>
<section id="linear-regression">
<h2>Linear Regression<a class="headerlink" href="#linear-regression" title="Link to this heading">#</a></h2>
<p>In cases where we have a lot of data, particularly when we have noisy (messy) data like we usually when making experimental measurements, we don’t really want to “overfit” the data by building the maximum order polynomial permitted by the data available. Instead, we <em><strong>generally</strong></em> want to find a polynomial that adequately describes <em>trends</em> in data without <em>overfitting</em> the data.  This is the basic idea behind regression analysis – it is a method wherein we seek to minimize the error between model predictionss and the measurement values (data) that we have available. How do we decide on the exact polynomial or functional form that should comprise our model? Ultimately, this is done by applying some intuition about the way that the system should behave (e.g., if we know that <span class="math notranslate nohighlight">\(y\)</span> should scale linearly with <span class="math notranslate nohighlight">\(x\)</span>) and combining it with a critical examination of how well a given model describes our data.</p>
<p>To begin with <em><strong>regression analysis</strong></em>, let’s look at the random data set again, but we’ll apply a critical eye and propose a model that makes sense instead of attempting to fit a maximum order polynomial.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For reasons that will become apparent later, when we perform polynomial regressions of the type described here, we are performing <em><strong>linear regression</strong></em>. It does not matter how nonlinear the model is because we are solving for coefficients (not <span class="math notranslate nohighlight">\(x\)</span> or <span class="math notranslate nohighlight">\(y\)</span> values), and nonlinear polynomials are linear in coefficients for known values of <span class="math notranslate nohighlight">\((x,y)\)</span>. Linear regression does not mean fitting data to a first order model – it refers to using matrices to perform linear least squares analysis.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###########################################################################</span>
<span class="c1"># Prepare a scatterplot with the 11 random (x,y) pairs                    #</span>
<span class="c1">###########################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fce12c31689bd7c7a37f87c2e40c7a6a553eee75cfd6856b97bf167bb4a399ee.png" src="../_images/fce12c31689bd7c7a37f87c2e40c7a6a553eee75cfd6856b97bf167bb4a399ee.png" />
</div>
</div>
<section id="fitting-a-first-order-linear-model-to-the-data">
<h3>Fitting a first order (linear) model to the data<a class="headerlink" href="#fitting-a-first-order-linear-model-to-the-data" title="Link to this heading">#</a></h3>
<p>Let’s start by acknowledging that we do not want to try to model the dependence of <span class="math notranslate nohighlight">\(y\)</span> on <span class="math notranslate nohighlight">\(x\)</span> using a <span class="math notranslate nohighlight">\(10^{th}\)</span> order polynomial. As explained above, a <span class="math notranslate nohighlight">\(10^{th}\)</span> order polynomial overfits the data and reduces its predictive power. Let’s propose a different model – we’ll try to suggest something that can capture the overall <em><strong>trend</strong></em> in data or the <em><strong>shape</strong></em> of the data while ignoring noise. Looking at the data, we could reasonably suggest that the value of <span class="math notranslate nohighlight">\(y\)</span> decreases linearly as the value of <span class="math notranslate nohighlight">\(x\)</span> increases. This would motivate us to try to fit a <em><strong>first order model</strong></em> to the data. We can represent that model using the general form of a first order polynomial:</p>
<div class="math notranslate nohighlight">
\[y(x) = \alpha_1x^1 + \alpha_0x^0\]</div>
<p>If we inspect this equation alongside the available data, we would eventually conclude that we have two unknown coefficients in that model, and we would like to determine their values. In this case, we will attempt to do so by leveraging the 11 data points we have available. One observation we might make upon reviewing the scatterplot of <span class="math notranslate nohighlight">\((x,y)\)</span> pairs is that we have 11 data points, and they are all scattered (this is done to simulate experimental noise). Visually, it should be very clear that there is no single straight line (first order model) that can pass through each data point. In mathematical terms, this comprises an overdetermiend system. In this case, our goal is not to find a straight line that passes through all data points – it is to find the the one straight line that minimizes the error between the measured value of <span class="math notranslate nohighlight">\(y\)</span> at a given value of <span class="math notranslate nohighlight">\(x\)</span> and the value of <span class="math notranslate nohighlight">\(y\)</span> predicted by the model for a given value of <span class="math notranslate nohighlight">\(x\)</span>. There are many ways to approach this, but the most common one is least squares regression. In this approach, we define a metric called the residual sum of squares:</p>
<div class="math notranslate nohighlight">
\[\textrm{SSE} = \sum_i (y_i - \hat{y}_i)^2\]</div>
<p>Here, <span class="math notranslate nohighlight">\(y_i\)</span> is <span class="math notranslate nohighlight">\(i^{th}\)</span> value of our observable, <span class="math notranslate nohighlight">\(y_i\)</span>, measured at condition <span class="math notranslate nohighlight">\(x_i\)</span>, and <span class="math notranslate nohighlight">\(\hat{y}_i\)</span> is the value of our observable <span class="math notranslate nohighlight">\(y_i\)</span> predicted at condition <span class="math notranslate nohighlight">\(x_i\)</span> by our model. We will use least squares a lot in this course! In fact, whether you previously realized it or not, the method of least squares is embedded in a lot of the tools that most of us are probably are using already. The one most people are familiar with is Excel’s trendline feature, which is performing linear least squares regression using whichever model you choose. Excel also has least squarest regression build into the LINEST function. The methods we are developing for least squares here are also used in <code class="docutils literal notranslate"><span class="pre">numpy.polyfit()</span></code>.</p>
<p>It is most straightforward to frame linear regression as an extension of the matrix method that we developed above for polynomial interpolation. We begin proposing that a first order (linear) model will adequately describe the dependence of <span class="math notranslate nohighlight">\(y\)</span> on <span class="math notranslate nohighlight">\(x\)</span>. This means that we intend to use first order model (2 coefficients) to describe 11 <span class="math notranslate nohighlight">\((x,y)\)</span> pairs. We can write the first order model for each <span class="math notranslate nohighlight">\((x,y)\)</span> pair in our data set to generate the following system of equations…</p>
<div class="amsmath math notranslate nohighlight" id="equation-8350a4d9-ae67-4d37-b587-1817db4f6dfc">
<span class="eqno">(13)<a class="headerlink" href="#equation-8350a4d9-ae67-4d37-b587-1817db4f6dfc" title="Permalink to this equation">#</a></span>\[\begin{align}
    y_1    &amp;= \alpha_1x_1 + \alpha_0 \\
    y_2    &amp;= \alpha_1x_2 + \alpha_0 \\
    y_3    &amp;= \alpha_1x_3 + \alpha_0 \\
    y_4    &amp;= \alpha_1x_4 + \alpha_0 \\
    y_5    &amp;= \alpha_1x_5 + \alpha_0 \\
    y_6    &amp;= \alpha_1x_6 + \alpha_0 \\
    y_7    &amp;= \alpha_1x_7 + \alpha_0 \\
    y_8    &amp;= \alpha_1x_8 + \alpha_0 \\
    y_9    &amp;= \alpha_1x_9 + \alpha_0 \\
    y_{10} &amp;= \alpha_1x_{10} + \alpha_0 \\
    y_{11} &amp;= \alpha_1x_{11} + \alpha_0 \\
\end{align}\]</div>
<p>In that set of equations, we know each of the <span class="math notranslate nohighlight">\((x,y)\)</span> pairs because we have a measured or observed value of <span class="math notranslate nohighlight">\(y\)</span> at every corresponding <span class="math notranslate nohighlight">\(x\)</span>. We do not know the values of the coefficients <span class="math notranslate nohighlight">\(\alpha_1\)</span> and <span class="math notranslate nohighlight">\(\alpha_2\)</span>. These are the two unknowns that we are trying to solve for! The problem here is that we have 11 equations written in terms of only 2 unknowns. This is an overdetermined system, and there is no way for us to satisfy each of these constraints equation exactly. There is then no unique solution for <span class="math notranslate nohighlight">\((\alpha_0, \alpha_1)\)</span> that will solve this system of equations. Instead, we aim to minimize the error between measured values and predicted values. This is still a linear system since the problem is linear in our unknown coefficients. As such, we can use linear algebra to estimate the “best” values for the unknown coefficients. We start by putting the above system in matrix form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix} x_1^1 &amp; x_1^0 \\ x_2^1 &amp; x_2^0 \\ x_3^1 &amp; x_3^0 \\ x_4^1 &amp; x_4^0 \\ x_5^1 &amp; x_5^0 \\ x_6^1 &amp; x_6^0 \\ x_7^1 &amp; x_7^0 \\ x_8^1 &amp; x_8^0 \\ x_9^1 &amp; x_9^0 \\ x_{10}^1 &amp; x_{10}^0 \\ x_{11}^1 &amp; x_{11}^0 \end{bmatrix} \times 
\begin{bmatrix} \alpha_1 \\ \alpha_0 \end{bmatrix} = 
\begin{bmatrix} y_1 \\ y_2 \\ y_3 \\ y_4 \\ y_5 \\ y_6 \\ y_7 \\ y_8 \\ y_9 \\ y_{10} \\ y_{11} \\  \end{bmatrix}\end{split}\]</div>
<p>Or, as usual:</p>
<div class="math notranslate nohighlight">
\[XA = Y\]</div>
<p>We run into a problem when we try to solve this, though (see below).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In Python, we can truncate the Vandermonde matrix to include the number of columns necessary to fit a specific order polynomial – remember that in the Vandermonde Matrix, each column corresponds to an order (power) of “x” that appears in the model. For this example, we are fitting a first order polynomial to the data; we have an <span class="math notranslate nohighlight">\(x^1\)</span> term and an <span class="math notranslate nohighlight">\(x^0\)</span> term in a first order model, and we have two unknown coefficients, so we truncate the Vandermonde Matrix to two columns (zero order, first order).</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################################</span>
<span class="c1"># Generating, printing, and truncating various forms of X matrix  #</span>
<span class="c1">###################################################################</span>

<span class="n">Ya</span> <span class="o">=</span> <span class="n">ydata</span>
<span class="c1"># print(np.vander(xdata)) #full vandermonde matrix; would use to generate 10th order polynomial from data</span>
<span class="c1"># np.round(np.vander(xdata), 2) #full vandermonde matrix rounded to two decimal places for display purposes</span>
<span class="c1"># np.round(np.vander(xdata, 2), 2) #vandermonde matrix truncated to first order (two columns); each rounded to two decimal places</span>
<span class="n">Xa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">#This creates the X matrix shown above, truncating at 1st order</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Xa</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ya</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.22733602 1.        ]
 [0.31675834 1.        ]
 [0.79736546 1.        ]
 [0.67625467 1.        ]
 [0.39110955 1.        ]
 [0.33281393 1.        ]
 [0.59830875 1.        ]
 [0.18673419 1.        ]
 [0.67275604 1.        ]
 [0.94180287 1.        ]
 [0.24824571 1.        ]]
[0.94888115 0.66723745 0.09589794 0.44183967 0.88647992 0.6974535
 0.32647286 0.73392816 0.22013496 0.08159457 0.1598956 ]
</pre></div>
</div>
</div>
</div>
<p>If we try to solve the matrix system with that X, though, we’ll hit an error…</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The code blocks below include intentional dimension errors that demonstrate the messages that come from attempting to invert a non-square matrix. Remember: matrices can only be inverted if they are square (which is a fully determined system)!</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">########################################################################################</span>
<span class="c1"># Direct matrix inversion will not work for overdetermined system                      #</span>
<span class="c1">########################################################################################</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Xa</span><span class="p">,</span> <span class="n">Ya</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">LinAlgError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">########################################################################################</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="c1"># Direct matrix inversion will not work for overdetermined system                      #</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1">########################################################################################</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Xa</span><span class="p">,</span> <span class="n">Ya</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\Lib\site-packages\numpy\linalg\_linalg.py:399,</span> in <span class="ni">solve</span><span class="nt">(a, b)</span>
<span class="g g-Whitespace">    </span><span class="mi">397</span> <span class="n">a</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_makearray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">398</span> <span class="n">_assert_stacked_2d</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">399</span> <span class="n">_assert_stacked_square</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">400</span> <span class="n">b</span><span class="p">,</span> <span class="n">wrap</span> <span class="o">=</span> <span class="n">_makearray</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">401</span> <span class="n">t</span><span class="p">,</span> <span class="n">result_t</span> <span class="o">=</span> <span class="n">_commonType</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\Lib\site-packages\numpy\linalg\_linalg.py:202,</span> in <span class="ni">_assert_stacked_square</span><span class="nt">(*arrays)</span>
<span class="g g-Whitespace">    </span><span class="mi">200</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
<span class="g g-Whitespace">    </span><span class="mi">201</span> <span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="n">n</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">202</span>     <span class="k">raise</span> <span class="n">LinAlgError</span><span class="p">(</span><span class="s1">&#39;Last 2 dimensions of the array must be square&#39;</span><span class="p">)</span>

<span class="ne">LinAlgError</span>: Last 2 dimensions of the array must be square
</pre></div>
</div>
</div>
</div>
<p>This comes up because we can’t invert a non-square matrix…(X is tall, not square)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1"># Demonstrating error from attempting to invert a non-square matrix           #</span>
<span class="c1">###############################################################################</span>

<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Xa</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">LinAlgError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">42</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">###############################################################################</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="c1"># Demonstrating error from attempting to invert a non-square matrix           #</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1">###############################################################################</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Xa</span><span class="p">)</span>

<span class="nn">File c:\Users\jqbon\anaconda3\Lib\site-packages\numpy\linalg\_linalg.py:609,</span> in <span class="ni">inv</span><span class="nt">(a)</span>
<span class="g g-Whitespace">    </span><span class="mi">607</span> <span class="n">a</span><span class="p">,</span> <span class="n">wrap</span> <span class="o">=</span> <span class="n">_makearray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">608</span> <span class="n">_assert_stacked_2d</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">609</span> <span class="n">_assert_stacked_square</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">610</span> <span class="n">t</span><span class="p">,</span> <span class="n">result_t</span> <span class="o">=</span> <span class="n">_commonType</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">612</span> <span class="n">signature</span> <span class="o">=</span> <span class="s1">&#39;D-&gt;D&#39;</span> <span class="k">if</span> <span class="n">isComplexType</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;d-&gt;d&#39;</span>

<span class="nn">File c:\Users\jqbon\anaconda3\Lib\site-packages\numpy\linalg\_linalg.py:202,</span> in <span class="ni">_assert_stacked_square</span><span class="nt">(*arrays)</span>
<span class="g g-Whitespace">    </span><span class="mi">200</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
<span class="g g-Whitespace">    </span><span class="mi">201</span> <span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="n">n</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">202</span>     <span class="k">raise</span> <span class="n">LinAlgError</span><span class="p">(</span><span class="s1">&#39;Last 2 dimensions of the array must be square&#39;</span><span class="p">)</span>

<span class="ne">LinAlgError</span>: Last 2 dimensions of the array must be square
</pre></div>
</div>
</div>
</div>
<p>Again, we have an overdetermined system, and we cannot solve it directly by matrix inversion as we would a fully determined system of linear equations. The linear algebra way to approach the problem of an overdetermined system follows. We start with our non-square <span class="math notranslate nohighlight">\(X\)</span> matrix, and we apply the following multiplication steps. Note that multiplying <span class="math notranslate nohighlight">\(X\)</span> by its transpose will create a square matrix, so the product <span class="math notranslate nohighlight">\(X^TX\)</span> <em><strong>is</strong></em> invertible even if <span class="math notranslate nohighlight">\(X\)</span> is non-square.</p>
<div class="amsmath math notranslate nohighlight" id="equation-253839a2-5627-44dd-9d8d-c9b341d86724">
<span class="eqno">(14)<a class="headerlink" href="#equation-253839a2-5627-44dd-9d8d-c9b341d86724" title="Permalink to this equation">#</a></span>\[\begin{align}
    XA &amp;= Y \\
    X^TXA &amp;= X^TY \\
    \left(X^TX\right)^{-1}X^TXA &amp;= \left(X^TX\right)^{-1}X^TY \\
    IA &amp;= \left(X^TX\right)^{-1}X^TY \\
    A &amp;= \left(X^TX\right)^{-1}X^TY \\
\end{align}\]</div>
<p>Believe it or not, that operation on the right hand side, <span class="math notranslate nohighlight">\(\left(X^TX\right)^{-1}X^TY\)</span> finds the set of coefficients that minimizes the sum of squares for this linear problem. This is a completely general result, and we can use a matrix method to solve for the optimum coefficients (giving the line of “best fit”) for any problem that is linear in its coefficients.  See below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">############################################################################################</span>
<span class="c1"># Solving the least squares problem for best fit coefficients                              #</span>
<span class="c1">############################################################################################</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Xa</span><span class="o">.</span><span class="n">T</span><span class="nd">@Xa</span><span class="p">,</span> <span class="n">Xa</span><span class="o">.</span><span class="n">T</span><span class="nd">@Ya</span><span class="p">)</span> 
<span class="c1">#The above is equivalent to (but more memory efficient) than np.linalg.inv(X.T@X)@X.T@Y</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.90421001  0.92118569]
</pre></div>
</div>
</div>
</div>
<p>Now we can plug those “optimum” coefficients into our first order model, which is the best fit straight line to our data set (from a least squares perspective)…</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Note that since these are matrices, we generate the array of predicted <span class="math notranslate nohighlight">\(Y\)</span> values at each value in <span class="math notranslate nohighlight">\(X\)</span> from the following relationship using matrix multiplication</p>
<div class="math notranslate nohighlight">
\[\hat{Y} = X\hat{A}\]</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#################################################################################</span>
<span class="c1"># Define large array of x values for generating smooth continuous line plot     #</span>
<span class="c1">#################################################################################</span>

<span class="n">xline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1">#################################################################################</span>
<span class="c1"># Define lambda function that describes line of best fit                        #</span>
<span class="c1">#################################################################################</span>

<span class="n">yline</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1">#################################################################################</span>
<span class="c1"># Overlay data, model predictions for y at x data, and continuous function y(x) #</span>
<span class="c1">################################################################################# </span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;measured data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">yline</span><span class="p">(</span><span class="n">xline</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;regressed y(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">Xa</span><span class="nd">@A</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data predictions&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9691ee14e928e094b52e9986cba7293da053a333cb5d8337110b72bc99354a37.png" src="../_images/9691ee14e928e094b52e9986cba7293da053a333cb5d8337110b72bc99354a37.png" />
</div>
</div>
<p>Is this line a perfect descriiption of our data? No. But this <em><strong>is</strong></em> the straight line that best describes the trend in our data (i.e., the relationship between <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(x\)</span>). Depending on our insights into the fundamental relationship between <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(x\)</span>, and depending on how well a given model fits our data, we might alternatively choose a different model (2nd order, exponential function, etc.). Different models might fit our data better than a first order model, but we should realize that <em><strong>if we want to use a straight line to model the relationship between <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(x\)</span>, this result is as good as it gets.</strong></em></p>
<p>If you like, paste the arrays of <code class="docutils literal notranslate"><span class="pre">xdata</span></code> and <code class="docutils literal notranslate"><span class="pre">ydata</span></code> into Excel, plot them, and add a first order trendline. If you do so, you will find that:</p>
<ol class="arabic simple">
<li><p>slope = -0.904</p></li>
<li><p>y-intercept = 0.921</p></li>
</ol>
<p>Why?  Because we just went through what trendline does under the hood. Now you know!!</p>
</section>
<section id="fitting-a-second-order-quadratic-model-to-the-data">
<h3>Fitting a second order (quadratic) model to the data<a class="headerlink" href="#fitting-a-second-order-quadratic-model-to-the-data" title="Link to this heading">#</a></h3>
<p>Let’s say that we believe our data suggests that there is some curvature in the way that <span class="math notranslate nohighlight">\(y\)</span> varies as a function of <span class="math notranslate nohighlight">\(x\)</span>. We might also couple this with some insight about the system (the fundamental physics of the type of system we are considering, e.g., we know the reaction we are studying has a rate that is second order in reactant concentration. In this case, we might want a quadratic fit. That is no problem for us – the method we developed above is completely general and extensible to any order polynomial.  For a very formal display, we would start by writing a system of equations using the general form for a second order polynomial. As in all cases prior, we would write 11 equations because we have 11 <span class="math notranslate nohighlight">\((x,y)\)</span> pairs in our data set. This looks like:</p>
<div class="amsmath math notranslate nohighlight" id="equation-927d5708-03d6-4cc0-a745-131d3b0ce404">
<span class="eqno">(15)<a class="headerlink" href="#equation-927d5708-03d6-4cc0-a745-131d3b0ce404" title="Permalink to this equation">#</a></span>\[\begin{align}
    y_1    &amp;= \alpha_2{x_1}^2 + \alpha_1x_1 + \alpha_0 \\
    y_2    &amp;= \alpha_2{x_2}^2 + \alpha_1x_2 + \alpha_0 \\
    y_3    &amp;= \alpha_2{x_3}^2 + \alpha_1x_3 + \alpha_0 \\
    y_4    &amp;= \alpha_2{x_4}^2 + \alpha_1x_4 + \alpha_0 \\
    y_5    &amp;= \alpha_2{x_5}^2 + \alpha_1x_5 + \alpha_0 \\
    y_6    &amp;= \alpha_2{x_6}^2 + \alpha_1x_6 + \alpha_0 \\
    y_7    &amp;= \alpha_2{x_7}^2 + \alpha_1x_7 + \alpha_0 \\
    y_8    &amp;= \alpha_2{x_8}^2 + \alpha_1x_8 + \alpha_0 \\
    y_9    &amp;= \alpha_2{x_9}^2 + \alpha_1x_9 + \alpha_0 \\
    y_{10} &amp;= \alpha_2{x_{10}}^2 + \alpha_1x_{10} + \alpha_0 \\
    y_{11} &amp;= \alpha_2{x_{11}}^2 + \alpha_1x_{11} + \alpha_0 \\
\end{align}\]</div>
<p>We again have an overdetermined system of 11 equations written in terms of 11 known <span class="math notranslate nohighlight">\((x,y)\)</span> pairs and 3 unknown coefficients <span class="math notranslate nohighlight">\((\alpha_2, \alpha_1, \alpha_0)\)</span>. We create the standard X and Y arrays, and we use the least squares approach to find the optimum coefficients. We can again use <code class="docutils literal notranslate"><span class="pre">numpy.vander()</span></code> to create a truncated vandermonde matrix that includes terms up to <span class="math notranslate nohighlight">\(x^2\)</span>. We stop at <span class="math notranslate nohighlight">\(x^2\)</span> because we are fitting a second order model to the data.</p>
<div class="amsmath math notranslate nohighlight" id="equation-9d6f9bb2-97c5-40fb-bbf5-3ad44bba00f3">
<span class="eqno">(16)<a class="headerlink" href="#equation-9d6f9bb2-97c5-40fb-bbf5-3ad44bba00f3" title="Permalink to this equation">#</a></span>\[\begin{align}
    XA &amp;= Y \\
    X^TXA &amp;= X^TY \\
    \left(X^TX\right)^{-1}X^TXA &amp;= \left(X^TX\right)^{-1}X^TY \\
    IA &amp;= \left(X^TX\right)^{-1}X^TY \\
    A &amp;= \left(X^TX\right)^{-1}X^TY \\
\end{align}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because we have converted all equations into matrix form, the solution is identical to the first order regression problem, we just have an X matrix with a different size/shape <span class="math notranslate nohighlight">\((11, 3)\)</span>, and we have 3 coefficients.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######################################################################################</span>
<span class="c1"># Generate Y array of observables/measured quantities                                #</span>
<span class="c1">######################################################################################</span>

<span class="n">Yb</span> <span class="o">=</span> <span class="n">ydata</span>

<span class="c1">######################################################################################</span>
<span class="c1"># Generate truncated vandermonde matrix @ second order                               #</span>
<span class="c1"># This has 3 columns, x^2, x^1, x^0                                                  #</span>
<span class="c1">######################################################################################</span>

<span class="n">Xb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="c1">######################################################################################</span>
<span class="c1"># Display array of observables and truncated vandermonde matrix                      #</span>
<span class="c1">######################################################################################</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Yb</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">######################################################################################</span>
<span class="c1"># Solve for optimum set of coefficients for the 2nd order model, display results     #</span>
<span class="c1">######################################################################################</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Xb</span><span class="o">.</span><span class="n">T</span><span class="nd">@Xb</span><span class="p">,</span> <span class="n">Xb</span><span class="o">.</span><span class="n">T</span><span class="nd">@Yb</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1">######################################################################################</span>
<span class="c1"># Define lambda function for best fit 2nd order model using regressed coefficients   #</span>
<span class="c1">######################################################################################</span>

<span class="n">yline</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="c1">######################################################################################</span>
<span class="c1"># Overlay measured y data, predicted y data, and continuous 2nd order function y(x)  #</span>
<span class="c1">######################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;measured data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">yline</span><span class="p">(</span><span class="n">xline</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;regressed y(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">Xb</span><span class="nd">@A</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data predictions&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.94888115 0.66723745 0.09589794 0.44183967 0.88647992 0.6974535
 0.32647286 0.73392816 0.22013496 0.08159457 0.1598956 ] 

[[0.05 0.23 1.  ]
 [0.1  0.32 1.  ]
 [0.64 0.8  1.  ]
 [0.46 0.68 1.  ]
 [0.15 0.39 1.  ]
 [0.11 0.33 1.  ]
 [0.36 0.6  1.  ]
 [0.03 0.19 1.  ]
 [0.45 0.67 1.  ]
 [0.89 0.94 1.  ]
 [0.06 0.25 1.  ]] 

[-0.69969354 -0.14991027  0.76170812]
</pre></div>
</div>
<img alt="../_images/bb1b6edfc73a177fb82648a6a5480dcad65c7dc33a0ab2fc883d4d7ec282c5a3.png" src="../_images/bb1b6edfc73a177fb82648a6a5480dcad65c7dc33a0ab2fc883d4d7ec282c5a3.png" />
</div>
</div>
</section>
<section id="fitting-a-third-order-model-to-the-data">
<h3>Fitting a third order model to the data<a class="headerlink" href="#fitting-a-third-order-model-to-the-data" title="Link to this heading">#</a></h3>
<p>If for some reason we had insight to suggest that <span class="math notranslate nohighlight">\(y\)</span> scales with <span class="math notranslate nohighlight">\(x^3\)</span>, we might propose a third order polynomial to model the data. The general procedure still applies. We have 11 <span class="math notranslate nohighlight">\((x,y)\)</span> pairs, so we would write 11 equations based on a third order polynomial form.  These would be comprised of 11 known <span class="math notranslate nohighlight">\((x,y)\)</span> pairs and 4 unknown coefficients <span class="math notranslate nohighlight">\((\alpha_3, \alpha_2, \alpha_1, \alpha_0)\)</span>. The system of equations would look something like:</p>
<div class="amsmath math notranslate nohighlight" id="equation-2a98cae5-4a50-44f5-a1a6-70098d1c732a">
<span class="eqno">(17)<a class="headerlink" href="#equation-2a98cae5-4a50-44f5-a1a6-70098d1c732a" title="Permalink to this equation">#</a></span>\[\begin{align}
    y_1    &amp;= \alpha_3{x_1}^3 + \alpha_2{x_1}^2 + \alpha_1x_1 + \alpha_0 \\
    y_2    &amp;= \alpha_3{x_2}^3 + \alpha_2{x_2}^2 + \alpha_1x_2 + \alpha_0 \\
    y_3    &amp;= \alpha_3{x_3}^3 + \alpha_2{x_3}^2 + \alpha_1x_3 + \alpha_0 \\
    y_4    &amp;= \alpha_3{x_4}^3 + \alpha_2{x_4}^2 + \alpha_1x_4 + \alpha_0 \\
    y_5    &amp;= \alpha_3{x_5}^3 + \alpha_2{x_5}^2 + \alpha_1x_5 + \alpha_0 \\
    y_6    &amp;= \alpha_3{x_6}^3 + \alpha_2{x_6}^2 + \alpha_1x_6 + \alpha_0 \\
    y_7    &amp;= \alpha_3{x_7}^3 + \alpha_2{x_7}^2 + \alpha_1x_7 + \alpha_0 \\
    y_8    &amp;= \alpha_3{x_8}^3 + \alpha_2{x_8}^2 + \alpha_1x_8 + \alpha_0 \\
    y_9    &amp;= \alpha_3{x_9}^3 + \alpha_2{x_9}^2 + \alpha_1x_9 + \alpha_0 \\
    y_{10} &amp;= \alpha_3{x_{10}}^3 + \alpha_2{x_{10}}^2 + \alpha_1x_{10} + \alpha_0 \\
    y_{11} &amp;= \alpha_3{x_{11}}^3 + \alpha_2{x_{11}}^2 + \alpha_1x_{11} + \alpha_0 \\
\end{align}\]</div>
<p>The system is still overdetermined with 11 equations written in terms of 4 unknown coefficients, so we would apply a least squares solution to find the optimum coefficient values.  Again, we organize information in matrices, and the least square solution is exactly the same as above – the only difference is that we have an <span class="math notranslate nohighlight">\(X\)</span> matrix that is <span class="math notranslate nohighlight">\((11, 4),\)</span> and we have 4 coefficients in the <span class="math notranslate nohighlight">\(A\)</span> array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######################################################################################</span>
<span class="c1"># Generate Y array of observables/measured quantities                                #</span>
<span class="c1">######################################################################################</span>

<span class="n">Yc</span> <span class="o">=</span> <span class="n">ydata</span>

<span class="c1">######################################################################################</span>
<span class="c1"># Generate truncated vandermonde matrix @ second order                               #</span>
<span class="c1"># This has 4 columns, x^3, x^2, x^1, x^0                                             #</span>
<span class="c1">######################################################################################</span>

<span class="n">Xc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>

<span class="c1">######################################################################################</span>
<span class="c1"># Display array of observables and truncated vandermonde matrix                      #</span>
<span class="c1">######################################################################################</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Yc</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Xc</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">######################################################################################</span>
<span class="c1"># Solve for optimum set of coefficients for the 2nd order model, display results     #</span>
<span class="c1">######################################################################################</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Xc</span><span class="o">.</span><span class="n">T</span><span class="nd">@Xc</span><span class="p">,</span> <span class="n">Xc</span><span class="o">.</span><span class="n">T</span><span class="nd">@Yc</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1">######################################################################################</span>
<span class="c1"># Define lambda function for best fit 2nd order model using regressed coefficients   #</span>
<span class="c1">######################################################################################</span>

<span class="n">yline</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="c1">######################################################################################</span>
<span class="c1"># Overlay measured y data, predicted y data, and continuous 2nd order function y(x)  #</span>
<span class="c1">######################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;measured data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">yline</span><span class="p">(</span><span class="n">xline</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;regressed y(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">Xc</span><span class="nd">@A</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data predictions&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.94888115 0.66723745 0.09589794 0.44183967 0.88647992 0.6974535
 0.32647286 0.73392816 0.22013496 0.08159457 0.1598956 ] 

[[0.01 0.05 0.23 1.  ]
 [0.03 0.1  0.32 1.  ]
 [0.51 0.64 0.8  1.  ]
 [0.31 0.46 0.68 1.  ]
 [0.06 0.15 0.39 1.  ]
 [0.04 0.11 0.33 1.  ]
 [0.21 0.36 0.6  1.  ]
 [0.01 0.03 0.19 1.  ]
 [0.3  0.45 0.67 1.  ]
 [0.84 0.89 0.94 1.  ]
 [0.02 0.06 0.25 1.  ]] 

[ 4.85887321 -9.04727267  4.12600401  0.14299066]
</pre></div>
</div>
<img alt="../_images/1f9d1a90b1c8b0ffc4cb39cb6e332b1284aeda052b8b7f230b1f128c8cca5fc3.png" src="../_images/1f9d1a90b1c8b0ffc4cb39cb6e332b1284aeda052b8b7f230b1f128c8cca5fc3.png" />
</div>
</div>
<p>We can follow this same pattern all the way up to a 10th order polynomial. At this point, we are fitting an <span class="math notranslate nohighlight">\(n^{th}\)</span> order polynomial to <span class="math notranslate nohighlight">\(n+1\)</span> data points. This is a fully determined system, and we find a unique solution as presented <a class="reference internal" href="#general-representation">above</a>.</p>
</section>
</section>
<section id="for-fall-2025">
<h2>For Fall 2025:<a class="headerlink" href="#for-fall-2025" title="Link to this heading">#</a></h2>
<p>Consider stopping here.  The SSE and various other metrics start being useful around L30, and they would probably be retained better if introduced there instead of here.  Can truncate presentation to just focus on the coefficients and visually showing the line of best fit overlay.</p>
<section id="extra-useful-things-to-accompany-regression">
<h3>Extra, useful things to accompany regression<a class="headerlink" href="#extra-useful-things-to-accompany-regression" title="Link to this heading">#</a></h3>
<p>We calculate the residual sum of squares as usual:</p>
<div class="math notranslate nohighlight">
\[SSE = \sum_i (y_i - \hat{y}_i)^2\]</div>
<p>Which, for a linear regression problem is equivalent to:</p>
<div class="math notranslate nohighlight">
\[SSE = (Y - XA)^T(Y - XA)\]</div>
<p>In numpy that would be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SSE = (Y - X@A).T@(Y - X@A)
</pre></div>
</div>
<p>Mean Square Error is another useful metric. It quantifies the average square error in our data fit:</p>
<div class="math notranslate nohighlight">
\[MSE = \frac{SSE}{n_m}\]</div>
<p>Where <span class="math notranslate nohighlight">\(n_m\)</span> is the number of data points/measurements. From this, we can get the root mean square error, which is a good approximation of the absolute displacement (error) between our model and our measurement.</p>
<div class="math notranslate nohighlight">
\[RMSE = \sqrt{MSE}\]</div>
<p>The total sum of squares quantifies the error between the measurement and the mean of measurments:</p>
<div class="math notranslate nohighlight">
\[SST = \sum_i (y_i - \bar{y}_i)\]</div>
<p>If we have the residual and total sum of squares, we can calculate the coefficient of determination:</p>
<div class="math notranslate nohighlight">
\[R^2 = 1 - \frac{SSE}{SST}\]</div>
<p>If you want to obtain estimates of standard error in the slope and y intercept that you regress, you need to estimate the covariance matrix.  First, we estimate the variance, <span class="math notranslate nohighlight">\(\sigma^2\)</span> with the following:</p>
<div class="math notranslate nohighlight">
\[\sigma^2 \approx s^2\]</div>
<p>and:</p>
<div class="math notranslate nohighlight">
\[s^2 = \frac{SSE}{n_m - n_p}\]</div>
<p>Where <span class="math notranslate nohighlight">\(n_m\)</span> is the number of measurements and <span class="math notranslate nohighlight">\(n_p\)</span> is the number of regressed parameters.  This is also known as the “degrees of freedom” in our regression.</p>
<div class="math notranslate nohighlight">
\[s^2 = \frac{SSE}{DOF}\]</div>
<p>With that, we can estimate the covariance matrix from the measured data:</p>
<div class="math notranslate nohighlight">
\[COV = s^2(X^TX)^{-1}\]</div>
<p>The standard error in our regressed parameters is given by the diagonal elements in the following matrix:</p>
<div class="math notranslate nohighlight">
\[se = \sqrt{COV}\]</div>
<p>Noting that this may throw a warning if off-diagonal elements of the covariance matrix are negative.</p>
<p>From that, we get the standard error in the slope from <code class="docutils literal notranslate"><span class="pre">se[0,0]</span></code> and the standard error in the intercept from <code class="docutils literal notranslate"><span class="pre">se[1,1]</span></code>, i.e., the diagonal elements.</p>
<p>If you want to calculate confidence intervals, they are given by:</p>
<div class="math notranslate nohighlight">
\[CI = t(q, DOF)\times SE\]</div>
<p>Finally, noting that I’m working with a linear system, if I want to generate predicted values of my measured quantity (here ln(CA)), I can do so by multiplying my truncated vandermonde matrix by the regressed coefficients:</p>
<div class="math notranslate nohighlight">
\[\hat{Y} = X\hat{A}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ya</span>     <span class="o">=</span> <span class="n">ydata</span>
<span class="n">Xa</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#This creates the X matrix shown above, truncating at 1st order</span>
<span class="n">A</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Xa</span><span class="o">.</span><span class="n">T</span><span class="nd">@Xa</span><span class="p">,</span> <span class="n">Xa</span><span class="o">.</span><span class="n">T</span><span class="nd">@Ya</span><span class="p">)</span> 
<span class="n">Ypred</span>  <span class="o">=</span> <span class="n">Xa</span><span class="nd">@A</span>
<span class="n">Ybar</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>
<span class="n">Ndata</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>
<span class="n">SSE1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Ya</span> <span class="o">-</span> <span class="n">Ypred</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">SSE2</span>   <span class="o">=</span> <span class="p">(</span><span class="n">Ya</span> <span class="o">-</span> <span class="n">Xa</span><span class="nd">@A</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">@</span><span class="p">(</span><span class="n">Ya</span> <span class="o">-</span> <span class="n">Xa</span><span class="nd">@A</span><span class="p">)</span>
<span class="n">SST</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Ya</span> <span class="o">-</span> <span class="n">Ybar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">MSE</span>    <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">Ndata</span>
<span class="n">RMSE</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE</span><span class="p">)</span>
<span class="n">R2</span>     <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">SST</span>
<span class="n">DOF</span>    <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">s2</span>     <span class="o">=</span> <span class="n">SSE1</span><span class="o">/</span><span class="n">DOF</span>
<span class="n">COV</span>    <span class="o">=</span> <span class="n">s2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Xa</span><span class="o">.</span><span class="n">T</span><span class="nd">@Xa</span><span class="p">)</span>
<span class="n">m</span>      <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">b</span>      <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">SEm</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">SEb</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">COV</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">tval</span>   <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">DOF</span><span class="p">)</span>
<span class="n">CIm</span>    <span class="o">=</span> <span class="n">SEm</span><span class="o">*</span><span class="n">tval</span>
<span class="n">CIb</span>    <span class="o">=</span> <span class="n">SEb</span><span class="o">*</span><span class="n">tval</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;SSE&#39;</span><span class="p">,</span> <span class="s1">&#39;SST&#39;</span><span class="p">,</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span><span class="s1">&#39;RMSE&#39;</span><span class="p">,</span> <span class="s1">&#39;R2&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span>  <span class="p">,</span>  <span class="n">b</span> <span class="p">,</span>  <span class="n">SSE1</span><span class="p">,</span>  <span class="n">SST</span> <span class="p">,</span> <span class="n">MSE</span> <span class="p">,</span> <span class="n">RMSE</span><span class="p">,</span>  <span class="n">R2</span><span class="p">]</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIm</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1"> +/- </span><span class="si">{</span><span class="n">CIm</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">:</span><span class="s1">4s</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">xline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">yline</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;measured data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">yline</span><span class="p">(</span><span class="n">xline</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;smoothed regression line&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">Xa</span><span class="nd">@A</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data predictions&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>m    = -0.90 +/- 0.65
b    = 0.92 +/- 0.65
SSE  = 0.49
SST  = 1.03
MSE  = 0.04
RMSE = 0.21
R2   = 0.52
</pre></div>
</div>
<img alt="../_images/4d8598f0a9daf05e2bdd125a727830709092d79e176fb0634b25b07a1f284e40.png" src="../_images/4d8598f0a9daf05e2bdd125a727830709092d79e176fb0634b25b07a1f284e40.png" />
</div>
</div>
</section>
</section>
<section id="fyi-python-will-do-all-this-stuff-for-you-if-you-want">
<h2>FYI, Python will do all this stuff for you if you want…<a class="headerlink" href="#fyi-python-will-do-all-this-stuff-for-you-if-you-want" title="Link to this heading">#</a></h2>
<p>For your reference, Python will do most of this automatically through either np.polyfit or <code class="docutils literal notranslate"><span class="pre">np.linalg.leastsq()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#Fit a first order polynomial to data, two coefficients</span>
<span class="n">A2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">#Fit a second order polynomial to data, three coefficients</span>
<span class="n">A3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">#Fit a third order polynomial to data, four coefficients</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.90421001  0.92118569]
[-0.69969354 -0.14991027  0.76170812]
[ 4.85887321 -9.04727267  4.12600401  0.14299066]
</pre></div>
</div>
</div>
</div>
<p>Numpy is very nice because it will both do the regression for us (using <code class="docutils literal notranslate"><span class="pre">np.polyfit()</span></code>), and it will generate a polynomial for us so that we can make predictions (using <code class="docutils literal notranslate"><span class="pre">np.polyval()</span></code>).  This is an automated version of what we did above using matrices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">xline</span><span class="p">)</span>
<span class="n">second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span> <span class="n">xline</span><span class="p">)</span>
<span class="n">third</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">A3</span><span class="p">,</span> <span class="n">xline</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;regressed first order&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;regressed second order&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">third</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;regressed third order&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ab54341a6aaf33bfce51878053d353a76cbf81273ea7a346fdeb2b1fc220e374.png" src="../_images/ab54341a6aaf33bfce51878053d353a76cbf81273ea7a346fdeb2b1fc220e374.png" />
<img alt="../_images/bbd70f39633dd2612f7c3bb1b641a725aa5d9e885577a624006e2865068c3ce1.png" src="../_images/bbd70f39633dd2612f7c3bb1b641a725aa5d9e885577a624006e2865068c3ce1.png" />
<img alt="../_images/9ee44e6504c39d6fd0c42cd75ff672c470f06a3de5908a4f3014e6f6e34417cb.png" src="../_images/9ee44e6504c39d6fd0c42cd75ff672c470f06a3de5908a4f3014e6f6e34417cb.png" />
</div>
</div>
<p>Numpy also has the least squares version of <code class="docutils literal notranslate"><span class="pre">np.linalg.solve()</span></code>, which has a very similar syntax and will return least squares regressed coefficients same as above.  See results below for a first and second order regression of our the “tall” matrices above.  These will return regressed coefficients and the minimum sum of squares.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coeffs_1</span><span class="p">,</span> <span class="n">SSE_1</span><span class="p">,</span> <span class="n">cov_1</span><span class="p">,</span> <span class="n">sing_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">Xa</span><span class="p">,</span> <span class="n">Ya</span><span class="p">,</span> <span class="n">rcond</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">coeffs_2</span><span class="p">,</span> <span class="n">SSE_2</span><span class="p">,</span> <span class="n">cov_2</span><span class="p">,</span> <span class="n">sing_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">Yb</span><span class="p">,</span> <span class="n">rcond</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">coeffs_3</span><span class="p">,</span> <span class="n">SSE_3</span><span class="p">,</span> <span class="n">cov_3</span><span class="p">,</span> <span class="n">sing_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">Xc</span><span class="p">,</span> <span class="n">Yc</span><span class="p">,</span> <span class="n">rcond</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="c1">#np.linalg.lstsq(Xc, Yc, rcond = None)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">coeffs_1</span><span class="p">,</span> <span class="n">SSE_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coeffs_2</span><span class="p">,</span> <span class="n">SSE_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coeffs_3</span><span class="p">,</span> <span class="n">SSE_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.90421001  0.92118569] [0.49163018]
[-0.69969354 -0.14991027  0.76170812] [0.47936939]
[ 4.85887321 -9.04727267  4.12600401  0.14299066] [0.45149249]
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../Chapter2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lectures</p>
      </div>
    </a>
    <a class="right-next"
       href="587-N38.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Useful Ancillary Skills for Regression</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolation-vs-regression">Interpolation vs. Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-utility-of-functions">The Utility of Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#univariate-functions-f-x">Univariate Functions f(x)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zero-order">Zero order</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#first-order">First order</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#second-order">Second order</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#third-order">Third order</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fourth-order">Fourth order</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nth-order">nth order</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-modelling-the-inverse-problem">Data Modelling: The Inverse Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-data-into-a-system-of-equations">Converting data into a system of equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-quadratic-example">A Quadratic Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-matrix-vector-representation-of-the-inverse-problem">A Matrix/Vector representation of the Inverse Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-representation-of-the-2nd-order-problem">Matrix representation of the 2nd order problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-matrix-representation-of-higher-order-models">General Matrix Representation of higher order models</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-the-data">Fitting the data</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-x-matrix">Creating the X matrix</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-the-y-array">Constructing the Y array</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-for-the-unknown-coefficients">Solving for the unknown coefficients</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-the-interpolating-polynomial">Constructing the interpolating polynomial</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#now-pump-the-brakes">Now pump the brakes…</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-call-a-vandermonde-matrix-a-vandermonde-matrix">Let’s call a Vandermonde Matrix a Vandermonde Matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression">Linear Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-a-first-order-linear-model-to-the-data">Fitting a first order (linear) model to the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-a-second-order-quadratic-model-to-the-data">Fitting a second order (quadratic) model to the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-a-third-order-model-to-the-data">Fitting a third order model to the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-fall-2025">For Fall 2025:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-useful-things-to-accompany-regression">Extra, useful things to accompany regression</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fyi-python-will-do-all-this-stuff-for-you-if-you-want">FYI, Python will do all this stuff for you if you want…</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jesse Q. Bond, Syracuse University
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>